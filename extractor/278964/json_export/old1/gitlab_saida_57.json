[{"id":91104875,"iid":337230,"project_id":278964,"title":"Project import from S3 remote object storage does not work","description":"## Overview\n\nThis issue started by testing the [project import from remote object storage](https://docs.gitlab.com/ee/api/project_import_export.html#import-a-file-from-a-remote-object-storage) feature.\nAWS S3 was chosen for remote object storage.\n\nWhen trying to import a project export archive, uploaded to an AWS S3 bucket, to gitlab.com, it returns the following response:\n```text\n400 Bad Request\ncloudflare\n```\nThis applies to both the API by using Insomnia and `curl`.\n\n* The feature flag is enabled on gitlab.com by default.\n* This has also been tested on an on-prem GitLab instance and enabling the FF (`nginx` instead of `cloudflare`)\n\n```ruby\nirb(main):007:0\u003e Feature.all.map {|f| [f.name, f.state]}\n=\u003e [[\"multiple_merge_request_assignees\", :on], [:import_project_from_remote_file, :on]]\n```\n\nWhich remote object storage provider has this feature been tested on?\n\n## Details\n\n* The pre-signed URL is generated locally, on a MacOS, using the `brew` `aws` library:\n\n```bash\n$ aws s3 presign s3://import-from-remote-object-storage/2021-06-29_17-32-723_pmm-demo_test-project_export.tar.gz\n...\n\u003cpresigned_url_output\u003e\n```\n\n* The following JSON object is `POST`ed to the API endpoint `https://gitlab.com/api/v4/projects/remote-import`\n\n```json\n{\n\t\"url\":\"\u003cpresigned_url_output\u003e\",\n\t\"path\":\"pprokic-test-remote-project\",\n\t\"name\": \"pprokic Test Remote Project\",\n\t\"namespace\": \"pprokic\"\n}\n```\n\n* With headers\n\n```json\n{\n  Content-Type: application/json,\n  Private-Token: \u003ctoken\u003e,\n  Content-Length: application/gzip\n}\n```\n\n* By following the [doc example](https://docs.gitlab.com/14.0/ee/api/project_import_export.html#import-a-file-from-a-remote-object-storage) you would receive, even when adding the 2 missing headers `ContentType` and `ContentLength`:\n\n```json\n{\"error\":\"url is missing, path is missing\"}\n```\n\n* When fixing the 2 headers to `Content-Type` and `Content-Length` one gets:\n\n```html\n\u003chtml\u003e\n\u003chead\u003e\u003ctitle\u003e400 Bad Request\u003c/title\u003e\u003c/head\u003e\n\u003cbody\u003e\n\u003ccenter\u003e\u003ch1\u003e400 Bad Request\u003c/h1\u003e\u003c/center\u003e\n\u003chr\u003e\u003ccenter\u003ecloudflare\u003c/center\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nor `nginx` in case of self-managed\n\n## Proposed Solution\n\n- [x] Documentation fix: https://gitlab.com/gitlab-org/gitlab/-/merge_requests/75158\n   * The error `{\"error\":\"url is missing, path is missing\"}` is caused when the `data` attribute is not parsed, which because the header `Content-Type: application/json` is missing.\n- [x] `Content-Lenght` and `Content-Type` fix: https://gitlab.com/gitlab-org/gitlab/-/merge_requests/75170\n   * S3 don't return the `Content-Length` on a `head` request (https://gitlab.com/gitlab-org/gitlab/blob/master/app/services/import/gitlab_projects/create_project_from_remote_file_service.rb#L70);\n   * S3 don't use `application/gzip` for a `tar.gz` (https://gitlab.com/gitlab-org/gitlab/blob/master/app/services/import/gitlab_projects/create_project_from_remote_file_service.rb#L7), instead it uses `application/x-tar`;","state":"closed","created_at":"2021-07-29T16:32:11.745Z","updated_at":"2022-11-28T16:23:00.460Z","closed_at":"2021-12-20T22:15:33.368Z","closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"labels":["Category:Importers","Importer:Project Export/Import","Next Up","auto updated","backend","devops::manage","group::import","milestone::p2","section::dev","type::bug","workflow::production"],"milestone":{"id":2114820,"iid":67,"group_id":9970,"title":"14.6","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T05:00:52.094Z","updated_at":"2022-04-21T07:26:38.271Z","due_date":"2021-12-17","start_date":"2021-11-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/67"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"}],"author":{"id":3944762,"username":"pprokic","name":"Petar Prokiƒá","state":"active","avatar_url":"https://secure.gravatar.com/avatar/9fad1e062ce5cc63b1fbb5f9cc43e94c?s=80\u0026d=identicon","web_url":"https://gitlab.com/pprokic"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"user_notes_count":16,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337230","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":2,"completed_count":2},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"2 of 2 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337230","notes":"https://gitlab.com/api/v4/projects/278964/issues/337230/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337230/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337230","relative":"#337230","full":"gitlab-org/gitlab#337230"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3054,"epic":{"id":39522,"iid":3054,"title":"üêû Project Export/Import bugs","url":"/groups/gitlab-org/-/epics/3054","group_id":9970},"iteration":null,"health_status":null},{"id":91104482,"iid":337228,"project_id":278964,"title":"Adjust rate-limiting to webhook executions per plan","description":"\u003c!-- This issue template can be used a great starting point for feature requests. The last section \"Release notes\" can be used as a summary of the feature and is also required if you want to have your release post blog MR auto generated using the release post item generator:  https://about.gitlab.com/handbook/marketing/blog/release-posts/#release-post-item-generator. The remaining sections are the backbone for every feature in GitLab. --\u003e\n\n### Release notes \n\n\u003c!-- What is the problem and solution you're proposing? This content sets the overall vision for the feature and serves as the release notes that will populate in various places, including the [release post blog](https://about.gitlab.com/releases/categories/releases/) and [Gitlab project releases](https://gitlab.com/gitlab-org/gitlab/-/releases). \" --\u003e\n\n### Problem to solve \n\nIn https://gitlab.com/gitlab-org/gitlab/-/issues/330133, introduced limits per plan for webhooks but  only configured a webhook rate-limit for the Free tier.\n\nWe have to analyze the data we have to find good limits per each plan. Similar to what we did for the free tier https://gitlab.com/gitlab-org/gitlab/-/issues/330133#note_590024134.\n\n### Proposal \n\nSet limits for paid tiers but would need higher limits. We already use plan-based limits so this is simple to add, we just need to determine suitable limits for each tier. We should analyze what normal, non-abuse patterns look like today and what other similar services have set as limits.\n\nThis issue represents the first iteration where we log if a customer would be over limit but do not enforce the limit. A second issue https://gitlab.com/gitlab-org/gitlab/-/issues/365605 will enforce the limit.\n\n\u003c!--- Use the following resources to find the appropriate labels:\n- https://gitlab.com/gitlab-org/gitlab/-/labels\n- https://about.gitlab.com/handbook/product/categories/features/\n\nConsider adding related issues and epics to this issue. You can also reference the Feature Proposal Template (https://gitlab.com/gitlab-org/gitlab/-/blob/master/.gitlab/issue_templates/Feature%20proposal%20-%20detailed.md) for additional details to consider adding to this issue. Additionally, as a data oriented organization, when your feature exits planning breakdown, consider adding the `What does success look like, and how can we measure that?` section.\n\nOther sections to consider adding: \n\n### Intended users\n\nWho will use this feature? If known, include any of the following: types of users (e.g. Developer), personas, or specific company roles (e.g. Release Manager). It's okay to write \"Unknown\" and fill this field in later.\n\nPersonas are described at https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/\n\n* [Cameron (Compliance Manager)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#cameron-compliance-manager)\n* [Parker (Product Manager)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#parker-product-manager)\n* [Delaney (Development Team Lead)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#delaney-development-team-lead)\n* [Presley (Product Designer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#presley-product-designer)\n* [Sasha (Software Developer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#sasha-software-developer)\n* [Devon (DevOps Engineer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#devon-devops-engineer)\n* [Sidney (Systems Administrator)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#sidney-systems-administrator)\n* [Sam (Security Analyst)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#sam-security-analyst)\n* [Rachel (Release Manager)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#rachel-release-manager) \n* [Alex (Security Operations Engineer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#alex-security-operations-engineer)\n* [Simone (Software Engineer in Test)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#simone-software-engineer-in-test)\n* [Allison (Application Ops)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#allison-application-ops) \n* [Priyanka (Platform Engineer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#priyanka-platform-engineer)\n* [Dana (Data Analyst)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#dana-data-analyst)\n\n\n### User experience goal\n\nWhat is the single user experience workflow this problem addresses? \nFor example, \"The user should be able to use the UI/API/.gitlab-ci.yml with GitLab to \u003cperform a specific task\u003e\"\nhttps://about.gitlab.com/handbook/engineering/ux/ux-research-training/user-story-mapping/ \n\n\n### Further details\n\nInclude use cases, benefits, goals, or any other details that will help us understand the problem better. \n\n### Permissions and Security\n\n\u003c!-- What permissions are required to perform the described actions? Are they consistent with the existing permissions as documented for users, groups, and projects as appropriate? Is the proposed behavior consistent between the UI, API, and other access methods (e.g. email replies)?\nConsider adding checkboxes and expectations of users with certain levels of membership https://docs.gitlab.com/ee/user/permissions.html\n* [ ] Add expected impact to members with no access (0)\n* [ ] Add expected impact to Guest (10) members\n* [ ] Add expected impact to Reporter (20) members\n* [ ] Add expected impact to Developer (30) members \n* [ ] Add expected impact to Maintainer (40) members\n* [ ] Add expected impact to Owner (50) members \n\n### Documentation\n\n See the Feature Change Documentation Workflow https://docs.gitlab.com/ee/development/documentation/workflow.html#for-a-product-change\n\n* Add all known Documentation Requirements in this section. See https://docs.gitlab.com/ee/development/documentation/workflow.html\n* If this feature requires changing permissions, update the permissions document. See https://docs.gitlab.com/ee/user/permissions.html \n\n### Availability \u0026 Testing\n\nThis section needs to be retained and filled in during the workflow planning breakdown phase of this feature proposal, if not earlier.\n\nWhat risks does this change pose to our availability? How might it affect the quality of the product? What additional test coverage or changes to tests will be needed? Will it require cross-browser testing?\n\nPlease list the test areas (unit, integration and end-to-end) that needs to be added or updated to ensure that this feature will work as intended. Please use the list below as guidance.\n* Unit test changes\n* Integration test changes\n* End-to-end test change\n\nSee the test engineering planning process and reach out to your counterpart Software Engineer in Test for assistance: https://about.gitlab.com/handbook/engineering/quality/test-engineering/#test-planning \n\n### What does success look like, and how can we measure that?\n\nDefine both the success metrics and acceptance criteria. Note that success metrics indicate the desired business outcomes, while acceptance criteria indicate when the solution is working correctly. If there is no way to measure success, link to an issue that will implement a way to measure this. \n\n### What is the type of buyer?\n\nWhat is the buyer persona for this feature? See https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/buyer-persona/\nIn which enterprise tier should this feature go? See https://about.gitlab.com/handbook/product/pricing/#three-tiers\n\n### Is this a cross-stage feature?\n\nCommunicate if this change will affect multiple Stage Groups or product areas. We recommend always start with the assumption that a feature request will have an impact into another Group. Loop in the most relevant PM and Product Designer from that Group to provide strategic support to help align the Group's broader plan and vision, as well as to avoid UX and technical debt. https://about.gitlab.com/handbook/product/#cross-stage-features --\u003e\n\u003c!-- triage-serverless v3 PLEASE DO NOT REMOVE THIS SECTION --\u003e\n*This page may contain information related to upcoming products, features and functionality.\nIt is important to note that the information presented is for informational purposes only, so please do not rely on the information for purchasing or planning purposes.\nJust like with all projects, the items mentioned on the page are subject to change or delay, and the development, release, and timing of any products, features, or functionality remain at the sole discretion of GitLab Inc.*\n\u003c!-- triage-serverless v3 PLEASE DO NOT REMOVE THIS SECTION --\u003e\n\n### Availability \u0026 Testing\n\nThere is an issue for [expanding rate limit tests](https://gitlab.com/gitlab-org/gitlab/-/issues/350898)\n\nSuggestion: This issue should be brought into the milestone, with an addition of a EE specific unit/controller test that will trigger or not trigger the rate limit in different circumstances.\n\n\u003c!-- This section needs to be retained and filled in during the workflow planning breakdown phase of this feature proposal, if not earlier.\n\nWhat risks does this change pose to our availability? How might it affect the quality of the product? What additional test coverage or changes to tests will be needed? Will it require cross-browser testing?\n\nPlease list the test areas (unit, integration and end-to-end) that needs to be added or updated to ensure that this feature will work as intended. Please use the list below as guidance.\n* Unit test changes\n* Integration test changes\n* End-to-end test change\n\nSee the test engineering planning process and reach out to your counterpart Software Engineer in Test for assistance: https://about.gitlab.com/handbook/engineering/quality/test-engineering/#test-planning --\u003e","state":"closed","created_at":"2021-07-29T16:24:09.832Z","updated_at":"2022-11-22T19:36:47.420Z","closed_at":"2022-06-21T22:11:15.271Z","closed_by":{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"},"labels":["Application Limits","Deliverable","Eng-Inter-Dept::Rate Limits","GitLab Premium","GitLab Ultimate","availability::limit","backend","devops::manage","direction","documentation","group::integrations","quad-planning::complete-action","reliability","section::dev","severity::3","type::feature","workflow::in dev"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/73"},"assignees":[{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"}],"author":{"id":5709669,"username":"mushakov","name":"Melissa Ushakov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5709669/avatar.png","web_url":"https://gitlab.com/mushakov"},"type":"ISSUE","assignee":{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"},"user_notes_count":75,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":"2022-04-11","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337228","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":6,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 6 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337228","notes":"https://gitlab.com/api/v4/projects/278964/issues/337228/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337228/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337228","relative":"#337228","full":"gitlab-org/gitlab#337228"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":8975,"epic":{"id":623279,"iid":8975,"title":"Improve the reliability of webhooks: Webhook rate limiting","url":"/groups/gitlab-org/-/epics/8975","group_id":9970,"human_readable_end_date":"Dec 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":"on_track"},{"id":91103226,"iid":337226,"project_id":278964,"title":"Lazy load the logs_tree and lastCommit in the repository browser","description":"\u003c!-- This template is a great use for issues that are feature::additions or technical tasks for larger issues.--\u003e\n\n### Proposal \n\nInstead of pre-loading all the logs_tree / lastCommit in the page, lazy load them as users navigate through the page.\n\nThis could reduce the unnecessary extra load done to load content that is never shown to users.\n\nPlus, it could allow us to do some \"diet\" on the payload itself: Do we need the full commit message?\n\nThe timings show that these requests can be fast enough to not induce UX penalties.\n\n\n\u003cimg src=\"/uploads/507c173f21adb76ad34a3e203a3b828f/image.png\" width=\"300\"\u003e\n\n\u003c!-- Use this section to explain the feature and how it will work. It can be helpful to add technical details, design proposals, and links to related epics or issues. --\u003e\n\n\u003c!-- Consider adding related issues and epics to this issue. You can also reference the Feature Proposal Template (https://gitlab.com/gitlab-org/gitlab/-/blob/master/.gitlab/issue_templates/Feature%20proposal%20-%20detailed.md) for additional details to consider adding to this issue. Additionally, as a data oriented organization, when your feature exits planning breakdown, consider adding the `What does success look like, and how can we measure that?` section.\n--\u003e","state":"closed","created_at":"2021-07-29T16:03:27.986Z","updated_at":"2022-08-24T10:46:05.838Z","closed_at":"2021-10-13T10:55:48.950Z","closed_by":{"id":2819375,"username":"jerasmus","name":"Jacques Erasmus","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2819375/avatar.png","web_url":"https://gitlab.com/jerasmus"},"labels":["Category:Source Code Management","Deliverable","devops::create","frontend","group::source code","missed-deliverable","missed:14.3","section::dev","type::feature"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[{"id":2819375,"username":"jerasmus","name":"Jacques Erasmus","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2819375/avatar.png","web_url":"https://gitlab.com/jerasmus"}],"author":{"id":853414,"username":"andr3","name":"Andr√© Lu√≠s","state":"active","avatar_url":"https://secure.gravatar.com/avatar/241e39726efb512a29621070ccf26a90?s=80\u0026d=identicon","web_url":"https://gitlab.com/andr3"},"type":"ISSUE","assignee":{"id":2819375,"username":"jerasmus","name":"Jacques Erasmus","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2819375/avatar.png","web_url":"https://gitlab.com/jerasmus"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337226","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337226","notes":"https://gitlab.com/api/v4/projects/278964/issues/337226/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337226/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337226","relative":"#337226","full":"gitlab-org/gitlab#337226"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91098332,"iid":337220,"project_id":278964,"title":"Understand Ecosystem error budgets","description":"## Background\n\nAs we start using error budgets more in our planning, it would be useful to spend some time looking at the data behind them.\n\n[Kibana dashboard](https://dashboards.gitlab.net/d/stage-groups-integrations/stage-groups-group-dashboard-ecosystem-integrations?orgId=1).\n\n## Proposal\n\nThis could be a time-boxed discovery issue, and would answer questions like:\n\n* [x] Which types of errors are included? - A: https://gitlab.com/gitlab-org/gitlab/-/issues/337220#note_639138754\n* [x] Are we missing any errors that should be included? https://gitlab.com/gitlab-org/gitlab/-/issues/337220#note_650103811\n* [x] Are we including any errors that shouldn't be? (e.g. webhook error responses) - A: https://gitlab.com/gitlab-org/gitlab/-/issues/337220#note_639171853\n* [x] What's the impact of the most frequent errors? https://gitlab.com/gitlab-org/gitlab/-/issues/337220#note_650105817\n* [x] How do we prioritise reducing our error budget spend? https://gitlab.com/gitlab-org/gitlab/-/issues/337220#note_639178041\n\n## Follow up\n\nhttps://gitlab.com/gitlab-org/gitlab/-/issues/338383 to see if we can improve any documentation.","state":"closed","created_at":"2021-07-29T14:48:03.683Z","updated_at":"2022-11-22T19:36:49.045Z","closed_at":"2021-08-12T22:55:47.107Z","closed_by":{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"},"labels":["Category:Integrations","Discovery","auto updated","devops::manage","group::integrations","meta","reliability","section::dev","workflow::planning breakdown"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"}],"author":{"id":423116,"username":"toupeira","name":"Markus Koller","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7585ed50675c4febe7619f25b44f7fe0?s=80\u0026d=identicon","web_url":"https://gitlab.com/toupeira"},"type":"ISSUE","assignee":{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"},"user_notes_count":24,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337220","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":5,"completed_count":5},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"5 of 5 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337220","notes":"https://gitlab.com/api/v4/projects/278964/issues/337220/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337220/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337220","relative":"#337220","full":"gitlab-org/gitlab#337220"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6913,"epic":{"id":370101,"iid":6913,"title":"Integrations Error Budgets","url":"/groups/gitlab-org/-/epics/6913","group_id":9970},"iteration":null,"health_status":null},{"id":91097451,"iid":337216,"project_id":278964,"title":"Make the frontend handle a server error (500) on batch diffs gracefully","description":"\u003c!---\nPlease read this!\n\nBefore opening a new issue, make sure to search for keywords in the issues\nfiltered by the \"regression\" or \"bug\" label:\n\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=regression\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=bug\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n### Summary\n\n\u003c!-- Summarize the bug encountered concisely. --\u003e\n\nWhen the batch diffs trip and spit out a 500, the FE just sits there without any error.\n\nThis at least happens in the case described in:\n\n\u003e Just ran into this [over here](https://gitlab.com/gitlab-org/release-tools/-/merge_requests/1506/diffs). When opening the diff, the spinner just spins indefinitely with no indication that anything went wrong:\n\u003e\n\u003e ![Screen_Shot_2021-07-26_at_10.57.22_AM](https://gitlab.com/gitlab-org/gitlab/uploads/7a766e4fdbd2c8c633ffde2af09e273f/Screen_Shot_2021-07-26_at_10.57.22_AM.png)\n\u003e \n\u003e At the very least we could improve this with a \"Something went wrong fetching the diff\" on the ~frontend ü§∑\n\n\n### Steps to reproduce\n\n\u003c!-- Describe how one can reproduce the issue - this is very important. Please use an ordered list. --\u003e\n\n\n### Example Project\n\n\u003c!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. --\u003e\n\nhttps://gitlab.com/gitlab-org/release-tools/-/merge_requests/1506/diffs\n\n### What is the current *bug* behavior?\n\n\u003c!-- Describe what actually happens. --\u003e\n\nNo diffs show up and no error message is shown.\n\nHeads up: please check Show one file at a time and Show whitespace changes combinations.\n\n\n### What is the expected *correct* behavior?\n\n\u003c!-- Describe what you should see instead. --\u003e\nIf there's an error, properly inform the user.\n\n### Relevant logs and/or screenshots\n\n\u003c!-- Paste any relevant logs - please use code blocks (```) to format console output, logs, and code\n as it's tough to read otherwise. --\u003e\n\n\u003e ![Screen_Shot_2021-07-26_at_10.57.22_AM](https://gitlab.com/gitlab-org/gitlab/uploads/7a766e4fdbd2c8c633ffde2af09e273f/Screen_Shot_2021-07-26_at_10.57.22_AM.png)\n### Possible fixes\n\n\u003c!-- If you can, link to the line of code that might be responsible for the problem. --\u003e","state":"closed","created_at":"2021-07-29T14:33:10.930Z","updated_at":"2021-09-18T07:00:58.821Z","closed_at":"2021-09-08T16:18:28.633Z","closed_by":{"id":113870,"username":"iamphill","name":"Phil Hughes","state":"active","avatar_url":"https://secure.gravatar.com/avatar/533a51534470a11062df393543eab649?s=80\u0026d=identicon","web_url":"https://gitlab.com/iamphill"},"labels":["Category:Code Review Workflow","Deliverable","UX","devops::create","frontend","group::code review","priority::2","section::dev","severity::3","type::bug"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":113870,"username":"iamphill","name":"Phil Hughes","state":"active","avatar_url":"https://secure.gravatar.com/avatar/533a51534470a11062df393543eab649?s=80\u0026d=identicon","web_url":"https://gitlab.com/iamphill"},{"id":626804,"username":"pedroms","name":"Pedro Moreira da Silva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c306f087d191ac15549f3c11e3bed321?s=80\u0026d=identicon","web_url":"https://gitlab.com/pedroms"}],"author":{"id":853414,"username":"andr3","name":"Andr√© Lu√≠s","state":"active","avatar_url":"https://secure.gravatar.com/avatar/241e39726efb512a29621070ccf26a90?s=80\u0026d=identicon","web_url":"https://gitlab.com/andr3"},"type":"ISSUE","assignee":{"id":113870,"username":"iamphill","name":"Phil Hughes","state":"active","avatar_url":"https://secure.gravatar.com/avatar/533a51534470a11062df393543eab649?s=80\u0026d=identicon","web_url":"https://gitlab.com/iamphill"},"user_notes_count":4,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337216","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337216","notes":"https://gitlab.com/api/v4/projects/278964/issues/337216/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337216/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337216","relative":"#337216","full":"gitlab-org/gitlab#337216"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91093271,"iid":337209,"project_id":278964,"title":"Follow-up: Drop Trace Section Tables","description":"Drop `ci_build_trace_sections` and `ci_build_trace_section_names` as a follow-up from https://gitlab.com/gitlab-org/gitlab/-/issues/32565 where the application code was deleted.\n\n**Why** See https://gitlab.com/gitlab-org/gitlab/-/issues/32565 - we need to drop data we don't use","state":"closed","created_at":"2021-07-29T13:28:12.121Z","updated_at":"2022-05-30T15:01:21.781Z","closed_at":"2021-11-10T10:20:08.713Z","closed_by":{"id":1562869,"username":"abrandl","name":"Andreas Brandl","state":"active","avatar_url":"https://secure.gravatar.com/avatar/487c4c74f7e1714b5a270e00d4735e84?s=80\u0026d=identicon","web_url":"https://gitlab.com/abrandl"},"labels":["Category:Continuous Integration","Category:Database","auto updated","database","devops::data_stores","group::database","missed:14.2","missed:14.3","missed:14.4","section::ops","workflow::staging"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/66"},"assignees":[{"id":1562869,"username":"abrandl","name":"Andreas Brandl","state":"active","avatar_url":"https://secure.gravatar.com/avatar/487c4c74f7e1714b5a270e00d4735e84?s=80\u0026d=identicon","web_url":"https://gitlab.com/abrandl"}],"author":{"id":4626651,"username":"allison.browne","name":"Allison Browne","state":"active","avatar_url":"https://secure.gravatar.com/avatar/4bc33904c3bd3f2dce3db4e5af4ad1ae?s=80\u0026d=identicon","web_url":"https://gitlab.com/allison.browne"},"type":"ISSUE","assignee":{"id":1562869,"username":"abrandl","name":"Andreas Brandl","state":"active","avatar_url":"https://secure.gravatar.com/avatar/487c4c74f7e1714b5a270e00d4735e84?s=80\u0026d=identicon","web_url":"https://gitlab.com/abrandl"},"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337209","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337209","notes":"https://gitlab.com/api/v4/projects/278964/issues/337209/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337209/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337209","relative":"#337209","full":"gitlab-org/gitlab#337209"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6214,"epic":{"id":291484,"iid":6214,"title":"Table size violates \u003c 100 GB target: ci_build_trace_sections","url":"/groups/gitlab-org/-/epics/6214","group_id":9970,"human_readable_end_date":"Nov 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":"on_track"},{"id":91092498,"iid":337208,"project_id":278964,"title":"Follow-up from \"[RUN AS-IF-FOSS] Remove wrapper methods from Gitlab::Database\"","description":"The following discussions from !66288 should be addressed:\n\n- [ ] @ayufan started a [discussion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66288#note_638684719): \n\n    \u003e I think this is a follow-up to support many databases.\n\n- [ ] @ayufan started a [discussion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66288#note_638684725): \n\n    \u003e TODO: Support many DBs.\n\n- [ ] @ayufan started a [discussion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66288#note_638684729): \n\n    \u003e Support many databases, especially `:ci` as well.","state":"closed","created_at":"2021-07-29T13:16:28.319Z","updated_at":"2022-05-30T15:01:22.839Z","closed_at":"2021-09-13T15:40:39.894Z","closed_by":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"labels":["Category:Database","Category:Pods","Engineering Allocation","[deprecated] Accepting merge requests","devops::data_stores","group::database","section::enablement","type::maintenance"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337208","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":3,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 3 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337208","notes":"https://gitlab.com/api/v4/projects/278964/issues/337208/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337208/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337208","relative":"#337208","full":"gitlab-org/gitlab#337208"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":5974,"epic":{"id":268361,"iid":5974,"title":"Generalise our Load Balancing usage to allow many databases","url":"/groups/gitlab-org/-/epics/5974","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":91084094,"iid":337190,"project_id":278964,"title":"Sync requirements and requirement issues","description":"As part of https://gitlab.com/gitlab-org/gitlab/-/issues/323779 (Stage [IIb](https://gitlab.com/gitlab-org/gitlab/-/issues/323779#tools-stage-iib-logic-to-sync-requirements-with-requirementissues)), we want to sync requirements and requirement issues so that when the migration is finished, they are kept identical until we can move the SSOT from Requirments table to the Issues table.\n\nRelated to https://gitlab.com/gitlab-org/gitlab/-/issues/323779#tools-stage-iib-logic-to-sync-requirements-with-requirementissues","state":"closed","created_at":"2021-07-29T10:53:14.668Z","updated_at":"2022-09-12T15:50:36.887Z","closed_at":"2021-10-25T13:46:22.283Z","closed_by":{"id":426128,"username":"felipe_artur","name":"Felipe Artur","state":"active","avatar_url":"https://secure.gravatar.com/avatar/dbad92659914f56621cbdd726e283e60?s=80\u0026d=identicon","web_url":"https://gitlab.com/felipe_artur"},"labels":["Category:Requirements Management","Deliverable","auto updated","backend","devops::plan","feature::addition","group::certify","missed-deliverable","missed:14.2","missed:14.3","missed:14.4","section::dev","type::feature","workflow::verification"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/66"},"assignees":[{"id":426128,"username":"felipe_artur","name":"Felipe Artur","state":"active","avatar_url":"https://secure.gravatar.com/avatar/dbad92659914f56621cbdd726e283e60?s=80\u0026d=identicon","web_url":"https://gitlab.com/felipe_artur"},{"id":3717078,"username":"cablett","name":"charlie ablett","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3717078/avatar.png","web_url":"https://gitlab.com/cablett"}],"author":{"id":3717078,"username":"cablett","name":"charlie ablett","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3717078/avatar.png","web_url":"https://gitlab.com/cablett"},"type":"ISSUE","assignee":{"id":426128,"username":"felipe_artur","name":"Felipe Artur","state":"active","avatar_url":"https://secure.gravatar.com/avatar/dbad92659914f56621cbdd726e283e60?s=80\u0026d=identicon","web_url":"https://gitlab.com/felipe_artur"},"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337190","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337190","notes":"https://gitlab.com/api/v4/projects/278964/issues/337190/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337190/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337190","relative":"#337190","full":"gitlab-org/gitlab#337190"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91083988,"iid":337189,"project_id":278964,"title":"Prohibit unsupported features on Requirement Issues","description":"This is broken out from https://gitlab.com/gitlab-org/gitlab/-/issues/323779, specifically [Stage IIa](https://gitlab.com/gitlab-org/gitlab/-/issues/323779#tools-stage-iia-prohibit-unsupported-features-for-requirement-issues).\n\nWe're moving Requirement objects to Requirement Issues, but we don't want to accidentally introduce new functionality for them. So we need to identify the issue features that Requirements don't have and prohibit them.\n\nThis will most likely involve adding to https://gitlab.com/gitlab-org/gitlab/blob/master/ee/app/models/concerns/ee/issue_available_features.rb#L15. Here is an example https://gitlab.com/gitlab-org/gitlab/-/merge_requests/50396.\n\nFeatures that need to be blocked (further context: https://gitlab.com/gitlab-org/gitlab/-/issues/323779#note_632031203):\n\n- moving to another project\n- promote to epic\n- lock?\netc. \n\nSome of these have been done already and may not need doing.\n\nRelated to https://gitlab.com/gitlab-org/gitlab/-/issues/323779","state":"closed","created_at":"2021-07-29T10:51:07.448Z","updated_at":"2022-11-09T21:52:36.983Z","closed_at":"2021-11-03T18:33:26.797Z","closed_by":{"id":426128,"username":"felipe_artur","name":"Felipe Artur","state":"active","avatar_url":"https://secure.gravatar.com/avatar/dbad92659914f56621cbdd726e283e60?s=80\u0026d=identicon","web_url":"https://gitlab.com/felipe_artur"},"labels":["Category:Requirements Management","Deliverable","auto updated","backend","devops::plan","feature::addition","group::certify","missed-deliverable","missed:14.3","missed:14.4","section::dev","type::feature","workflow::in dev"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/66"},"assignees":[{"id":426128,"username":"felipe_artur","name":"Felipe Artur","state":"active","avatar_url":"https://secure.gravatar.com/avatar/dbad92659914f56621cbdd726e283e60?s=80\u0026d=identicon","web_url":"https://gitlab.com/felipe_artur"}],"author":{"id":3717078,"username":"cablett","name":"charlie ablett","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3717078/avatar.png","web_url":"https://gitlab.com/cablett"},"type":"ISSUE","assignee":{"id":426128,"username":"felipe_artur","name":"Felipe Artur","state":"active","avatar_url":"https://secure.gravatar.com/avatar/dbad92659914f56621cbdd726e283e60?s=80\u0026d=identicon","web_url":"https://gitlab.com/felipe_artur"},"user_notes_count":14,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337189","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337189","notes":"https://gitlab.com/api/v4/projects/278964/issues/337189/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337189/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337189","relative":"#337189","full":"gitlab-org/gitlab#337189"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":5171,"epic":{"id":178701,"iid":5171,"title":"Work Items - Migrate Requirements to Work Items","url":"/groups/gitlab-org/-/epics/5171","group_id":9970,"human_readable_end_date":"Apr 30, 2023","human_readable_timestamp":"\u003cstrong\u003e4\u003c/strong\u003e months remaining"},"iteration":null,"health_status":null},{"id":91073197,"iid":337177,"project_id":278964,"title":"Geo /admin/geo/nodes does not work properly with relative URLs","description":"I've configured `external_url https://gitlab.example.com/gitlab`.\n\nWhen I click `Save changes` or `Cancel` in my `/gitlab/admin/geo/nodes` screen, both buttons redirect me back to the `/admin/geo/nodes` page with a 404.\n\n![image](/uploads/80a549506ed2004a1eda9356443c0d16/image.png)\n\n![image](/uploads/abfa1de4da59f87ac09d9c497c319ece/image.png)\n\nDon't forget the relative path!","state":"closed","created_at":"2021-07-29T08:18:08.508Z","updated_at":"2021-08-10T15:55:27.329Z","closed_at":"2021-08-05T13:40:46.020Z","closed_by":{"id":4748809,"username":"zcuddy","name":"Zack Cuddy","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4748809/avatar.png","web_url":"https://gitlab.com/zcuddy"},"labels":["UX","devops::systems","frontend","group::geo","javascript","priority::4","section::enablement","severity::4","type::bug","workflow::in review"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":4748809,"username":"zcuddy","name":"Zack Cuddy","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4748809/avatar.png","web_url":"https://gitlab.com/zcuddy"}],"author":{"id":64248,"username":"stanhu","name":"Stan Hu","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/64248/stanhu.jpg","web_url":"https://gitlab.com/stanhu"},"type":"ISSUE","assignee":{"id":4748809,"username":"zcuddy","name":"Zack Cuddy","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4748809/avatar.png","web_url":"https://gitlab.com/zcuddy"},"user_notes_count":7,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337177","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337177","notes":"https://gitlab.com/api/v4/projects/278964/issues/337177/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337177/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337177","relative":"#337177","full":"gitlab-org/gitlab#337177"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91067305,"iid":337174,"project_id":278964,"title":"[Ci Minutes] [Feature flag] Add support for group actors","description":"As a PM/Engineer,\n- I want to be able to test a feature behind a feature flag with the max amount of confidence\n- I want to be able to debug it, might any problem arise\n- I want to be able to scope the activation on production only to [certain groups](https://gitlab.com/gitlab-org/gitlab/-/issues/322582#testing-groupsprojectsusers)\n\nTo obtain such results, we will add support for [groups actors](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors) for the FF `:new_route_ci_minutes_purchase` introduced with gitlab-org/gitlab!54934","state":"closed","created_at":"2021-07-29T07:22:09.226Z","updated_at":"2021-08-05T07:35:02.571Z","closed_at":"2021-08-05T07:35:02.555Z","closed_by":{"id":6348276,"username":"agulina","name":"Angelo Gulina","state":"active","avatar_url":"https://secure.gravatar.com/avatar/b28693a558066993ea93b7272208d285?s=80\u0026d=identicon","web_url":"https://gitlab.com/agulina"},"labels":["Category:Purchase","Fulfillment Priority","OKR","auto updated","backend","devops::fulfillment","group::purchase","section::fulfillment","type::feature","workflow::production"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":6348276,"username":"agulina","name":"Angelo Gulina","state":"active","avatar_url":"https://secure.gravatar.com/avatar/b28693a558066993ea93b7272208d285?s=80\u0026d=identicon","web_url":"https://gitlab.com/agulina"}],"author":{"id":6348276,"username":"agulina","name":"Angelo Gulina","state":"active","avatar_url":"https://secure.gravatar.com/avatar/b28693a558066993ea93b7272208d285?s=80\u0026d=identicon","web_url":"https://gitlab.com/agulina"},"type":"ISSUE","assignee":{"id":6348276,"username":"agulina","name":"Angelo Gulina","state":"active","avatar_url":"https://secure.gravatar.com/avatar/b28693a558066993ea93b7272208d285?s=80\u0026d=identicon","web_url":"https://gitlab.com/agulina"},"user_notes_count":7,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337174","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337174","notes":"https://gitlab.com/api/v4/projects/278964/issues/337174/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337174/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337174","relative":"#337174","full":"gitlab-org/gitlab#337174"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":5391,"epic":{"id":202570,"iid":5391,"title":"FE: Move CI Minutes purchase flows to GitLab.com UI","url":"/groups/gitlab-org/-/epics/5391","group_id":9970,"human_readable_end_date":"Nov 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":91066311,"iid":337169,"project_id":278964,"title":"Update usage ping enabled check in redis ordinary counters","description":"https://gitlab.com/gitlab-org/gitlab/-/blob/master/lib/gitlab/usage_data_counters/redis_counter.rb#L7\n\nWe have this check for usage_ping_enabled in redis counter\n\n```ruby\n      def increment(redis_counter_key)\n        return unless Gitlab::CurrentSettings.usage_ping_enabled\n\n        Gitlab::Redis::SharedState.with { |redis| redis.incr(redis_counter_key) }\n      end\n```\n\nWe should check for ee instances if customer service is enabled. We could use https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/services/service_ping/service_ping_settings.rb\n\nThis might affect 2 operational metrics. \n\n[counts.network_policy_drops](https://gitlab.com//gitlab-org/gitlab/-/blob/master/config/metrics/counts_all/20210216175448_network_policy_drops.yml)\n\n[counts.network_policy_forwards](https://gitlab.com//gitlab-org/gitlab/-/blob/master/config/metrics/counts_all/20210216175446_network_policy_forwards.yml)\n\nFor instances that have customers enabled and usage_ping disabled, we do not track this 2 metrics.","state":"closed","created_at":"2021-07-29T07:02:56.026Z","updated_at":"2021-08-19T13:33:46.927Z","closed_at":"2021-08-19T09:37:01.876Z","closed_by":{"id":4807002,"username":"mikolaj_wawrzyniak","name":"Miko≈Çaj Wawrzyniak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4807002/avatar.png","web_url":"https://gitlab.com/mikolaj_wawrzyniak"},"labels":["auto updated","backend","devops::growth","group::product intelligence","section::growth","workflow::in review"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":4807002,"username":"mikolaj_wawrzyniak","name":"Miko≈Çaj Wawrzyniak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4807002/avatar.png","web_url":"https://gitlab.com/mikolaj_wawrzyniak"}],"author":{"id":5365921,"username":"alinamihaila","name":"Alina Mihaila","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5365921/avatar.png","web_url":"https://gitlab.com/alinamihaila"},"type":"ISSUE","assignee":{"id":4807002,"username":"mikolaj_wawrzyniak","name":"Miko≈Çaj Wawrzyniak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4807002/avatar.png","web_url":"https://gitlab.com/mikolaj_wawrzyniak"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337169","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337169","notes":"https://gitlab.com/api/v4/projects/278964/issues/337169/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337169/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337169","relative":"#337169","full":"gitlab-org/gitlab#337169"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91065309,"iid":337167,"project_id":278964,"title":"[Feature flag] Rollout of `ci_skip_before_parsing_yaml`","description":"## Feature\n\nThis issue is to rollout [Move skip ci to be earlier in the pipeline processing](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66147) on production,\nwhich is currently behind the `ci_skip_before_parsing_yaml` feature flag.\n\n## Owners\n\n- Team: ~\"group::pipeline execution\" \n- Most appropriate slack channel to reach out to: `#g_pipeline_execution`\n- Best individual to reach out to: @avielle \n- PM: @jreporter \n\n## The Rollout Plan\n\n**Preparation Phase**\n- [x] Enable for `gitlab-org/gitlab` - Done on `2021-08-03`\n- [x] If no issue for 2 days, enable for 25% of Gitlab.com - Done on `2021-08-06` (delayed because of an unrelated) production incident\n- [ ] ~~If no issue for 2 days, enable for 50% of Gitlab.com~~ - skipped per this [thread](https://gitlab.com/gitlab-org/gitlab/-/issues/337167#note_645256984) \n- [ ] ~~If no issue for 2 days, enable for 75% of Gitlab.com~~ - skipped per this [thread](https://gitlab.com/gitlab-org/gitlab/-/issues/337167#note_645256984)\n- [x] If no issue for 2 days, enable for all of Gitlab.com - Done on `2021-08-09`\n- [x] If no issue for 2 days, enable by default in the YAML file - Done on `2021-08-11` https://gitlab.com/gitlab-org/gitlab/-/merge_requests/67839\n\n**Cleanup**\n\n- [x] Announce on the issue that the flag has been enabled\n- [x] Remove `ci_skip_before_parsing_yaml` feature flag\n    - [x] Remove all references to the feature flag from the codebase\n    - [x] Remove the YAML definitions for the feature from the repository\n    - [x] Update documentation if necessary\n    - [x] Create a Changelog Entry\n- [x] Clean up the feature flag from all environments by running this chatops command in `#production` channel `/chatops run feature delete ci_skip_before_parsing_yaml`.\n\n**Final Step**\n\n- [x] Close this rollout issue for the feature flag after the feature flag is removed from the codebase.\n\n## Rollback Steps\n\nThis feature can be disabled by running the following Chatops command:\n\n```\n/chatops run feature set ci_skip_before_parsing_yaml false\n```","state":"closed","created_at":"2021-07-29T06:46:00.231Z","updated_at":"2021-10-28T13:54:35.213Z","closed_at":"2021-08-19T12:56:22.572Z","closed_by":{"id":4059128,"username":"avielle","name":"Avielle Wolfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4059128/avatar.png","web_url":"https://gitlab.com/avielle"},"labels":["Category:Continuous Integration","backend","devops::verify","feature flag","group::pipeline execution","section::ops","type::maintenance"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":4059128,"username":"avielle","name":"Avielle Wolfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4059128/avatar.png","web_url":"https://gitlab.com/avielle"}],"author":{"id":514662,"username":"furkanayhan","name":"Furkan Ayhan","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/514662/avatar.png","web_url":"https://gitlab.com/furkanayhan"},"type":"ISSUE","assignee":{"id":4059128,"username":"avielle","name":"Avielle Wolfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4059128/avatar.png","web_url":"https://gitlab.com/avielle"},"user_notes_count":10,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337167","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":14,"completed_count":12},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"12 of 14 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337167","notes":"https://gitlab.com/api/v4/projects/278964/issues/337167/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337167/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337167","relative":"#337167","full":"gitlab-org/gitlab#337167"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":"on_track"},{"id":91051985,"iid":337158,"project_id":278964,"title":"Speed up search end to end tests by turning on elasticsearch once","description":"We're currently turning on elasticsearch before each test if the test sees that it is off. That is, the test examines the elasticsearch setting to see if it's off, if it is off then the test turns it on, waits, then starts the test, when the test is over as an `after` step the test returns the state to the original state, which is off. The next test does the same thing etc.\n\nWe can use `before(:suite)` in an `Rspec.configure` block to turn rspec on once, then run all the tests, then return it to the off position if we desire.","state":"closed","created_at":"2021-07-28T23:45:05.499Z","updated_at":"2022-05-30T16:31:10.520Z","closed_at":"2021-12-16T23:00:24.100Z","closed_by":{"id":4945780,"username":"ebanks","name":"Erick Banks","state":"active","avatar_url":"https://secure.gravatar.com/avatar/80fec5512e3a226d9fd734eb8875d4e5?s=80\u0026d=identicon","web_url":"https://gitlab.com/ebanks"},"labels":["Category:Global Search","auto updated","devops::data_stores","group::global search","section::enablement","type::maintenance","workflow::ready for development"],"milestone":{"id":2156369,"iid":68,"group_id":9970,"title":"14.7","description":"","state":"active","created_at":"2021-07-21T17:39:41.786Z","updated_at":"2021-07-21T17:39:41.786Z","due_date":"2022-01-17","start_date":"2021-12-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/68"},"assignees":[{"id":4945780,"username":"ebanks","name":"Erick Banks","state":"active","avatar_url":"https://secure.gravatar.com/avatar/80fec5512e3a226d9fd734eb8875d4e5?s=80\u0026d=identicon","web_url":"https://gitlab.com/ebanks"}],"author":{"id":4945780,"username":"ebanks","name":"Erick Banks","state":"active","avatar_url":"https://secure.gravatar.com/avatar/80fec5512e3a226d9fd734eb8875d4e5?s=80\u0026d=identicon","web_url":"https://gitlab.com/ebanks"},"type":"ISSUE","assignee":{"id":4945780,"username":"ebanks","name":"Erick Banks","state":"active","avatar_url":"https://secure.gravatar.com/avatar/80fec5512e3a226d9fd734eb8875d4e5?s=80\u0026d=identicon","web_url":"https://gitlab.com/ebanks"},"user_notes_count":5,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337158","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337158","notes":"https://gitlab.com/api/v4/projects/278964/issues/337158/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337158/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337158","relative":"#337158","full":"gitlab-org/gitlab#337158"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91050736,"iid":337156,"project_id":278964,"title":"`Delete user and contributions` action is missing for users that are a sole owner of a group","description":"\u003c!---\nPlease read this!\n\nBefore opening a new issue, make sure to search for keywords in the issues\nfiltered by the \"regression\" or \"bug\" label:\n\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=regression\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=bug\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n### Summary\n\nThe `Delete user and contributions` action is missing for users that are a sole owner of a group. Furthermore the previous message saying that you can not soft delete a user that is a sole owner of a group until you transfer that group ownership to someone else. Previously this was the message:\n\n![Screen_Shot_2021-07-29_at_8.40.15_AM](/uploads/ca10ae8b5660d3f03b05d066f78c1e2b/Screen_Shot_2021-07-29_at_8.40.15_AM.png)\n\nThis regression was introduced by https://gitlab.com/gitlab-org/gitlab/-/merge_requests/64648\n\n### Steps to reproduce\n\n1. Visit a user that is the sole owner of a group\n1. Look in \"User administration\" dropdown menu. Notice the missing `Delete user and contributions` action.\n\n### What is the current *bug* behavior?\n\n`Delete user and contributions` is missing for users that are a sole owner of a group.\n\n![Screen_Shot_2021-07-29_at_10.51.14_AM](/uploads/d315f9d83e8b9cddb95d66dd16fc0209/Screen_Shot_2021-07-29_at_10.51.14_AM.png)\n\n### What is the expected *correct* behavior?\n\n`Delete user and contributions` action is available.\n\n![Screen_Shot_2021-07-29_at_10.43.59_AM](/uploads/a710a366bf18d0bf351f1fa5bda76486/Screen_Shot_2021-07-29_at_10.43.59_AM.png)\n\n### Output of checks\n\nGitLab.com, GitLab Enterprise Edition 14.2.0-pre 859c8a0e18a\n\n### Workaround\n\nUsers that are the sole owner of a group can be deleted via the [API](https://docs.gitlab.com/ee/api/users.html#user-deletion) with the `hard_delete=true` option","state":"closed","created_at":"2021-07-28T22:49:57.226Z","updated_at":"2021-09-03T20:02:39.370Z","closed_at":"2021-08-03T15:25:20.331Z","closed_by":{"id":2454149,"username":"cynthia","name":"Cynthia \"Arty\" Ng","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2454149/avatar.png","web_url":"https://gitlab.com/cynthia"},"labels":["Category:Authentication and Authorization","admin dashboard","devops::manage","frontend","group::authentication and authorization","internal customer","priority::2","regression","regression:14.1","reproduced on GitLab.com","section::dev","severity::2","type::bug","workflow::production"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":5413811,"username":"peterhegman","name":"Peter Hegman","state":"active","avatar_url":"https://secure.gravatar.com/avatar/459d8635e9ab17a052c00ead1d7bf1e6?s=80\u0026d=identicon","web_url":"https://gitlab.com/peterhegman"}],"author":{"id":2454149,"username":"cynthia","name":"Cynthia \"Arty\" Ng","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2454149/avatar.png","web_url":"https://gitlab.com/cynthia"},"type":"ISSUE","assignee":{"id":5413811,"username":"peterhegman","name":"Peter Hegman","state":"active","avatar_url":"https://secure.gravatar.com/avatar/459d8635e9ab17a052c00ead1d7bf1e6?s=80\u0026d=identicon","web_url":"https://gitlab.com/peterhegman"},"user_notes_count":21,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337156","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337156","notes":"https://gitlab.com/api/v4/projects/278964/issues/337156/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337156/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337156","relative":"#337156","full":"gitlab-org/gitlab#337156"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91047490,"iid":337149,"project_id":278964,"title":"Move Content Editor loading and initialization to a Vue component","description":"Since the Content Editor object is not tracked by Vue reactivity system anymore, we need an accompanying reactive property to track when the editor loads. This forces clients of the Content Editor to implement pattern where a reactive property named \"isLoading\" is always required to make the Content Editor work properly. \n\nWe need to abstract this pattern in a reusable component to make the Content Editor API easier to integrate in other features.\n\nThe following discussion from !66540 should be addressed:\n\n- [ ] @pslaughter started a [discussion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66540#note_635672381):  (+2 comments)\n\n    \u003e **question:** Now that `contentEditor` isn't reactive (which is a good thing), the only reason this works in the template is because of it's association with `isContentEditorLoading`. For instance, I'm pretty sure that something like this wouldn't work:\n    \u003e \n    \u003e ```html\n    \u003e \u003ccontent-editor v-if=\"contentEditor\" :content-editor=\"contentEditor\" /\u003e\n    \u003e ```\n    \u003e \n    \u003e Which isn't really obvious. Considering that we want to reuse this in other areas, we might want to solve this problem sooner than later :thinking:\n    \u003e \n    \u003e In our early discussions about this, I think we were trying to shoot for a single component which could be responsible for creating this class. If there was some way we could encapsulate [`initContentEditor`](https://gitlab.com/gitlab-org/gitlab/blob/9d0c2edd0f540ed69f329e73cc8657659dfccb8a/app/assets/javascripts/pages/shared/wikis/components/wiki_form.vue#L262) into a reactive component, that would be pretty sweet...\n    \u003e \n    \u003e Given the current components, I'm thinking about something like:\n    \u003e \n    \u003e ```html\n    \u003e \u003ccontent-editor-factory :render-markdown=\"...\" :uploads-path=\"...\" :tiptap-options=\"...\" :init-content=\"...\"\u003e\n    \u003e   \u003ctemplate #default=\"{ isLoading, contentEditor }\"\u003e\n    \u003e     \u003ccontent-editor :content-editor=\"contentEditor\" /\u003e\n    \u003e   \u003c/template\u003e\n    \u003e \u003c/content-editor-factory\u003e\n    \u003e ```\n    \u003e \n    \u003e I'd love to hear your thoughts on this! What do you think is appropriate for this iteration? At the very least maybe we should leave some comments about the reactivity assumptions we're making?","state":"closed","created_at":"2021-07-28T21:03:41.075Z","updated_at":"2021-09-23T14:31:52.785Z","closed_at":"2021-08-12T20:06:08.561Z","closed_by":{"id":3540517,"username":"ealcantara","name":"Enrique Alc√°ntara","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3540517/avatar.png","web_url":"https://gitlab.com/ealcantara"},"labels":["auto updated","devops::create","frontend","group::editor","maintenance::refactor","section::dev","type::feature"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":3540517,"username":"ealcantara","name":"Enrique Alc√°ntara","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3540517/avatar.png","web_url":"https://gitlab.com/ealcantara"}],"author":{"id":3540517,"username":"ealcantara","name":"Enrique Alc√°ntara","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3540517/avatar.png","web_url":"https://gitlab.com/ealcantara"},"type":"ISSUE","assignee":{"id":3540517,"username":"ealcantara","name":"Enrique Alc√°ntara","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3540517/avatar.png","web_url":"https://gitlab.com/ealcantara"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337149","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 1 checklist item completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337149","notes":"https://gitlab.com/api/v4/projects/278964/issues/337149/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337149/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337149","relative":"#337149","full":"gitlab-org/gitlab#337149"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91046817,"iid":337145,"project_id":278964,"title":"Parse Markdown pasted into the Content Editor","description":"\u003c!-- triage-serverless v3 PLEASE DO NOT REMOVE THIS SECTION --\u003e\n*This page may contain information related to upcoming products, features and functionality.\nIt is important to note that the information presented is for informational purposes only, so please do not rely on the information for purchasing or planning purposes.\nJust like with all projects, the items mentioned on the page are subject to change or delay, and the development, release, and timing of any products, features, or functionality remain at the sole discretion of GitLab Inc.*\n\u003c!-- triage-serverless v3 PLEASE DO NOT REMOVE THIS SECTION --\u003e\n\u003c!-- This issue template can be used a great starting point for feature requests. The last section \"Release notes\" can be used as a summary of the feature and is also required if you want to have your release post blog MR auto generated using the release post item generator:  https://about.gitlab.com/handbook/marketing/blog/release-posts/#release-post-item-generator. The remaining sections are the backbone for every feature in GitLab. --\u003e\n\n### Release notes \n\n\u003c!-- What is the problem and solution you're proposing? This content sets the overall vision for the feature and serves as the release notes that will populate in various places, including the [release post blog](https://about.gitlab.com/releases/categories/releases/) and [Gitlab project releases](https://gitlab.com/gitlab-org/gitlab/-/releases). \" --\u003e\n\n### Problem to solve \n\nSometimes Markdown content destined for the Wiki is created outside of GitLab. In the \"classic\" Wiki editor, pasting valid Markdown was no problem because the raw source was preserved and only rendered when the content was submitted. In the Content Editor, the pasted content retains its Markdown formatting but ends up getting treated as plain text. This results in the need to manually reformat every line to remove Markdown syntax and re-format it using the WYSIWYG tools. \n\n### Proposal \n\nWhen content is pasted into the Content Editor, parse the Markdown syntax as if it were typed directly into the editor. \n\nFor example, if my clipboard contains\n\n```\n# A heading\n\nSome content followed by a \n\n- list of\n- some items\n- and another item\n```\n\nThe result of pasting it into the Content Editor should **not** be plain text with the same formatting, rather styled text in the editor.\n\n### Testing\n\nPlease run `package-and-qa` in MR and notify the SET in case of any failures. No changes to E2Es required, provided a lower level (integration/system) test coverage is in place.\n\n\u003c!--- Use the following resources to find the appropriate labels:\n- https://gitlab.com/gitlab-org/gitlab/-/labels\n- https://about.gitlab.com/handbook/product/categories/features/\n\nConsider adding related issues and epics to this issue. You can also reference the Feature Proposal Template (https://gitlab.com/gitlab-org/gitlab/-/blob/master/.gitlab/issue_templates/Feature%20proposal%20-%20detailed.md) for additional details to consider adding to this issue. Additionally, as a data oriented organization, when your feature exits planning breakdown, consider adding the `What does success look like, and how can we measure that?` section.\n\nOther sections to consider adding: \n\n### Intended users\n\nWho will use this feature? If known, include any of the following: types of users (e.g. Developer), personas, or specific company roles (e.g. Release Manager). It's okay to write \"Unknown\" and fill this field in later.\n\nPersonas are described at https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/\n\n* [Cameron (Compliance Manager)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#cameron-compliance-manager)\n* [Parker (Product Manager)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#parker-product-manager)\n* [Delaney (Development Team Lead)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#delaney-development-team-lead)\n* [Presley (Product Designer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#presley-product-designer)\n* [Sasha (Software Developer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#sasha-software-developer)\n* [Devon (DevOps Engineer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#devon-devops-engineer)\n* [Sidney (Systems Administrator)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#sidney-systems-administrator)\n* [Sam (Security Analyst)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#sam-security-analyst)\n* [Rachel (Release Manager)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#rachel-release-manager) \n* [Alex (Security Operations Engineer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#alex-security-operations-engineer)\n* [Simone (Software Engineer in Test)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#simone-software-engineer-in-test)\n* [Allison (Application Ops)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#allison-application-ops) \n* [Priyanka (Platform Engineer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#priyanka-platform-engineer)\n* [Dana (Data Analyst)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#dana-data-analyst)\n\n\n### User experience goal\n\nWhat is the single user experience workflow this problem addresses? \nFor example, \"The user should be able to use the UI/API/.gitlab-ci.yml with GitLab to \u003cperform a specific task\u003e\"\nhttps://about.gitlab.com/handbook/engineering/ux/ux-research-training/user-story-mapping/ \n\n\n### Further details\n\nInclude use cases, benefits, goals, or any other details that will help us understand the problem better. \n\n### Permissions and Security\n\n\u003c!-- What permissions are required to perform the described actions? Are they consistent with the existing permissions as documented for users, groups, and projects as appropriate? Is the proposed behavior consistent between the UI, API, and other access methods (e.g. email replies)?\nConsider adding checkboxes and expectations of users with certain levels of membership https://docs.gitlab.com/ee/user/permissions.html\n* [ ] Add expected impact to members with no access (0)\n* [ ] Add expected impact to Guest (10) members\n* [ ] Add expected impact to Reporter (20) members\n* [ ] Add expected impact to Developer (30) members \n* [ ] Add expected impact to Maintainer (40) members\n* [ ] Add expected impact to Owner (50) members \n\n### Documentation\n\n See the Feature Change Documentation Workflow https://docs.gitlab.com/ee/development/documentation/workflow.html#for-a-product-change\n\n* Add all known Documentation Requirements in this section. See https://docs.gitlab.com/ee/development/documentation/workflow.html\n* If this feature requires changing permissions, update the permissions document. See https://docs.gitlab.com/ee/user/permissions.html \n\n### Availability \u0026 Testing\n\nThis section needs to be retained and filled in during the workflow planning breakdown phase of this feature proposal, if not earlier.\n\nWhat risks does this change pose to our availability? How might it affect the quality of the product? What additional test coverage or changes to tests will be needed? Will it require cross-browser testing?\n\nPlease list the test areas (unit, integration and end-to-end) that needs to be added or updated to ensure that this feature will work as intended. Please use the list below as guidance.\n* Unit test changes\n* Integration test changes\n* End-to-end test change\n\nSee the test engineering planning process and reach out to your counterpart Software Engineer in Test for assistance: https://about.gitlab.com/handbook/engineering/quality/test-engineering/#test-planning \n\n### What does success look like, and how can we measure that?\n\nDefine both the success metrics and acceptance criteria. Note that success metrics indicate the desired business outcomes, while acceptance criteria indicate when the solution is working correctly. If there is no way to measure success, link to an issue that will implement a way to measure this. \n\n### What is the type of buyer?\n\nWhat is the buyer persona for this feature? See https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/buyer-persona/\nIn which enterprise tier should this feature go? See https://about.gitlab.com/handbook/product/pricing/#three-tiers\n\n### Is this a cross-stage feature?\n\nCommunicate if this change will affect multiple Stage Groups or product areas. We recommend always start with the assumption that a feature request will have an impact into another Group. Loop in the most relevant PM and Product Designer from that Group to provide strategic support to help align the Group's broader plan and vision, as well as to avoid UX and technical debt. https://about.gitlab.com/handbook/product/#cross-stage-features --\u003e","state":"closed","created_at":"2021-07-28T20:41:53.819Z","updated_at":"2022-03-18T07:01:15.097Z","closed_at":"2022-03-08T12:38:37.157Z","closed_by":{"id":3540517,"username":"ealcantara","name":"Enrique Alc√°ntara","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3540517/avatar.png","web_url":"https://gitlab.com/ealcantara"},"labels":["Content Editor","Deliverable","GitLab Free","backend","devops::create","direction","documentation","frontend","group::editor","missed-deliverable","missed:14.5","missed:14.6","quad-planning::complete-action","section::dev","type::feature","workflow::ready for development"],"milestone":{"id":2204140,"iid":71,"group_id":9970,"title":"14.9","description":"","state":"active","created_at":"2021-08-26T19:11:46.841Z","updated_at":"2022-03-22T13:29:17.028Z","due_date":"2022-03-17","start_date":"2022-02-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/71"},"assignees":[{"id":3540517,"username":"ealcantara","name":"Enrique Alc√°ntara","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3540517/avatar.png","web_url":"https://gitlab.com/ealcantara"}],"author":{"id":5212466,"username":"ericschurter","name":"Eric Schurter","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5212466/avatar.png","web_url":"https://gitlab.com/ericschurter"},"type":"ISSUE","assignee":{"id":3540517,"username":"ealcantara","name":"Enrique Alc√°ntara","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3540517/avatar.png","web_url":"https://gitlab.com/ealcantara"},"user_notes_count":24,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337145","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":6,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 6 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337145","notes":"https://gitlab.com/api/v4/projects/278964/issues/337145/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337145/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337145","relative":"#337145","full":"gitlab-org/gitlab#337145"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6228,"epic":{"id":292771,"iid":6228,"title":"Improve the UX of the Content Editor","url":"/groups/gitlab-org/-/epics/6228","group_id":9970,"human_readable_end_date":"Jul 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":91038575,"iid":337127,"project_id":278964,"title":"Investigation: Cannot migrate job artifacts to/from object storage","description":"This is an investigation issue to create reproducible steps to replicate the bug found in https://gitlab.com/gitlab-org/gitlab/-/issues/22172.\n\nFrom the linked issue:\n\n\u003e I have a GitLab CE install which has been upgraded progressively from 10.2 to currently 10.7.3. On upgrade to 10.6, I enabled object storage for CI job artifacts, using Google Cloud Storage as a backend. The `gitlab:artifacts:check` and `gitlab:artifacts:migrate` Rake tasks fail, and I'm not sure what to do about it.\n\nWe should also investigate the reverse of this issue which can be found in https://gitlab.com/gitlab-org/gitlab/-/issues/325844:\n\n\u003e We have migrated our artifacts to object storage long time ago and want revert this now. The error happens when running `gitlab-rake gitlab:artifacts:migrate_to_local`","state":"closed","created_at":"2021-07-28T17:29:02.981Z","updated_at":"2022-10-05T10:01:43.545Z","closed_at":"2022-10-05T10:01:43.487Z","closed_by":{"id":11758441,"username":"dbiryukov","name":"Dmytro Biryukov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/11758441/avatar.png","web_url":"https://gitlab.com/dbiryukov"},"labels":["Category:Build Artifacts","Verify::P3","approaching-SLO","backend","candidate::15.4","devops::verify","group::pipeline insights","missed-SLO","missed:14.5","missed:14.6","missed:14.8","missed:15.4","priority::2","section::ops","severity::2","spike","team activities","type::bug","workflow::in dev"],"milestone":{"id":1212252,"iid":48,"group_id":9970,"title":"Next 1-3 releases","description":"Issues which are not quite ready to schedule, but should be considered as part of the near-term roadmap.","state":"active","created_at":"2020-03-26T20:39:10.889Z","updated_at":"2020-03-26T20:39:10.889Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/48"},"assignees":[{"id":11758441,"username":"dbiryukov","name":"Dmytro Biryukov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/11758441/avatar.png","web_url":"https://gitlab.com/dbiryukov"}],"author":{"id":3029776,"username":"shampton","name":"Scott Hampton","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3029776/avatar.png","web_url":"https://gitlab.com/shampton"},"type":"ISSUE","assignee":{"id":11758441,"username":"dbiryukov","name":"Dmytro Biryukov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/11758441/avatar.png","web_url":"https://gitlab.com/dbiryukov"},"user_notes_count":26,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337127","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":1,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337127","notes":"https://gitlab.com/api/v4/projects/278964/issues/337127/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337127/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337127","relative":"#337127","full":"gitlab-org/gitlab#337127"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91031010,"iid":337116,"project_id":278964,"title":"Version-app: Configure Sentry to tag correct environment","description":"https://sentry.gitlab.net/gitlab/versiongitlabcom/issues/2740702/?referrer=slack\n\nAll errors in Sentry are configured so that are tagged environment: production.  \n\nWe should make a distinction between different environments \n\nhttps://gitlab.com/gitlab-services/version-gitlab-com/-/blob/master/config/initializers/sentry.rb#L5","state":"closed","created_at":"2021-07-28T15:16:12.633Z","updated_at":"2022-03-16T11:40:19.920Z","closed_at":"2021-08-17T03:47:35.424Z","closed_by":{"id":8198564,"username":"rkadam3","name":"Rajendra Kadam","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/8198564/avatar.png","web_url":"https://gitlab.com/rkadam3"},"labels":["backend","devops::growth","group::product intelligence","maintenance::workflow","section::growth","spike","type::maintenance","workflow::in review"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":8198564,"username":"rkadam3","name":"Rajendra Kadam","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/8198564/avatar.png","web_url":"https://gitlab.com/rkadam3"}],"author":{"id":5365921,"username":"alinamihaila","name":"Alina Mihaila","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5365921/avatar.png","web_url":"https://gitlab.com/alinamihaila"},"type":"ISSUE","assignee":{"id":8198564,"username":"rkadam3","name":"Rajendra Kadam","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/8198564/avatar.png","web_url":"https://gitlab.com/rkadam3"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337116","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337116","notes":"https://gitlab.com/api/v4/projects/278964/issues/337116/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337116/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337116","relative":"#337116","full":"gitlab-org/gitlab#337116"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6371,"epic":{"id":309188,"iid":6371,"title":"Version-App maintenance","url":"/groups/gitlab-org/-/epics/6371","group_id":9970,"human_readable_end_date":"Mar 17, 2023","human_readable_timestamp":"\u003cstrong\u003e2\u003c/strong\u003e months remaining"},"iteration":null,"health_status":null},{"id":91028567,"iid":337111,"project_id":278964,"title":"Replace Bootstrap utility classes with GitLab UI utility classes in `app/views/users/show.html.haml`","description":"## Summary\n\nFollow-up to https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66493#note_637200196 we should replace all of the Bootstrap utility classes in [app/views/users/show.html.haml](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/views/users/show.html.haml) with GitLab UI utility classes. \n\n## Improvements\n\nMove closer towards a Bootstrap utility class free GitLab.\n\n## Risks\n\nSlight visual regressions. Should be fairly easy to mitigate by comparing before and after screenshots\n\n## Involved components\n\n- [app/views/users/show.html.haml](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/views/users/show.html.haml)","state":"closed","created_at":"2021-07-28T14:36:24.815Z","updated_at":"2021-10-28T13:54:35.749Z","closed_at":"2021-08-26T14:34:07.385Z","closed_by":{"id":5413811,"username":"peterhegman","name":"Peter Hegman","state":"active","avatar_url":"https://secure.gravatar.com/avatar/459d8635e9ab17a052c00ead1d7bf1e6?s=80\u0026d=identicon","web_url":"https://gitlab.com/peterhegman"},"labels":["Category:Authentication and Authorization","devops::manage","frontend","group::authentication and authorization","section::dev","type::maintenance","workflow::production"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":5413811,"username":"peterhegman","name":"Peter Hegman","state":"active","avatar_url":"https://secure.gravatar.com/avatar/459d8635e9ab17a052c00ead1d7bf1e6?s=80\u0026d=identicon","web_url":"https://gitlab.com/peterhegman"}],"author":{"id":5413811,"username":"peterhegman","name":"Peter Hegman","state":"active","avatar_url":"https://secure.gravatar.com/avatar/459d8635e9ab17a052c00ead1d7bf1e6?s=80\u0026d=identicon","web_url":"https://gitlab.com/peterhegman"},"type":"ISSUE","assignee":{"id":5413811,"username":"peterhegman","name":"Peter Hegman","state":"active","avatar_url":"https://secure.gravatar.com/avatar/459d8635e9ab17a052c00ead1d7bf1e6?s=80\u0026d=identicon","web_url":"https://gitlab.com/peterhegman"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337111","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337111","notes":"https://gitlab.com/api/v4/projects/278964/issues/337111/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337111/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337111","relative":"#337111","full":"gitlab-org/gitlab#337111"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91027012,"iid":337109,"project_id":278964,"title":"500 Error When Loading Branches Page","description":"https://sentry.gitlab.net/gitlab/gitlabcom/issues/2739674/?referrer=gitlab_plugin\n\n```\nPG::QueryCanceled: ERROR:  canceling statement due to statement timeout\n\n from activerecord (6.1.3.2) lib/active_record/connection_adapters/postgresql_adapter.rb:672:in `exec_params'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/postgresql_adapter.rb:672:in `block (2 levels) in exec_no_cache'\n  from activesupport (6.1.3.2) lib/active_support/dependencies/interlock.rb:48:in `block in permit_concurrent_loads'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/share_lock.rb:187:in `yield_shares'\n  from activesupport (6.1.3.2) lib/active_support/dependencies/interlock.rb:47:in `permit_concurrent_loads'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/postgresql_adapter.rb:671:in `block in exec_no_cache'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/abstract_adapter.rb:696:in `block (2 levels) in log'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/load_interlock_aware_monitor.rb:26:in `block (2 levels) in synchronize'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/load_interlock_aware_monitor.rb:25:in `handle_interrupt'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/load_interlock_aware_monitor.rb:25:in `block in synchronize'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/load_interlock_aware_monitor.rb:21:in `handle_interrupt'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/load_interlock_aware_monitor.rb:21:in `synchronize'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/abstract_adapter.rb:695:in `block in log'\n  from activesupport (6.1.3.2) lib/active_support/notifications/instrumenter.rb:24:in `instrument'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/abstract_adapter.rb:687:in `log'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/postgresql_adapter.rb:670:in `exec_no_cache'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/postgresql_adapter.rb:649:in `execute_and_clear'\n  from marginalia (1.10.0) lib/marginalia.rb:95:in `execute_and_clear_with_marginalia'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/postgresql/database_statements.rb:53:in `exec_query'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/abstract/database_statements.rb:532:in `select'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/abstract/database_statements.rb:69:in `select_all'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/abstract/query_cache.rb:101:in `block in select_all'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/abstract/query_cache.rb:118:in `block in cache_sql'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/load_interlock_aware_monitor.rb:26:in `block (2 levels) in synchronize'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/load_interlock_aware_monitor.rb:25:in `handle_interrupt'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/load_interlock_aware_monitor.rb:25:in `block in synchronize'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/load_interlock_aware_monitor.rb:21:in `handle_interrupt'\n  from activesupport (6.1.3.2) lib/active_support/concurrency/load_interlock_aware_monitor.rb:21:in `synchronize'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/abstract/query_cache.rb:109:in `cache_sql'\n  from activerecord (6.1.3.2) lib/active_record/connection_adapters/abstract/query_cache.rb:101:in `select_all'\n  from gitlab/database/load_balancing/connection_proxy.rb:95:in `block in read_using_load_balancer'\n  from gitlab/database/load_balancing/load_balancer.rb:41:in `read'\n  from gitlab/database/load_balancing/connection_proxy.rb:94:in `read_using_load_balancer'\n  from gitlab/database/load_balancing/connection_proxy.rb:47:in `select_all'\n  from activerecord (6.1.3.2) lib/active_record/querying.rb:47:in `find_by_sql'\n  from activerecord (6.1.3.2) lib/active_record/relation.rb:849:in `block in exec_queries'\n  from activerecord (6.1.3.2) lib/active_record/relation.rb:867:in `skip_query_cache_if_necessary'\n  from activerecord (6.1.3.2) lib/active_record/relation.rb:834:in `exec_queries'\n  from activerecord (6.1.3.2) lib/active_record/association_relation.rb:54:in `exec_queries'\n  from activerecord (6.1.3.2) lib/active_record/relation.rb:638:in `load'\n  from activerecord (6.1.3.2) lib/active_record/relation.rb:249:in `records'\n  from activerecord (6.1.3.2) lib/active_record/relation/delegation.rb:88:in `each'\n  from ci/pipeline.rb:383:in `each_with_object'\n  from ci/pipeline.rb:383:in `latest_successful_for_refs'\n  from gitlab/metrics/instrumentation.rb:160:in `block in latest_successful_for_refs'\n  from gitlab/metrics/method_call.rb:27:in `measure'\n  from gitlab/metrics/instrumentation.rb:160:in `latest_successful_for_refs'\n  from activerecord (6.1.3.2) lib/active_record/relation/delegation.rb:67:in `block in latest_successful_for_refs'\n  from activerecord (6.1.3.2) lib/active_record/relation.rb:406:in `block in scoping'\n  from activerecord (6.1.3.2) lib/active_record/relation.rb:810:in `_scoping'\n  from activerecord (6.1.3.2) lib/active_record/relation.rb:406:in `scoping'\n  from activerecord (6.1.3.2) lib/active_record/associations/collection_proxy.rb:1109:in `scoping'\n  from activerecord (6.1.3.2) lib/active_record/relation/delegation.rb:67:in `latest_successful_for_refs'\n  from projects/branches_controller.rb:28:in `block (2 levels) in index'\n  from actionpack (6.1.3.2) lib/action_controller/metal/mime_responds.rb:214:in `respond_to'\n  from projects/branches_controller.rb:19:in `index'\n```","state":"closed","created_at":"2021-07-28T14:13:26.969Z","updated_at":"2021-08-30T09:44:15.395Z","closed_at":"2021-08-30T09:44:15.379Z","closed_by":{"id":722076,"username":"matteeyah","name":"Matija ƒåupiƒá","state":"active","avatar_url":"https://secure.gravatar.com/avatar/8bc04cc15e0adba406cf56fecd9d910a?s=80\u0026d=identicon","web_url":"https://gitlab.com/matteeyah"},"labels":["Category:Pipeline Authoring","Category:Source Code Management","customer","devops::verify","gitlab.com","group::pipeline authoring","priority::2","section::ops","severity::2","type::bug","workflow::in dev"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[{"id":722076,"username":"matteeyah","name":"Matija ƒåupiƒá","state":"active","avatar_url":"https://secure.gravatar.com/avatar/8bc04cc15e0adba406cf56fecd9d910a?s=80\u0026d=identicon","web_url":"https://gitlab.com/matteeyah"}],"author":{"id":402401,"username":"jobbot","name":"Bot","state":"active","avatar_url":"https://secure.gravatar.com/avatar/aaa6738f1ebf25404010884af511b0e7?s=80\u0026d=identicon","web_url":"https://gitlab.com/jobbot"},"type":"ISSUE","assignee":{"id":722076,"username":"matteeyah","name":"Matija ƒåupiƒá","state":"active","avatar_url":"https://secure.gravatar.com/avatar/8bc04cc15e0adba406cf56fecd9d910a?s=80\u0026d=identicon","web_url":"https://gitlab.com/matteeyah"},"user_notes_count":18,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337109","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337109","notes":"https://gitlab.com/api/v4/projects/278964/issues/337109/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337109/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337109","relative":"#337109","full":"gitlab-org/gitlab#337109"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91026965,"iid":337108,"project_id":278964,"title":"\"comparison of String with nil failed\" when base pipeline is present but coverage is nil","description":"\u003c!---\nPlease read this!\n\nBefore opening a new issue, make sure to search for keywords in the issues\nfiltered by the \"regression\" or \"bug\" label:\n\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=regression\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=bug\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n### Summary\n\nBug identified on customer call [ZD link](https://gitlab.zendesk.com/agent/tickets/225388)(internal)\n\u003c!-- Summarize the bug encountered concisely. --\u003e\n\nRelated to #324281 and introduced in https://gitlab.com/gitlab-org/gitlab/-/merge_requests/63079\n\nWhen evaluating whether to require approval for a merge request, we check whether the pipeline coverage is less than the base pipeline coverage if `base_pipeline.present?`\n\n```\n\n    def merge_requests_approved_coverage\n      pipeline.merge_requests_as_head_pipeline.reject do |merge_request|\n        base_pipeline = merge_request.base_pipeline\n\n        # if base pipeline is missing we just default to not require approval.\n        pipeline.coverage \u003c base_pipeline.coverage if base_pipeline.present?\n      end\n    end\n```\n\nThe problem is `base_pipeline.present?` only checks whether there's a base pipeline, and doesn't check whether there's coverage. As a result `base_pipeline.coverage` evaluates to `nil` and we get a `NoMethodError`\n\n\n### Steps to reproduce\n\nFrom `gitlab-rails console`: \n\n```\n# Pick MR where base pipeline coverage is nil\n# pipeline is current pipeline\n\n`pipeline.coverage \u003c base_pipeline.coverage if base_pipeline.present?`\n\n```\n\nThe output will be: \n\n`comparison of String with nil failed` if `pipeline.coverage` isn't `nil `\n`NoMethodError (undefined method \u003c for nil:NilClass)` if they're both `nil`\n\n\n### Example from my console: \n\n```\nirb(main):036:0\u003e current_pipeline.coverage \u003c merge_request.base_pipeline.coverage if merge_request.base_pipeline.present?\nTraceback (most recent call last):\n        1: from (irb):36\nNoMethodError (undefined method `\u003c' for nil:NilClass)\nirb(main):037:0\u003e\n```\n\nWith workaround: \n\n```\nirb(main):037:0\u003e current_pipeline.coverage \u003c merge_request.base_pipeline.coverage if merge_request.base_pipeline.coverage.present?\n=\u003e nil\nirb(main):038:0\u003e\n```\n\n### Possible fixes\n\nThe current workaround is to check for the presence of `base_pipeline.coverage` rather than the presence of`base_pipeline`. \n\n`pipeline.coverage \u003c base_pipeline.coverage if base_pipeline.coverage.present?`","state":"closed","created_at":"2021-07-28T14:12:39.124Z","updated_at":"2021-12-07T02:57:14.940Z","closed_at":"2021-12-07T02:54:58.288Z","closed_by":{"id":6354882,"username":"alberts-gitlab","name":"Albert Salim","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/6354882/avatar.png","web_url":"https://gitlab.com/alberts-gitlab"},"labels":["Category:Code Testing and Coverage","backend","customer","devops::verify","group::pipeline insights","onboarding","priority::3","section::ops","severity::3","type::bug","workflow::production"],"milestone":{"id":2114820,"iid":67,"group_id":9970,"title":"14.6","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T05:00:52.094Z","updated_at":"2022-04-21T07:26:38.271Z","due_date":"2021-12-17","start_date":"2021-11-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/67"},"assignees":[{"id":6354882,"username":"alberts-gitlab","name":"Albert Salim","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/6354882/avatar.png","web_url":"https://gitlab.com/alberts-gitlab"}],"author":{"id":3409107,"username":"sahbabou","name":"Sara Ahbabou","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3409107/avatar.png","web_url":"https://gitlab.com/sahbabou"},"type":"ISSUE","assignee":{"id":6354882,"username":"alberts-gitlab","name":"Albert Salim","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/6354882/avatar.png","web_url":"https://gitlab.com/alberts-gitlab"},"user_notes_count":25,"merge_requests_count":0,"upvotes":5,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337108","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337108","notes":"https://gitlab.com/api/v4/projects/278964/issues/337108/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337108/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337108","relative":"#337108","full":"gitlab-org/gitlab#337108"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":91024944,"iid":337102,"project_id":278964,"title":"Backfill UserNamespace for every personal namespace","description":"We have 3 types of `Namespaces`:\n- personal namespace / `UserNamespace`\n- `Group`\n- `ProjectNamespace`\n\nUnfortunately, we don't have actually have `UserNamespace` model. We used a generic `Namespace` model instead, and had used various workarounds in the codebase for this (eg: [`Namespace#kind`](https://gitlab.com/gitlab-org/gitlab/-/blob/v14.0.0-ee/app/models/namespace.rb#L219)). This is confusing, but can be easily fixed and cleaned up:\n- introduce a new `UserNamespace` model which inherits from `Namespace`\n- backfill `type` to `UserNamespace` in a background migration\n- get rid of workaround for missing `type` for personal projects","state":"closed","created_at":"2021-07-28T13:43:39.782Z","updated_at":"2021-10-28T13:54:36.689Z","closed_at":"2021-09-16T20:01:39.262Z","closed_by":{"id":194645,"username":"digitalmoksha","name":"Brett Walker","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/194645/avatar.png","web_url":"https://gitlab.com/digitalmoksha"},"labels":["Category:Authentication and Authorization","devops::manage","group::organization","maintenance::refactor","namespace","section::dev","type::maintenance","workflow::in dev"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[{"id":194645,"username":"digitalmoksha","name":"Brett Walker","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/194645/avatar.png","web_url":"https://gitlab.com/digitalmoksha"}],"author":{"id":1315784,"username":"ifarkas","name":"Imre Farkas","state":"active","avatar_url":"https://secure.gravatar.com/avatar/b4dcfa5185b8513751b447d76b069bf6?s=80\u0026d=identicon","web_url":"https://gitlab.com/ifarkas"},"type":"ISSUE","assignee":{"id":194645,"username":"digitalmoksha","name":"Brett Walker","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/194645/avatar.png","web_url":"https://gitlab.com/digitalmoksha"},"user_notes_count":12,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337102","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337102","notes":"https://gitlab.com/api/v4/projects/278964/issues/337102/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337102/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337102","relative":"#337102","full":"gitlab-org/gitlab#337102"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6697,"epic":{"id":343640,"iid":6697,"title":"[Phase1] Define and backfill ProjectNamespace and UserNamespace","url":"/groups/gitlab-org/-/epics/6697","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":91024798,"iid":337100,"project_id":278964,"title":"Backfill ProjectNamespace for every Project","description":"We need a background migration to create a `ProjectNamespace` for every project based in the architecture blueprint https://docs.gitlab.com/ee/architecture/blueprints/consolidating_groups_and_projects/\n\n- Backfill migration should set the current date for backfilled project namespaces created/updated date/times(i.e. not the project's created/updated date/times) re https://gitlab.com/gitlab-org/manage/general-discussion/-/issues/17406#note_700152960","state":"closed","created_at":"2021-07-28T13:41:49.639Z","updated_at":"2022-04-26T09:14:49.463Z","closed_at":"2022-03-28T11:02:55.982Z","closed_by":{"id":3483274,"username":"acroitor","name":"Alexandru Croitor","state":"active","avatar_url":"https://secure.gravatar.com/avatar/461378ef52c26eec55e6c15ec09bb9ed?s=80\u0026d=identicon","web_url":"https://gitlab.com/acroitor"},"labels":["Category:Authentication and Authorization","blocked","devops::manage","group::organization","missed:14.5","missed:14.6","missed:14.7","missed:14.9","namespace","section::dev","workflow::scheduling"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/72"},"assignees":[{"id":3483274,"username":"acroitor","name":"Alexandru Croitor","state":"active","avatar_url":"https://secure.gravatar.com/avatar/461378ef52c26eec55e6c15ec09bb9ed?s=80\u0026d=identicon","web_url":"https://gitlab.com/acroitor"}],"author":{"id":1315784,"username":"ifarkas","name":"Imre Farkas","state":"active","avatar_url":"https://secure.gravatar.com/avatar/b4dcfa5185b8513751b447d76b069bf6?s=80\u0026d=identicon","web_url":"https://gitlab.com/ifarkas"},"type":"ISSUE","assignee":{"id":3483274,"username":"acroitor","name":"Alexandru Croitor","state":"active","avatar_url":"https://secure.gravatar.com/avatar/461378ef52c26eec55e6c15ec09bb9ed?s=80\u0026d=identicon","web_url":"https://gitlab.com/acroitor"},"user_notes_count":31,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337100","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337100","notes":"https://gitlab.com/api/v4/projects/278964/issues/337100/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337100/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337100","relative":"#337100","full":"gitlab-org/gitlab#337100"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6814,"epic":{"id":355782,"iid":6814,"title":"Project create should ensure a corresponding ProjectNamespace record is created","url":"/groups/gitlab-org/-/epics/6814","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":91024620,"iid":337099,"project_id":278964,"title":"Introduce ProjectNamespace","description":"Steps:\n- introduce a new database column for `Project#project_namespace_id`\n- introduce the `ProjectNamespace` model","state":"closed","created_at":"2021-07-28T13:39:22.053Z","updated_at":"2021-12-14T12:02:38.778Z","closed_at":"2021-09-07T09:51:18.659Z","closed_by":{"id":3717078,"username":"cablett","name":"charlie ablett","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3717078/avatar.png","web_url":"https://gitlab.com/cablett"},"labels":["Category:Authentication and Authorization","devops::manage","group::organization","namespace","section::dev","type::maintenance","workflow::production"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":3717078,"username":"cablett","name":"charlie ablett","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3717078/avatar.png","web_url":"https://gitlab.com/cablett"}],"author":{"id":1315784,"username":"ifarkas","name":"Imre Farkas","state":"active","avatar_url":"https://secure.gravatar.com/avatar/b4dcfa5185b8513751b447d76b069bf6?s=80\u0026d=identicon","web_url":"https://gitlab.com/ifarkas"},"type":"ISSUE","assignee":{"id":3717078,"username":"cablett","name":"charlie ablett","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3717078/avatar.png","web_url":"https://gitlab.com/cablett"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337099","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337099","notes":"https://gitlab.com/api/v4/projects/278964/issues/337099/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337099/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337099","relative":"#337099","full":"gitlab-org/gitlab#337099"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6697,"epic":{"id":343640,"iid":6697,"title":"[Phase1] Define and backfill ProjectNamespace and UserNamespace","url":"/groups/gitlab-org/-/epics/6697","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":91018704,"iid":337091,"project_id":278964,"title":"Integrations.type migration: Clean up records with invalid values","description":"This issue is part of https://gitlab.com/groups/gitlab-org/-/epics/6177. See that Epic for a broader description of the feature.\n\nAfter the other issues have been implemented, we want to run a data migration to clean up any remaining `integrations` records with invalid `type` values, such as integrations that were removed at some point.\n\nCurrently known `type` values which were removed:\n\n- `AlertsService`: https://gitlab.com/gitlab-org/gitlab/-/merge_requests/53534\n- `HipchatService`: https://gitlab.com/gitlab-org/gitlab/-/merge_requests/62222\n- `JenkinsDeprecatedService`: https://gitlab.com/gitlab-org/gitlab/-/merge_requests/31607\n- `MockDeploymentService`: https://gitlab.com/gitlab-org/gitlab/-/merge_requests/52966\n\nPending removals:\n\n- `OpenProjectService`: https://gitlab.com/gitlab-org/gitlab/-/issues/330832","state":"closed","created_at":"2021-07-28T12:08:54.540Z","updated_at":"2022-11-22T19:36:58.156Z","closed_at":"2022-06-14T16:26:07.301Z","closed_by":{"id":3614858,"username":"alexkalderimis","name":"Alex Kalderimis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3614858/avatar.png","web_url":"https://gitlab.com/alexkalderimis"},"labels":["Category:Integrations","backend","database","devops::manage","group::integrations","section::dev","type::maintenance","workflow::in review"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/73"},"assignees":[{"id":3614858,"username":"alexkalderimis","name":"Alex Kalderimis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3614858/avatar.png","web_url":"https://gitlab.com/alexkalderimis"}],"author":{"id":423116,"username":"toupeira","name":"Markus Koller","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7585ed50675c4febe7619f25b44f7fe0?s=80\u0026d=identicon","web_url":"https://gitlab.com/toupeira"},"type":"ISSUE","assignee":{"id":3614858,"username":"alexkalderimis","name":"Alex Kalderimis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3614858/avatar.png","web_url":"https://gitlab.com/alexkalderimis"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337091","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337091","notes":"https://gitlab.com/api/v4/projects/278964/issues/337091/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337091/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337091","relative":"#337091","full":"gitlab-org/gitlab#337091"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6177,"epic":{"id":288464,"iid":6177,"title":"Data migration: Change `integrations.type` values to reflect new namespaced models","url":"/groups/gitlab-org/-/epics/6177","group_id":9970,"human_readable_end_date":"Jun 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":91017293,"iid":337090,"project_id":278964,"title":"Review Snowplow data for the audit events date range segmented controls","description":"With https://gitlab.com/gitlab-org/gitlab/-/issues/333944 we added Snowplow tracking to the audit events date range segmented controls.\n\nWe should review this data to see how often these are used.\n\nA good place to start is the [last 30 days events dashboard](https://app.periscopedata.com/app/gitlab/539181/Snowplow-Event-Exploration---last-30-days) searching for the `action`: `click_date_range_button`.\n\nWe can then compare against each button and which audit events page it was used on","state":"closed","created_at":"2021-07-28T11:46:14.312Z","updated_at":"2022-02-22T15:22:35.914Z","closed_at":"2022-02-16T18:15:55.207Z","closed_by":{"id":5209897,"username":"rob.hunt","name":"Robert Hunt","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5209897/avatar.png","web_url":"https://gitlab.com/rob.hunt"},"labels":["Category:Audit Events","Discovery","GitLab Premium","Next Up","UX","auto updated","devops::manage","frontend","group::compliance","missed:14.5","priority::4","section::dev","type::maintenance","workflow::problem validation"],"milestone":{"id":2161849,"iid":70,"group_id":9970,"title":"14.8","description":"","state":"active","created_at":"2021-07-26T16:51:47.677Z","updated_at":"2021-07-26T16:51:47.677Z","due_date":"2022-02-17","start_date":"2022-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/70"},"assignees":[{"id":5209897,"username":"rob.hunt","name":"Robert Hunt","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5209897/avatar.png","web_url":"https://gitlab.com/rob.hunt"}],"author":{"id":5209897,"username":"rob.hunt","name":"Robert Hunt","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5209897/avatar.png","web_url":"https://gitlab.com/rob.hunt"},"type":"ISSUE","assignee":{"id":5209897,"username":"rob.hunt","name":"Robert Hunt","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5209897/avatar.png","web_url":"https://gitlab.com/rob.hunt"},"user_notes_count":14,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337090","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337090","notes":"https://gitlab.com/api/v4/projects/278964/issues/337090/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337090/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337090","relative":"#337090","full":"gitlab-org/gitlab#337090"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":"on_track"},{"id":91015885,"iid":337087,"project_id":278964,"title":"Expose job scope data in  CI_JOB_TOKEN  API for introspection","description":"### Release notes \n\nGitLab has introduced a secure workflow for CI_JOB_TOKEN and you may be looking for information about if the setting is enabled in your project. Now you can easily use the CI_JOB_TOKEN API for introspection into the token's data such as if the scope has been enabled. \n\n### Problem to solve \n\nAlso, it could be useful if there was an API endpoint that the¬†CI_JOB_TOKEN¬†could use for introspection of the project chiefly to see if the flag is enabled which would be useful for us using the¬†custom executor\n\n### Proposal \n\nExpose job token scope data by `job_token_scope_enabled: true/false` in API for CI_JOB_TOKEN introspection: https://docs.gitlab.com/ee/api/jobs.html#get-job-tokens-job\n\nThe response will look like:\n\n```json\n{\n  \"project\": {\n    \"job_token_scope_enabled\": true/false\n  }\n  \"name\": \"my-job\",\n  ...other fields...\n}\n```\n\u003c!-- triage-serverless v3 PLEASE DO NOT REMOVE THIS SECTION --\u003e\n*This page may contain information related to upcoming products, features and functionality.\nIt is important to note that the information presented is for informational purposes only, so please do not rely on the information for purchasing or planning purposes.\nJust like with all projects, the items mentioned on the page are subject to change or delay, and the development, release, and timing of any products, features, or functionality remain at the sole discretion of GitLab Inc.*\n\u003c!-- triage-serverless v3 PLEASE DO NOT REMOVE THIS SECTION --\u003e","state":"closed","created_at":"2021-07-28T11:22:38.382Z","updated_at":"2023-01-10T16:32:31.923Z","closed_at":"2022-09-30T19:00:00.732Z","closed_by":{"id":12195435,"username":"carolinesimpson","name":"Caroline Simpson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/12195435/avatar.png","web_url":"https://gitlab.com/carolinesimpson"},"labels":["Category:Continuous Integration","GitLab Core","GitLab Free","Verify::P2","backend","devops::verify","direction","documentation","group::pipeline execution","missed:14.6","missed:14.7","quad-planning::complete-no-action","release post item","release post item::in review","section::ops","type::feature","workflow::production"],"milestone":{"id":2453027,"iid":77,"group_id":9970,"title":"15.5","description":"","state":"active","created_at":"2022-02-03T22:29:56.909Z","updated_at":"2022-02-03T22:29:56.909Z","due_date":"2022-10-17","start_date":"2022-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/77"},"assignees":[],"author":{"id":4905402,"username":"jreporter","name":"Jackie Porter","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4905402/avatar.png","web_url":"https://gitlab.com/jreporter"},"type":"ISSUE","assignee":null,"user_notes_count":27,"merge_requests_count":0,"upvotes":3,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337087","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337087","notes":"https://gitlab.com/api/v4/projects/278964/issues/337087/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337087/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337087","relative":"#337087","full":"gitlab-org/gitlab#337087"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6546,"epic":{"id":324192,"iid":6546,"title":"Secure CI_JOB_TOKEN Workflows","url":"/groups/gitlab-org/-/epics/6546","group_id":9970,"human_readable_end_date":"May 17, 2023","human_readable_timestamp":"\u003cstrong\u003e4\u003c/strong\u003e months remaining"},"iteration":null,"health_status":null},{"id":91011933,"iid":337080,"project_id":278964,"title":"Cache commit stats in order to avoid expensive gitaly calls","description":"### Background\n\nWe are dealing with an active incident where a single user is able to trigger a lot of heavy gitaly RPCs: https://gitlab.com/gitlab-com/gl-infra/production/-/issues/5229.\n\nThese calls degrade the experience for that user, but more importantly can consume a lot of CPU resources on the gitaly server. Once resource utilization reaches a tipping point, performance for _all repos_ hosted on that gitaly server degrades.\n\nAs a mitigation, we are manually applying stricter rate limits to specific paths.\n\n### Impact\n\nThis behaviour has resulted in 27 alerts over the last 48 hours:\n\n![Screenshot_2021-07-28_at_12.28.15](/uploads/aefc1bff0cdd318e92e5b76300c7b15d/Screenshot_2021-07-28_at_12.28.15.png)\n\nhttps://nonprod-log.gitlab.net/goto/ff7dd80b5054aa922b4474293264ec0f\n\n### Proposal\n\nIn order to mitigate the impact of these slow calls, we could cache the output of the `CommitStats` RPC. This would protect us against repeated calls against the same commit.\n\nThe endpoint in question is the [Commits API](https://docs.gitlab.com/ee/api/commits.html#get-a-single-commit) (which defaults to including commit stats).\n\n### Verification\n\nRate of `CommitStats` RPCs taking longer than 10 seconds should consistently be under 10 per hour.\n\n![Screenshot_2021-07-28_at_13.33.11](/uploads/01b3b2e42340b5f79324116bede0eb77/Screenshot_2021-07-28_at_13.33.11.png)\n\nhttps://log.gprd.gitlab.net/goto/1af19691a77914b95cbd8f6112a7df9d\n\nPlease note that this metric may be artificially lowered by SRE applying rate limiting as a mitigation: https://gitlab.com/gitlab-com/gl-infra/cloudflare-firewall/-/issues/89.","state":"closed","created_at":"2021-07-28T10:29:00.432Z","updated_at":"2021-10-27T10:38:54.998Z","closed_at":"2021-08-10T09:34:55.256Z","closed_by":{"id":1161495,"username":"igor.drozdov","name":"Igor Drozdov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1161495/avatar.png","web_url":"https://gitlab.com/igor.drozdov"},"labels":["Category:Source Code Management","Deliverable","Eng-Consumer::Infrastructure","Eng-Producer::Development","Engineering Allocation","auto updated","bug::performance","devops::create","group::source code","infradev","priority::2","section::dev","severity::2","workflow::in review"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":1161495,"username":"igor.drozdov","name":"Igor Drozdov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1161495/avatar.png","web_url":"https://gitlab.com/igor.drozdov"}],"author":{"id":876203,"username":"igorwwwwwwwwwwwwwwwwwwww","name":"Igor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/876203/avatar.png","web_url":"https://gitlab.com/igorwwwwwwwwwwwwwwwwwwww"},"type":"ISSUE","assignee":{"id":1161495,"username":"igor.drozdov","name":"Igor Drozdov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1161495/avatar.png","web_url":"https://gitlab.com/igor.drozdov"},"user_notes_count":11,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337080","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337080","notes":"https://gitlab.com/api/v4/projects/278964/issues/337080/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337080/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337080","relative":"#337080","full":"gitlab-org/gitlab#337080"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6523,"epic":{"id":321041,"iid":6523,"title":"Engineering Allocation (Source Code BE): 02-AUG-2021","url":"/groups/gitlab-org/-/epics/6523","group_id":9970,"human_readable_end_date":"Dec 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":91009097,"iid":337077,"project_id":278964,"title":"Introduce mechanism to prevent introduction of a new cross-joins across main and CI","description":"Updating GitLab to use a decomposed CI is a moving target. We need to prevent introduction\nof new features that violate the rule of inability to do cross-join across main and CI\nwhile being able to allow some of these constructs to be there until we fix them.\n\n## Proposal\n\n1. Use `rspec` with `pg_query` to discover queries joining main and CI tables\n2. Allow to mark some methods as allowed to perform cross-join and link to issue\n\n```ruby\nclass User\n  def ci_owned_runners\n    ::Gitlab::Database.allow_cross_joins_across_databases(url: \"https://gitlab.com/gitlab-org/gitlab/-/issues/336436\")\n\n    @ci_owned_runners ||= begin\n      ...\n  end\nend\n```\n\n## Problems\n\n1. Ideally we would use schemas visibility for that, but we are pretty far from that\n1. A lot of failures today is generated by the lack of `disable_joins:` added\n1. We cannot use `allow_cross_joins_across_databases` with `yield` as the check is performed on execution of query,\n   which is done by caller. Doing that with `yield` would require all places the given method is used to be marked\n   with the exception.","state":"closed","created_at":"2021-07-28T09:47:02.898Z","updated_at":"2022-05-31T12:22:06.380Z","closed_at":"2021-08-31T22:57:47.128Z","closed_by":{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"},"labels":["Category:Pods","devops::data_stores","group::pods","section::enablement","type::maintenance"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337077","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337077","notes":"https://gitlab.com/api/v4/projects/278964/issues/337077/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337077/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337077","relative":"#337077","full":"gitlab-org/gitlab#337077"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6103,"epic":{"id":281355,"iid":6103,"title":"Decomposition: Support for many databases","url":"/groups/gitlab-org/-/epics/6103","group_id":9970,"human_readable_end_date":"Sep 16, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90966514,"iid":337065,"project_id":278964,"title":"[VSA] Update developer documentation","description":"\u003c!--\n\n* Use this issue template for suggesting new docs or updates to existing docs.\n  Note: Doc work as part of feature development is covered in the Feature Request template.\n\n* For issues related to features of the docs.gitlab.com site, see\n     https://gitlab.com/gitlab-org/gitlab-docs/issues/\n\n* For information about documentation content and process, see\n     https://docs.gitlab.com/ee/development/documentation/ --\u003e\n\n### Problem to solve\n\n\u003c!-- Include the following detail as necessary:\n* What product or feature(s) affected?\n* What docs or doc section affected? Include links or paths.\n* Is there a problem with a specific document, or a feature/process that's not addressed sufficiently in docs?\n* Any other ideas or requests?\n--\u003e\n\nThe https://gitlab.com/groups/gitlab-org/-/epics/5194 epic introduces some substantial changes to the architecture of value stream analytics, both on the ~frontend and ~backend. \n\nAt the completion or close to the end of the refactor epic, we should update our [developer documentation](https://docs.gitlab.com/ee/development/value_stream_analytics.html) to reflect the new architecture.\n\n### Further details\n\n\u003c!--\n* Any concepts, procedures, reference info we could add to make it easier to successfully use GitLab?\n* Include use cases, benefits, and/or goals for this work.\n* If adding content: What audience is it intended for? (What roles and scenarios?)\n  For ideas, see personas at https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/ or the persona labels at\n  https://gitlab.com/groups/gitlab-org/-/labels?subscribed=\u0026search=persona%3A\n--\u003e\n\n### Proposal\n\n\u003c!-- Further specifics for how can we solve the problem. --\u003e\nSome areas we could look to cover include:\n* [x] Feature differences across FOSS/CE/EE as well as Group vs Project level\n* [x] Test data organization\n* [x] Frontend architecture \n\n...\n* [ ] Any technical limitations\n* [ ] Any other dependencies\n\n### Who can address the issue\n\n\u003c!-- What if any special expertise is required to resolve this issue? --\u003e\n\n### Other links/references\n\n\u003c!-- E.g. related GitLab issues/MRs --\u003e","state":"closed","created_at":"2021-07-28T06:52:42.009Z","updated_at":"2022-08-26T05:52:23.111Z","closed_at":"2022-08-26T05:52:23.042Z","closed_by":{"id":4156052,"username":"ahegyi","name":"Adam Hegyi","state":"active","avatar_url":"https://secure.gravatar.com/avatar/ff7cdaff6b98fba9b977f1885578b8b3?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahegyi"},"labels":["Category:Value Stream Management","Stretch","backend","development guidelines","devops::manage","documentation","frontend","group::optimize","missed:15.3","priority::3","section::dev","type::maintenance","workflow::production"],"milestone":{"id":2453026,"iid":76,"group_id":9970,"title":"15.4","description":"[GitLab 15.4 Release](https://gitlab.com/gitlab-org/gitlab/-/releases/v15.4.0-ee)","state":"active","created_at":"2022-02-03T22:29:22.015Z","updated_at":"2022-09-29T02:21:26.561Z","due_date":"2022-09-17","start_date":"2022-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/76"},"assignees":[{"id":3397881,"username":"ekigbo","name":"Ezekiel Kigbo","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3397881/avatar.png","web_url":"https://gitlab.com/ekigbo"},{"id":4156052,"username":"ahegyi","name":"Adam Hegyi","state":"active","avatar_url":"https://secure.gravatar.com/avatar/ff7cdaff6b98fba9b977f1885578b8b3?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahegyi"}],"author":{"id":3397881,"username":"ekigbo","name":"Ezekiel Kigbo","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3397881/avatar.png","web_url":"https://gitlab.com/ekigbo"},"type":"ISSUE","assignee":{"id":3397881,"username":"ekigbo","name":"Ezekiel Kigbo","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3397881/avatar.png","web_url":"https://gitlab.com/ekigbo"},"user_notes_count":16,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337065","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":5,"completed_count":3},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"3 of 5 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337065","notes":"https://gitlab.com/api/v4/projects/278964/issues/337065/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337065/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337065","relative":"#337065","full":"gitlab-org/gitlab#337065"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":5194,"epic":{"id":180134,"iid":5194,"title":"[VSA] Refactor project-level feature to use group-level code","url":"/groups/gitlab-org/-/epics/5194","group_id":9970,"human_readable_end_date":"Sep 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90964828,"iid":337064,"project_id":278964,"title":"[CI Minutes] [Feature flag] Remove 'new_route_ci_minutes_purchase' feature flag","description":"In order to rollout feature flag `:new_route_ci_minutes_purchase` for purchasing CI Minutes, we proceed as follow:\n\n|||\n|-|-|\n| roll-out `:new_route_ci_minutes_purchase` | gitlab-org/gitlab#322582 |\n| release the feature and remove `:new_route_ci_minutes_purchase` | üëà you are here |\n\n### NOTE: ADD A CHANGELOG WHEN REMOVING THE FEATURE FLAG.\n\n## Summary\n\nThis issue is to rollout [the feature](https://gitlab.com/groups/gitlab-org/-/epics/5391) on production,\nthat is currently behind the `new_route_ci_minutes_purchase` feature flag.\n\nThe feature is updating the CI Minutes purchase from an external one (on Customers Portal) to the one embedded in GitLab. More details in the [Epic](https://gitlab.com/groups/gitlab-org/-/epics/5391).\n\n## Owners\n\n- Team: ~16487743 \n- Most appropriate slack channel to reach out to: `#g_purchase`\n- Best individual to reach out to: @agulina \n- PM: @tgolubeva \n\n## Stakeholders\n\n## The Rollout Plan\n\n- Partial Rollout on GitLab.com with testing groups\n- Rollout on GitLab.com for a certain period (2 milestones)\n- Percentage Rollout on GitLab.com\n- Rollout Feature for everyone as soon as it's ready\n\n\u003c!-- Which dashboards from https://dashboards.gitlab.net are most relevant? Sentry errors reports can also be useful to review --\u003e\n\n## Testing Groups/Projects/Users\n\n\u003c!-- If applicable, any groups/projects that are happy to have this feature turned on early. Some organizations may wish to test big changes they are interested in with a small subset of users ahead of time for example. --\u003e\n\n- `gitlab-org`/`tatyanas-test-gitlab-group` group (@tgolubeva)\n- `gitlab-org`/`test-group-894` group (@esybrant)\n\n## Expectations\n\n### What are we expecting to happen?\n\nWhen a group is eligible for purchasing additional CI Minutes, the button on the Usage Quotas are of the group will direct the customer to the GitLab-embedded CI Minutes flow.\n\n### What might happen if this goes wrong?\n\nIf something goes wrong, the customers won't be able to purchase additional CI Minutes. Disabling the FF will be sufficient to solve any incident.\n\n### What can we monitor to detect problems with this?\n\n\u003c!-- Which dashboards from https://dashboards.gitlab.net are most relevant? --\u003e\n\n## Rollout Steps\n\nThe rollout part is handled with: gitlab-org/gitlab#322582\n\n### Release the feature\n\nAfter the feature has been [deemed stable](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release),\nthe [clean up](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up)\nshould be done as soon as possible to permanently enable the feature and reduce complexity in the\ncodebase.\n\n\u003c!-- The checklist here is to help stakeholders keep track of the feature flag status --\u003e\n- [x] Create a merge request to remove `\u003cfeature-flag-name\u003e` feature flag. Ask for review and merge it.\n    - [x] Remove all references to the feature flag from the codebase.\n    - [x] Remove the YAML definitions for the feature from the repository.\n    - [x] Create [a changelog entry](https://docs.gitlab.com/ee/development/feature_flags/#changelog).\n- [ ] Ensure that the cleanup MR has been deployed to both production and canary.\n      If the merge request was deployed before [the code cutoff](https://about.gitlab.com/handbook/engineering/releases/#self-managed-releases-1),\n      the feature can be officially announced in a release blog post.\n    - [x] `/chatops run auto_deploy status \u003cmerge-commit-of-cleanup-mr\u003e`\n- [x] Close [the feature issue](https://gitlab.com/groups/gitlab-org/-/epics/5391) to indicate the feature will be released in the current milestone.\n- [x] Clean up the feature flag from all environments by running these chatops command in `#production` channel:\n    - [-] `/chatops run feature delete \u003cfeature-flag-name\u003e --dev` NOT RELEVANT\n    - [x] `/chatops run feature delete new_route_ci_minutes_purchase --staging`\n    - [x] `/chatops run feature delete new_route_ci_minutes_purchase`\n- [x] Close this rollout issue.\n\n## Rollback Steps\n\n- [ ] This feature can be disabled by running the following Chatops command:\n\n```\n/chatops run feature set new_route_ci_minutes_purchase false\n```","state":"closed","created_at":"2021-07-28T06:32:58.726Z","updated_at":"2022-02-18T07:03:05.626Z","closed_at":"2022-02-07T22:53:53.655Z","closed_by":{"id":10325315,"username":"vvempati","name":"Vamsi Vempati","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10325315/avatar.png","web_url":"https://gitlab.com/vvempati"},"labels":["Category:Purchase","Deliverable","Fulfillment Priority","OKR","Unplanned","auto updated","devops::fulfillment","feature flag","feature::addition","frontend","group::purchase","quad-planning::complete-no-action","section::fulfillment","type::feature","workflow::production"],"milestone":{"id":2161849,"iid":70,"group_id":9970,"title":"14.8","description":"","state":"active","created_at":"2021-07-26T16:51:47.677Z","updated_at":"2021-07-26T16:51:47.677Z","due_date":"2022-02-17","start_date":"2022-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/70"},"assignees":[{"id":10325315,"username":"vvempati","name":"Vamsi Vempati","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10325315/avatar.png","web_url":"https://gitlab.com/vvempati"}],"author":{"id":6348276,"username":"agulina","name":"Angelo Gulina","state":"active","avatar_url":"https://secure.gravatar.com/avatar/b28693a558066993ea93b7272208d285?s=80\u0026d=identicon","web_url":"https://gitlab.com/agulina"},"type":"ISSUE","assignee":{"id":10325315,"username":"vvempati","name":"Vamsi Vempati","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10325315/avatar.png","web_url":"https://gitlab.com/vvempati"},"user_notes_count":16,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337064","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":12,"completed_count":10},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"10 of 12 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337064","notes":"https://gitlab.com/api/v4/projects/278964/issues/337064/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337064/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337064","relative":"#337064","full":"gitlab-org/gitlab#337064"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6574,"epic":{"id":327000,"iid":6574,"title":"Move CI Minutes purchase flows to GitLab.com UI (Group namespaces only)","url":"/groups/gitlab-org/-/epics/6574","group_id":9970,"human_readable_end_date":"Dec 10, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90964076,"iid":337063,"project_id":278964,"title":"GITLAB_USER_LOGIN getting wrong value randomly","description":"### Summary\n\nHello,\n\nI have an issue on a job getting wrong user, when \"playing\" a job with a service account, GITLAB_USER_LOGIN contains the value of pipeline initiator instead of service account.\n\nComplete workflow:\n\n* User A create a feature branch\n* User A create a merge request\n* User B approve the MR\n* User A merge\n* a pipeline run on master : syntax, build, test, release\n* release step create a gitlab release using CI_JOB_TOKEN https://docs.gitlab.com/ee/api/releases/#create-a-release\n* a pipeline start on the tag release\n* this pipeline contains ‚Äúdeployment‚Äù jobs and ‚Äúour change process‚Äù\n* sandbox is automatically executed\n* User A manually deploy on preprod\n* User C approve playing ‚Äúapprove:tech‚Äù via WebUI manual job (or Technical Validation in the schema) =\u003e GITLAB_USER_LOGIN had User C login, never seen a wrong value\n* User A open an internal tool to feed the change. We created a formula for calulating the risk. If not risky the tool play the job using an account service, otherwise the tool wait a validation via a Slack quorum, when reached, we play the same job with the same account\n* The job played in both cases by the tool / bot is ‚Äúapprove:auto‚Äù via API =\u003e this is the job not getting the right value, sometimes GITLAB_USER_LOGIN had the account service login sometimes User A value, but it must be account service (according to the doc)\n\n![pipeline](/uploads/cc139550749779febe322b1e3781dfce/pipeline.png)\n\n### Steps to reproduce\n\nAs premium customer we try to reproduce with no luck the issue with @jfarmiloe ([ZD link, internal only](https://gitlab.zendesk.com/agent/tickets/223447))\n\n#### Results of GitLab environment info\n\nWe see this issue on Gitlab 12.10 and our current 13.11.4\n\n### Possible fixes\n\nUnfortunately, As this issue impact our production, I changed the way the pipeline work to avoid this issue so I can't make extra tests.\n\nAs a workaround, I‚Äôm using the ci job token to identify himself and retrieve rights data via https://gitlab.com/gitlab-org/gitlab/-/merge_requests/51727\n\nPS: we never override the environment variables, and the approval:auto job was never played by another user.","state":"closed","created_at":"2021-07-28T06:20:02.969Z","updated_at":"2022-09-02T19:42:58.166Z","closed_at":"2021-12-16T14:06:40.269Z","closed_by":{"id":4512666,"username":"jheimbuck_gl","name":"James Heimbuck","state":"active","avatar_url":"https://secure.gravatar.com/avatar/8dd2ef9c1cacb6e80d7ca47db6f0ce22?s=80\u0026d=identicon","web_url":"https://gitlab.com/jheimbuck_gl"},"labels":["Category:Continuous Integration","Verify::P1","backend","customer","devops::verify","group::pipeline execution","priority::4","section::ops","severity::3","type::bug","workflow::production"],"milestone":{"id":2114820,"iid":67,"group_id":9970,"title":"14.6","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T05:00:52.094Z","updated_at":"2022-04-21T07:26:38.271Z","due_date":"2021-12-17","start_date":"2021-11-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/67"},"assignees":[{"id":695467,"username":"fabiopitino","name":"Fabio Pitino","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f0db032076c54065b10b3efdfd175e6c?s=80\u0026d=identicon","web_url":"https://gitlab.com/fabiopitino"}],"author":{"id":1646194,"username":"ahmet2mir","name":"Ahmet Demir","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1646194/avatar.png","web_url":"https://gitlab.com/ahmet2mir"},"type":"ISSUE","assignee":{"id":695467,"username":"fabiopitino","name":"Fabio Pitino","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f0db032076c54065b10b3efdfd175e6c?s=80\u0026d=identicon","web_url":"https://gitlab.com/fabiopitino"},"user_notes_count":18,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337063","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337063","notes":"https://gitlab.com/api/v4/projects/278964/issues/337063/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337063/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337063","relative":"#337063","full":"gitlab-org/gitlab#337063"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90962557,"iid":337062,"project_id":278964,"title":"Make sure user information stays up to date on sidebar","description":"As discussed in https://gitlab.com/gitlab-org/gitlab/-/merge_requests/65217#note_635691923, `Assingees`, `Reviewers`, `Participants` may display stale information if we enable the cache feature.\nWe may need to observe cache_key changes of individual user record to fix this problem.","state":"closed","created_at":"2021-07-28T05:57:23.751Z","updated_at":"2021-10-28T13:54:39.028Z","closed_at":"2021-08-17T05:45:40.138Z","closed_by":{"id":4901936,"username":"dskim_gitlab","name":"Sincheol (David) Kim","state":"active","avatar_url":"https://secure.gravatar.com/avatar/84a984a56c54d1d31338678421cecc32?s=80\u0026d=identicon","web_url":"https://gitlab.com/dskim_gitlab"},"labels":["Deliverable","auto updated","backend","devops::create","group::code review","section::dev","type::maintenance"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":4901936,"username":"dskim_gitlab","name":"Sincheol (David) Kim","state":"active","avatar_url":"https://secure.gravatar.com/avatar/84a984a56c54d1d31338678421cecc32?s=80\u0026d=identicon","web_url":"https://gitlab.com/dskim_gitlab"}],"author":{"id":4901936,"username":"dskim_gitlab","name":"Sincheol (David) Kim","state":"active","avatar_url":"https://secure.gravatar.com/avatar/84a984a56c54d1d31338678421cecc32?s=80\u0026d=identicon","web_url":"https://gitlab.com/dskim_gitlab"},"type":"ISSUE","assignee":{"id":4901936,"username":"dskim_gitlab","name":"Sincheol (David) Kim","state":"active","avatar_url":"https://secure.gravatar.com/avatar/84a984a56c54d1d31338678421cecc32?s=80\u0026d=identicon","web_url":"https://gitlab.com/dskim_gitlab"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337062","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337062","notes":"https://gitlab.com/api/v4/projects/278964/issues/337062/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337062/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337062","relative":"#337062","full":"gitlab-org/gitlab#337062"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90959971,"iid":337060,"project_id":278964,"title":"Track `ActiveRecord::StatementInvalid` errors, and raise in development","description":"## Proposal\n\nSend `ActiveRecord::StatementInvalid` errors in `lib/gitlab/utils/usage_data.rb` to sentry, and raise exception in dev. In other words, use `Gitlab::ErrorTracking.track_and_raise_for_dev_exception`. (Thanks @alinamihaila for this great idea)\n\n## Problem\n\nSome `ActiveRecord::StatementInvalid` cause problems as Postgres tears down the connection upon encountering such errors. It then becomes a hard thing to debug as the error can occur anywhere\n\n```\n*** ActiveRecord::StatementInvalid Exception: PG::InFailedSqlTransaction: ERROR:  current transaction is aborted, commands ignored until end of transaction block\n```\n\n### Why can't we raise in production\n\nData is collected per week in a instance, and we cannot backfill so we have to rescue this exception.\n\n/cc @alinamihaila @mikolaj_wawrzyniak @a_akgun\n\n# Acceptance Criteria\n\n- [x] Add `track_and_raise_for_dev_exception` For each hardening method\n- [x] Update related service ping tests","state":"closed","created_at":"2021-07-28T04:48:29.681Z","updated_at":"2022-01-21T05:56:48.950Z","closed_at":"2022-01-21T05:56:48.936Z","closed_by":{"id":8200977,"username":"lmejia2","name":"Luis Mejia","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/8200977/avatar.png","web_url":"https://gitlab.com/lmejia2"},"labels":["backend","devops::growth","group::product intelligence","maintenance::refactor","missed:14.6","missed:14.7","section::growth","workflow::production"],"milestone":{"id":2161849,"iid":70,"group_id":9970,"title":"14.8","description":"","state":"active","created_at":"2021-07-26T16:51:47.677Z","updated_at":"2021-07-26T16:51:47.677Z","due_date":"2022-02-17","start_date":"2022-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/70"},"assignees":[{"id":8200977,"username":"lmejia2","name":"Luis Mejia","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/8200977/avatar.png","web_url":"https://gitlab.com/lmejia2"}],"author":{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"},"type":"ISSUE","assignee":{"id":8200977,"username":"lmejia2","name":"Luis Mejia","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/8200977/avatar.png","web_url":"https://gitlab.com/lmejia2"},"user_notes_count":13,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337060","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":2,"completed_count":2},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"2 of 2 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337060","notes":"https://gitlab.com/api/v4/projects/278964/issues/337060/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337060/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337060","relative":"#337060","full":"gitlab-org/gitlab#337060"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90956197,"iid":337055,"project_id":278964,"title":"\"There are merge conflicts\" warning is showing up when MR has no commits","description":"\u003c!---\nPlease read this!\n\nBefore opening a new issue, make sure to search for keywords in the issues\nfiltered by the \"regression\" or \"bug\" label:\n\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=regression\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=bug\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n### Summary\n\nThe \"There are merge conflicts\" warning is showing up when a merge request has no commits yet. There are no commits yet so there shouldn't be any conflicts.\n\n### Steps to reproduce\n\nCreate a MR with no commits. View the \"Changes\" tab.\n\n### Example Project\n\nhttps://gitlab.com/patrickbajao/verification/-/merge_requests/42/diffs\n\n### What is the current *bug* behavior?\n\nIt's showing the \"There are merge conflicts\" warning even if there are no conflicts.\n\n### What is the expected *correct* behavior?\n\nIt shouldn't the \"There are merge conflicts\" warning when there are no conflicts.\n\n### Relevant logs and/or screenshots\n\n![Screen_Shot_2021-07-28_at_10.57.06_AM](/uploads/5acda5ff01118391d9f34d19cb804ba0/Screen_Shot_2021-07-28_at_10.57.06_AM.png)\n\n### Possible fixes\n\nThe bug is due to `diffs_metadata.json` is returning `has_conflicts` as `true` when MR has no commits. To fix it, we should ensure that `has_conflicts` property wont be true if merge request has no real conflicts.","state":"closed","created_at":"2021-07-28T02:58:48.703Z","updated_at":"2021-09-17T13:00:37.789Z","closed_at":"2021-09-17T12:55:08.043Z","closed_by":{"id":2935693,"username":"phikai","name":"Kai Armstrong","state":"active","avatar_url":"https://secure.gravatar.com/avatar/2c5d6a63b41cbeb3ea4cccda82e758e1?s=80\u0026d=identicon","web_url":"https://gitlab.com/phikai"},"labels":["[deprecated] Accepting merge requests","backend","customer","devops::create","group::code review","section::dev","severity::4","type::bug"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/66"},"assignees":[],"author":{"id":1884221,"username":"patrickbajao","name":"Patrick Bajao","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1884221/avatar.png","web_url":"https://gitlab.com/patrickbajao"},"type":"ISSUE","assignee":null,"user_notes_count":17,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337055","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337055","notes":"https://gitlab.com/api/v4/projects/278964/issues/337055/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337055/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337055","relative":"#337055","full":"gitlab-org/gitlab#337055"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90955345,"iid":337054,"project_id":278964,"title":"Should we cache `Database::Connection.config` ?","description":"1. Should we cache `Database::Connection.config` ? If not we can remove `uncached_config`\n1. Otherwise we should make `uncached_config` private.\n\nThe following discussion from !66988 should be addressed:\n\n- [ ] @ashmckenzie started a [discussion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66988#note_637051291):  (+1 comment)\n\n    \u003e question: One perhaps for a follow-up in the interest of getting this fix out, but could `uncached_config` be made private to discourage from public use?\n\n/cc @yorickpeterse","state":"closed","created_at":"2021-07-28T02:33:06.251Z","updated_at":"2022-05-31T12:22:07.082Z","closed_at":"2021-07-29T17:14:46.779Z","closed_by":{"id":209240,"username":"yorickpeterse","name":"Yorick Peterse","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/209240/avatar.png","web_url":"https://gitlab.com/yorickpeterse"},"labels":["Category:Pods","auto updated","database","devops::data_stores","group::pods","section::enablement","type::feature"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[],"author":{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337054","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 1 checklist item completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337054","notes":"https://gitlab.com/api/v4/projects/278964/issues/337054/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337054/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337054","relative":"#337054","full":"gitlab-org/gitlab#337054"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":5974,"epic":{"id":268361,"iid":5974,"title":"Generalise our Load Balancing usage to allow many databases","url":"/groups/gitlab-org/-/epics/5974","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90954818,"iid":337052,"project_id":278964,"title":"Follow-up from \"Improve user errors during Jira API requests\"","description":"The following discussion from !66987 should be addressed:\n\n- [ ] @.luke started a [discussion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66987#note_637046855): \n\n    \u003e I'll create a follow-up issue to see if we can consolidate this list of errors in:\n    \u003e \n    \u003e - `app/services/jira_import/users_importer.rb`\n    \u003e - `app/models/integrations/jira.rb`","state":"closed","created_at":"2021-07-28T02:16:34.662Z","updated_at":"2022-11-22T19:36:58.849Z","closed_at":"2021-08-17T05:35:05.084Z","closed_by":{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"},"labels":["backend","devops::manage","group::integrations","section::dev","type::maintenance","workflow::ready for development"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"}],"author":{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"},"type":"ISSUE","assignee":{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337052","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 1 checklist item completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337052","notes":"https://gitlab.com/api/v4/projects/278964/issues/337052/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337052/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337052","relative":"#337052","full":"gitlab-org/gitlab#337052"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90949103,"iid":337044,"project_id":278964,"title":"Add the ability to filter epic boards and issue boards by milestone in graphql","description":"To get completeness of add new filtered search to issue/epic boards, we need to keep adding tokens.\n\nWe need to add milestone title filter to epic boards and issue boards\n\n---\n### Feature Flag\n\nWe're working on refactoring filtered search on boards to use GraphQL. This issue is part of that work, and is behind the `:issue_boards_filtered_search` feature flag.","state":"closed","created_at":"2021-07-27T23:15:53.355Z","updated_at":"2021-12-09T01:16:00.783Z","closed_at":"2021-11-11T00:16:51.802Z","closed_by":{"id":3507264,"username":"donaldcook","name":"Donald Cook","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3507264/avatar.png","web_url":"https://gitlab.com/donaldcook"},"labels":["backend","devops::plan","feature::addition","frontend","group::product planning","section::dev","type::feature"],"milestone":null,"assignees":[],"author":{"id":4447636,"username":"sstern","name":"Scott Stern","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4447636/avatar.png","web_url":"https://gitlab.com/sstern"},"type":"ISSUE","assignee":null,"user_notes_count":15,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337044","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337044","notes":"https://gitlab.com/api/v4/projects/278964/issues/337044/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337044/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337044","relative":"#337044","full":"gitlab-org/gitlab#337044"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6517,"epic":{"id":320221,"iid":6517,"title":"Completely use new filtered search tokens on group/project issue boards","url":"/groups/gitlab-org/-/epics/6517","group_id":9970,"human_readable_end_date":"Dec 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90949032,"iid":337043,"project_id":278964,"title":"Add the ability to filter issue boards by confidentiality in GraphQL","description":"To get completeness of add new filtered search to issue/epic boards, we need to keep adding tokens. \n\nWe need to add confidentiality filter to issue boards and epic boards\n\n~backend \n\nWe need to add `confidential` to be a filter on `Board.lists(issueFilters: BoardIssueInput)` and `BoardList.issues(filters: BoardIssueInput)`\n\n---\n### Feature Flag\n\nWe're working on refactoring filtered search on boards to use GraphQL. This issue is part of that work, and is behind the `:issue_boards_filtered_search` feature flag.","state":"closed","created_at":"2021-07-27T23:12:34.929Z","updated_at":"2022-01-04T22:36:15.211Z","closed_at":"2021-12-13T22:14:46.274Z","closed_by":{"id":4846639,"username":"fguibert","name":"Florie Guibert","state":"active","avatar_url":"https://secure.gravatar.com/avatar/705331e7e375d5832c9fa5309370b55f?s=80\u0026d=identicon","web_url":"https://gitlab.com/fguibert"},"labels":["backend","devops::plan","feature::addition","frontend","group::product planning","section::dev","type::feature","workflow::production"],"milestone":null,"assignees":[{"id":3860200,"username":"egrieff","name":"Eugenia Grieff","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3860200/avatar.png","web_url":"https://gitlab.com/egrieff"},{"id":4846639,"username":"fguibert","name":"Florie Guibert","state":"active","avatar_url":"https://secure.gravatar.com/avatar/705331e7e375d5832c9fa5309370b55f?s=80\u0026d=identicon","web_url":"https://gitlab.com/fguibert"}],"author":{"id":4447636,"username":"sstern","name":"Scott Stern","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4447636/avatar.png","web_url":"https://gitlab.com/sstern"},"type":"ISSUE","assignee":{"id":3860200,"username":"egrieff","name":"Eugenia Grieff","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3860200/avatar.png","web_url":"https://gitlab.com/egrieff"},"user_notes_count":20,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337043","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337043","notes":"https://gitlab.com/api/v4/projects/278964/issues/337043/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337043/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337043","relative":"#337043","full":"gitlab-org/gitlab#337043"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6517,"epic":{"id":320221,"iid":6517,"title":"Completely use new filtered search tokens on group/project issue boards","url":"/groups/gitlab-org/-/epics/6517","group_id":9970,"human_readable_end_date":"Dec 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":{"id":38169,"iid":43,"sequence":4,"group_id":9970,"title":"Iteration 4: December 08, 2021 - December 21, 2021","description":null,"state":3,"created_at":"2021-10-22T17:12:40.546Z","updated_at":"2021-12-22T00:05:02.231Z","start_date":"2021-12-08","due_date":"2021-12-21","web_url":"https://gitlab.com/groups/gitlab-org/-/iterations/38169"},"health_status":null},{"id":90946824,"iid":337040,"project_id":278964,"title":"Backport enum mangling fix","description":"## Background\n\nFrom the PoC MR we tried using the same migration files for both main: and ci: databases. For the most part it works, except for `rails db:migrate:reset`.\n\n## Problem\n\nNote: This is not relevant if we change our mind and use different migrations files for each database.\n\nIt is common practice to narrowly define the model you want inside the database, to prevent `app/models` changes from affecting migrations by accident. However, Rails 6 introduced enum mangling detection which means in `db:migrate:reset` we run into this error:\n\n```\nArgumentError: You tried to define an enum named \"usage\" on the model \"DeleteInconsistentInternalIdRecords2::InternalId\", but this will generate a instance method \"issues?\", which is already defined by another enum.\n```\n\n## Task\n\nBackport https://github.com/rails/rails/pull/40992 which should fix this","state":"closed","created_at":"2021-07-27T21:57:11.250Z","updated_at":"2022-05-31T12:22:07.780Z","closed_at":"2021-09-13T15:48:21.009Z","closed_by":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"labels":["Category:Pods","[deprecated] Accepting merge requests","auto updated","devops::data_stores","group::pods","section::enablement","type::feature"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[],"author":{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"},"type":"ISSUE","assignee":null,"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337040","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337040","notes":"https://gitlab.com/api/v4/projects/278964/issues/337040/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337040/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337040","relative":"#337040","full":"gitlab-org/gitlab#337040"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6103,"epic":{"id":281355,"iid":6103,"title":"Decomposition: Support for many databases","url":"/groups/gitlab-org/-/epics/6103","group_id":9970,"human_readable_end_date":"Sep 16, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90946307,"iid":337039,"project_id":278964,"title":"Hanging specs when databases decomposed","description":"These feature specs hangs on [this MR](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/78182):\n\n\n* [x] spec/features/merge_request/user_sees_pipelines_spec.rb - https://gitlab.com/gitlab-org/gitlab/-/merge_requests/80848\n* [x] spec/features/admin/admin_runners_spec.rb\n* [x] spec/features/triggers_spec.rb\n* [x] spec/features/expand_collapse_diffs_spec.rb\n* [-] ~ee/spec/features/registrations/combined_registration_spec.rb~\n\n### Reproduction\n\n```\n$ export GITLAB_USE_MODEL_LOAD_BALANCING=true\n$ export CACHE_CLASSES=true\n$ export GITLAB_TEST_EAGER_LOAD=true\n$ bin/rspec -f d spec/features/admin/admin_runners_spec.rb\n\n**hangs**\n```\n\nAt this stage start `lldb` on mac, or `gdb`\n\n```\n$ lldb\n(lldb) process attach --pid 73448\n\n# See https://saveriomiroddi.github.io/Debugging-a-live-stuck-ruby-process-with-gdb-fully-explained-plus-many-goodies/#other-interesting-sources\n(lldb) call (void) rb_p((unsigned long) rb_eval_string_protect(\"Thread.list.each {|t| puts t; puts t.backtrace}\", (int*)0))\n```\n\nAlternative install https://github.com/fluent/sigdump#install which will give you a nice dump of all Threads' backtraces.\n\n\n## Investigation\n\nI confirmed that spec/features/merge_request/user_sees_pipelines_spec.rb is definitely hanging on the autoload lock (load_interlock_aware_monitor.rb)\n\n- From a [discussion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/62092#note_636300615):  (+1 comment)\n\n    \u003e ## Hang with spec/features/merge_request/user_sees_pipelines_spec.rb\n    \u003e \n    \u003e Found this piece of magic in [the internet](https://youtu.be/APNZmTEs9tc), which lists the backtrace of every Thread:\n    \u003e \n    \u003e ```c\n    \u003e call rb_p(rb_eval_string_protect(\"Thread.list.each {|t| puts t; puts t.backtrace.join(%Q[\\n]); }\", (int*)0))\n    \u003e ```\n    \u003e \n    \u003e [thread_backtraces.txt](/uploads/769f509382b20f310d80fbe7845c74c2/thread_backtraces.txt)\n    \u003e \n    \u003e The backtraces is stuck in `load_interlock_aware_monitor.rb:17`\n    \u003e \n    \u003e Possibly relevant issues :\n    \u003e \n    \u003e - https://github.com/rails/rails/issues/37092\n    \u003e - https://github.com/rails/rails/issues/27025\n    \u003e - https://github.com/rails/rails/issues/34310\n\n[thread_backtraces.txt](/uploads/f77cd5dcd0f56126c921e2f1e554d5cd/thread_backtraces.txt)","state":"closed","created_at":"2021-07-27T21:40:10.234Z","updated_at":"2022-07-29T21:25:36.646Z","closed_at":"2022-03-01T05:03:23.028Z","closed_by":{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"},"labels":["Category:Pods","auto updated","ci-decomposition","ci-decomposition::phase4","devops::systems","group::pipeline execution","pods::active","section::enablement","type::maintenance","workflow::in review"],"milestone":{"id":2204140,"iid":71,"group_id":9970,"title":"14.9","description":"","state":"active","created_at":"2021-08-26T19:11:46.841Z","updated_at":"2022-03-22T13:29:17.028Z","due_date":"2022-03-17","start_date":"2022-02-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/71"},"assignees":[{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"}],"author":{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"},"type":"ISSUE","assignee":{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"},"user_notes_count":31,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337039","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":4,"completed_count":4},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"4 of 4 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337039","notes":"https://gitlab.com/api/v4/projects/278964/issues/337039/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337039/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337039","relative":"#337039","full":"gitlab-org/gitlab#337039"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6379,"epic":{"id":309971,"iid":6379,"title":"Decomposition: Make Ops features compatible with Decomposed CI database","url":"/groups/gitlab-org/-/epics/6379","group_id":9970,"human_readable_end_date":"Jun 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90945230,"iid":337036,"project_id":278964,"title":"Increase spacing between Code results on Global Search results page","description":"### Problem to solve\n\nCurrently, there is very little spacing between Code results on the Global Search results page. This makes it very difficult to scan the result listing and clearly see where one result starts and another ends. Additionally, we are missing a top border on each result, which would help in creating this separation. See screenshots below:\n\n| | |\n| ------ | ------ |\n| current | ![Screen_Shot_2021-07-27_at_2.48.58_PM](/uploads/42c15b2723381d48b4e181ef8e9f8ba4/Screen_Shot_2021-07-27_at_2.48.58_PM.png) |\n| proposed | ![Screen_Shot_2021-07-27_at_2.51.32_PM](/uploads/fc8fa259b6b3077f8dfb6a9c8915075d/Screen_Shot_2021-07-27_at_2.51.32_PM.png) |\n\n/cc @JohnMcGuire","state":"closed","created_at":"2021-07-27T20:56:11.755Z","updated_at":"2022-05-30T16:31:11.814Z","closed_at":"2021-08-12T15:46:40.710Z","closed_by":{"id":4748809,"username":"zcuddy","name":"Zack Cuddy","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4748809/avatar.png","web_url":"https://gitlab.com/zcuddy"},"labels":["Category:Global Search","UX","devops::data_stores","frontend","group::global search","section::enablement","type::feature","workflow::in review"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":4748809,"username":"zcuddy","name":"Zack Cuddy","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4748809/avatar.png","web_url":"https://gitlab.com/zcuddy"}],"author":{"id":5041243,"username":"nickbrandt","name":"Nick Brandt","state":"active","avatar_url":"https://secure.gravatar.com/avatar/96e3036898d44a8ad7063ba07cce0998?s=80\u0026d=identicon","web_url":"https://gitlab.com/nickbrandt"},"type":"ISSUE","assignee":{"id":4748809,"username":"zcuddy","name":"Zack Cuddy","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4748809/avatar.png","web_url":"https://gitlab.com/zcuddy"},"user_notes_count":7,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337036","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":0,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337036","notes":"https://gitlab.com/api/v4/projects/278964/issues/337036/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337036/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337036","relative":"#337036","full":"gitlab-org/gitlab#337036"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90942096,"iid":337033,"project_id":278964,"title":"Gitlab for Jira app doesn't load: can't configure","description":"\u003c!---\nPlease read this!\n\nBefore opening a new issue, make sure to search for keywords in the issues\nfiltered by the \"regression\" or \"bug\" label:\n\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=regression\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=bug\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n### Summary \nOur organization is unable to configure the **[Gitlab for Jira app](https://marketplace.atlassian.com/apps/1221011/gitlab-com-for-jira-cloud?hosting=cloud\u0026tab=overview)** installed on our Cloud Jira instance. **Other users** have reported the same issue on the app's [review page](https://marketplace.atlassian.com/apps/1221011/gitlab-com-for-jira-cloud?hosting=cloud\u0026tab=reviews), unable to configure the app.\n\n\u003c!-- Summarize the bug encountered concisely. --\u003e\nThe \"Get started\" page for the Gitlab app shows a **blank screen and won't load**. After a while, it shows an error that says:\"Something's gone wrong. Our team has been notified. If the problem persists, please contact Atlassian Support.\"\n\nWe contacted Atlassian and they redirected us to Gitlab as Atlassian doesn't support 3rd-party apps.\n\nOn the Gitlab for Jira app's review page, some people have reported the same issue, unable to configure the app.\n\n### Steps to reproduce\nOn Jira Cloud: Go to Settings \u003e\u003e Apps \u003e\u003e Manage apps \u003e\u003e Gitlab for Jira \u003e\u003e Get Started\n\n\u003c!-- Describe how one can reproduce the issue - this is very important. Please use an ordered list. --\u003e\n\n### Example Project\n\n\u003c!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. --\u003e\n\n### What is the current *bug* behavior?\nWhen clicking on \"Get Started,\" nothing loads. The page spins, shows a white screen and then shows an error message. \n\n\u003c!-- Describe what actually happens. --\u003e\n\n### What is the expected *correct* behavior?\nWhen clicking on \"Get Started,\" we should be able to configure the Gitlab for Jira app to integrate Gitlab with our Jira projects. \n\n\u003c!-- Describe what you should see instead. --\u003e\n\n### Relevant logs and/or screenshots\n![Screen_Shot_2021-07-26_at_10.36.29_AM](/uploads/866728745878d62259ee354946676d15/Screen_Shot_2021-07-26_at_10.36.29_AM.png)![Screen_Shot_2021-07-26_at_10.36.41_AM__2_](/uploads/26977922f06d80c3a37fb0de483ae7b5/Screen_Shot_2021-07-26_at_10.36.41_AM__2_.png)\n\n\u003c!-- Paste any relevant logs - please use code blocks (```) to format console output, logs, and code\n as it's tough to read otherwise. --\u003e\n\n### Output of checks\n\n\u003c!-- If you are reporting a bug on GitLab.com, write: This bug happens on GitLab.com --\u003e\n\n#### Results of GitLab environment info\n\n\u003c!--  Input any relevant GitLab environment information if needed. --\u003e\n\n\u003cdetails\u003e\n\u003csummary\u003eExpand for output related to GitLab environment info\u003c/summary\u003e\n\n\u003cpre\u003e\n\n(For installations with omnibus-gitlab package run and paste the output of:\n`sudo gitlab-rake gitlab:env:info`)\n\n(For installations from source run and paste the output of:\n`sudo -u git -H bundle exec rake gitlab:env:info RAILS_ENV=production`)\n\n\u003c/pre\u003e\n\u003c/details\u003e\n\n#### Results of GitLab application Check\n\n\u003c!--  Input any relevant GitLab application check information if needed. --\u003e\n\n\u003cdetails\u003e\n\u003csummary\u003eExpand for output related to the GitLab application check\u003c/summary\u003e\n\u003cpre\u003e\n\n(For installations with omnibus-gitlab package run and paste the output of:\n`sudo gitlab-rake gitlab:check SANITIZE=true`)\n\n(For installations from source run and paste the output of:\n`sudo -u git -H bundle exec rake gitlab:check RAILS_ENV=production SANITIZE=true`)\n\n(we will only investigate if the tests are passing)\n\n\u003c/pre\u003e\n\u003c/details\u003e\n\n### Possible fixes\n\n\u003c!-- If you can, link to the line of code that might be responsible for the problem. --\u003e","state":"closed","created_at":"2021-07-27T19:31:46.893Z","updated_at":"2022-11-22T19:37:00.438Z","closed_at":"2022-04-14T13:50:04.011Z","closed_by":{"id":423116,"username":"toupeira","name":"Markus Koller","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7585ed50675c4febe7619f25b44f7fe0?s=80\u0026d=identicon","web_url":"https://gitlab.com/toupeira"},"labels":["Category:Integrations","Integration::Jira","Jira::ConnectApp","backend","customer","devops::manage","group::integrations","priority::1","section::dev","severity::1","type::bug","workflow::verification"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/72"},"assignees":[{"id":423116,"username":"toupeira","name":"Markus Koller","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7585ed50675c4febe7619f25b44f7fe0?s=80\u0026d=identicon","web_url":"https://gitlab.com/toupeira"}],"author":{"id":9009957,"username":"caroline.debrion","name":"Caroline D.","state":"active","avatar_url":"https://secure.gravatar.com/avatar/377f7d1360b37a93fb126107b3847a27?s=80\u0026d=identicon","web_url":"https://gitlab.com/caroline.debrion"},"type":"ISSUE","assignee":{"id":423116,"username":"toupeira","name":"Markus Koller","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7585ed50675c4febe7619f25b44f7fe0?s=80\u0026d=identicon","web_url":"https://gitlab.com/toupeira"},"user_notes_count":22,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337033","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337033","notes":"https://gitlab.com/api/v4/projects/278964/issues/337033/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337033/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337033","relative":"#337033","full":"gitlab-org/gitlab#337033"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90936476,"iid":337027,"project_id":278964,"title":"[UX] Let customer know that there is a future dated subscription on the account","description":"This is the UX issue for https://gitlab.com/gitlab-org/gitlab/-/issues/337026.\n\n## Proposal\n\n| Scenario | Descriptions |\n| ------ | ------ |\n| **Scenario 1**\u003cbr\u003e- SM instance that has no active subscription\u003cbr\u003e- SM instance that has no previously activated expired licenses | ![Frame_23](/uploads/679f03ec6fb507f4f476f6815a545e6c/Frame_23.png) |\n| **Scenario 2**\u003cbr\u003e- SM instance that has no active subscription\u2028\u003cbr\u003e- SM instance that has previously activated expired licenses\u003cbr\u003e\u003cbr\u003e**Additions**\u003cbr\u003eWe now show the subscription history table underneath the activate subscription component `Free trial` and `Buy subscription` components. | ![Frame_24](/uploads/aee1d65ea9ef557309e0ba2e52c0d710/Frame_24.png) |\n| **Scenario 3**\u003cbr\u003e- SM instance that has no active subscription\u2028\u003cbr\u003e- SM instance that has a future-dated subscription\u2028\u003cbr\u003e\u003cbr\u003e**Additions** `IMPORTANT`\u003cbr\u003eWe now show the subscription history table and an alert banner underneath the activate subscription component. The alert is to help inform the user of their future-dated subscription. | ![Frame_25](/uploads/4c09aea952df1ba9aba828361bfbac47/Frame_25.png) |\n| **Scenario 3 (Avoiding two alerts)**\u003cbr\u003eWe should avoid if possible this scenario where we have two alerts displayed. If there is no active subscription I do not think the success alert is needed. | ![Frame_26](/uploads/34ec4dded314fb45a2e7e6a2d3713adf/Frame_26.png) | \n\n[**Figma design specs**](https://www.figma.com/file/1PPVuqztzEB2cR52oJUq6K/Future-dated-license-exploration?node-id=4%3A8686)\n\n---\n\n**Important**\n\nThe Subscription table is changing as of https://gitlab.com/gitlab-org/gitlab/-/issues/337531#proposal","state":"closed","created_at":"2021-07-27T17:10:19.056Z","updated_at":"2021-12-23T15:37:18.727Z","closed_at":"2021-09-16T15:03:14.007Z","closed_by":{"id":3354144,"username":"timnoah","name":"Tim Noah","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3354144/avatar.png","web_url":"https://gitlab.com/timnoah"},"labels":["Cloud License Sync - V2","Technical Writing","UI text","UX","[deprecated] Category:Provision","devops::fulfillment","group::provision","missed:14.2","section::fulfillment","type::feature"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":3354144,"username":"timnoah","name":"Tim Noah","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3354144/avatar.png","web_url":"https://gitlab.com/timnoah"}],"author":{"id":7971452,"username":"teresatison","name":"Teresa Tison","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/7971452/avatar.png","web_url":"https://gitlab.com/teresatison"},"type":"ISSUE","assignee":{"id":3354144,"username":"timnoah","name":"Tim Noah","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3354144/avatar.png","web_url":"https://gitlab.com/timnoah"},"user_notes_count":14,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337027","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337027","notes":"https://gitlab.com/api/v4/projects/278964/issues/337027/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337027/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337027","relative":"#337027","full":"gitlab-org/gitlab#337027"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90933616,"iid":337019,"project_id":278964,"title":"Introduce Rubocop rule that prevents usage of `Gitlab::Database.main/ci`","description":"Follow-up after conversation on Slack: https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66288.\n\nWhen discussing that with @yorickpeterse a lot of changes that we do today with moving\ninvocations from `Gitlab::Database.` to `Gitlab::Database.main.` is to refactor a singleton\nusage of `Gitlab::Database.` to something that indicates what DB is being used.\nHowever, we acknowledge that a lot of instance methods of these classes are actually problematic\nwhen having to be supported with many databases, as we might end-up with a lot of ifs and\nvery unclear pieces of code whether we should use `.main.` or `.ci.`. This depends mostly\non a running configuration of GitLab and dependening on implementation the `main==ci`\nor `ci==nil` or `main!=ci`.\n\nThis issue proposes that since we know that usage of `.main|ci.` is gonna cause hardless we\nshould discourage its usage all-together. The Rubocop rule is a handy tool for that.\n\n## Proposal\n\n1. Introduce Rubocop rule, mark all existing usages\n2. Create issues and ask respective teams to remove this usage\n3. Prevent new usages of `.main.` and redirect to alternatives using models\n\n## Desire\n\nWith many DBs we will anyway have to re-check all places with usage of `.main.` and we also want to\nbe proactive on preventing new ones being added that do not take many DBs into account.","state":"closed","created_at":"2021-07-27T16:16:05.821Z","updated_at":"2022-05-30T15:01:28.920Z","closed_at":"2021-11-18T08:32:43.675Z","closed_by":{"id":209240,"username":"yorickpeterse","name":"Yorick Peterse","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/209240/avatar.png","web_url":"https://gitlab.com/yorickpeterse"},"labels":["Category:Database","Category:Pods","Engineering Allocation","[deprecated] Accepting merge requests","devops::data_stores","group::database","missed:14.4","section::enablement","type::maintenance"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/66"},"assignees":[],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":null,"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337019","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337019","notes":"https://gitlab.com/api/v4/projects/278964/issues/337019/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337019/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337019","relative":"#337019","full":"gitlab-org/gitlab#337019"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6103,"epic":{"id":281355,"iid":6103,"title":"Decomposition: Support for many databases","url":"/groups/gitlab-org/-/epics/6103","group_id":9970,"human_readable_end_date":"Sep 16, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90931046,"iid":337016,"project_id":278964,"title":"[QA] Overhaul eventually_matcher","description":"\u003c!-- This issue template can be used a great starting point for feature requests. The last section \"Release notes\" can be used as a summary of the feature and is also required if you want to have your release post blog MR auto generated using the release post item generator:  https://about.gitlab.com/handbook/marketing/blog/release-posts/#release-post-item-generator. The remaining sections are the backbone for every feature in GitLab. --\u003e\n\n### Release notes \n\n\u003c!-- What is the problem and solution you're proposing? This content sets the overall vision for the feature and serves as the release notes that will populate in various places, including the [release post blog](https://about.gitlab.com/releases/categories/releases/) and [Gitlab project releases](https://gitlab.com/gitlab-org/gitlab/-/releases). \" --\u003e\n\n### Problem to solve \n\nThe Eventually Matcher for our end-to-end suite is limited to only two options:\n- Duration\n- Attempts\n\nThis limits the extensibility and usability of the Eventually Matcher\n\n### Proposal \n\nInstead of defining these options to pass:\n\n```ruby\nexpect { :a }.to eventually_eq(:a).within(duration: 60, attempts: 4)\n```\n\nWe should simply pass the `within` parameters through to the `QA::Support::Retrier.retry_until` call\n\n```diff\ndiff --git a/qa/spec/support/matchers/eventually_matcher.rb b/qa/spec/support/matchers/eventually_matcher.rb\nindex 3f0afd6fb54..f37ca66633b 100644\n--- a/qa/spec/support/matchers/eventually_matcher.rb\n+++ b/qa/spec/support/matchers/eventually_matcher.rb\n@@ -22,8 +22,7 @@ module Matchers\n   ].each do |op|\n     RSpec::Matchers.define(:\"eventually_#{op}\") do |*expected|\n       chain(:within) do |options = {}|\n-        @duration = options[:duration]\n-        @attempts = options[:attempts]\n+        @options = options\n       end\n \n       def supports_block_expectations?\n@@ -52,11 +51,7 @@ def supports_block_expectations?\n       # @param [Symbol] expectation_name\n       # @return [Boolean]\n       def wait_and_check(actual, expectation_name)\n-        QA::Support::Retrier.retry_until(\n-          max_attempts: @attempts,\n-          max_duration: @duration,\n-          sleep_interval: 0.5\n-        ) do\n+        QA::Support::Retrier.retry_until(@options) do\n           public_send(expectation_name, actual)\n         rescue RSpec::Expectations::ExpectationNotMetError, QA::Resource::ApiFabricator::ResourceNotFoundError\n           false\n```\n\n#### Design Considerations\n\n- We should maintain the usability for the Eventually Matcher to use `duration` and `attempts`, rather than the more verbose `max_duration` and `max_attempts`\n\n```ruby\nexpect { :a }.to eventually_eq(:a).within(duration: 50, reload_page: page, attempts: 4, sleep_interval: 1.0)\n```\n\n\u003c!--- Use the following resources to find the appropriate labels:\n- https://gitlab.com/gitlab-org/gitlab/-/labels\n- https://about.gitlab.com/handbook/product/categories/features/\n\nConsider adding related issues and epics to this issue. You can also reference the Feature Proposal Template (https://gitlab.com/gitlab-org/gitlab/-/blob/master/.gitlab/issue_templates/Feature%20proposal%20-%20detailed.md) for additional details to consider adding to this issue. Additionally, as a data oriented organization, when your feature exits planning breakdown, consider adding the `What does success look like, and how can we measure that?` section.\n\nOther sections to consider adding: \n\n### Intended users\n\nWho will use this feature? If known, include any of the following: types of users (e.g. Developer), personas, or specific company roles (e.g. Release Manager). It's okay to write \"Unknown\" and fill this field in later.\n\nPersonas are described at https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/\n\n* [Sasha (Software Developer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#sasha-software-developer)\n* [Simone (Software Engineer in Test)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#simone-software-engineer-in-test)\n\n/cc @acunskis","state":"closed","created_at":"2021-07-27T15:31:48.846Z","updated_at":"2021-10-28T13:54:40.419Z","closed_at":"2021-08-11T13:17:45.377Z","closed_by":{"id":8551613,"username":"acunskis","name":"Andrejs Cunskis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/8551613/avatar.png","web_url":"https://gitlab.com/acunskis"},"labels":["QA","Quality","Quality::test-infrastructure","[deprecated] Accepting merge requests","type::maintenance"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[],"author":{"id":272636,"username":"ddavison","name":"Dan Davison","state":"active","avatar_url":"https://secure.gravatar.com/avatar/6e56557ffa1baafe3e73e45bd2dc9524?s=80\u0026d=identicon","web_url":"https://gitlab.com/ddavison"},"type":"ISSUE","assignee":null,"user_notes_count":7,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337016","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337016","notes":"https://gitlab.com/api/v4/projects/278964/issues/337016/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337016/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337016","relative":"#337016","full":"gitlab-org/gitlab#337016"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90928676,"iid":337009,"project_id":278964,"title":"DAST Site validation - Meta tag - Backend","description":"Epic - https://gitlab.com/groups/gitlab-org/-/epics/6460\n\n# Why are we doing this work\n\nThis is a ~backend issue for implementing DAST Site validation using Meta Tags.\n\n### Requirements\n\nA new validation option added to the validation modal to allow for use of an HTML meta tag with the validation string as the value.\n\n\n## Implementation plan\n\n- [X] [Add metatag validation to runner image](https://gitlab.com/gitlab-org/security-products/dast-runner-validation/-/merge_requests/10) \n- [x] [Release runner image](https://gitlab.com/security-products/dast-runner-validation/container_registry/2110665)\n- [x] [Extend ~GraphQL enum](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/67553)","state":"closed","created_at":"2021-07-27T15:04:17.849Z","updated_at":"2021-08-18T07:06:21.469Z","closed_at":"2021-08-16T01:17:26.752Z","closed_by":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"labels":["Category:DAST","Deliverable","Stretch","backend","devops::secure","feature::addition","group::dynamic analysis","section::sec","type::feature","workflow::in review"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"}],"author":{"id":4019091,"username":"djadmin","name":"Dheeraj Joshi","state":"active","avatar_url":"https://secure.gravatar.com/avatar/57dccb416bfcfac947a69c53c5585128?s=80\u0026d=identicon","web_url":"https://gitlab.com/djadmin"},"type":"ISSUE","assignee":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337009","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":3,"completed_count":3},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"3 of 3 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337009","notes":"https://gitlab.com/api/v4/projects/278964/issues/337009/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337009/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337009","relative":"#337009","full":"gitlab-org/gitlab#337009"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6460,"epic":{"id":315399,"iid":6460,"title":"DAST Site validation - Meta tag","url":"/groups/gitlab-org/-/epics/6460","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90924831,"iid":337006,"project_id":278964,"title":"Add product tier to Jira issue requirement documentation","description":"## Problem to solve\n\nJira issue requirement is a ~\"GitLab Ultimate\" feature, however the [docs](https://docs.gitlab.com/ee/integration/jira/issues.html#require-associated-jira-issue-for-merge-requests-to-be-merged) does not have a product tier.\n\n## Suggested solution\n\nAdd a ~\"GitLab Ultimate\" product tier to the docs section.","state":"closed","created_at":"2021-07-27T14:11:53.270Z","updated_at":"2021-07-29T13:12:50.411Z","closed_at":"2021-07-29T13:12:50.398Z","closed_by":{"id":3468028,"username":"jiaan","name":"Jiaan Louw","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3468028/avatar.png","web_url":"https://gitlab.com/jiaan"},"labels":["Integration::Jira","devops::manage","docs-only","documentation","group::compliance","section::dev"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":3468028,"username":"jiaan","name":"Jiaan Louw","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3468028/avatar.png","web_url":"https://gitlab.com/jiaan"}],"author":{"id":3468028,"username":"jiaan","name":"Jiaan Louw","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3468028/avatar.png","web_url":"https://gitlab.com/jiaan"},"type":"ISSUE","assignee":{"id":3468028,"username":"jiaan","name":"Jiaan Louw","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3468028/avatar.png","web_url":"https://gitlab.com/jiaan"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337006","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337006","notes":"https://gitlab.com/api/v4/projects/278964/issues/337006/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337006/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337006","relative":"#337006","full":"gitlab-org/gitlab#337006"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90923666,"iid":337003,"project_id":278964,"title":"DAST Site validation - Meta tag - Frontend","description":"Epic - https://gitlab.com/groups/gitlab-org/-/epics/6460\n\n# Why are we doing this work\n\nThis is a ~frontend implementation issue for adding \"Meta tag\" to DAST Site validation.\n\n### Requirements\n\nA new validation option added to the validation modal to allow for use of an HTML meta tag with the validation string as the value.\n\nDesigns - https://gitlab.com/gitlab-org/gitlab/-/issues/333733#designs\n\n## Implementation plan\n\n- [x] Add `Meta tag` option to [DAST_SITE_VALIDATION_METHODS](https://gitlab.com/gitlab-org/gitlab/blob/113f16a2dcfc1de1766f6a055a5627b5be3986aa/ee/app/assets/javascripts/security_configuration/dast_site_validation/constants.js)\n- [x] Update `dast_site_validation_modal.vue`\n   - [x] Add a new `GlFormGroup`\n   - [x] Update copy changes\n   - [x] Add new `validationStrategy`\n- [x] Update ~GraphQL \n   - Add new strategy to `dast_site_validation_create.mutation.graphql`\n- [x] Put all the changes behind a new ~\"feature flag\" \n- [x] Add specs for\n   - [x] new option\n   - [x] new validation strategy","state":"closed","created_at":"2021-07-27T13:57:53.636Z","updated_at":"2021-08-13T07:32:42.579Z","closed_at":"2021-08-13T07:32:42.561Z","closed_by":{"id":4019091,"username":"djadmin","name":"Dheeraj Joshi","state":"active","avatar_url":"https://secure.gravatar.com/avatar/57dccb416bfcfac947a69c53c5585128?s=80\u0026d=identicon","web_url":"https://gitlab.com/djadmin"},"labels":["Category:DAST","Stretch","devops::secure","feature::addition","frontend","group::dynamic analysis","section::sec","type::feature","workflow::production"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":4019091,"username":"djadmin","name":"Dheeraj Joshi","state":"active","avatar_url":"https://secure.gravatar.com/avatar/57dccb416bfcfac947a69c53c5585128?s=80\u0026d=identicon","web_url":"https://gitlab.com/djadmin"}],"author":{"id":4019091,"username":"djadmin","name":"Dheeraj Joshi","state":"active","avatar_url":"https://secure.gravatar.com/avatar/57dccb416bfcfac947a69c53c5585128?s=80\u0026d=identicon","web_url":"https://gitlab.com/djadmin"},"type":"ISSUE","assignee":{"id":4019091,"username":"djadmin","name":"Dheeraj Joshi","state":"active","avatar_url":"https://secure.gravatar.com/avatar/57dccb416bfcfac947a69c53c5585128?s=80\u0026d=identicon","web_url":"https://gitlab.com/djadmin"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337003","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":10,"completed_count":10},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"10 of 10 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337003","notes":"https://gitlab.com/api/v4/projects/278964/issues/337003/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337003/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337003","relative":"#337003","full":"gitlab-org/gitlab#337003"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6460,"epic":{"id":315399,"iid":6460,"title":"DAST Site validation - Meta tag","url":"/groups/gitlab-org/-/epics/6460","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":"on_track"},{"id":90922273,"iid":337001,"project_id":278964,"title":"Add Integration Tests to Historical CI Minute Charts","description":"### Proposal \n\nWe need to add tests to charts introduced in https://gitlab.com/gitlab-org/gitlab/-/issues/246844\n\n### Availability \u0026 Testing\n\n\u003c!-- This section needs to be retained and filled in during the workflow planning breakdown phase of this feature proposal, if not earlier.\n\nWhat risks does this change pose to our availability? How might it affect the quality of the product? What additional test coverage or changes to tests will be needed? Will it require cross-browser testing?\n\nPlease list the test areas (unit, integration and end-to-end) that needs to be added or updated to ensure that this feature will work as intended. Please use the list below as guidance.\n* Unit test changes\n* Integration test changes\n* End-to-end test change\n\nSee the test engineering planning process and reach out to your counterpart Software Engineer in Test for assistance: https://about.gitlab.com/handbook/engineering/quality/test-engineering/#test-planning --\u003e\n\n#### Unit Testing\nFor unit testing, as always, let's make sure we have good coverage for the changes we're introducing/updating here.\n\n#### Integration Testing\nSince there's going to be a refactor to move CI minutes to Core (https://gitlab.com/gitlab-org/gitlab/-/issues/336569). Let's introduce some integration tests to ensure the graphs are able to fetch the data and display it properly before and after the refactor.\n\nFew things we can look into verifying here:\n1. The CI usage count (0 / 400 minutes) is correct.\n2. The month dropdown options are correct.","state":"closed","created_at":"2021-07-27T13:34:43.931Z","updated_at":"2021-08-17T16:25:53.440Z","closed_at":"2021-08-17T15:18:07.060Z","closed_by":{"id":829774,"username":"jivanvl","name":"Jose Ivan Vargas","state":"active","avatar_url":"https://secure.gravatar.com/avatar/730cc1b85a20f2a3891829f7aa198972?s=80\u0026d=identicon","web_url":"https://gitlab.com/jivanvl"},"labels":["Category:Continuous Integration","Quality","Verify::P1","auto updated","group::pipeline execution","needs weight","quad-planning::ready","section::ops","test-plan","workflow::verification"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":829774,"username":"jivanvl","name":"Jose Ivan Vargas","state":"active","avatar_url":"https://secure.gravatar.com/avatar/730cc1b85a20f2a3891829f7aa198972?s=80\u0026d=identicon","web_url":"https://gitlab.com/jivanvl"}],"author":{"id":4905402,"username":"jreporter","name":"Jackie Porter","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4905402/avatar.png","web_url":"https://gitlab.com/jreporter"},"type":"ISSUE","assignee":{"id":829774,"username":"jivanvl","name":"Jose Ivan Vargas","state":"active","avatar_url":"https://secure.gravatar.com/avatar/730cc1b85a20f2a3891829f7aa198972?s=80\u0026d=identicon","web_url":"https://gitlab.com/jivanvl"},"user_notes_count":12,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/337001","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/337001","notes":"https://gitlab.com/api/v4/projects/278964/issues/337001/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/337001/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#337001","relative":"#337001","full":"gitlab-org/gitlab#337001"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90921621,"iid":336999,"project_id":278964,"title":"Evil webhook DoS 2: Giant Headers","description":"**[HackerOne report #1252116](https://hackerone.com/reports/1252116)** by `afewgoats` on 2021-07-05, assigned to H1 Triage:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n#####  Summary\n\nGitlab Webhooks do not properly obey timeouts, so connections can be forced to last forever.\n\nThe previous bug [1029269](https://hackerone.com/reports/1029269) was [patched](https://gitlab.com/gitlab-org/gitlab/-/commit/94aa90323f79cd797863afa43642bdceb6c38bdf) but I found a way to bypass the fix. Instead of sending data slowly in the HTTP body, send data forever in the HTTP header section.\n\nIn the patch, a block is passed to HTTParty. However, this block is only called [after the headers have been processed and the body data starts to arrive](https://github.com/jnunemaker/httparty/blob/fb7c40303b7e6429196ef748754505768520407c/lib/httparty/request.rb#L141).\n\nA malicious webhook receiver can respond in a way such that:\n\n* The HTTP(S) connection between the Gitlab sidekiq process and the webhook server NEVER ends  \n* Large amounts of data are kept in memory\n\nIt's not just project webhooks. Any use of `Gitlab::HTTP.post` such as system webhooks and integrations (e.g. Mattermost) are affected.\n\n#####  Steps to reproduce\n\nThe node server attached sends data at a rate of 1 byte per 3.21 seconds without ending the HTTP header section: `HTTP/1.1 200 OK\\r\\nxxxxxxxxxxxxxxxxxxxx...`\n\n1. Start the malicious webserver with `node never-end-headers.js`  \n2. Create a project and add webhooks for issue events to http://maliciousserver:3000/xyz  \n3. Create an issue (or close or reopen one) to trigger the webhook.  \n4. The webhook connection will stay open forever.\n\nAlso try adding `/mega` to the path which makes it send 550 MB over the first 5 minutes and then send the usual 1 byte per 3.21 seconds. This can reserve 550 MB in process memory. You can of course modify the script to send endless amounts of data much faster.\n\nFor your convenience you can use my test server again but please again redact the domain:  https://viii.sr/never-end/justheaders/gitlab\n\n#####  Examples\n\nI did run it briefly on Gitlab.org (`User-Agent: GitLab/14.1.0-pre`), but killed the connection after half an hour.\n\n#####  What is the current *bug* behavior?\n\nThere is no overall timeout on the webhook connection except when using the Test Webhook function. (Also accepts huge response data in header section)\n\n#####  What is the expected *correct* behavior?\n\nAfter 10 seconds (or some other reasonable timeout), webhook requests timeout even if headers are still being transferred. Many HTTP clients also have a header size limit.\n\n#####  Relevant logs and/or screenshots\n\nNever ending jobs:\n\n![sidekiq.png](https://h1.sec.gitlab.net/a/a8e6dc3a-c70f-4169-8e58-bb104405b81a/sidekiq.png)\n\nAfter **deliberately** killing the connection:\n\n![gitlabhook.png](https://h1.sec.gitlab.net/a/f07b2d4f-4d8e-4a30-bfb3-51a52b1e69db/gitlabhook.png)\n\n```  \n{\"severity\":\"ERROR\",\"time\":\"2021-07-05T22:02:16.462Z\",\"correlation_id\":\"d055442cfe2e0bf0cd4d1c9273abaa28\",\"exception.class\":\"Gitlab::HTTP::ReadTotalTimeout\",\"exception.message\":\"Gitlab::HTTP::ReadTotalTimeout with \\\"Request timed out after 332.36488593695685 seconds\\\"\",\"exception.b  \nacktrace\":[\"lib/gitlab/http.rb:55:in `block in perform_request'\",\"lib/gitlab/http.rb:53:in `perform_request'\",\"app/services/web_hook_service.rb:109:in `make_request'\",\"app/services/web_hook_service.rb:56:in `execute'\",\"app/workers/web_hook_worker.rb:19:in `perform'\",\"lib/gitlab/sid  \nekiq_middleware/duplicate_jobs/strategies/until_executing.rb:16:in `perform'\",\"lib/gitlab/sidekiq_middleware/duplicate_jobs/duplicate_job.rb:41:in `perform'\",\"lib/gitlab/sidekiq_middleware/duplicate_jobs/server.rb:8:in `call'\",\"lib/gitlab/sidekiq_middleware/worker_context.rb:9:in `  \nwrap_in_optional_context'\",\"lib/gitlab/sidekiq_middleware/worker_context/server.rb:17:in `block in call'\",\"lib/gitlab/application_context.rb:74:in `block in use'\",\"lib/gitlab/application_context.rb:74:in `use'\",\"lib/gitlab/application_context.rb:27:in `with_context'\",\"lib/gitlab/si  \ndekiq_middleware/worker_context/server.rb:15:in `call'\",\"lib/gitlab/sidekiq_status/server_middleware.rb:7:in `call'\",\"lib/gitlab/sidekiq_versioning/middleware.rb:9:in `call'\",\"lib/gitlab/sidekiq_middleware/admin_mode/server.rb:14:in `call'\",\"lib/gitlab/sidekiq_middleware/instrument  \nation_logger.rb:9:in `call'\",\"lib/gitlab/sidekiq_middleware/batch_loader.rb:7:in `call'\",\"lib/gitlab/sidekiq_middleware/extra_done_log_metadata.rb:7:in `call'\",\"lib/gitlab/sidekiq_middleware/request_store_middleware.rb:10:in `block in call'\",\"lib/gitlab/with_request_store.rb:17:in   \n`enabling_request_store'\",\"lib/gitlab/with_request_store.rb:10:in `with_request_store'\",\"lib/gitlab/sidekiq_middleware/request_store_middleware.rb:9:in `call'\",\"lib/gitlab/sidekiq_middleware/server_metrics.rb:29:in `block in call'\",\"lib/gitlab/sidekiq_middleware/server_metrics.rb:5  \n2:in `block in instrument'\",\"lib/gitlab/metrics/background_transaction.rb:30:in `run'\",\"lib/gitlab/sidekiq_middleware/server_metrics.rb:52:in `instrument'\",\"lib/gitlab/sidekiq_middleware/server_metrics.rb:28:in `call'\",\"lib/gitlab/sidekiq_middleware/monitor.rb:8:in `block in call'\"  \n,\"lib/gitlab/sidekiq_daemon/monitor.rb:49:in `within_job'\",\"lib/gitlab/sidekiq_middleware/monitor.rb:7:in `call'\",\"lib/gitlab/sidekiq_middleware/size_limiter/server.rb:13:in `call'\",\"lib/gitlab/sidekiq_logging/structured_logger.rb:19:in `call'\"],\"user.username\":\"root\",\"tags.program  \n\":\"sidekiq\",\"tags.locale\":\"en\",\"tags.feature_category\":\"integrations\",\"tags.correlation_id\":\"d055442cfe2e0bf0cd4d1c9273abaa28\",\"extra.sidekiq\":{\"class\":\"WebHookWorker\",\"args\":[\"2\",\"[FILTERED]\",\"issue_hooks\"],\"retry\":4,\"queue\":\"web_hook\",\"version\":0,\"dead\":false,\"jid\":\"710ebd1ab8d7a  \nf75e2fd9e18\",\"created_at\":1625522198.495918,\"meta.user\":\"root\",\"meta.project\":\"root/hookz\",\"meta.root_namespace\":\"root\",\"meta.caller_id\":\"GraphqlController#execute\",\"meta.remote_ip\":\"172.17.0.1\",\"meta.related_class\":\"ProjectHook\",\"meta.feature_category\":\"not_owned\",\"meta.client_id\"  \n:\"user/1\",\"correlation_id\":\"d055442cfe2e0bf0cd4d1c9273abaa28\",\"idempotency_key\":\"resque:gitlab:duplicate:web_hook:42f4ec1690d28151b9660ac15937309479fb9587947c60a56e9aa77c318ddeb5\",\"enqueued_at\":1625522204.049519}}  \n```\n\n#####  Output of checks\n\nThis bug happens on GitLab.com and locally\n\n######  Results of GitLab environment info\n\nGitlab-ee docker image\n\n```  \nroot@gitlab:/# gitlab-rake gitlab:env:info\n\nSystem information  \nSystem:  \nProxy:          no  \nCurrent User:   git  \nUsing RVM:      no  \nRuby Version:   2.7.2p137  \nGem Version:    3.1.4  \nBundler Version:2.1.4  \nRake Version:   13.0.3  \nRedis Version:  6.0.14  \nGit Version:    2.32.0  \nSidekiq Version:5.2.9  \nGo Version:     unknown\n\nGitLab information  \nVersion:        14.0.2-ee  \nRevision:       2504e045362  \nDirectory:      /opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:     PostgreSQL  \nDB Version:     12.6  \nURL:            https://gitlab.example.com  \nHTTP Clone URL: https://gitlab.example.com/some-group/some-project.git  \nSSH Clone URL:  git@gitlab.example.com:some-group/some-project.git  \nElasticsearch:  no  \nGeo:            no  \nUsing LDAP:     no  \nUsing Omniauth: yes  \nOmniauth Providers: \n\nGitLab Shell  \nVersion:        13.19.0  \nRepository storage paths:  \n- default:      /var/opt/gitlab/git-data/repositories  \nGitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell  \nGit:            /opt/gitlab/embedded/bin/git  \n```\n\n####  Impact\n\nDoS against connection pool, memory. Connections can last days and you can start multiple connections.\n\nThe only difference in impact from the previous report is that the headers now don't get saved in the database. If after a few hours the malicious server cleanly ends the connection with a nice \\r\\n\\r\\n, the timeout-checking block will be run and `Gitlab::HTTP::ReadTotalTimeout` will be belatedly raised.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [gitlabhook.png](https://h1.sec.gitlab.net/a/f07b2d4f-4d8e-4a30-bfb3-51a52b1e69db/gitlabhook.png)\n* [sidekiq.png](https://h1.sec.gitlab.net/a/a8e6dc3a-c70f-4169-8e58-bb104405b81a/sidekiq.png)\n* [never-end-headers.js](https://h1.sec.gitlab.net/a/d1b377d2-a636-4593-8eb6-2372f2f6697f/never-end-headers.js)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\nThe report had clear reproduction steps, I'd only add that to make things easier to reproduce locally it can be good to enable connections to the local network in the admin settings.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues\n\n### Reproducing this on the Rails console\n\n1. Copy the malicious server example and save it in a file `slow_server.rb`.\n1. Start the server `ruby slow_server.rb`.\n1. In a new terminal window, open the rails console `bundle exec rails c`.\n1. Send a request `Gitlab::HTTP.get('http://localhost:9292')`.\n1. Observe that the request is blocked forever.\n\n**Malicious server example:**\n\n```ruby\nrequire 'socket'\n\nserver = TCPServer.new 9292\n\ndef start_session(server)\n  while session = server.accept\n    request = session.gets\n    puts request\n  \n    session.print \"HTTP/1.1 200\\r\\n\"\n  \n    session.print \"Content-Type: text/html\" # 2\n    (1..400).each do |i|\n      session.print 'h' # 2\n      sleep 1\n    end\n  \n    session.print \"\\r\\n\" # 2\n    session.print \"\\r\\n\" # 3\n  \n    session.print \"Hello world! The time is #{Time.now}\" #4\n  \n    session.close\n  end\nend\n\ndef listen(server)\n  start_session(server)\nrescue Errno::EPIPE\n  listen(server)\nend\n\nlisten(server)\n```","state":"closed","created_at":"2021-07-27T13:24:31.590Z","updated_at":"2022-11-22T19:37:04.352Z","closed_at":"2022-03-03T19:24:56.460Z","closed_by":{"id":16943,"username":"Andysoiron","name":"Andy Soiron","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/16943/avatar.png","web_url":"https://gitlab.com/Andysoiron"},"labels":["Deliverable","HackerOne","Weakness::CWE-400","auto updated","availability::limit","backend","bug::vulnerability","devops::manage","group::integrations","missed-SLO","missed-deliverable","missed:14.4","missed:14.5","missed:14.6","missed:14.7","missed:14.8","priority::2","reliability","section::dev","security","security-awards::awarded","security-backlog::review-complete","severity::2","type::bug","workflow::verification"],"milestone":{"id":2204140,"iid":71,"group_id":9970,"title":"14.9","description":"","state":"active","created_at":"2021-08-26T19:11:46.841Z","updated_at":"2022-03-22T13:29:17.028Z","due_date":"2022-03-17","start_date":"2022-02-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/71"},"assignees":[{"id":16943,"username":"Andysoiron","name":"Andy Soiron","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/16943/avatar.png","web_url":"https://gitlab.com/Andysoiron"}],"author":{"id":2741139,"username":"gitlab-securitybot","name":"GitLab SecurityBot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2741139/avatar.png","web_url":"https://gitlab.com/gitlab-securitybot"},"type":"ISSUE","assignee":{"id":16943,"username":"Andysoiron","name":"Andy Soiron","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/16943/avatar.png","web_url":"https://gitlab.com/Andysoiron"},"user_notes_count":41,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2021-09-25","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336999","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336999","notes":"https://gitlab.com/api/v4/projects/278964/issues/336999/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336999/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336999","relative":"#336999","full":"gitlab-org/gitlab#336999"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90921096,"iid":336998,"project_id":278964,"title":"N+1 noted around pipeline webhook event payload serialisation","description":"We checked with the suggested test mentioned in comment https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66744#note_636058887 and noticed that pipeline webhook payload serialization causes N+1 queries.\n\nThe fix for the existing issues is also recommended in the same comment as diff.\n\nOpening this issue to implement the changes suggested.","state":"closed","created_at":"2021-07-27T13:15:15.042Z","updated_at":"2021-08-18T08:36:10.082Z","closed_at":"2021-08-17T13:21:54.437Z","closed_by":{"id":9253328,"username":"bala.kumar","name":"Bala Kumar","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9253328/avatar.png","web_url":"https://gitlab.com/bala.kumar"},"labels":["Category:Continuous Delivery","backend","devops::release","group::release","maintenance::refactor","section::ops","type::bug","workflow::production"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":9253328,"username":"bala.kumar","name":"Bala Kumar","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9253328/avatar.png","web_url":"https://gitlab.com/bala.kumar"}],"author":{"id":9253328,"username":"bala.kumar","name":"Bala Kumar","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9253328/avatar.png","web_url":"https://gitlab.com/bala.kumar"},"type":"ISSUE","assignee":{"id":9253328,"username":"bala.kumar","name":"Bala Kumar","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9253328/avatar.png","web_url":"https://gitlab.com/bala.kumar"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336998","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336998","notes":"https://gitlab.com/api/v4/projects/278964/issues/336998/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336998/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336998","relative":"#336998","full":"gitlab-org/gitlab#336998"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90915674,"iid":336994,"project_id":278964,"title":"Follow-up from \"Add state column to members table\"","description":"The following discussion from !66550 should be addressed:\n\n- [ ] @Quintasan started a [discussion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66550#note_636419446):  (+2 comments)\n\n    \u003e `members` is a huge table ‚Äì `24 707 028` records currently, please use `with_lock_retries` helper. See https://docs.gitlab.com/ee/development/migration_style_guide.html#high-traffic-tables for more information\n    \u003e \n    \u003e I think we should have a follow-up merge request to add `members` to https://gitlab.com/gitlab-org/gitlab/-/blob/master/rubocop/rubocop-migrations.yml#L4","state":"closed","created_at":"2021-07-27T12:09:05.874Z","updated_at":"2021-08-24T07:43:18.656Z","closed_at":"2021-08-24T07:43:01.173Z","closed_by":{"id":4192493,"username":"ebaque","name":"Etienne Baqu√©","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4192493/avatar.png","web_url":"https://gitlab.com/ebaque"},"labels":["auto updated","missed:14.2","workflow::in review"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":4192493,"username":"ebaque","name":"Etienne Baqu√©","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4192493/avatar.png","web_url":"https://gitlab.com/ebaque"}],"author":{"id":4192493,"username":"ebaque","name":"Etienne Baqu√©","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4192493/avatar.png","web_url":"https://gitlab.com/ebaque"},"type":"ISSUE","assignee":{"id":4192493,"username":"ebaque","name":"Etienne Baqu√©","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4192493/avatar.png","web_url":"https://gitlab.com/ebaque"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336994","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 1 checklist item completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336994","notes":"https://gitlab.com/api/v4/projects/278964/issues/336994/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336994/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336994","relative":"#336994","full":"gitlab-org/gitlab#336994"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90910761,"iid":336987,"project_id":278964,"title":"Remove StoreSecurityScansWorker","description":"## Why are we doing this work\n\nRemove the `StoreSecurityScansWorker` from the codebase as it has become obsolete by https://gitlab.com/gitlab-org/gitlab/-/merge_requests/42634.\n\n## Implementation plan\n\n- [x] ~backend Remove the `StoreSecurityScansWorker` and related configuration from the codebase.","state":"closed","created_at":"2021-07-27T10:42:27.984Z","updated_at":"2021-10-28T13:54:42.930Z","closed_at":"2021-08-01T22:02:05.868Z","closed_by":{"id":480804,"username":"thiagocsf","name":"Thiago Figueir√≥","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/480804/avatar.png","web_url":"https://gitlab.com/thiagocsf"},"labels":["Category:Vulnerability Management","backend","devops::secure","good for new contributors","group::threat insights","maintenance::refactor","section::sec","type::maintenance","workflow::in review"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":480804,"username":"thiagocsf","name":"Thiago Figueir√≥","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/480804/avatar.png","web_url":"https://gitlab.com/thiagocsf"}],"author":{"id":5721376,"username":"minac","name":"Mehmet Emin INAC","state":"active","avatar_url":"https://secure.gravatar.com/avatar/d8bdee790902422e3554e411a173c7c0?s=80\u0026d=identicon","web_url":"https://gitlab.com/minac"},"type":"ISSUE","assignee":{"id":480804,"username":"thiagocsf","name":"Thiago Figueir√≥","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/480804/avatar.png","web_url":"https://gitlab.com/thiagocsf"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336987","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":1},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"1 of 1 checklist item completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336987","notes":"https://gitlab.com/api/v4/projects/278964/issues/336987/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336987/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336987","relative":"#336987","full":"gitlab-org/gitlab#336987"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90909583,"iid":336986,"project_id":278964,"title":"Change the primary identifier on job page to job name","description":"## üß© Background\nhttps://gitlab.com/gitlab-org/gitlab/-/issues/334349/ introduces a change to the job index page to focus on job names as the primary identifier. However, the job log page still shows the ID as the primary identifier in the mast head.\n| Image |\n|--------|\n| ![Frame_1__14_](/uploads/1adb3125c3a733c18683858f5540db2c/Frame_1__14_.png) |\n\n## ‚ú® Proposal\nChange the Job ID shown in the mast head on the job log page to job name.","state":"closed","created_at":"2021-07-27T10:17:18.097Z","updated_at":"2021-09-20T16:13:27.396Z","closed_at":"2021-09-20T14:18:56.620Z","closed_by":{"id":4477803,"username":"pburdette","name":"Payton Burdette","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4477803/avatar.png","web_url":"https://gitlab.com/pburdette"},"labels":["Category:Continuous Integration","UX","Verify::P2","auto updated","devops::verify","frontend","group::pipeline execution","section::ops","workflow::production"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[{"id":4477803,"username":"pburdette","name":"Payton Burdette","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4477803/avatar.png","web_url":"https://gitlab.com/pburdette"}],"author":{"id":6115425,"username":"v_mishra","name":"Veethika M","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f09a3a0badac17a57e28b4e18a45c1c0?s=80\u0026d=identicon","web_url":"https://gitlab.com/v_mishra"},"type":"ISSUE","assignee":{"id":4477803,"username":"pburdette","name":"Payton Burdette","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4477803/avatar.png","web_url":"https://gitlab.com/pburdette"},"user_notes_count":12,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336986","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336986","notes":"https://gitlab.com/api/v4/projects/278964/issues/336986/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336986/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336986","relative":"#336986","full":"gitlab-org/gitlab#336986"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90904066,"iid":336981,"project_id":278964,"title":"Migrate all window.location assignments to setWindowLocation helper in Jest","description":"This issue tracks the migration of the remaining test suites to `setWindowLocation` or `useMockLocationHelper`.\n\nIn https://gitlab.com/gitlab-org/gitlab/-/merge_requests/63878, the `setWindowLocation` helper was improved, and various test suites were migrated to use it instead of the various approaches that existed before.\n\nVarious uses remain, one of the most common is [this sort of pattern](https://gitlab.com/gitlab-org/gitlab/blob/bf3ddac65e7bf84bd4bdf3fd38ed1715a72e19b3/spec/frontend/packages/list/components/packages_list_app_spec.js#L242-246):\n\n```js\ndelete window.location;\nwindow.location = {\n  href: 'some_path?foo=bar',\n  search: '?foo=bar',\n};\n```\n\nor\n\n```js\ndelete window.location;\nwindow.location = new URL('https://gdk.test');\n```\n\nSomething else that could be tackled at the same time is [simplifying the arguments passed to `setWindowLocation`](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/63878#note_635709252).","state":"closed","created_at":"2021-07-27T08:55:52.904Z","updated_at":"2021-10-28T13:54:43.642Z","closed_at":"2021-08-09T14:00:52.395Z","closed_by":{"id":553096,"username":"markrian","name":"Mark Florian","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/553096/avatar.png","web_url":"https://gitlab.com/markrian"},"labels":["auto updated","frontend","type::maintenance","unit testing"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":553096,"username":"markrian","name":"Mark Florian","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/553096/avatar.png","web_url":"https://gitlab.com/markrian"}],"author":{"id":553096,"username":"markrian","name":"Mark Florian","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/553096/avatar.png","web_url":"https://gitlab.com/markrian"},"type":"ISSUE","assignee":{"id":553096,"username":"markrian","name":"Mark Florian","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/553096/avatar.png","web_url":"https://gitlab.com/markrian"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336981","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336981","notes":"https://gitlab.com/api/v4/projects/278964/issues/336981/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336981/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336981","relative":"#336981","full":"gitlab-org/gitlab#336981"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90901791,"iid":336976,"project_id":278964,"title":"Merge request test summary fields are illegible","description":"### Summary\n\nThe values of the regular fields `Classname` and `Execution time` of the test summary in the merge request view are illegible in GitLab dark mode.\n\n### Steps to reproduce\n\n- Use GitLab Dark Mode (alpha).\n- Create a merge request which outputs a junit report with failing tests.\n- Expand the test results\n- Click on a test\n- Notice the values for **Classname:** and **Execution time:** aren‚Äôt legible. They are there though, they can be selected.\n\n### Example Project\n\nN/A\n\n### What is the current *bug* behavior?\n\nClassname and execution time values are illegible.\n\n### What is the expected *correct* behavior?\n\nClassname and execution time values are legible.\n\n### Relevant logs and/or screenshots\n\n![image](/uploads/1beb75db338a1e5b80bcd74a24ae7c23/image.png)\n\n### Output of checks\n\nThis bug happens on GitLab.com\n\n### Possible fixes\n\nChange the text color for the `text-secondary` CSS class.","state":"closed","created_at":"2021-07-27T08:20:47.547Z","updated_at":"2021-10-28T13:54:46.198Z","closed_at":"2021-08-16T15:44:34.063Z","closed_by":{"id":3374280,"username":"mfluharty","name":"Miranda Fluharty","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3374280/avatar.png","web_url":"https://gitlab.com/mfluharty"},"labels":["Category:Code Testing and Coverage","FY22::Q3","UX","automation:ml","automation:ml wrong","devops::verify","frontend","group::pipeline insights","section::ops","type::maintenance","usability","workflow::verification"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":3374280,"username":"mfluharty","name":"Miranda Fluharty","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3374280/avatar.png","web_url":"https://gitlab.com/mfluharty"}],"author":{"id":615964,"username":"remcohaszing","name":"Remco Haszing","state":"active","avatar_url":"https://secure.gravatar.com/avatar/fe52b3d3928f49a5057987549d39d1cb?s=80\u0026d=identicon","web_url":"https://gitlab.com/remcohaszing"},"type":"ISSUE","assignee":{"id":3374280,"username":"mfluharty","name":"Miranda Fluharty","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3374280/avatar.png","web_url":"https://gitlab.com/mfluharty"},"user_notes_count":15,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336976","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336976","notes":"https://gitlab.com/api/v4/projects/278964/issues/336976/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336976/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":"https://gitlab.com/api/v4/projects/278964/issues/334007"},"references":{"short":"#336976","relative":"#336976","full":"gitlab-org/gitlab#336976"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90896352,"iid":336969,"project_id":278964,"title":"Create empty state for CI usage chart","description":"## üß© Background\n\nIn https://gitlab.com/gitlab-org/gitlab/-/issues/246844/ we delivered VI usage charts to enable users to analyze historical usage by monthly and by project. Currently, we do not have an empty and loading state for the charts.\n\n## ‚ú® Proposal\n\nDesign:\n1. An empty state for the CI usage chart for when no information is available\n\nFollow-up for later:\n1. Design a loading state to boost perceived performance while the information is being fetch to show on the chart","state":"closed","created_at":"2021-07-27T07:04:50.496Z","updated_at":"2022-04-27T07:42:35.767Z","closed_at":"2021-11-08T14:51:00.853Z","closed_by":{"id":4477803,"username":"pburdette","name":"Payton Burdette","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4477803/avatar.png","web_url":"https://gitlab.com/pburdette"},"labels":["Category:Continuous Integration","UI text","UX","Verify::P1","auto updated","devops::verify","frontend","group::pipeline execution","section::ops","workflow::production"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/66"},"assignees":[{"id":4477803,"username":"pburdette","name":"Payton Burdette","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4477803/avatar.png","web_url":"https://gitlab.com/pburdette"},{"id":6115425,"username":"v_mishra","name":"Veethika M","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f09a3a0badac17a57e28b4e18a45c1c0?s=80\u0026d=identicon","web_url":"https://gitlab.com/v_mishra"}],"author":{"id":6115425,"username":"v_mishra","name":"Veethika M","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f09a3a0badac17a57e28b4e18a45c1c0?s=80\u0026d=identicon","web_url":"https://gitlab.com/v_mishra"},"type":"ISSUE","assignee":{"id":4477803,"username":"pburdette","name":"Payton Burdette","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4477803/avatar.png","web_url":"https://gitlab.com/pburdette"},"user_notes_count":21,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336969","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336969","notes":"https://gitlab.com/api/v4/projects/278964/issues/336969/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336969/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336969","relative":"#336969","full":"gitlab-org/gitlab#336969"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90894659,"iid":336968,"project_id":278964,"title":"Add `Administration` to new Sidebar","description":"This is an EE only menu:\n\n![image](/uploads/f33128c84d9e84fb572e7d08ab8a899d/image.png)","state":"closed","created_at":"2021-07-27T06:32:43.529Z","updated_at":"2021-09-18T07:01:06.286Z","closed_at":"2021-08-20T05:28:59.313Z","closed_by":{"id":955795,"username":"fjsanpedro","name":"Francisco Javier L√≥pez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/955795/avatar.png","web_url":"https://gitlab.com/fjsanpedro"},"labels":["Category:Navigation \u0026 Settings","Deliverable","auto updated","backend","devops::create","group::editor","section::dev"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":955795,"username":"fjsanpedro","name":"Francisco Javier L√≥pez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/955795/avatar.png","web_url":"https://gitlab.com/fjsanpedro"}],"author":{"id":955795,"username":"fjsanpedro","name":"Francisco Javier L√≥pez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/955795/avatar.png","web_url":"https://gitlab.com/fjsanpedro"},"type":"ISSUE","assignee":{"id":955795,"username":"fjsanpedro","name":"Francisco Javier L√≥pez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/955795/avatar.png","web_url":"https://gitlab.com/fjsanpedro"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336968","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336968","notes":"https://gitlab.com/api/v4/projects/278964/issues/336968/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336968/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336968","relative":"#336968","full":"gitlab-org/gitlab#336968"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":5819,"epic":{"id":254641,"iid":5819,"title":"Group sidebar code refactor","url":"/groups/gitlab-org/-/epics/5819","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90890445,"iid":336953,"project_id":278964,"title":"Fix `Ci::PipelinesFinder#by_name` cross-join `users` and `ci_pipelines`","description":"### Release notes\n\n   In GitLab 14.3, we will remove the ability to filter by `name` in the [list project pipelines API endpoint](https://docs.gitlab.com/ee/api/pipelines.html#list-project-pipelines) to improve performance. If you currently use this parameter with this endpoint, you will need to switch to `username`.\n\n### Problem to solve\n\nThere is an open MR where we started this discussion already https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66020 but it has stalled.\n\nThis [`Ci::PipelinesFinder#by_name`](https://gitlab.com/gitlab-org/gitlab/-/blob/15d6c423c2bd7893a712dd0109508c44daba233c/app/finders/ci/pipelines_finder.rb#L111) method is only used [in the API](https://gitlab.com/gitlab-org/gitlab/-/blob/15d6c423c2bd7893a712dd0109508c44daba233c/lib/api/ci/pipelines.rb#L47) (see `name` field in [the docs](https://docs.gitlab.com/ee/api/pipelines.html#list-project-pipelines)). Please note this is referring to the user's display name (the one you can edit and add whatever you want to and not the `username` which is unique and harder to change).\n\nThis cannot work when `ci_*` tables are moved to a separate database.\n\n### Options\n\n1. Remove this feature from the API\n2. Change the code to load the candidate users using `User.where(name: 'blah').pluck(:id)` in the first query and pass this through in the 2nd query. Note the performance considerations discussed in https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66020#note_625501999 . This approach will have to have some reasonable limit if there is a `name` that is incredibly common in a GitLab instance we don't want to OOM ourselves by loading all the users with that name into memory.\n3. If we really need to correctly handle this feature then de-normalizing the `users.name` onto the `ci_pipelines` is the only robust way to do it. But it's not recommended because this is very expensive as it's a text field and updates very regularly. We do not recommend this de-normalization. \n\n### Sharding team recommended solution\n\nRemove the feature from the API. It seems unlikely that people use this feature and it seems like a pointless feature anyway since we already support filtering by `username`. `name` is a field that users can change constantly and we don't even have use cases ourselves for filtering by `name`. More of my reasoning at https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66020#note_624876082","state":"closed","created_at":"2021-07-27T04:41:43.401Z","updated_at":"2021-10-28T13:54:46.739Z","closed_at":"2021-09-08T07:35:32.221Z","closed_by":{"id":514662,"username":"furkanayhan","name":"Furkan Ayhan","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/514662/avatar.png","web_url":"https://gitlab.com/furkanayhan"},"labels":["Category:Pipeline Authoring","Engineering Allocation","FY22::Q3","SaaS","Verify::P2","auto updated","ci-decomposition","devops::verify","group::pipeline authoring","maintenance::refactor","needs weight","release post item::in review","reliability","section::ops","type::maintenance","workflow::production"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":514662,"username":"furkanayhan","name":"Furkan Ayhan","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/514662/avatar.png","web_url":"https://gitlab.com/furkanayhan"}],"author":{"id":120073,"username":"DylanGriffith","name":"Dylan Griffith","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/120073/avatar.png","web_url":"https://gitlab.com/DylanGriffith"},"type":"ISSUE","assignee":{"id":514662,"username":"furkanayhan","name":"Furkan Ayhan","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/514662/avatar.png","web_url":"https://gitlab.com/furkanayhan"},"user_notes_count":32,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336953","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336953","notes":"https://gitlab.com/api/v4/projects/278964/issues/336953/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336953/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336953","relative":"#336953","full":"gitlab-org/gitlab#336953"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6588,"epic":{"id":328775,"iid":6588,"title":"Engineering Allocation: Improve SaaS Reliability in the Verify stage","url":"/groups/gitlab-org/-/epics/6588","group_id":9970,"human_readable_end_date":"Apr 8, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":"on_track"},{"id":90886567,"iid":336946,"project_id":278964,"title":"[Feature flag] Rollout of `dast_scanner_profile_disable_joins`","description":"\u003c!-- Title suggestion: [Feature flag] Enable description of feature --\u003e\n\n## Summary\n\nThis issue is to rollout [the feature](ISSUE LINK) on production,\nthat is currently behind the `\u003cfeature-flag-name\u003e` feature flag.\n\nThis issue is to rollout [Prepare DAST for CI Decomposition initiative](https://gitlab.com/gitlab-org/gitlab/-/issues/336195) on production,\nthat is currently behind the `dast_scanner_profile_disable_joins` feature flag.\n\n\u003c!-- Short description of what the feature is about and link to relevant other issues. --\u003e\n\n## Owners\n\n* Team: ~\"group::dynamic analysis\"\n* Most appropriate slack channel to reach out to: `#g_secure-dynamic-analysis`\n* Best individual to reach out to: @philipcunningham\n* PM: @derekferguson\n\n## Stakeholders\n\n\u003c!--\nAre there any other stages or teams involved that need to be kept in the loop?\n\n- Name of a PM\n- The Support Team\n- The Delivery Team\n--\u003e\n\n## The Rollout Plan\n\n- Partial Rollout on GitLab.com with testing groups\n- Rollout on GitLab.com for a certain period (How long)\n- Percentage Rollout on GitLab.com\n- Rollout Feature for everyone as soon as it's ready\n\n\u003c!-- Which dashboards from https://dashboards.gitlab.net are most relevant? Sentry errors reports can also be useful to review --\u003e\n\n## Testing Groups/Projects/Users\n\n\u003c!-- If applicable, any groups/projects that are happy to have this feature turned on early. Some organizations may wish to test big changes they are interested in with a small subset of users ahead of time for example. --\u003e\n\n- `gitlab-org/gitlab` project\n- `gitlab-org`/`gitlab-com` groups\n- ...\n\n\n## Expectations\n\n### What are we expecting to happen?\n\n\u003c!-- Describe the expected outcome when rolling out this feature --\u003e\n\n### What might happen if this goes wrong?\n\n\u003c!-- Should the feature flag be turned off? Any MRs that need to be rolled back? Communication that needs to happen? What are some things you can think of that could go wrong - data loss or broken pages? --\u003e\n\n### What can we monitor to detect problems with this?\n\n\u003c!-- Which dashboards from https://dashboards.gitlab.net are most relevant? --\u003e\n\n## Rollout Steps\n\n### Rollout on non-production environments\n\n- [ ] Ensure that the feature MRs have been deployed to non-production environments.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-your-feature\u003e`\n- [ ] Enable the feature globally on non-production environments.\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e true --dev`\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e true --staging`\n- [ ] Verify that the feature works as expected. Posting the QA result in this issue is preferable.\n\n### Preparation before production rollout\n\n- [ ] Ensure that the feature MRs have been deployed to both production and canary.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-your-feature\u003e`\n- [ ] Check if the feature flag change needs to be accompanied with a\n  [change management issue](https://about.gitlab.com/handbook/engineering/infrastructure/change-management/#feature-flags-and-the-change-management-process).\n  Cross link the issue here if it does.\n- [ ] Ensure that you or a representative in development can be available for at least 2 hours after feature flag updates in production.\n  If a different developer will be covering, or an exception is needed, please inform the oncall SRE by using the `@sre-oncall` Slack alias.\n- [ ] Ensure that documentation has been updated ([More info](https://docs.gitlab.com/ee/development/documentation/feature_flags.html#features-that-became-enabled-by-default)).\n- [ ] Announce on [the feature issue](ISSUE LINK) an estimated time this will be enabled on GitLab.com.\n- [ ] If the feature might impact the user experience, notify `#support_gitlab-com` and your team channel ([more guidance when this is necessary in the dev docs](https://docs.gitlab.com/ee/development/feature_flags/controls.html#communicate-the-change)).\n- [ ] If the feature flag in code has [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), enable it on GitLab.com for [testing groups/projects](#testing-groupsprojectsusers).\n    - [ ] `/chatops run feature set --\u003cactor-type\u003e=\u003cactor\u003e \u003cfeature-flag-name\u003e true`\n- [ ] Verify that the feature works as expected. Posting the QA result in this issue is preferable.\n\n### Global rollout on production\n\n- [ ] [Incrementally roll out](https://docs.gitlab.com/ee/development/feature_flags/controls.html#process) the feature.\n  - If the feature flag in code has [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), perform **actor-based** rollout.\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e \u003crollout-percentage\u003e --actors`\n  - If the feature flag in code does **NOT** have [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), perform time-based rollout (**random** rollout).\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e \u003crollout-percentage\u003e`\n  - Enable the feature globally on production environment.\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e true`\n- [ ] Announce on [the feature issue](ISSUE LINK) that the feature has been globally enabled.\n- [ ] Wait for [at least one day for the verification term](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release).\n\n### (Optional) Release the feature with the feature flag\n\nIf you're still unsure whether the feature is [deemed stable](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release)\nbut want to release it in the current milestone, you can change the default state of the feature flag to be enabled.\nTo do so, follow these steps:\n\n- [ ] Create a merge request with the following changes. Ask for review and merge it.\n    - [ ] Set the `default_enabled` attribute in [the feature flag definition](https://docs.gitlab.com/ee/development/feature_flags/#feature-flag-definition-and-validation) to `true`.\n    - [ ] Create [a changelog entry](https://docs.gitlab.com/ee/development/feature_flags/#changelog).\n- [ ] Ensure that the default-enabling MR has been deployed to both production and canary.\n      If the merge request was deployed before [the code cutoff](https://about.gitlab.com/handbook/engineering/releases/#self-managed-releases-1),\n      the feature can be officially announced in a release blog post.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-default-enabling-mr\u003e`\n- [ ] Close [the feature issue](ISSUE LINK) to indicate the feature will be released in the current milestone.\n- [ ] Set the next milestone to this rollout issue for scheduling [the flag removal](#release-the-feature).\n- [ ] (Optional) You can create a separate issue for scheduling the steps below to [Release the feature](#release-the-feature).\n    - [ ] Set the title to \"[Feature flag] Cleanup `\u003cfeature-flag-name\u003e`\".\n    - [ ] Execute the `/copy_metadata \u003cthis-rollout-issue-link\u003e` quick action to copy the labels from this rollout issue.\n    - [ ] Link this rollout issue as a related issue.\n    - [ ] Close this rollout issue.\n\n**WARNING:** This approach has the downside that it makes it difficult for us to\n[clean up](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up) the flag.\nFor example, on-premise users could disable the feature on their GitLab instance. But when you\nremove the flag at some point, they suddenly see the feature as enabled and they can't roll it back\nto the previous behavior. To avoid this potential breaking change, use this approach only for urgent\nmatters.\n\n### Release the feature\n\nAfter the feature has been [deemed stable](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release),\nthe [clean up](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up)\nshould be done as soon as possible to permanently enable the feature and reduce complexity in the\ncodebase.\n\n\u003c!-- The checklist here is to help stakeholders keep track of the feature flag status --\u003e\n- [ ] Create a merge request to remove `\u003cfeature-flag-name\u003e` feature flag. Ask for review and merge it.\n    - [ ] Remove all references to the feature flag from the codebase.\n    - [ ] Remove the YAML definitions for the feature from the repository.\n    - [ ] Create [a changelog entry](https://docs.gitlab.com/ee/development/feature_flags/#changelog).\n- [ ] Ensure that the cleanup MR has been deployed to both production and canary.\n      If the merge request was deployed before [the code cutoff](https://about.gitlab.com/handbook/engineering/releases/#self-managed-releases-1),\n      the feature can be officially announced in a release blog post.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-cleanup-mr\u003e`\n- [ ] Close [the feature issue](ISSUE LINK) to indicate the feature will be released in the current milestone.\n- [ ] Clean up the feature flag from all environments by running these chatops command in `#production` channel:\n    - [ ] `/chatops run feature delete \u003cfeature-flag-name\u003e --dev`\n    - [ ] `/chatops run feature delete \u003cfeature-flag-name\u003e --staging`\n    - [ ] `/chatops run feature delete \u003cfeature-flag-name\u003e`\n- [ ] Close this rollout issue.\n\n## Rollback Steps\n\n- [ ] This feature can be disabled by running the following Chatops command:\n\n```\n/chatops run feature set \u003cfeature-flag-name\u003e false\n```","state":"closed","created_at":"2021-07-27T02:05:23.985Z","updated_at":"2021-08-25T08:19:07.990Z","closed_at":"2021-08-25T08:19:07.960Z","closed_by":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"labels":["Category:DAST","auto updated","backend","devops::secure","feature flag","group::dynamic analysis","section::sec","type::feature","workflow::verification"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"}],"author":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"type":"ISSUE","assignee":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336946","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":47,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 47 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336946","notes":"https://gitlab.com/api/v4/projects/278964/issues/336946/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336946/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336946","relative":"#336946","full":"gitlab-org/gitlab#336946"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90886509,"iid":336945,"project_id":278964,"title":"[Feature flag] Rollout of `dast_site_profile_disable_joins`","description":"\u003c!-- Title suggestion: [Feature flag] Enable description of feature --\u003e\n\n## Summary\n\nThis issue is to rollout [Prepare DAST for CI Decomposition initiative](https://gitlab.com/gitlab-org/gitlab/-/issues/336195) on production,\nthat is currently behind the `dast_site_profile_disable_joins` feature flag.\n\n## Owners\n\n* Team: ~\"group::dynamic analysis\"\n* Most appropriate slack channel to reach out to: `#g_secure-dynamic-analysis`\n* Best individual to reach out to: @philipcunningham\n* PM: @derekferguson\n\n## Stakeholders\n\n\u003c!--\nAre there any other stages or teams involved that need to be kept in the loop?\n\n- Name of a PM\n- The Support Team\n- The Delivery Team\n--\u003e\n\n## The Rollout Plan\n\n- Partial Rollout on GitLab.com with testing groups\n- Rollout on GitLab.com for a certain period (How long)\n- Percentage Rollout on GitLab.com\n- Rollout Feature for everyone as soon as it's ready\n\n\u003c!-- Which dashboards from https://dashboards.gitlab.net are most relevant? Sentry errors reports can also be useful to review --\u003e\n\n## Testing Groups/Projects/Users\n\n\u003c!-- If applicable, any groups/projects that are happy to have this feature turned on early. Some organizations may wish to test big changes they are interested in with a small subset of users ahead of time for example. --\u003e\n\n- `gitlab-org/gitlab` project\n- `gitlab-org`/`gitlab-com` groups\n- ...\n\n\n## Expectations\n\n### What are we expecting to happen?\n\n\u003c!-- Describe the expected outcome when rolling out this feature --\u003e\n\n### What might happen if this goes wrong?\n\n\u003c!-- Should the feature flag be turned off? Any MRs that need to be rolled back? Communication that needs to happen? What are some things you can think of that could go wrong - data loss or broken pages? --\u003e\n\n### What can we monitor to detect problems with this?\n\n\u003c!-- Which dashboards from https://dashboards.gitlab.net are most relevant? --\u003e\n\n## Rollout Steps\n\n### Rollout on non-production environments\n\n- [ ] Ensure that the feature MRs have been deployed to non-production environments.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-your-feature\u003e`\n- [ ] Enable the feature globally on non-production environments.\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e true --dev`\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e true --staging`\n- [ ] Verify that the feature works as expected. Posting the QA result in this issue is preferable.\n\n### Preparation before production rollout\n\n- [ ] Ensure that the feature MRs have been deployed to both production and canary.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-your-feature\u003e`\n- [ ] Check if the feature flag change needs to be accompanied with a\n  [change management issue](https://about.gitlab.com/handbook/engineering/infrastructure/change-management/#feature-flags-and-the-change-management-process).\n  Cross link the issue here if it does.\n- [ ] Ensure that you or a representative in development can be available for at least 2 hours after feature flag updates in production.\n  If a different developer will be covering, or an exception is needed, please inform the oncall SRE by using the `@sre-oncall` Slack alias.\n- [ ] Ensure that documentation has been updated ([More info](https://docs.gitlab.com/ee/development/documentation/feature_flags.html#features-that-became-enabled-by-default)).\n- [ ] Announce on [the feature issue](ISSUE LINK) an estimated time this will be enabled on GitLab.com.\n- [ ] If the feature might impact the user experience, notify `#support_gitlab-com` and your team channel ([more guidance when this is necessary in the dev docs](https://docs.gitlab.com/ee/development/feature_flags/controls.html#communicate-the-change)).\n- [ ] If the feature flag in code has [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), enable it on GitLab.com for [testing groups/projects](#testing-groupsprojectsusers).\n    - [ ] `/chatops run feature set --\u003cactor-type\u003e=\u003cactor\u003e \u003cfeature-flag-name\u003e true`\n- [ ] Verify that the feature works as expected. Posting the QA result in this issue is preferable.\n\n### Global rollout on production\n\n- [ ] [Incrementally roll out](https://docs.gitlab.com/ee/development/feature_flags/controls.html#process) the feature.\n  - If the feature flag in code has [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), perform **actor-based** rollout.\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e \u003crollout-percentage\u003e --actors`\n  - If the feature flag in code does **NOT** have [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), perform time-based rollout (**random** rollout).\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e \u003crollout-percentage\u003e`\n  - Enable the feature globally on production environment.\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e true`\n- [ ] Announce on [the feature issue](ISSUE LINK) that the feature has been globally enabled.\n- [ ] Wait for [at least one day for the verification term](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release).\n\n### (Optional) Release the feature with the feature flag\n\nIf you're still unsure whether the feature is [deemed stable](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release)\nbut want to release it in the current milestone, you can change the default state of the feature flag to be enabled.\nTo do so, follow these steps:\n\n- [ ] Create a merge request with the following changes. Ask for review and merge it.\n    - [ ] Set the `default_enabled` attribute in [the feature flag definition](https://docs.gitlab.com/ee/development/feature_flags/#feature-flag-definition-and-validation) to `true`.\n    - [ ] Create [a changelog entry](https://docs.gitlab.com/ee/development/feature_flags/#changelog).\n- [ ] Ensure that the default-enabling MR has been deployed to both production and canary.\n      If the merge request was deployed before [the code cutoff](https://about.gitlab.com/handbook/engineering/releases/#self-managed-releases-1),\n      the feature can be officially announced in a release blog post.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-default-enabling-mr\u003e`\n- [ ] Close [the feature issue](ISSUE LINK) to indicate the feature will be released in the current milestone.\n- [ ] Set the next milestone to this rollout issue for scheduling [the flag removal](#release-the-feature).\n- [ ] (Optional) You can create a separate issue for scheduling the steps below to [Release the feature](#release-the-feature).\n    - [ ] Set the title to \"[Feature flag] Cleanup `\u003cfeature-flag-name\u003e`\".\n    - [ ] Execute the `/copy_metadata \u003cthis-rollout-issue-link\u003e` quick action to copy the labels from this rollout issue.\n    - [ ] Link this rollout issue as a related issue.\n    - [ ] Close this rollout issue.\n\n**WARNING:** This approach has the downside that it makes it difficult for us to\n[clean up](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up) the flag.\nFor example, on-premise users could disable the feature on their GitLab instance. But when you\nremove the flag at some point, they suddenly see the feature as enabled and they can't roll it back\nto the previous behavior. To avoid this potential breaking change, use this approach only for urgent\nmatters.\n\n### Release the feature\n\nAfter the feature has been [deemed stable](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release),\nthe [clean up](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up)\nshould be done as soon as possible to permanently enable the feature and reduce complexity in the\ncodebase.\n\n\u003c!-- The checklist here is to help stakeholders keep track of the feature flag status --\u003e\n- [ ] Create a merge request to remove `\u003cfeature-flag-name\u003e` feature flag. Ask for review and merge it.\n    - [ ] Remove all references to the feature flag from the codebase.\n    - [ ] Remove the YAML definitions for the feature from the repository.\n    - [ ] Create [a changelog entry](https://docs.gitlab.com/ee/development/feature_flags/#changelog).\n- [ ] Ensure that the cleanup MR has been deployed to both production and canary.\n      If the merge request was deployed before [the code cutoff](https://about.gitlab.com/handbook/engineering/releases/#self-managed-releases-1),\n      the feature can be officially announced in a release blog post.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-cleanup-mr\u003e`\n- [ ] Close [the feature issue](ISSUE LINK) to indicate the feature will be released in the current milestone.\n- [ ] Clean up the feature flag from all environments by running these chatops command in `#production` channel:\n    - [ ] `/chatops run feature delete \u003cfeature-flag-name\u003e --dev`\n    - [ ] `/chatops run feature delete \u003cfeature-flag-name\u003e --staging`\n    - [ ] `/chatops run feature delete \u003cfeature-flag-name\u003e`\n- [ ] Close this rollout issue.\n\n## Rollback Steps\n\n- [ ] This feature can be disabled by running the following Chatops command:\n\n```\n/chatops run feature set \u003cfeature-flag-name\u003e false\n```","state":"closed","created_at":"2021-07-27T02:03:26.747Z","updated_at":"2021-08-25T08:19:00.992Z","closed_at":"2021-08-25T08:19:00.977Z","closed_by":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"labels":["Category:DAST","auto updated","backend","devops::secure","feature flag","group::dynamic analysis","section::sec","type::feature","workflow::verification"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"}],"author":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"type":"ISSUE","assignee":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336945","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":47,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 47 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336945","notes":"https://gitlab.com/api/v4/projects/278964/issues/336945/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336945/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336945","relative":"#336945","full":"gitlab-org/gitlab#336945"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90886436,"iid":336944,"project_id":278964,"title":"[Feature flag] Rollout of `dast_profile_disable_joins`","description":"\u003c!-- Title suggestion: [Feature flag] Enable description of feature --\u003e\n\n## Summary\n\nThis issue is to rollout [Prepare DAST for CI Decomposition initiative](https://gitlab.com/gitlab-org/gitlab/-/issues/336195) on production,\nthat is currently behind the `dast_profile_disable_joins` feature flag.\n\n\u003c!-- Short description of what the feature is about and link to relevant other issues. --\u003e\n\n## Owners\n\n- Team: ~\"group::dynamic analysis\" \n- Most appropriate slack channel to reach out to: `#g_secure-dynamic-analysis`\n- Best individual to reach out to: @philipcunningham \n- PM: @derekferguson \n\n## Stakeholders\n\n\u003c!--\nAre there any other stages or teams involved that need to be kept in the loop?\n\n- Name of a PM\n- The Support Team\n- The Delivery Team\n--\u003e\n\n## The Rollout Plan\n\n- Partial Rollout on GitLab.com with testing groups\n- Rollout on GitLab.com for a certain period (How long)\n- Percentage Rollout on GitLab.com\n- Rollout Feature for everyone as soon as it's ready\n\n\u003c!-- Which dashboards from https://dashboards.gitlab.net are most relevant? Sentry errors reports can also be useful to review --\u003e\n\n## Testing Groups/Projects/Users\n\n\u003c!-- If applicable, any groups/projects that are happy to have this feature turned on early. Some organizations may wish to test big changes they are interested in with a small subset of users ahead of time for example. --\u003e\n\n- `gitlab-org/gitlab` project\n- `gitlab-org`/`gitlab-com` groups\n- ...\n\n\n## Expectations\n\n### What are we expecting to happen?\n\n\u003c!-- Describe the expected outcome when rolling out this feature --\u003e\n\n### What might happen if this goes wrong?\n\n\u003c!-- Should the feature flag be turned off? Any MRs that need to be rolled back? Communication that needs to happen? What are some things you can think of that could go wrong - data loss or broken pages? --\u003e\n\n### What can we monitor to detect problems with this?\n\n\u003c!-- Which dashboards from https://dashboards.gitlab.net are most relevant? --\u003e\n\n## Rollout Steps\n\n### Rollout on non-production environments\n\n- [ ] Ensure that the feature MRs have been deployed to non-production environments.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-your-feature\u003e`\n- [ ] Enable the feature globally on non-production environments.\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e true --dev`\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e true --staging`\n- [ ] Verify that the feature works as expected. Posting the QA result in this issue is preferable.\n\n### Preparation before production rollout\n\n- [ ] Ensure that the feature MRs have been deployed to both production and canary.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-your-feature\u003e`\n- [ ] Check if the feature flag change needs to be accompanied with a\n  [change management issue](https://about.gitlab.com/handbook/engineering/infrastructure/change-management/#feature-flags-and-the-change-management-process).\n  Cross link the issue here if it does.\n- [ ] Ensure that you or a representative in development can be available for at least 2 hours after feature flag updates in production.\n  If a different developer will be covering, or an exception is needed, please inform the oncall SRE by using the `@sre-oncall` Slack alias.\n- [ ] Ensure that documentation has been updated ([More info](https://docs.gitlab.com/ee/development/documentation/feature_flags.html#features-that-became-enabled-by-default)).\n- [ ] Announce on [the feature issue](ISSUE LINK) an estimated time this will be enabled on GitLab.com.\n- [ ] If the feature might impact the user experience, notify `#support_gitlab-com` and your team channel ([more guidance when this is necessary in the dev docs](https://docs.gitlab.com/ee/development/feature_flags/controls.html#communicate-the-change)).\n- [ ] If the feature flag in code has [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), enable it on GitLab.com for [testing groups/projects](#testing-groupsprojectsusers).\n    - [ ] `/chatops run feature set --\u003cactor-type\u003e=\u003cactor\u003e \u003cfeature-flag-name\u003e true`\n- [ ] Verify that the feature works as expected. Posting the QA result in this issue is preferable.\n\n### Global rollout on production\n\n- [ ] [Incrementally roll out](https://docs.gitlab.com/ee/development/feature_flags/controls.html#process) the feature.\n  - If the feature flag in code has [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), perform **actor-based** rollout.\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e \u003crollout-percentage\u003e --actors`\n  - If the feature flag in code does **NOT** have [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), perform time-based rollout (**random** rollout).\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e \u003crollout-percentage\u003e`\n  - Enable the feature globally on production environment.\n    - [ ] `/chatops run feature set \u003cfeature-flag-name\u003e true`\n- [ ] Announce on [the feature issue](ISSUE LINK) that the feature has been globally enabled.\n- [ ] Wait for [at least one day for the verification term](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release).\n\n### (Optional) Release the feature with the feature flag\n\nIf you're still unsure whether the feature is [deemed stable](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release)\nbut want to release it in the current milestone, you can change the default state of the feature flag to be enabled.\nTo do so, follow these steps:\n\n- [ ] Create a merge request with the following changes. Ask for review and merge it.\n    - [ ] Set the `default_enabled` attribute in [the feature flag definition](https://docs.gitlab.com/ee/development/feature_flags/#feature-flag-definition-and-validation) to `true`.\n    - [ ] Create [a changelog entry](https://docs.gitlab.com/ee/development/feature_flags/#changelog).\n- [ ] Ensure that the default-enabling MR has been deployed to both production and canary.\n      If the merge request was deployed before [the code cutoff](https://about.gitlab.com/handbook/engineering/releases/#self-managed-releases-1),\n      the feature can be officially announced in a release blog post.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-default-enabling-mr\u003e`\n- [ ] Close [the feature issue](ISSUE LINK) to indicate the feature will be released in the current milestone.\n- [ ] Set the next milestone to this rollout issue for scheduling [the flag removal](#release-the-feature).\n- [ ] (Optional) You can create a separate issue for scheduling the steps below to [Release the feature](#release-the-feature).\n    - [ ] Set the title to \"[Feature flag] Cleanup `\u003cfeature-flag-name\u003e`\".\n    - [ ] Execute the `/copy_metadata \u003cthis-rollout-issue-link\u003e` quick action to copy the labels from this rollout issue.\n    - [ ] Link this rollout issue as a related issue.\n    - [ ] Close this rollout issue.\n\n**WARNING:** This approach has the downside that it makes it difficult for us to\n[clean up](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up) the flag.\nFor example, on-premise users could disable the feature on their GitLab instance. But when you\nremove the flag at some point, they suddenly see the feature as enabled and they can't roll it back\nto the previous behavior. To avoid this potential breaking change, use this approach only for urgent\nmatters.\n\n### Release the feature\n\nAfter the feature has been [deemed stable](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release),\nthe [clean up](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up)\nshould be done as soon as possible to permanently enable the feature and reduce complexity in the\ncodebase.\n\n\u003c!-- The checklist here is to help stakeholders keep track of the feature flag status --\u003e\n- [ ] Create a merge request to remove `\u003cfeature-flag-name\u003e` feature flag. Ask for review and merge it.\n    - [ ] Remove all references to the feature flag from the codebase.\n    - [ ] Remove the YAML definitions for the feature from the repository.\n    - [ ] Create [a changelog entry](https://docs.gitlab.com/ee/development/feature_flags/#changelog).\n- [ ] Ensure that the cleanup MR has been deployed to both production and canary.\n      If the merge request was deployed before [the code cutoff](https://about.gitlab.com/handbook/engineering/releases/#self-managed-releases-1),\n      the feature can be officially announced in a release blog post.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-cleanup-mr\u003e`\n- [ ] Close [the feature issue](ISSUE LINK) to indicate the feature will be released in the current milestone.\n- [ ] Clean up the feature flag from all environments by running these chatops command in `#production` channel:\n    - [ ] `/chatops run feature delete \u003cfeature-flag-name\u003e --dev`\n    - [ ] `/chatops run feature delete \u003cfeature-flag-name\u003e --staging`\n    - [ ] `/chatops run feature delete \u003cfeature-flag-name\u003e`\n- [ ] Close this rollout issue.\n\n## Rollback Steps\n\n- [ ] This feature can be disabled by running the following Chatops command:\n\n```\n/chatops run feature set \u003cfeature-flag-name\u003e false\n```","state":"closed","created_at":"2021-07-27T02:01:39.318Z","updated_at":"2021-08-25T08:18:50.276Z","closed_at":"2021-08-25T08:18:50.259Z","closed_by":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"labels":["Category:DAST","auto updated","backend","devops::secure","feature flag","group::dynamic analysis","section::sec","type::feature","workflow::verification"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"}],"author":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"type":"ISSUE","assignee":{"id":5749348,"username":"philipcunningham","name":"Philip Cunningham","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5749348/avatar.png","web_url":"https://gitlab.com/philipcunningham"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336944","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":47,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 47 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336944","notes":"https://gitlab.com/api/v4/projects/278964/issues/336944/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336944/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336944","relative":"#336944","full":"gitlab-org/gitlab#336944"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90875333,"iid":336940,"project_id":278964,"title":"Read through PJs Component Lifecycle","description":"Hi, y'all (@gitlab-com/gitlab-ux/secure-protect-ux @gitlab-com/gitlab-ux/configure-monitor-ux) can you please read through the [PJs Component Lifecycle](https://design.gitlab.com/get-started/lifecycle/) page and then check yourself off when you're done?\n\n* [x] Amelia\n* [x] Andy\n* [x] Annabel\n* [x] Becka\n* [x] Camellia\n* [x] Michael","state":"closed","created_at":"2021-07-26T23:36:15.163Z","updated_at":"2021-08-13T15:09:43.267Z","closed_at":"2021-08-13T14:46:52.021Z","closed_by":{"id":5291762,"username":"jmandell","name":"Justin Mandell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/aa77747277d0bb7c31300ca6b0cdde56?s=80\u0026d=identicon","web_url":"https://gitlab.com/jmandell"},"labels":["UX","auto updated"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":5291762,"username":"jmandell","name":"Justin Mandell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/aa77747277d0bb7c31300ca6b0cdde56?s=80\u0026d=identicon","web_url":"https://gitlab.com/jmandell"}],"author":{"id":5291762,"username":"jmandell","name":"Justin Mandell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/aa77747277d0bb7c31300ca6b0cdde56?s=80\u0026d=identicon","web_url":"https://gitlab.com/jmandell"},"type":"ISSUE","assignee":{"id":5291762,"username":"jmandell","name":"Justin Mandell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/aa77747277d0bb7c31300ca6b0cdde56?s=80\u0026d=identicon","web_url":"https://gitlab.com/jmandell"},"user_notes_count":7,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336940","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":6,"completed_count":6},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"6 of 6 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336940","notes":"https://gitlab.com/api/v4/projects/278964/issues/336940/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336940/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336940","relative":"#336940","full":"gitlab-org/gitlab#336940"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90874085,"iid":336934,"project_id":278964,"title":"Improved UX for bulk deleting container image tags","description":"### Problem to solve\n\nIt can be difficult to delete image tags from the container registry UI. Following https://gitlab.com/gitlab-org/gitlab/-/issues/327693#note_632953808, this issue proposes improving the UX for bulk deleting many tags.\n\n### Proposal\n\nSee below designs.\nCheckbox in header selects all below. \nSelecting any checkbox causes secondary danger button to change from disable to enabled.\nPressing delete button triggers a confirmation modal. \n\nIf paginated and user hits select all checkbox, we could either select only the items on current page as an MVC. Or if it's easy, perhaps we could so something like [concept in figma](https://www.figma.com/proto/KyeuQrnvo5fmhza64zcAWG/Bulk-deletion-container-and-package-registry?page-id=15%3A6046\u0026node-id=18%3A46973\u0026viewport=341%2C48%2C0.62\u0026scaling=min-zoom)\n\n### Standardizing this behaviour\n\nThere are a number of places in the registries UI that could benefit from a bulk delete UI so it would be good to reuse this pattern. I've attached some designs to this issue for the package registry.\n\nOutside of package, this pattern should be added into into Pajamas. [issue here](https://gitlab.com/gitlab-org/gitlab-services/design.gitlab.com/-/issues/1148)\n\n\n\n## Testing and Availability\n\nWe currently have an existing end-to-end test that deletes [a specific tag](https://gitlab.com/gitlab-org/gitlab/-/blob/master/qa/qa/specs/features/browser_ui/5_package/container_registry_omnibus_spec.rb#L82). The implementation of this functionality should not affect the existing test flow. We verify it by running the job `package-and-qa` on the MRs.","state":"closed","created_at":"2021-07-26T22:44:12.069Z","updated_at":"2022-10-03T03:23:55.832Z","closed_at":"2021-12-08T10:39:27.585Z","closed_by":{"id":4584738,"username":"nmezzopera","name":"Nicol√≤ Maria Mezzopera","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4584738/avatar.png","web_url":"https://gitlab.com/nmezzopera"},"labels":["Category:Container Registry","Deliverable","Package:P1","UX","auto updated","devops::package","frontend","frontend-weight::2","group::package registry","quad-planning::complete-action","reliability","section::ops","type::feature","workflow::in review"],"milestone":{"id":2114820,"iid":67,"group_id":9970,"title":"14.6","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T05:00:52.094Z","updated_at":"2022-04-21T07:26:38.271Z","due_date":"2021-12-17","start_date":"2021-11-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/67"},"assignees":[{"id":4584738,"username":"nmezzopera","name":"Nicol√≤ Maria Mezzopera","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4584738/avatar.png","web_url":"https://gitlab.com/nmezzopera"}],"author":{"id":3799560,"username":"trizzi","name":"Tim Rizzi","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3799560/avatar.png","web_url":"https://gitlab.com/trizzi"},"type":"ISSUE","assignee":{"id":4584738,"username":"nmezzopera","name":"Nicol√≤ Maria Mezzopera","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4584738/avatar.png","web_url":"https://gitlab.com/nmezzopera"},"user_notes_count":17,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336934","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336934","notes":"https://gitlab.com/api/v4/projects/278964/issues/336934/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336934/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336934","relative":"#336934","full":"gitlab-org/gitlab#336934"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90874050,"iid":336933,"project_id":278964,"title":"Improve the process of deleting image tags","description":"### Problem to solve\n\nIt can be difficult to delete image tags from the container registry UI. Following https://gitlab.com/gitlab-org/gitlab/-/issues/327693#note_632953808, this issue proposes improving the UX for deleting individual tags. \n\n\n### Proposal\n\n* User should be able to delete tags individually in the list/table view.\n* The button with a trash bin icon should be replaced by a `more actions` dropdown button.\n  * ~\"component:button\" ellipsis https://design.gitlab.com/components/button/#ellipsis\n  * Clicking the `more action` button displays the *Delete tag* option.\n    * Clicking *Delete tag* triggers the existing flow for deleting an individual tag.\n  * Clicking anywhere outside the dropdown closes it.","state":"closed","created_at":"2021-07-26T22:42:39.586Z","updated_at":"2021-10-18T07:02:09.173Z","closed_at":"2021-10-12T15:42:33.336Z","closed_by":{"id":4584738,"username":"nmezzopera","name":"Nicol√≤ Maria Mezzopera","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4584738/avatar.png","web_url":"https://gitlab.com/nmezzopera"},"labels":["Category:Container Registry","Deliverable","GitLab Free","Package:P1","auto updated","devops::package","frontend","group::package registry","reliability","section::ops","type::feature","workflow::verification"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[{"id":4584738,"username":"nmezzopera","name":"Nicol√≤ Maria Mezzopera","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4584738/avatar.png","web_url":"https://gitlab.com/nmezzopera"}],"author":{"id":3799560,"username":"trizzi","name":"Tim Rizzi","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3799560/avatar.png","web_url":"https://gitlab.com/trizzi"},"type":"ISSUE","assignee":{"id":4584738,"username":"nmezzopera","name":"Nicol√≤ Maria Mezzopera","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4584738/avatar.png","web_url":"https://gitlab.com/nmezzopera"},"user_notes_count":7,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336933","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336933","notes":"https://gitlab.com/api/v4/projects/278964/issues/336933/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336933/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336933","relative":"#336933","full":"gitlab-org/gitlab#336933"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90869774,"iid":336926,"project_id":278964,"title":"Archive old deployments (Delete old deployment refs)","description":"## Release notes\n\nWe have added automated archiving of old deployments to maintain high performance for git commands and to clean up project records. GitLab will keep the recent 50,000 deployments per project and archive the others. Specifically, the associated git-ref will be deleted.\n\n\n## Problem\n\nWhen a deployment job runs (i.e. job with `environment` keyword), [a corresponding deployment entry](https://docs.gitlab.com/ee/ci/environments/#view-environments-and-deployments) is created, and it subsequently creates [a deployment ref](https://docs.gitlab.com/ee/ci/environments/#check-out-deployments-locally) in the format of `refs/remotes/origin/environments/*`. Since these git-refs are [advertised for git-checkout](https://gitlab.com/gitlab-org/gitlab/-/issues/300277), this often causes [a performance issue](https://gitlab.com/gitlab-com/gl-infra/production/-/issues/5068#note_629095969), especially slowing down git commands on gitlab.com. This happens not only on [www-gitlab-com](https://gitlab.com/gitlab-com/gl-infra/production/-/issues/5068#note_629095969), but also [a customer project](https://gitlab.com/gitlab-org/gitlab/-/issues/19724#note_371247415).\n\nWhile we're preparing [an automated mechanizm to clean up non-critical environments](https://gitlab.com/groups/gitlab-org/-/epics/5920#note_633701136), this problem still stands for critical environments as well. For example, https://gitlab.com/groups/gitlab-org/-/epics/5920#note_633731178 states that 446,000+ of deployment refs exist on `production` environment. We need a further cleanup-automation for old deployments on critical environments without affecting the traceability of the deployment history. \n\n## Proposal\n\nWe keep the recent 50,000 deployments per project and archive the rest. Specifically,\n\n- We add `archived` boolean flag to `deployments` table. Default is `false`.\n- We set `archived=true` to deployment records that created **before recent 50,000 deployments**.\n- An archived deployment deletes a corresponding git-ref e.g. `refs/remotes/origin/environments/*`.\n\nNOTE:\n\n- Users still can fetch the deployed source code with `git checkout \u003ccommit-sha\u003e` even after archive.\n- GitLab can restore the deleted deployment refs by running [`deployment.created_ref`](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/models/deployment.rb#L210). If there is an unexpected negative consequence on this change, we can restore the refs by running `Deployment.archived.each(\u0026:create_ref)`.\n- Consider this is a similar feature with [Archive Jobs](https://docs.gitlab.com/ee/user/admin_area/settings/continuous_integration.html#archive-jobs).\n\n## The difference from [Delete stopped environments proposal](https://gitlab.com/gitlab-org/gitlab/-/issues/233882)\n\n| header | This Issue | [Delete stopped environments proposal](https://gitlab.com/gitlab-org/gitlab/-/issues/233882) |\n|--------|---------|---------|\n| Deployment to act on | All deployments older than recent 50,000 deployments | Deployments in [**Auto-Stopped**](https://docs.gitlab.com/ee/ci/environments/#stop-an-environment-after-a-certain-time-period) environments older than 1 month |\n| Environment to act on | Long-live environments (e.g. production) and Short-live Environments (e.g. Review App) | Short-live Environments (e.g. Review App) |\n| What to remove | Git Ref | Git Ref and Database Record |\n| Recoverable | Yes (See note above) | No |\n\n## Questions\n\n**Do we know how many deployment refs per project that we can start noticing degraded performance in git operations?**\n\nIt's up to how the GitLab instance is scalable (e.g. HA is enabled or not). Here are some data points:\n\n- [A project on gitlab.com](https://gitlab.com/gitlab-com/gl-infra/production/-/issues/5068#note_629095969) encountered this issue with 400k deployments.\n- [A project on customer's on-premises instance](https://gitlab.com/gitlab-org/gitlab/-/issues/19724#note_371247415) encountered this issue with 80k deployments.\n\n**What happens if a deployment is marked archived?**\n\nWhen a deployment is archived, the corresponding git-ref is deleted, other than that nothing is changed.\n\n**Does removing the ref cause any unexpected user interface issues?**\n\nOne of the potential use case of deployment refs is deploying from an external server. For example,\n\n- A user runs a pipeline and create a deployment record.\n- Triggers a deployment webhook to notify an external system.\n- The external system fetches [deployment information via API](https://docs.gitlab.com/ee/api/deployments.html) and checking out a specific deployment ref.\n\nSo as long as the recent deployment refs stay intact, users won't encounter a problem.\n\nAlso, if the above assumption is wrong, we can [restore the archived refs](#proposal).\n\n## Further iteration\n\n- If an archived deployment should be read-only records so that we can prevent users from accidentally pushing [the retry/rollback buttons](https://docs.gitlab.com/ee/ci/environments/#environment-rollback).","state":"closed","created_at":"2021-07-26T20:31:07.913Z","updated_at":"2022-11-11T02:46:19.443Z","closed_at":"2021-12-13T05:36:53.420Z","closed_by":{"id":758045,"username":"shinya.maeda","name":"Shinya Maeda","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/758045/avatar.png","web_url":"https://gitlab.com/shinya.maeda"},"labels":["Category:Release Orchestration","GitLab Free","Release::P1","auto updated","backend","bug::performance","devops::release","environments","group::release","release post item::in review","section::ops","workflow::verification"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/66"},"assignees":[{"id":758045,"username":"shinya.maeda","name":"Shinya Maeda","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/758045/avatar.png","web_url":"https://gitlab.com/shinya.maeda"}],"author":{"id":5213298,"username":"kbychu","name":"Kevin Chu","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0b6f70425a17d5ab47ec6093f8df9aa6?s=80\u0026d=identicon","web_url":"https://gitlab.com/kbychu"},"type":"ISSUE","assignee":{"id":758045,"username":"shinya.maeda","name":"Shinya Maeda","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/758045/avatar.png","web_url":"https://gitlab.com/shinya.maeda"},"user_notes_count":16,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336926","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336926","notes":"https://gitlab.com/api/v4/projects/278964/issues/336926/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336926/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336926","relative":"#336926","full":"gitlab-org/gitlab#336926"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":5920,"epic":{"id":262921,"iid":5920,"title":"Environments Cleanup","url":"/groups/gitlab-org/-/epics/5920","group_id":9970,"human_readable_end_date":"Sep 30, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90864626,"iid":336916,"project_id":278964,"title":"Simulate fatal error during online GC run (preprod)","description":"## Context\n\nThis is part of the work to upgrade and migrate the GitLab.com container registry to a new version backed by a metadata database and online garbage collection (https://gitlab.com/groups/gitlab-org/-/epics/5523). This will be achieved following the gradual migration plan detailed in https://gitlab.com/gitlab-org/container-registry/-/issues/374.\n\nBefore moving to production we will test a series of failure scenarios that were previously identified and documented in https://gitlab.com/gitlab-com/runbooks/-/merge_requests/3628.\n\n## Scenario\n\nFatal error during online GC run.\n\nThe easiest way to simulate this would to provoke a failure when online GC attempts to delete a dangling manifest or blob record from the database. Because the GC is so fast, attempting to e.g. take the DB server down during a run would not be feasible. Therefore, the easiest way (without introducing broken code on purpose) would likely be to temporarily remove the `DELETE` grant for the registry DB user on specific tables. This would cause the deletions to fail, which is considered a fatal error.\n\n### Expectations\n\n#### Impact\n\n- Task fails to be processed;\n- GC queues size may increase if it's not a transient error.\n\n#### Behavior\n\n- GC attempts to postpone the review of the task to a future date. If failed, the original review date remains unchanged, but this has little to no impact (ideally we should postpone the next review in case of error);\n- The GC workers should backoff exponentially for every failed run, up to the maximum configured duration (24h by default).\n\n#### Observability\n\n- Errors show up in Sentry and logs;\n- Grafana dashboards reflect the magnitude of the impact on the [Garbage Collection Detail](https://dashboards.gitlab.net/d/registry-gc/registry-garbage-collection-detail?orgId=1) dashboard.\n\n#### Recovery\n\nGC workers resume normal operation. The next run will happen automatically after the last exponential backoff.\n\n## Target Environment\n\nThis can be tested in preprod.","state":"closed","created_at":"2021-07-26T17:51:51.606Z","updated_at":"2021-10-28T13:54:48.962Z","closed_at":"2021-09-01T08:51:41.327Z","closed_by":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"labels":["Category:Container Registry","Container Registry Migration","Deliverable","[deprecated] Accepting merge requests","auto updated","devops::package","group::package registry","section::ops","type::maintenance"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[],"author":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"type":"ISSUE","assignee":null,"user_notes_count":9,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336916","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336916","notes":"https://gitlab.com/api/v4/projects/278964/issues/336916/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336916/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336916","relative":"#336916","full":"gitlab-org/gitlab#336916"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6456,"epic":{"id":315000,"iid":6456,"title":"Simulate failure scenarios in preprod (Phase 1)","url":"/groups/gitlab-org/-/epics/6456","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90864596,"iid":336915,"project_id":278964,"title":"Simulate failed database schema migration (preprod)","description":"## Context\n\nThis is part of the work to upgrade and migrate the GitLab.com container registry to a new version backed by a metadata database and online garbage collection (https://gitlab.com/groups/gitlab-org/-/epics/5523). This will be achieved following the gradual migration plan detailed in https://gitlab.com/gitlab-org/container-registry/-/issues/374.\n\nBefore moving to production we will test a series of failure scenarios that were previously identified and documented in https://gitlab.com/gitlab-com/runbooks/-/merge_requests/3628.\n\n## Scenario\n\nSimulate a database schema migration failure. This applies to both invalid migrations (should be impossible, as we test them before releasing, unless another actor has changed something on the database schema) and timeouts.\n\n### Expectations\n\n#### Impact\n\n* Failed migration job (Charts) that precedes the application upgrade;\n* Blocked deployment due to the above.\n\n#### Behavior\n\nNormal behavior. Each migration is performed within a transaction and automatically rolled back in case of error. Due to the blocked deployment, the application version won't be updated.\n\n#### Observability\n\nThe registry CLI will output the corresponding error. For example:\n\n```shell\nERRO[0000] Exec                                          args=\"[]\" database=registry err=\"ERROR: column \\\"stop_level_namespace_id\\\" does not exist (SQLSTATE 42703)\" pid=77733 sql=\"CREATE INDEX IF NOT EXISTS index_repositories_on_top_level_namespace_id_and_parent_id ON repositories USING btree (stop_level_namespace_id, parent_id)\"\nfailed to run database migrations: ERROR: column \"stop_level_namespace_id\" does not exist (SQLSTATE 42703) handling 20210503145616_create_repositories_table‚èé  \n```\n\n#### Recovery\n\nIn case of a timeout, retrying the corresponding migration should succeed.\n\n## Target Environment\n\nAlthough preprod does not have a custom PostgreSQL cluster as we will have in production, that should not stop us from testing this there, as the underlying root cause should be generic enough to apply to a CloudSQL instance as well.","state":"closed","created_at":"2021-07-26T17:51:22.697Z","updated_at":"2021-10-28T13:54:49.627Z","closed_at":"2021-09-07T15:29:42.405Z","closed_by":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"labels":["Category:Container Registry","Container Registry Migration","Container Registry Migration::Phase 1","Deliverable","Package:P1","[deprecated] Accepting merge requests","auto updated","backend","devops::package","golang","group::package registry","section::ops","type::maintenance","workflow::ready for development"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[],"author":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"type":"ISSUE","assignee":null,"user_notes_count":9,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336915","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336915","notes":"https://gitlab.com/api/v4/projects/278964/issues/336915/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336915/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336915","relative":"#336915","full":"gitlab-org/gitlab#336915"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6456,"epic":{"id":315000,"iid":6456,"title":"Simulate failure scenarios in preprod (Phase 1)","url":"/groups/gitlab-org/-/epics/6456","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90864585,"iid":336914,"project_id":278964,"title":"Simulate database connection pool saturation (staging)","description":"## Context\n\nThis is part of the work to upgrade and migrate the GitLab.com container registry to a new version backed by a metadata database and online garbage collection (https://gitlab.com/groups/gitlab-org/-/epics/5523). This will be achieved following the gradual migration plan detailed in https://gitlab.com/gitlab-org/container-registry/-/issues/374.\n\nBefore moving to production we will test a series of failure scenarios that were previously identified and documented in https://gitlab.com/gitlab-com/runbooks/-/merge_requests/3628.\n\n## Scenario\n\nConnection pool saturation.\n\n### Expectations\n\n#### Impact\n\n* API unable to serve requests;\n* GC unable to process tasks.\n\n#### Behavior\n\n* API and/or GC fail to pull a connection from a pool at any given time;\n* API requests will timeout with a `500 Internal Server Error` response.\n\n#### Observability\n\n* Errors show up in Sentry and logs;\n* Grafana dashboards reflect the magnitude of the impact on the API and pool saturation metrics.\n\n#### Recovery\n\nAPI and GC resume operations normally once the connection pool is no longer saturated.\n\n## Target Environment\n\nThis should be tested in staging as that is the only environment with a custom PostgreSQL cluster like we will find in production.","state":"closed","created_at":"2021-07-26T17:50:53.791Z","updated_at":"2021-10-28T13:54:50.098Z","closed_at":"2021-09-20T09:34:34.824Z","closed_by":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"labels":["Category:Container Registry","Container Registry Migration","Container Registry Migration::Phase 1","Deliverable","GitLab Free","Package:P1","[deprecated] Accepting merge requests","auto updated","devops::package","group::package registry","section::ops","type::maintenance","workflow::ready for development"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[],"author":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"type":"ISSUE","assignee":null,"user_notes_count":20,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336914","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336914","notes":"https://gitlab.com/api/v4/projects/278964/issues/336914/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336914/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336914","relative":"#336914","full":"gitlab-org/gitlab#336914"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6685,"epic":{"id":342618,"iid":6685,"title":"Simulate failure scenarios in staging (Phase 1)","url":"/groups/gitlab-org/-/epics/6685","group_id":9970,"human_readable_end_date":"Oct 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90864575,"iid":336913,"project_id":278964,"title":"Simulate primary database server failure (staging)","description":"## Context\n\nThis is part of the work to upgrade and migrate the GitLab.com container registry to a new version backed by a metadata database and online garbage collection (https://gitlab.com/groups/gitlab-org/-/epics/5523). This will be achieved following the gradual migration plan detailed in https://gitlab.com/gitlab-org/container-registry/-/issues/374.\n\nBefore moving to production we will test a series of failure scenarios that were previously identified and documented in https://gitlab.com/gitlab-com/runbooks/-/merge_requests/3628.\n\n## Scenario\n\nPrimary database server failure (e.g. goes offline or becomes unresponsive).\n\n### Expectations\n\n#### Impact\n\n* API unable to serve requests.\n* GC unable to process tasks.\n\n#### Behavior\n\n- API and GC handle refused or timed out database connections gracefully;\n- Connections are retried once (at the database driver level). In case of failure, connections are discarded and requests halted with a `503 Service Unavailable` response;\n- A new request leads to a new connection attempt.\n\n#### Observability\n\n- Errors show up in Sentry and logs;\n- Grafana dashboards reflect the impact scale.\n\n#### Recovery\n\nAPI and GC resume operations normally, without external intervention, once the server becomes operational.\n\n## Target Environment\n\nThis should be tested in staging as that is the only environment with a custom PostgreSQL cluster like we will find in production.","state":"closed","created_at":"2021-07-26T17:50:29.071Z","updated_at":"2021-10-28T13:54:51.240Z","closed_at":"2021-09-16T17:17:29.127Z","closed_by":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"labels":["Category:Container Registry","Container Registry Migration","Container Registry Migration::Phase 1","Deliverable","GitLab Free","Package:P1","[deprecated] Accepting merge requests","auto updated","devops::package","group::package registry","section::ops","type::maintenance"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[],"author":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"type":"ISSUE","assignee":null,"user_notes_count":11,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336913","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336913","notes":"https://gitlab.com/api/v4/projects/278964/issues/336913/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336913/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336913","relative":"#336913","full":"gitlab-org/gitlab#336913"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6685,"epic":{"id":342618,"iid":6685,"title":"Simulate failure scenarios in staging (Phase 1)","url":"/groups/gitlab-org/-/epics/6685","group_id":9970,"human_readable_end_date":"Oct 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90864132,"iid":336912,"project_id":278964,"title":"Breaking change: Container registry API updates","description":"`endpoint_id`: `GET /api/:version/groups/:id/registry/repositories`\n\n\n### Context\n\nYou can use the container registry API to return a list of container image repositories and their associated tags for a given groupID. \n\n### Problem to solve\n\nReturning a list of tags for every image repository is an expensive query and can result in slow response times that are beyond GitLab's tolerated apdex threshold of 1 second.\n\nThis endpoint continues to display very poor performance - the p75 is over 5 seconds, with p99 sometimes spiking up to over 20 seconds. \n\n![image](/uploads/766e51c818b378f1cdc41f616d755b66/image.png)\n\n[source](https://log.gprd.gitlab.net/goto/c4c90a2fa765fa814ea0f81cb8ce8208)\n\n### Proposal\n\nUpdate the API to only return a list of image repositories. The tags can be pulled for a specific image repository rather than generating every tag for every group.\n\nThis means that the [`GET /groups/:id/registry/repositories`](https://docs.gitlab.com/ee/api/container_registry.html#within-a-group) endpoint will no longer support the `tags` and `tags_count` parameters. To obtain the tag count/list, users can use the [`GET /registry/repositories/:id`](https://docs.gitlab.com/ee/api/container_registry.html#get-details-of-a-single-repository) endpoint, which will continue to support the `tags` and `tags_count` options as it does today.\n\nSince this may introduce a breaking change, we'll need to consider this change for milestone 15.0","state":"closed","created_at":"2021-07-26T17:38:51.098Z","updated_at":"2022-06-17T12:27:45.119Z","closed_at":"2022-05-09T06:21:05.531Z","closed_by":{"id":3983112,"username":"10io","name":"David Fernandez","state":"active","avatar_url":"https://secure.gravatar.com/avatar/4c42a43361e29bf7ed36cf8e54cb54bb?s=80\u0026d=identicon","web_url":"https://gitlab.com/10io"},"labels":["Category:Container Registry","Community contribution","Deliverable","Mechanical Sympathy","Package:P1","Quality:performance-issues","backend","breaking change","bug::performance","devops::package","golang","group::package registry","priority::4","reliability","ruby","section::ops","severity::4","type::feature","workflow::verification"],"milestone":{"id":2095271,"iid":65,"group_id":9970,"title":"15.0","description":"","state":"active","created_at":"2021-06-08T15:35:34.814Z","updated_at":"2021-11-02T18:23:35.115Z","due_date":"2022-05-17","start_date":"2022-04-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/65"},"assignees":[{"id":4059254,"username":"sabrams","name":"Steve Abrams","state":"active","avatar_url":"https://secure.gravatar.com/avatar/cac831f7b515c191dfba32c54f01c375?s=80\u0026d=identicon","web_url":"https://gitlab.com/sabrams"},{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https://secure.gravatar.com/avatar/40569112d16323eb878ebdead2117943?s=80\u0026d=identicon","web_url":"https://gitlab.com/feistel"}],"author":{"id":3799560,"username":"trizzi","name":"Tim Rizzi","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3799560/avatar.png","web_url":"https://gitlab.com/trizzi"},"type":"ISSUE","assignee":{"id":4059254,"username":"sabrams","name":"Steve Abrams","state":"active","avatar_url":"https://secure.gravatar.com/avatar/cac831f7b515c191dfba32c54f01c375?s=80\u0026d=identicon","web_url":"https://gitlab.com/sabrams"},"user_notes_count":26,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336912","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336912","notes":"https://gitlab.com/api/v4/projects/278964/issues/336912/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336912/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336912","relative":"#336912","full":"gitlab-org/gitlab#336912"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6726,"epic":{"id":346406,"iid":6726,"title":"Breaking changes for the Package stage: Milestone 15.0","url":"/groups/gitlab-org/-/epics/6726","group_id":9970,"human_readable_end_date":"May 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90864072,"iid":336911,"project_id":278964,"title":"[Contribution Analytics] Create view test coverage","description":"## Problem to solve\n\n[As noted by @rob.hunt](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66805/diffs#note_635085202), the [Contribution Analytics view](https://gitlab.com/gitlab-org/gitlab/-/blob/master/ee/app/views/groups/contribution_analytics/show.html.haml) does not have test coverage.  This has allowed at least [one bug](https://gitlab.com/gitlab-org/gitlab/-/issues/336708) to enter production.\n\n## Proposal\n\nThe [Contribution Analytics view](https://gitlab.com/gitlab-org/gitlab/-/blob/master/ee/app/views/groups/contribution_analytics/show.html.haml) should have test coverage.","state":"closed","created_at":"2021-07-26T17:36:03.487Z","updated_at":"2022-05-24T13:11:37.897Z","closed_at":"2022-05-24T13:11:00.866Z","closed_by":{"id":4826728,"username":"m_frankiewicz","name":"Magdalena Frankiewicz","state":"active","avatar_url":"https://secure.gravatar.com/avatar/ca314fa77051f58ced6e3e5bf7f0dd48?s=80\u0026d=identicon","web_url":"https://gitlab.com/m_frankiewicz"},"labels":["Hackathon","backend","devops::manage","good for new contributors","group::optimize","maintenance::refactor","missed:14.9","priority::4","section::dev","test","type::maintenance","workflow::in dev"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/72"},"assignees":[{"id":10409869,"username":"anshulriyal","name":"Anshul Riyal","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10409869/avatar.png","web_url":"https://gitlab.com/anshulriyal"}],"author":{"id":4512390,"username":"djensen","name":"Dan Jensen","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4512390/avatar.png","web_url":"https://gitlab.com/djensen"},"type":"ISSUE","assignee":{"id":10409869,"username":"anshulriyal","name":"Anshul Riyal","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10409869/avatar.png","web_url":"https://gitlab.com/anshulriyal"},"user_notes_count":12,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336911","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336911","notes":"https://gitlab.com/api/v4/projects/278964/issues/336911/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336911/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336911","relative":"#336911","full":"gitlab-org/gitlab#336911"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90862200,"iid":336909,"project_id":278964,"title":"Evaluate reuse of GroupsFinder class","description":"### Problem\n\nIn a [review comment](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66166#note_629619686) for https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66166, it came up that we should look into using the `GroupsFinder` rather than adding parameters to the logic in place for the Namespaces API endpoint (`/api/v4/namespaces`).\n\n### Proposal\n\nEvaluate if the `GroupsFinder` can be used in the Namespaces API endpoint instead of the duplicate logic in place. One thing to look out for is that the personal namespace has to be added manually afterwards since it's not part of the `GroupsFinder` logic.\n\n\n### Result\n\nReusing existing logic and easier maintenance of code.\n\n### Next steps (if any)\n\n### How will we measure success?","state":"closed","created_at":"2021-07-26T16:46:22.140Z","updated_at":"2021-10-28T13:54:51.737Z","closed_at":"2021-07-28T08:04:50.229Z","closed_by":{"id":4799322,"username":"cwiesner","name":"Corinna Gogolok","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4799322/avatar.png","web_url":"https://gitlab.com/cwiesner"},"labels":["[deprecated] Category:Provision","backend","devops::fulfillment","group::provision","section::fulfillment","type::maintenance","won't do"],"milestone":null,"assignees":[],"author":{"id":4799322,"username":"cwiesner","name":"Corinna Gogolok","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4799322/avatar.png","web_url":"https://gitlab.com/cwiesner"},"type":"ISSUE","assignee":null,"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336909","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336909","notes":"https://gitlab.com/api/v4/projects/278964/issues/336909/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336909/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336909","relative":"#336909","full":"gitlab-org/gitlab#336909"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90853434,"iid":336899,"project_id":278964,"title":"Fix `Gitlab::Database::SchemaCacheWithRenamedTable` does not work with many databases","description":"We use views to perform non-interruptive renamed of tables. Currently we inject `SchemaCacheWithRenamedTable` into make Rails look at a different table (under view). This does not work with many connections as we use `ActiveRecord::Base.connection`. Secondly, our different attempts to use `connection` did result in set of random failures and hacky solutions.\n\nWe should consider:\n1. Removing that for time being (and consider bringing this back next)\n2. Fixing","state":"closed","created_at":"2021-07-26T14:39:29.955Z","updated_at":"2022-05-30T15:01:32.357Z","closed_at":"2021-12-10T11:56:01.910Z","closed_by":{"id":9231122,"username":"dfrazao-gitlab","name":"Diogo Fraz√£o","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9231122/avatar.png","web_url":"https://gitlab.com/dfrazao-gitlab"},"labels":["Category:Database","Category:Pods","ci-decomposition","ci-decomposition::phase4","devops::data_stores","group::database","missed:14.3","missed:14.4","missed:14.5","section::enablement","type::maintenance"],"milestone":{"id":2114820,"iid":67,"group_id":9970,"title":"14.6","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T05:00:52.094Z","updated_at":"2022-04-21T07:26:38.271Z","due_date":"2021-12-17","start_date":"2021-11-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/67"},"assignees":[{"id":9231122,"username":"dfrazao-gitlab","name":"Diogo Fraz√£o","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9231122/avatar.png","web_url":"https://gitlab.com/dfrazao-gitlab"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":9231122,"username":"dfrazao-gitlab","name":"Diogo Fraz√£o","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9231122/avatar.png","web_url":"https://gitlab.com/dfrazao-gitlab"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336899","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336899","notes":"https://gitlab.com/api/v4/projects/278964/issues/336899/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336899/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336899","relative":"#336899","full":"gitlab-org/gitlab#336899"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6841,"epic":{"id":360537,"iid":6841,"title":"Decomposition: Update database tooling to support multiple databases","url":"/groups/gitlab-org/-/epics/6841","group_id":9970,"human_readable_end_date":"May 22, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90853168,"iid":336897,"project_id":278964,"title":"Draft: Define how `BackgroundMigrations` should be executed with many databases","description":"TBD","state":"closed","created_at":"2021-07-26T14:35:12.026Z","updated_at":"2022-05-31T12:22:09.662Z","closed_at":"2021-08-12T02:55:09.296Z","closed_by":{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"},"labels":["Category:Pods","[deprecated] Accepting merge requests","ci-decomposition","devops::data_stores","group::pods","section::enablement","type::maintenance"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":null,"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336897","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336897","notes":"https://gitlab.com/api/v4/projects/278964/issues/336897/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336897/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":"https://gitlab.com/api/v4/projects/278964/issues/333334"},"references":{"short":"#336897","relative":"#336897","full":"gitlab-org/gitlab#336897"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6387,"epic":{"id":311274,"iid":6387,"title":"Decomposition: Make Enablement features compatible with Decomposed CI database","url":"/groups/gitlab-org/-/epics/6387","group_id":9970,"human_readable_end_date":"May 22, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90853087,"iid":336896,"project_id":278964,"title":"Fix `BeforeAllAdapter` to support many databases (ideally upstream)","description":"Currently `BeforeAllAdapter` manually opens transaction for only a main database.\n\nThis should be fixed to support many databases, but as well be upstreamed.\n\nRef.:\n- https://gitlab.com/gitlab-org/gitlab/-/blob/a9c318847faad3b6db4e5d51440c009cff578dff/spec/support/before_all_adapter.rb\n- https://gitlab.com/gitlab-org/gitlab/-/blob/a9c318847faad3b6db4e5d51440c009cff578dff/ee/spec/support/before_all_adapter.rb","state":"closed","created_at":"2021-07-26T14:34:14.212Z","updated_at":"2022-05-31T12:22:10.618Z","closed_at":"2021-08-11T04:27:22.263Z","closed_by":{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"},"labels":["Category:Pods","[deprecated] Accepting merge requests","ci-decomposition","devops::data_stores","group::pods","section::enablement","type::maintenance"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":null,"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336896","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336896","notes":"https://gitlab.com/api/v4/projects/278964/issues/336896/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336896/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336896","relative":"#336896","full":"gitlab-org/gitlab#336896"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6103,"epic":{"id":281355,"iid":6103,"title":"Decomposition: Support for many databases","url":"/groups/gitlab-org/-/epics/6103","group_id":9970,"human_readable_end_date":"Sep 16, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90852603,"iid":336894,"project_id":278964,"title":"Fix `Ci::UnlockArtifactsService` calling `ActiveRecord::Base.connection`","description":"From https://gitlab.com/gitlab-org/gitlab/-/merge_requests/62092 we have seen that `UnlockArtifactsService` manually constructs query\nand calls it against a wrong connection (`ActiveRecord::Base`). We should:\n\n1. Avoid manually constructing executed SQLs (can we use AR for that)\n2. Call it on an appropiate model\n\nRef.: https://gitlab.com/gitlab-org/gitlab/-/blob/a9c318847faad3b6db4e5d51440c009cff578dff/app/services/ci/unlock_artifacts_service.rb","state":"closed","created_at":"2021-07-26T14:26:05.959Z","updated_at":"2021-10-18T07:01:57.382Z","closed_at":"2021-10-07T15:12:28.686Z","closed_by":{"id":3946912,"username":"lauraX","name":"Laura Montemayor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3946912/avatar.png","web_url":"https://gitlab.com/lauraX"},"labels":["CI artifacts","Category:Build Artifacts","Deliverable","Engineering Allocation","FY22::Q3","Ops candidate","SaaS","Verify::P2","auto updated","ci-decomposition","devops::verify","group::pipeline insights","missed-deliverable","missed:14.3","reliability","section::ops","workflow::in review"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[{"id":3946912,"username":"lauraX","name":"Laura Montemayor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3946912/avatar.png","web_url":"https://gitlab.com/lauraX"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":3946912,"username":"lauraX","name":"Laura Montemayor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3946912/avatar.png","web_url":"https://gitlab.com/lauraX"},"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336894","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336894","notes":"https://gitlab.com/api/v4/projects/278964/issues/336894/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336894/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336894","relative":"#336894","full":"gitlab-org/gitlab#336894"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6588,"epic":{"id":328775,"iid":6588,"title":"Engineering Allocation: Improve SaaS Reliability in the Verify stage","url":"/groups/gitlab-org/-/epics/6588","group_id":9970,"human_readable_end_date":"Apr 8, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90852450,"iid":336893,"project_id":278964,"title":"`BulkInsertSafe` should work with many databases","description":"From https://gitlab.com/gitlab-org/gitlab/-/merge_requests/62092 we have seen that `BulkInsertSafe` currently requires to use a main connection. This should be fixed to allow this to use whatever connection is assigned to a model.\n\nRef.: https://gitlab.com/gitlab-org/gitlab/-/blob/a9c318847faad3b6db4e5d51440c009cff578dff/app/models/concerns/bulk_insert_safe.rb","state":"closed","created_at":"2021-07-26T14:23:11.461Z","updated_at":"2022-05-30T15:01:33.477Z","closed_at":"2021-12-02T16:37:40.425Z","closed_by":{"id":5297955,"username":"pbair","name":"Patrick Bair","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5297955/avatar.png","web_url":"https://gitlab.com/pbair"},"labels":["Category:Database","Category:Pods","ci-decomposition","ci-decomposition::phase4","devops::data_stores","group::database","missed:14.4","section::enablement","type::maintenance","workflow::in dev"],"milestone":{"id":2114820,"iid":67,"group_id":9970,"title":"14.6","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T05:00:52.094Z","updated_at":"2022-04-21T07:26:38.271Z","due_date":"2021-12-17","start_date":"2021-11-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/67"},"assignees":[{"id":5297955,"username":"pbair","name":"Patrick Bair","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5297955/avatar.png","web_url":"https://gitlab.com/pbair"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":5297955,"username":"pbair","name":"Patrick Bair","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5297955/avatar.png","web_url":"https://gitlab.com/pbair"},"user_notes_count":10,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336893","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336893","notes":"https://gitlab.com/api/v4/projects/278964/issues/336893/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336893/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336893","relative":"#336893","full":"gitlab-org/gitlab#336893"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6841,"epic":{"id":360537,"iid":6841,"title":"Decomposition: Update database tooling to support multiple databases","url":"/groups/gitlab-org/-/epics/6841","group_id":9970,"human_readable_end_date":"May 22, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90852115,"iid":336891,"project_id":278964,"title":"Fix `PipelinesForMergeRequestFinder` doing cross-join to `projects`, `merge_requests`, `commits`","description":"From https://gitlab.com/gitlab-org/gitlab/-/merge_requests/62092 we have seen that `PipelinesForMergeRequestFinder` needs to join across many tables to find a list of latest pipelines for merge requests:\n\n## Scopes to fix\n\n1. `#all`\n2. `#pipelines_using_cte`\n3. `#filter_by_sha`\n4. `#filter_by`\n\n## Options\n\n1. Evaluate if we can `.ids` to fetch `ids` and use two separate queries\n2. Change how the feature is being used, and remove this method all together\n3. Take a look at some naive changes (not ideal, but breaking some aspects): https://gitlab.com/gitlab-org/gitlab/-/blob/a9c318847faad3b6db4e5d51440c009cff578dff/app/finders/ci/pipelines_for_merge_request_finder.rb","state":"closed","created_at":"2021-07-26T14:17:34.443Z","updated_at":"2022-04-06T04:05:24.150Z","closed_at":"2021-11-22T11:29:57.566Z","closed_by":{"id":3714742,"username":"ck3g","name":"Vitali Tatarintev","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3714742/avatar.png","web_url":"https://gitlab.com/ck3g"},"labels":["Category:Merge Trains","Engineering Allocation","FY22::Q4","OKR","Ops candidate","SaaS","Verify::P2","auto updated","ci-decomposition","ci-decomposition::phase6","devops::verify","group::pipeline execution","missed:14.3","missed:14.4","missed:14.5","priority::1","reliability","section::ops","severity::1","workflow::in review"],"milestone":{"id":2114820,"iid":67,"group_id":9970,"title":"14.6","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T05:00:52.094Z","updated_at":"2022-04-21T07:26:38.271Z","due_date":"2021-12-17","start_date":"2021-11-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/67"},"assignees":[{"id":3714742,"username":"ck3g","name":"Vitali Tatarintev","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3714742/avatar.png","web_url":"https://gitlab.com/ck3g"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":3714742,"username":"ck3g","name":"Vitali Tatarintev","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3714742/avatar.png","web_url":"https://gitlab.com/ck3g"},"user_notes_count":11,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336891","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336891","notes":"https://gitlab.com/api/v4/projects/278964/issues/336891/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336891/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336891","relative":"#336891","full":"gitlab-org/gitlab#336891"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6588,"epic":{"id":328775,"iid":6588,"title":"Engineering Allocation: Improve SaaS Reliability in the Verify stage","url":"/groups/gitlab-org/-/epics/6588","group_id":9970,"human_readable_end_date":"Apr 8, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90845390,"iid":336883,"project_id":278964,"title":"[Experiment cleanup] Trial onboarding","description":"Promote trial onboarding\n\nMerge request https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66836\n\n## Summary\n\nThe experiment is currently rolled out to 100% of users and has been deemed a success.\nThe changes need to become an official part of the product.\n\n## Steps\n\n- [X] Determine whether the feature should apply to SaaS and/or self-managed\n      - SaaS only\n- [X] Determine whether the feature should apply to EE - and which tiers - and/or Core\n     - Only applies to free trials which are currently limited to free users\n- [X] Determine if tracking should be kept as is, removed, or modified.\n    - Tracking can be removed\n- [X] Ensure any relevant documentation has been updated.\n    - No end-user documentation needs to be updated\n- [x] Consider changes to any `feature_category:` introduced by the experiment if ownership is changing (PM for Growth and PM for the new category as DRIs)\n- [x] Optional: Migrate experiment to a default enabled [feature flag](https://docs.gitlab.com/ee/development/feature_flags) for one milestone and add a changelog. Converting to a feature flag can be skipped at the ICs discretion if risk is deemed low with consideration to both SaaS and (if applicable) self managed\n- [x] In the next milestone, [remove the feature flag](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up) if applicable\n- [x] After the flag removal is deployed, [clean up the feature/experiment feature flags](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up) by running chatops command in `#production` channel\n- [x] Ensure the corresponding [Experiment Tracking](https://gitlab.com/groups/gitlab-org/-/boards/1352542?label_name[]=devops%3A%3Agrowth\u0026label_name[]=growth%20experiment\u0026label_name[]=experiment%20tracking) issue is updated","state":"closed","created_at":"2021-07-26T12:40:34.875Z","updated_at":"2021-10-28T13:54:52.968Z","closed_at":"2021-07-29T07:32:58.974Z","closed_by":{"id":4409816,"username":"a_akgun","name":"Alper Akgun","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4409816/avatar.png","web_url":"https://gitlab.com/a_akgun"},"labels":["Stretch","devops::growth","feature flag","group::acquisition","growth experiment","section::growth","type::maintenance","workflow::scheduling"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":4409816,"username":"a_akgun","name":"Alper Akgun","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4409816/avatar.png","web_url":"https://gitlab.com/a_akgun"}],"author":{"id":4409816,"username":"a_akgun","name":"Alper Akgun","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4409816/avatar.png","web_url":"https://gitlab.com/a_akgun"},"type":"ISSUE","assignee":{"id":4409816,"username":"a_akgun","name":"Alper Akgun","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4409816/avatar.png","web_url":"https://gitlab.com/a_akgun"},"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336883","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":9,"completed_count":9},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"9 of 9 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336883","notes":"https://gitlab.com/api/v4/projects/278964/issues/336883/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336883/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336883","relative":"#336883","full":"gitlab-org/gitlab#336883"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90845075,"iid":336882,"project_id":278964,"title":"Geo: adding filter options in the node page","description":"## Overview\n\nAs we have released the new dashboard, it could allow users that have multiple secondary sites.\n\nFollowing behaviors are known to us:\n- Sysadmins tend to check the details of sites that are not healthy.\n- Some sysadmins have their own monitoring system, and they want to quickly find the exact site in the Geo dashboard.\n\nFor better usability, having filtering options would be helpful for users with multiple secondaries and also general Geo users who regularly visit the dashboard and check the status of each site.\n\n## Design\n\n- [Spec in Figma üîó](https://www.figma.com/file/MYEfBPGuLygUMLAMa4UGkI/Geo?node-id=1048%3A16127)\n- [Design tab](https://gitlab.com/gitlab-org/gitlab/-/issues/336882/designs/Adding-filter-option-tab.png)\n\n![Adding-filter-option-tab](/uploads/248f84cb0c8e0b30dd3b973c75878f0b/Adding-filter-option-tab.png)","state":"closed","created_at":"2021-07-26T12:34:57.165Z","updated_at":"2022-02-22T16:44:20.304Z","closed_at":"2022-02-11T15:49:36.617Z","closed_by":{"id":4748809,"username":"zcuddy","name":"Zack Cuddy","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4748809/avatar.png","web_url":"https://gitlab.com/zcuddy"},"labels":["UX","auto updated","devops::systems","frontend","group::geo","release post item","section::enablement","severity::4","type::feature","workflow::verification"],"milestone":{"id":2161849,"iid":70,"group_id":9970,"title":"14.8","description":"","state":"active","created_at":"2021-07-26T16:51:47.677Z","updated_at":"2021-07-26T16:51:47.677Z","due_date":"2022-02-17","start_date":"2022-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/70"},"assignees":[{"id":4748809,"username":"zcuddy","name":"Zack Cuddy","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4748809/avatar.png","web_url":"https://gitlab.com/zcuddy"}],"author":{"id":4903414,"username":"sunjungp","name":"Sunjung Park","state":"active","avatar_url":"https://secure.gravatar.com/avatar/a2c072c26031ffd81b676b43eeb7b781?s=80\u0026d=identicon","web_url":"https://gitlab.com/sunjungp"},"type":"ISSUE","assignee":{"id":4748809,"username":"zcuddy","name":"Zack Cuddy","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4748809/avatar.png","web_url":"https://gitlab.com/zcuddy"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336882","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336882","notes":"https://gitlab.com/api/v4/projects/278964/issues/336882/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336882/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336882","relative":"#336882","full":"gitlab-org/gitlab#336882"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6042,"epic":{"id":274361,"iid":6042,"title":"Geo Status Page Improvements","url":"/groups/gitlab-org/-/epics/6042","group_id":9970,"human_readable_end_date":"Jun 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90839545,"iid":336875,"project_id":278964,"title":"Gradual production rollout for major customers (Phase 1)","description":"## Context\n\nThis is part of the work to upgrade and migrate the GitLab.com container registry to a new version backed by a metadata database and online garbage collection (https://gitlab.com/groups/gitlab-org/-/epics/5523). This will be achieved following the gradual migration plan detailed in https://gitlab.com/gitlab-org/container-registry/-/issues/374.\n\nFor the gradual [Phase 1](https://gitlab.com/gitlab-org/container-registry/-/issues/374#phase-1-the-metadata-db-serves-new-repositories) (new repositories only) production rollout, we'll split the work into three portions, in this order:\n\n1. **GitLab Org**: We'll start by testing with some custom-made container repositories under `gitlab-org/` and then allow all of its new container repositories to be handled by the metadata DB;\n\n1. **General**: Following the GitLab Org rollout, we will proceed with a general percentage-based roll out for everyone, excluding major customers (see next);\n\n1. **Major customers**: To reduce the risk of impacting users of the GitLab.com container registry that have large amounts of data, a very high activity, or very high availability/stability requirements, we will exclude these from (2) and handle them in this step with a manual gradual rollout, customer by customer.\n\n## Task\n\nPerform the gradual rollout for major customers (3).\n\nBased on the [list of 568 \"protected\" top-level namespaces](https://gitlab.com/gitlab-org/container-registry/-/issues/408#list-of-vip-namespaces) (internal) in hand, we'll need to do the following:\n\n1. Group namespaces by criticality (in coordination with Technical Account Managers (TAMs));\n1. Split namespaces into batches of variable size and sort them by increasing criticality (in coordination with TAMs);\n1. Start by processing a few namespaces manually (batch 0). This requires disabling the [`container_registry_migration_phase1_deny`](https://gitlab.com/gitlab-org/gitlab/-/issues/335706) feature flag (FF) using `chatops` in the `#production` Slack channel for each one of the namespaces, as follows:\n\n     ```\n     /chatops run feature set --group=\u003cnamespace path\u003e container_registry_migration_phase1_deny false\n     ```\n   This FF was enabled for all 568 namespaces (https://gitlab.com/gitlab-com/gl-infra/production/-/issues/5770), which prevents any _new_ image repositories from them to be created on the metadata database. As soon as we disable the FF for each, any _new_ repositories under their namespace will be automatically created on the metadata database;\n1. For noncritical namespaces (the vast majority), we'll want to process them in large batches. The process is identical, but instead of doing it manually with `chatops` commands, we'll need a change request similar to https://gitlab.com/gitlab-com/gl-infra/production/-/issues/5770;\n1. For critical namespaces, we'll process them in small batches, disabling the feature flag using a `chatops` command (same as above) in the `#production` Slack channel for each namespace, all in coordination with TAMs.","state":"closed","created_at":"2021-07-26T11:05:01.839Z","updated_at":"2022-01-19T14:51:52.099Z","closed_at":"2022-01-19T14:48:48.663Z","closed_by":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"labels":["Category:Container Registry","Container Registry Migration","Container Registry Migration::Phase 1","auto updated","devops::package","group::package registry","section::ops","type::maintenance","workflow::production"],"milestone":{"id":2156369,"iid":68,"group_id":9970,"title":"14.7","description":"","state":"active","created_at":"2021-07-21T17:39:41.786Z","updated_at":"2021-07-21T17:39:41.786Z","due_date":"2022-01-17","start_date":"2021-12-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/68"},"assignees":[{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"}],"author":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"type":"ISSUE","assignee":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"user_notes_count":37,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336875","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336875","notes":"https://gitlab.com/api/v4/projects/278964/issues/336875/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336875/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336875","relative":"#336875","full":"gitlab-org/gitlab#336875"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6442,"epic":{"id":314737,"iid":6442,"title":"Gradual production rollout (Phase 1)","url":"/groups/gitlab-org/-/epics/6442","group_id":9970,"human_readable_end_date":"Jan 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90839479,"iid":336874,"project_id":278964,"title":"General gradual production rollout (Phase 1)","description":"## Context\n\nThis is part of the work to upgrade and migrate the GitLab.com container registry to a new version backed by a metadata database and online garbage collection (https://gitlab.com/groups/gitlab-org/-/epics/5523). This will be achieved following the gradual migration plan detailed in https://gitlab.com/gitlab-org/container-registry/-/issues/374.\n\nFor the gradual [Phase 1](https://gitlab.com/gitlab-org/container-registry/-/issues/374#phase-1-the-metadata-db-serves-new-repositories) (new repositories only) production rollout, we'll split the work into three portions, in this order:\n\n1. **GitLab Org**: We'll start by testing with some custom-made container repositories under `gitlab-org/` and then allow all of its new container repositories to be handled by the metadata DB;\n1. **General**: Following the GitLab Org rollout, we will proceed with a general percentage-based roll out for everyone, excluding major customers (see next);\n1. **Major customers**: To reduce the risk of impacting users of the GitLab.com container registry that have large amounts of data, a very high activity, or very high availability/stability requirements, we will exclude these from (2) and handle them in this step with a manual gradual rollout, customer by customer.\n\n## Task\n\nPerform general percentage-based rollout (2) for new container repositories.","state":"closed","created_at":"2021-07-26T11:03:32.316Z","updated_at":"2021-10-28T13:54:53.441Z","closed_at":"2021-10-12T13:37:11.589Z","closed_by":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"labels":["Category:Container Registry","Container Registry Migration","Package:P1","[deprecated] Accepting merge requests","auto updated","devops::package","golang","group::package registry","section::ops","type::maintenance","workflow::ready for development"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/66"},"assignees":[],"author":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336874","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336874","notes":"https://gitlab.com/api/v4/projects/278964/issues/336874/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336874/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336874","relative":"#336874","full":"gitlab-org/gitlab#336874"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6442,"epic":{"id":314737,"iid":6442,"title":"Gradual production rollout (Phase 1)","url":"/groups/gitlab-org/-/epics/6442","group_id":9970,"human_readable_end_date":"Jan 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90839444,"iid":336873,"project_id":278964,"title":"Gradual production rollout for GitLab Org (Phase 1)","description":"## Context\n\nThis is part of the work to upgrade and migrate the GitLab.com container registry to a new version backed by a metadata database and online garbage collection (https://gitlab.com/groups/gitlab-org/-/epics/5523). This will be achieved following the gradual migration plan detailed in https://gitlab.com/gitlab-org/container-registry/-/issues/374.\n\nFor the gradual [Phase 1](https://gitlab.com/gitlab-org/container-registry/-/issues/374#phase-1-the-metadata-db-serves-new-repositories) (new repositories only) production rollout, we'll split the work into three portions, in this order:\n\n1. **GitLab Org**: We'll start by testing with some custom-made container repositories under `gitlab-org/` and then allow all of its new container repositories to be handled by the metadata DB;\n1. **General**: Following the GitLab Org rollout, we will proceed with a general percentage-based roll out for everyone, excluding major customers (see next);\n1. **Major customers**: To reduce the risk of impacting users of the GitLab.com container registry that have large amounts of data, a very high activity, or very high availability/stability requirements, we will exclude these from (2) and handle them in this step with a manual gradual rollout, customer by customer.\n\n## Task\n\nPerform the rollout for new container repositories under GitLab Org (1).\n\n### Steps\n\n\n1. [x] Enable metadata database and migration mode on the registry side for the **canary** stage (https://gitlab.com/gitlab-com/gl-infra/k8s-workloads/gitlab-com/-/merge_requests/1314). We should ensure that:\n\n    - [x] No impact is observed in logs/metrics/alerts.\n\n    - [x] Nothing is added to the database, and the new root prefix (`gitlab/`) does not exist in the GCS bucket.\n\n1. [x] Enable metadata database and migration mode on the registry side for the **main** stage (https://gitlab.com/gitlab-com/gl-infra/k8s-workloads/gitlab-com/-/merge_requests/1284). We should ensure that:\n\n    - [x] No impact is observed in logs/metrics/alerts.\n\n1. [x] Enable online GC for the **canary** stage (https://gitlab.com/gitlab-com/gl-infra/k8s-workloads/gitlab-com/-/merge_requests/1325). We should ensure that:\n\n    - [x] No impact is observed in logs/metrics/alerts. Nothing is deleted.\n\n1. [x] Enable online GC for the **main** stage (https://gitlab.com/gitlab-com/gl-infra/k8s-workloads/gitlab-com/-/merge_requests/1328). We should ensure that:\n\n    - [x] No impact is observed in logs/metrics/alerts. Nothing is deleted.\n\n1. [x] Update [list of protected top-level namespaces](https://gitlab.com/gitlab-org/container-registry/-/issues/408#list-of-vip-namespaces) in [this snippet](https://gitlab.com/gitlab-com/gl-infra/production/-/snippets/2193030).\n\n1. [x] Fill the [`container_registry_migration_phase1_deny`](https://gitlab.com/gitlab-org/gitlab/-/issues/335706) deny list feature flag with the list of protected top-level namespaces (https://gitlab.com/gitlab-com/gl-infra/production/-/issues/5770).\n\n1. [x] Enable the [`container_registry_migration_phase1`](https://gitlab.com/gitlab-org/gitlab/-/issues/335703) feature flag. This enables the migration mode/JWT token labeling on the Rails side. This should not cause requests to go to the database because all tokens are marked as non-eligible by default (see next step). Ensure that:\n\n    - [x] No impact is observed in logs/metrics/alerts.\n\n    - [x] Nothing is added to the database, and the new root prefix does not exist in the GCS bucket.\n\n1. [x] Enable the [`container_registry_migration_phase1_allow`](https://gitlab.com/gitlab-org/gitlab/-/issues/335705) feature flag for the [`container-registry-migration-test/phase1`](https://gitlab.com/container-registry-migration-test/phase1) project (created for testing purposes) and:\n\n    - [x] Push an image.\n\n    - [x] Ensure data was created on the database and the new bucket root prefix (and not on the old prefix).\n    - [x] Pull the previously pushed image.\n    - [x] Confirm other groups/projects/repositories are not being affected by any means `*`.\n\n1. [x] Enable the [`container_registry_migration_phase1_allow`](https://gitlab.com/gitlab-org/gitlab/-/issues/335705) feature flag for a [selected list of projects](https://gitlab.com/gitlab-org/gitlab/-/issues/335705#note_722220584) under `gitlab-org`:\n\n    - [x] Wait for a while to see if any new repositories are created under this namespace.\n\n    - [x] Ensure data (if any) was created on the database and the new bucket root prefix (and not on the old prefix).\n    - [x] Confirm other groups/projects/repositories are not being affected by any means `*`.\n\n`*` To do this we'll need to check the logs to ensure the only requests being marked as \"eligible for migration\" and handled through the new code path are the ones related to groups on the allow list (if any). We should also glance over the Grafana dashboards and try to spot any unusual apdex or error rate fluctuations. We don't need to wait too much time in this step, 30 minutes should be enough. The production request rate is high enough to expose a problem during this period.","state":"closed","created_at":"2021-07-26T11:02:47.093Z","updated_at":"2021-11-18T07:02:13.948Z","closed_at":"2021-11-08T10:55:47.019Z","closed_by":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"labels":["Category:Container Registry","Container Registry Migration","Deliverable","Package:P1","auto updated","devops::package","group::package registry","section::ops","type::feature","workflow::in dev"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/66"},"assignees":[{"id":4829721,"username":"hswimelar","name":"Hayley Swimelar","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4829721/avatar.png","web_url":"https://gitlab.com/hswimelar"},{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"}],"author":{"id":5054840,"username":"jdrpereira","name":"Jo√£o Pereira","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5054840/avatar.png","web_url":"https://gitlab.com/jdrpereira"},"type":"ISSUE","assignee":{"id":4829721,"username":"hswimelar","name":"Hayley Swimelar","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4829721/avatar.png","web_url":"https://gitlab.com/hswimelar"},"user_notes_count":28,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336873","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":23,"completed_count":23},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"23 of 23 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336873","notes":"https://gitlab.com/api/v4/projects/278964/issues/336873/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336873/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336873","relative":"#336873","full":"gitlab-org/gitlab#336873"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6442,"epic":{"id":314737,"iid":6442,"title":"Gradual production rollout (Phase 1)","url":"/groups/gitlab-org/-/epics/6442","group_id":9970,"human_readable_end_date":"Jan 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90835827,"iid":336864,"project_id":278964,"title":"[VSA] [FE] Migrate project VSA records endpoint to new dedicated endpoint","description":"\u003c!-- This issue template can be used a great starting point for feature requests. The last section \"Release notes\" can be used as a summary of the feature and is also required if you want to have your release post blog MR auto generated using the release post item generator:  https://about.gitlab.com/handbook/marketing/blog/release-posts/#release-post-item-generator. The remaining sections are the backbone for every feature in GitLab. --\u003e\n\n\u003c!-- What is the problem and solution you're proposing? This content sets the overall vision for the feature and serves as the release notes that will populate in various places, including the [release post blog](https://about.gitlab.com/releases/categories/releases/) and [Gitlab project releases](https://gitlab.com/gitlab-org/gitlab/-/releases). \" --\u003e\n\n### Problem to solve \n\nUpdates the project VSA stage table to request data from the ~~relevant group level endpoint~~ new dedicated endpoint introduced in https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66439\n\nThe updated project level endpoints will be available after https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66439\n\nRelated to #326704 and https://gitlab.com/gitlab-org/gitlab/-/issues/335953","state":"closed","created_at":"2021-07-26T09:50:09.424Z","updated_at":"2021-08-11T12:50:09.999Z","closed_at":"2021-08-06T02:53:52.777Z","closed_by":{"id":3397881,"username":"ekigbo","name":"Ezekiel Kigbo","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3397881/avatar.png","web_url":"https://gitlab.com/ekigbo"},"labels":["Category:Value Stream Management","auto updated","devops::manage","frontend","group::optimize","priority::2","section::dev","workflow::in review"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":3397881,"username":"ekigbo","name":"Ezekiel Kigbo","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3397881/avatar.png","web_url":"https://gitlab.com/ekigbo"}],"author":{"id":3397881,"username":"ekigbo","name":"Ezekiel Kigbo","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3397881/avatar.png","web_url":"https://gitlab.com/ekigbo"},"type":"ISSUE","assignee":{"id":3397881,"username":"ekigbo","name":"Ezekiel Kigbo","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3397881/avatar.png","web_url":"https://gitlab.com/ekigbo"},"user_notes_count":10,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336864","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336864","notes":"https://gitlab.com/api/v4/projects/278964/issues/336864/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336864/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336864","relative":"#336864","full":"gitlab-org/gitlab#336864"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":5194,"epic":{"id":180134,"iid":5194,"title":"[VSA] Refactor project-level feature to use group-level code","url":"/groups/gitlab-org/-/epics/5194","group_id":9970,"human_readable_end_date":"Sep 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90829392,"iid":336858,"project_id":278964,"title":"Merge requests parallax scroll","description":"\u003c!---\nPlease read this!\n\nBefore opening a new issue, make sure to search for keywords in the issues\nfiltered by the \"regression\" or \"bug\" label:\n\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=regression\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=bug\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n### Summary\n\nWeird parallax scrolling effect in big Merge Requests\n\n### Steps to reproduce\n\n\u003c!-- Describe how one can reproduce the issue - this is very important. Please use an ordered list. --\u003e\n\n1. Create an MR with 60+ file changes (it may happen at a lower value as well)\n\n\n### What is the current *bug* behavior?\n\nWhen scrolling in a long MR, the file headers and the file content itself are not scrolling at the same speed, creating a weird parallax effect\n\n### What is the expected *correct* behavior?\n\nFile headers and file content should stick together and scroll at the same time\n\n### Relevant logs and/or screenshots\n\nhttps://www.loom.com/share/ae52acf31d764179af5fc786c3a90ef4\n\n### Output of checks\n\nThis bug happens on GitLab.com","state":"closed","created_at":"2021-07-26T08:14:31.174Z","updated_at":"2021-09-22T09:05:33.425Z","closed_at":"2021-08-18T18:54:24.237Z","closed_by":{"id":853414,"username":"andr3","name":"Andr√© Lu√≠s","state":"active","avatar_url":"https://secure.gravatar.com/avatar/241e39726efb512a29621070ccf26a90?s=80\u0026d=identicon","web_url":"https://gitlab.com/andr3"},"labels":["[deprecated] Accepting merge requests","automation:ml","devops::create","frontend","group::code review","priority::2","section::dev","severity::3","spike","type::bug"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[],"author":{"id":3455586,"username":"TristanVermeesch","name":"Tristan Vermeesch","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3455586/avatar.png","web_url":"https://gitlab.com/TristanVermeesch"},"type":"ISSUE","assignee":null,"user_notes_count":29,"merge_requests_count":0,"upvotes":3,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336858","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336858","notes":"https://gitlab.com/api/v4/projects/278964/issues/336858/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336858/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336858","relative":"#336858","full":"gitlab-org/gitlab#336858"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90820406,"iid":336849,"project_id":278964,"title":"Update UpdateJiraTrackerDataDeploymentTypeBasedOnUrl to set `deployment_type` to `unknown` when url is blank","description":"### About\n\nThis issue was created from this recommendation https://gitlab.com/gitlab-org/gitlab/-/merge_requests/65663#note_627168588. \n\n### Problem\n\n`UpdateJiraTrackerDataDeploymentTypeBasedOnUrl` is a background migration that was run in %\"14.0\" https://gitlab.com/gitlab-org/gitlab/-/merge_requests/59902. \n\nIt set the `deployment_type` for records to either `cloud` or `server`.\n\nUnfortunately, a small edge-case exists where the model [allows inactive integrations to have a blank ](https://gitlab.com/gitlab-org/gitlab/-/blob/9710349cec0944de3360474f21d66b2038670d7e/app/models/integrations/jira.rb#L18)`url`. We can get records with blank `url` on our localhost by unsetting the property when we disable an integration, or afterwards.\n\nThose integration records should instead become `unknown`, and the migration will have set these to `server`\n\n### Proposal\n\nFrom https://gitlab.com/gitlab-org/gitlab/-/merge_requests/65663#note_627168588:\n\n1. Have the migration set `deployment_type` as `unknown` for blank (empty and nil) `url` strings. This will bring the migration into line with the existing logic in the model https://gitlab.com/gitlab-org/gitlab/-/merge_requests/65663#note_626498277.\n1. Have the migration handle `nil` `url`s https://gitlab.com/gitlab-org/gitlab/-/merge_requests/65663#note_625547559.\n\nBecause of `2` this means we need to re-run it from scratch with that new logic.\n\nNote that because the migration has been run previously as a background migration https://gitlab.com/gitlab-org/gitlab/-/merge_requests/59902, we [should `#steal` the migration](https://docs.gitlab.com/ee/development/background_migrations.html#cleaning-up) before re-running it.","state":"closed","created_at":"2021-07-26T05:20:54.306Z","updated_at":"2022-11-22T19:37:11.445Z","closed_at":"2022-08-04T08:33:08.655Z","closed_by":{"id":9588757,"username":"lenikadali","name":"Leni Kadali Mutungi","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9588757/avatar.png","web_url":"https://gitlab.com/lenikadali"},"labels":["Community contribution","auto updated","backend","database","devops::manage","group::integrations","section::dev","type::maintenance","workflow::in review"],"milestone":{"id":2453025,"iid":75,"group_id":9970,"title":"15.3","description":"","state":"active","created_at":"2022-02-03T22:28:50.229Z","updated_at":"2022-02-03T22:28:50.229Z","due_date":"2022-08-17","start_date":"2022-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/75"},"assignees":[{"id":9588757,"username":"lenikadali","name":"Leni Kadali Mutungi","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9588757/avatar.png","web_url":"https://gitlab.com/lenikadali"}],"author":{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"},"type":"ISSUE","assignee":{"id":9588757,"username":"lenikadali","name":"Leni Kadali Mutungi","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9588757/avatar.png","web_url":"https://gitlab.com/lenikadali"},"user_notes_count":13,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336849","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":1,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336849","notes":"https://gitlab.com/api/v4/projects/278964/issues/336849/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336849/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336849","relative":"#336849","full":"gitlab-org/gitlab#336849"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6391,"epic":{"id":311663,"iid":6391,"title":"Fix Jira integration deployment_type","url":"/groups/gitlab-org/-/epics/6391","group_id":9970},"iteration":null,"health_status":null},{"id":90818839,"iid":336847,"project_id":278964,"title":"Jobs with needs are skipped when the jobs they depend on is retried","description":"\u003c!---\nPlease read this!\n\nBefore opening a new issue, make sure to search for keywords in the issues\nfiltered by the \"regression\" or \"bug\" label:\n\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=regression\n- https://gitlab.com/gitlab-org/gitlab/issues?label_name%5B%5D=bug\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n### Summary\n\nRegular jobs(non-manual) that depends(through `needs`) on jobs from previous stages are skipped when they're retried.\n\n### Steps to reproduce\n\nI have not been able to reproduce this bug. Full CI file can be found in this ticket: https://gitlab.zendesk.com/agent/tickets/222631 (internal use only).\n\nIt appears that, jobs on later stages with needs points to previous stages are skipped when those jobs are retried. This does not happen always and are random.\n\nThis is observed in GitLab version 13.7.3.\n\n### Example Project\n\n\u003c!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. --\u003e\n\n### What is the current *bug* behavior?\n\nJobs on later stages are skipped.\n\n### What is the expected *correct* behavior?\n\nJobs on later stages should be rescheduled.\n\n### Relevant logs and/or screenshots\n\n\u003c!-- Paste any relevant logs - please use code blocks (```) to format console output, logs, and code\n as it's tough to read otherwise. --\u003e\n\n### Output of checks\n\n\u003c!-- If you are reporting a bug on GitLab.com, write: This bug happens on GitLab.com --\u003e\n\n#### Results of GitLab environment info\n\n\u003c!--  Input any relevant GitLab environment information if needed. --\u003e\n\n\u003cdetails\u003e\n\u003csummary\u003eExpand for output related to GitLab environment info\u003c/summary\u003e\n\n\u003cpre\u003e\n\n(For installations with omnibus-gitlab package run and paste the output of:\n`sudo gitlab-rake gitlab:env:info`)\n\n(For installations from source run and paste the output of:\n`sudo -u git -H bundle exec rake gitlab:env:info RAILS_ENV=production`)\n\n\u003c/pre\u003e\n\u003c/details\u003e\n\n#### Results of GitLab application Check\n\n\u003c!--  Input any relevant GitLab application check information if needed. --\u003e\n\n\u003cdetails\u003e\n\u003csummary\u003eExpand for output related to the GitLab application check\u003c/summary\u003e\n\u003cpre\u003e\n\n(For installations with omnibus-gitlab package run and paste the output of:\n`sudo gitlab-rake gitlab:check SANITIZE=true`)\n\n(For installations from source run and paste the output of:\n`sudo -u git -H bundle exec rake gitlab:check RAILS_ENV=production SANITIZE=true`)\n\n(we will only investigate if the tests are passing)\n\n\u003c/pre\u003e\n\u003c/details\u003e\n\n### Possible fixes\n\n\u003c!-- If you can, link to the line of code that might be responsible for the problem. --\u003e","state":"closed","created_at":"2021-07-26T04:27:20.899Z","updated_at":"2021-10-19T11:04:54.504Z","closed_at":"2021-10-19T11:04:54.487Z","closed_by":{"id":3946912,"username":"lauraX","name":"Laura Montemayor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3946912/avatar.png","web_url":"https://gitlab.com/lauraX"},"labels":["Category:Pipeline Authoring","[deprecated] Accepting merge requests","approaching-SLO","backend-weight::2","candidate::14.5","customer","devops::verify","group::pipeline authoring","missed-SLO","priority::2","section::ops","severity::2","type::bug"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[],"author":{"id":5287461,"username":"psureshbabu","name":"Priyan Sureshbabu","state":"active","avatar_url":"https://secure.gravatar.com/avatar/cf2976ba76d1e6194fb48522cb9ca061?s=80\u0026d=identicon","web_url":"https://gitlab.com/psureshbabu"},"type":"ISSUE","assignee":null,"user_notes_count":18,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336847","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336847","notes":"https://gitlab.com/api/v4/projects/278964/issues/336847/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336847/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336847","relative":"#336847","full":"gitlab-org/gitlab#336847"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90812815,"iid":336838,"project_id":278964,"title":"Database decomposition: Logging DB count query metrics per database","description":"Add query count as another logged metric per database like we did for duration in https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66515","state":"closed","created_at":"2021-07-25T22:49:20.992Z","updated_at":"2022-05-31T12:22:11.626Z","closed_at":"2021-08-09T00:20:28.096Z","closed_by":{"id":120073,"username":"DylanGriffith","name":"Dylan Griffith","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/120073/avatar.png","web_url":"https://gitlab.com/DylanGriffith"},"labels":["Category:Pods","auto updated","devops::data_stores","group::pods","section::enablement"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":120073,"username":"DylanGriffith","name":"Dylan Griffith","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/120073/avatar.png","web_url":"https://gitlab.com/DylanGriffith"}],"author":{"id":120073,"username":"DylanGriffith","name":"Dylan Griffith","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/120073/avatar.png","web_url":"https://gitlab.com/DylanGriffith"},"type":"ISSUE","assignee":{"id":120073,"username":"DylanGriffith","name":"Dylan Griffith","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/120073/avatar.png","web_url":"https://gitlab.com/DylanGriffith"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336838","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336838","notes":"https://gitlab.com/api/v4/projects/278964/issues/336838/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336838/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336838","relative":"#336838","full":"gitlab-org/gitlab#336838"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6134,"epic":{"id":285044,"iid":6134,"title":"Decomposition:  Create observability for multiple database servers","url":"/groups/gitlab-org/-/epics/6134","group_id":9970,"human_readable_end_date":"Aug 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90811553,"iid":336837,"project_id":278964,"title":"Many WebHooks::LogExecutionWorker failures due to invalid WebHook record: Validation failed: Url is blocked: Requests to the local network are not allowed","description":"https://sentry.gitlab.net/gitlab/gitlabcom/issues/2716902/?referrer=gitlab_plugin\n\nThere are ~15k errors per day appearing in Sentry from `WebHooks::LogExecutionWorker`.\n\nThe exception happens when calling `WebHooks::LogExecutionService#execute` and the errors suggest that there are `WebHook` records with invalid URLs: \n\n```\nActiveRecord::RecordInvalid: Validation failed: Url is blocked: Requests to the local network are not allowed\n...","state":"closed","created_at":"2021-07-25T21:48:21.333Z","updated_at":"2022-11-24T18:22:26.653Z","closed_at":"2021-07-30T00:47:55.222Z","closed_by":{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"},"labels":["Category:Webhooks","backend","devops::manage","group::ecosystem [DEPRECATED]","section::dev","type::bug","workflow::verification"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"}],"author":{"id":402401,"username":"jobbot","name":"Bot","state":"active","avatar_url":"https://secure.gravatar.com/avatar/aaa6738f1ebf25404010884af511b0e7?s=80\u0026d=identicon","web_url":"https://gitlab.com/jobbot"},"type":"ISSUE","assignee":{"id":2702368,"username":".luke","name":"Luke Duncalfe","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2702368/avatar.png","web_url":"https://gitlab.com/.luke"},"user_notes_count":15,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336837","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336837","notes":"https://gitlab.com/api/v4/projects/278964/issues/336837/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336837/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336837","relative":"#336837","full":"gitlab-org/gitlab#336837"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6913,"epic":{"id":370101,"iid":6913,"title":"Integrations Error Budgets","url":"/groups/gitlab-org/-/epics/6913","group_id":9970},"iteration":null,"health_status":null},{"id":90750924,"iid":336799,"project_id":278964,"title":"Backend: Add MR event type to the API response to represent Merge Train response","description":"Update the GraphQL or REST endpoint (depending on whichever is used today) to return the `pipeline.merge_request_event_type` to the ~frontend so that the FE can handle the event_type accordingly","state":"closed","created_at":"2021-07-23T21:18:12.478Z","updated_at":"2022-06-17T19:05:38.250Z","closed_at":"2022-06-15T01:43:50.481Z","closed_by":{"id":9468400,"username":"marknuzzo","name":"Mark Nuzzo","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9468400/avatar.png","web_url":"https://gitlab.com/marknuzzo"},"labels":["Category:Merge Trains","Community contribution","Verify::P3","approaching-SLO","auto updated","backend","devops::verify","group::pipeline execution","missed-SLO","priority::2","section::ops","severity::2","type::bug","workflow::verification"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/73"},"assignees":[],"author":{"id":5709468,"username":"cheryl.li","name":"Cheryl Li","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5709468/avatar.png","web_url":"https://gitlab.com/cheryl.li"},"type":"ISSUE","assignee":null,"user_notes_count":20,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336799","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336799","notes":"https://gitlab.com/api/v4/projects/278964/issues/336799/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336799/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336799","relative":"#336799","full":"gitlab-org/gitlab#336799"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90750613,"iid":336797,"project_id":278964,"title":"Bulk delete package assets from the UI","description":"### Context\n\nYou use the GitLab Package Registry to publish packages to your project or group. Package assets are the related files that make up a given package. In https://gitlab.com/groups/gitlab-org/-/epics/5152, we are adding a new GitLab feature that will allow you to programmatically delete package assets. \n\n### Problem to solve\n\nThe policies are great, but there are times when a project Maintainer/Owner is perusing their project and wants to manually delete items. Why? As an example, there may be a package with hundreds of duplicate assets that are confusing and slowing down the troubleshooting process. \n\n### Implementation plan\n\n- Render checkboxes in first column of [package files](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/packages_and_registries/package_registry/components/details/package_files.vue) table \n- Add `Delete selected` button, enable button when assets are selected \u0026 disable otherwise.\n- On click of above button, show confirmation modal confirming number of assets that will be deleted. \n- Upon confirmation, use mutation implemented in https://gitlab.com/gitlab-org/gitlab/-/merge_requests/89927#gear-test to call the backend API.\n- In scenario all package assets are selected \u0026 there are no more assets, show confirmation modal confirming that package will be deleted \u0026 delete the package using a `deletePackage` mutation. \n\n### Proposal\n\nAdd the ability to bulk delete package assets from the user interface. \n\n#### Designs :arrow_down:","state":"closed","created_at":"2021-07-23T21:02:41.794Z","updated_at":"2022-09-19T18:28:11.602Z","closed_at":"2022-08-05T01:32:13.420Z","closed_by":{"id":11214192,"username":"rchanila","name":"Rahul Chanila","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/11214192/avatar.png","web_url":"https://gitlab.com/rchanila"},"labels":["Category:Package Registry","Deliverable","Package:P1","UX","devops::package","feature::addition","frontend","frontend-weight::2","group::package registry","section::ops","type::feature","workflow::verification"],"milestone":{"id":2453025,"iid":75,"group_id":9970,"title":"15.3","description":"","state":"active","created_at":"2022-02-03T22:28:50.229Z","updated_at":"2022-02-03T22:28:50.229Z","due_date":"2022-08-17","start_date":"2022-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/75"},"assignees":[{"id":11214192,"username":"rchanila","name":"Rahul Chanila","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/11214192/avatar.png","web_url":"https://gitlab.com/rchanila"}],"author":{"id":3799560,"username":"trizzi","name":"Tim Rizzi","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3799560/avatar.png","web_url":"https://gitlab.com/trizzi"},"type":"ISSUE","assignee":{"id":11214192,"username":"rchanila","name":"Rahul Chanila","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/11214192/avatar.png","web_url":"https://gitlab.com/rchanila"},"user_notes_count":52,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336797","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336797","notes":"https://gitlab.com/api/v4/projects/278964/issues/336797/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336797/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336797","relative":"#336797","full":"gitlab-org/gitlab#336797"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":8022,"epic":{"id":518276,"iid":8022,"title":"Bulk delete packages and package assets from the UI","url":"/groups/gitlab-org/-/epics/8022","group_id":9970,"human_readable_end_date":"Feb 17, 2023","human_readable_timestamp":"\u003cstrong\u003e1\u003c/strong\u003e month remaining"},"iteration":null,"health_status":null},{"id":90747898,"iid":336793,"project_id":278964,"title":"review-qa-* jobs do not run on scheduled master pipelines","description":"`review-qa-*` jobs are not run during scheduled pipelines even though `review-deploy` is run. See https://gitlab.com/gitlab-org/gitlab/-/pipelines/339665755 as an example.","state":"closed","created_at":"2021-07-23T19:14:44.270Z","updated_at":"2022-03-16T11:40:25.181Z","closed_at":"2021-08-19T01:27:44.944Z","closed_by":{"id":419655,"username":"markglenfletcher","name":"Mark Fletcher","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/419655/avatar.png","web_url":"https://gitlab.com/markglenfletcher"},"labels":["Engineering Productivity","ep::review-apps","maintenance::pipelines","priority::2","type::maintenance","workflow::in review"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":419655,"username":"markglenfletcher","name":"Mark Fletcher","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/419655/avatar.png","web_url":"https://gitlab.com/markglenfletcher"}],"author":{"id":4303148,"username":"kwiebers","name":"Kyle Wiebers","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4303148/avatar.png","web_url":"https://gitlab.com/kwiebers"},"type":"ISSUE","assignee":{"id":419655,"username":"markglenfletcher","name":"Mark Fletcher","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/419655/avatar.png","web_url":"https://gitlab.com/markglenfletcher"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336793","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336793","notes":"https://gitlab.com/api/v4/projects/278964/issues/336793/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336793/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336793","relative":"#336793","full":"gitlab-org/gitlab#336793"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90747609,"iid":336792,"project_id":278964,"title":"Handle rendering very large Markdown files better in the Wiki","description":"\u003c!-- This issue template can be used a great starting point for feature requests. The last section \"Release notes\" can be used as a summary of the feature and is also required if you want to have your release post blog MR auto generated using the release post item generator:  https://about.gitlab.com/handbook/marketing/blog/release-posts/#release-post-item-generator. The remaining sections are the backbone for every feature in GitLab. --\u003e\n\n### Release notes \n\n\u003c!-- What is the problem and solution you're proposing? This content sets the overall vision for the feature and serves as the release notes that will populate in various places, including the [release post blog](https://about.gitlab.com/releases/categories/releases/) and [Gitlab project releases](https://gitlab.com/gitlab-org/gitlab/-/releases). \" --\u003e\n\n### Problem to solve \n\nAs outlined in https://gitlab.com/gitlab-org/gitlab/-/issues/276401, very large (\\~2.5 MB, \\~11,000 lines) Markdown files can take a painfully long time to render in the Wiki. These files sometimes fail to load entirely, resulting in a `500` or `502` error. \n\nThe root of the problem is in the performance of the backend Banzai pipeline, the process used by the Wiki to render the Markdown for display. However, optimizations there will likely be complex and have diminishing returns for edge cases such as these. Still, it's not acceptable to wait 30+ seconds for a page to load. \n\n### Proposal \n\nAsynchronously load the Markdown content on the wiki page. Load the GitLab common UI first, followed by the wiki sidebar, then show the rendered Markdown content. \n\nA loading state for the rendered Markdown content should indicate that something is happening. \n\n\n\n\u003c!--- Use the following resources to find the appropriate labels:\n- https://gitlab.com/gitlab-org/gitlab/-/labels\n- https://about.gitlab.com/handbook/product/categories/features/\n\nConsider adding related issues and epics to this issue. You can also reference the Feature Proposal Template (https://gitlab.com/gitlab-org/gitlab/-/blob/master/.gitlab/issue_templates/Feature%20proposal%20-%20detailed.md) for additional details to consider adding to this issue. Additionally, as a data oriented organization, when your feature exits planning breakdown, consider adding the `What does success look like, and how can we measure that?` section.\n\nOther sections to consider adding: \n\n### Intended users\n\nWho will use this feature? If known, include any of the following: types of users (e.g. Developer), personas, or specific company roles (e.g. Release Manager). It's okay to write \"Unknown\" and fill this field in later.\n\nPersonas are described at https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/\n\n* [Cameron (Compliance Manager)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#cameron-compliance-manager)\n* [Parker (Product Manager)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#parker-product-manager)\n* [Delaney (Development Team Lead)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#delaney-development-team-lead)\n* [Presley (Product Designer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#presley-product-designer)\n* [Sasha (Software Developer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#sasha-software-developer)\n* [Devon (DevOps Engineer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#devon-devops-engineer)\n* [Sidney (Systems Administrator)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#sidney-systems-administrator)\n* [Sam (Security Analyst)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#sam-security-analyst)\n* [Rachel (Release Manager)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#rachel-release-manager) \n* [Alex (Security Operations Engineer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#alex-security-operations-engineer)\n* [Simone (Software Engineer in Test)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#simone-software-engineer-in-test)\n* [Allison (Application Ops)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#allison-application-ops) \n* [Priyanka (Platform Engineer)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#priyanka-platform-engineer)\n* [Dana (Data Analyst)](https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/#dana-data-analyst)\n\n\n### User experience goal\n\nWhat is the single user experience workflow this problem addresses? \nFor example, \"The user should be able to use the UI/API/.gitlab-ci.yml with GitLab to \u003cperform a specific task\u003e\"\nhttps://about.gitlab.com/handbook/engineering/ux/ux-research-training/user-story-mapping/ \n\n\n### Further details\n\nInclude use cases, benefits, goals, or any other details that will help us understand the problem better. \n\n### Permissions and Security\n\n\u003c!-- What permissions are required to perform the described actions? Are they consistent with the existing permissions as documented for users, groups, and projects as appropriate? Is the proposed behavior consistent between the UI, API, and other access methods (e.g. email replies)?\nConsider adding checkboxes and expectations of users with certain levels of membership https://docs.gitlab.com/ee/user/permissions.html\n* [ ] Add expected impact to members with no access (0)\n* [ ] Add expected impact to Guest (10) members\n* [ ] Add expected impact to Reporter (20) members\n* [ ] Add expected impact to Developer (30) members \n* [ ] Add expected impact to Maintainer (40) members\n* [ ] Add expected impact to Owner (50) members \n\n### Documentation\n\n See the Feature Change Documentation Workflow https://docs.gitlab.com/ee/development/documentation/workflow.html#for-a-product-change\n\n* Add all known Documentation Requirements in this section. See https://docs.gitlab.com/ee/development/documentation/workflow.html\n* If this feature requires changing permissions, update the permissions document. See https://docs.gitlab.com/ee/user/permissions.html \n\n### Availability \u0026 Testing\n\nThis section needs to be retained and filled in during the workflow planning breakdown phase of this feature proposal, if not earlier.\n\nWhat risks does this change pose to our availability? How might it affect the quality of the product? What additional test coverage or changes to tests will be needed? Will it require cross-browser testing?\n\nPlease list the test areas (unit, integration and end-to-end) that needs to be added or updated to ensure that this feature will work as intended. Please use the list below as guidance.\n* Unit test changes\n* Integration test changes\n* End-to-end test change\n\nSee the test engineering planning process and reach out to your counterpart Software Engineer in Test for assistance: https://about.gitlab.com/handbook/engineering/quality/test-engineering/#test-planning \n\n### What does success look like, and how can we measure that?\n\nDefine both the success metrics and acceptance criteria. Note that success metrics indicate the desired business outcomes, while acceptance criteria indicate when the solution is working correctly. If there is no way to measure success, link to an issue that will implement a way to measure this. \n\n### What is the type of buyer?\n\nWhat is the buyer persona for this feature? See https://about.gitlab.com/handbook/marketing/product-marketing/roles-personas/buyer-persona/\nIn which enterprise tier should this feature go? See https://about.gitlab.com/handbook/product/pricing/#three-tiers\n\n### Is this a cross-stage feature?\n\nCommunicate if this change will affect multiple Stage Groups or product areas. We recommend always start with the assumption that a feature request will have an impact into another Group. Loop in the most relevant PM and Product Designer from that Group to provide strategic support to help align the Group's broader plan and vision, as well as to avoid UX and technical debt. https://about.gitlab.com/handbook/product/#cross-stage-features --\u003e","state":"closed","created_at":"2021-07-23T19:07:10.677Z","updated_at":"2022-08-05T07:39:00.751Z","closed_at":"2022-03-26T11:29:43.278Z","closed_by":{"id":955795,"username":"fjsanpedro","name":"Francisco Javier L√≥pez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/955795/avatar.png","web_url":"https://gitlab.com/fjsanpedro"},"labels":["Deliverable","GitLab Free","UX","backend","devops::create","documentation","feature::enhancement","frontend","group::editor","quad-planning::complete-no-action","section::dev","type::feature"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/72"},"assignees":[{"id":955795,"username":"fjsanpedro","name":"Francisco Javier L√≥pez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/955795/avatar.png","web_url":"https://gitlab.com/fjsanpedro"},{"id":3540517,"username":"ealcantara","name":"Enrique Alc√°ntara","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3540517/avatar.png","web_url":"https://gitlab.com/ealcantara"}],"author":{"id":5212466,"username":"ericschurter","name":"Eric Schurter","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5212466/avatar.png","web_url":"https://gitlab.com/ericschurter"},"type":"ISSUE","assignee":{"id":955795,"username":"fjsanpedro","name":"Francisco Javier L√≥pez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/955795/avatar.png","web_url":"https://gitlab.com/fjsanpedro"},"user_notes_count":60,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336792","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":6,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 6 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336792","notes":"https://gitlab.com/api/v4/projects/278964/issues/336792/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336792/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336792","relative":"#336792","full":"gitlab-org/gitlab#336792"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6475,"epic":{"id":316322,"iid":6475,"title":"Q3FY22 Goal: Improve the reliability of Wiki","url":"/groups/gitlab-org/-/epics/6475","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90745705,"iid":336791,"project_id":278964,"title":"Improve unit test coverage for `base_token_spec.js`","description":"## Description\n\nThe spec [`base_token_spec.js`](https://gitlab.com/gitlab-org/gitlab/blob/43f2004e705a4eb0c3a546cd82502570d786f9bb/spec/frontend/vue_shared/components/filtered_search_bar/tokens/base_token_spec.js) is missing a bit of coverage which can be shown by inserting bugs into the [`base_token.vue`](https://gitlab.com/gitlab-org/gitlab/blob/b299ccfe5dde3ecb44b6138e5836db4122c391a9/app/assets/javascripts/vue_shared/components/filtered_search_bar/tokens/base_token.vue).\n\n## Context\n\nThe following discussion from !65817 should be addressed:\n\n- [ ] @pslaughter started a [discussion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/65817#note_634281179):  (+2 comments)\n\n    \u003e \u003e This is why we need a master condition on `\u003ctemplate #suggestions\u003e` to hide this in this case.\n    \u003e \n    \u003e Ahhh... I was hoping that wasn't the case :sweat_smile: \n    \u003e \n    \u003e So, this prevents us from showing something when we shouldn't, but if this condition ever broke, the worst case is that we wouldn't show anything when we should (which is a bit worse).\n    \u003e \n    \u003e Either way, this sounds like something we could ideally catch with unit tests, but it looks like the unit tests for `base_token.vue` are missing quite a bit of coverage. The unit test still passed with the following severe bug :grimacing: :\n    \u003e \n    \u003e ```patch\n    \u003e diff --git a/app/assets/javascripts/vue_shared/components/filtered_search_bar/tokens/base_token.vue b/app/assets/javascripts/vue_shared/components/filtered_search_bar/tokens/base_token.vue\n    \u003e index 30531145311..87a49133358 100644\n    \u003e --- a/app/assets/javascripts/vue_shared/components/filtered_search_bar/tokens/base_token.vue\n    \u003e +++ b/app/assets/javascripts/vue_shared/components/filtered_search_bar/tokens/base_token.vue\n    \u003e @@ -130,13 +130,7 @@ export default {\n    \u003e        return this.availableSuggestions.length;\n    \u003e      },\n    \u003e      showSuggestions() {\n    \u003e -      return (\n    \u003e -        this.showDefaultSuggestions ||\n    \u003e -        this.showRecentSuggestions ||\n    \u003e -        this.showPreloadedSuggestions ||\n    \u003e -        this.suggestionsLoading ||\n    \u003e -        this.showAvailableSuggestions\n    \u003e -      );\n    \u003e +      return false;\n    \u003e      },\n    \u003e    },\n    \u003e    watch: {\n    \u003e \n    \u003e ```\n    \u003e \n    \u003e Let's maybe add a comment for the coupling here to the template and also a follow-up to improve the testing. I can take care of this :smile:\n    \u003e \n    \u003e FWIW, it would be really nice if we could solve this problem a bit more holistically at the `filtered-search-bar` component level :thinking:\n\n## Investigation notes\n\nLooking at the test, we do some [significant stubbing](https://gitlab.com/gitlab-org/gitlab/blob/43f2004e705a4eb0c3a546cd82502570d786f9bb/spec/frontend/vue_shared/components/filtered_search_bar/tokens/base_token_spec.js#L21) and testing of [component internals](https://gitlab.com/gitlab-org/gitlab/blob/43f2004e705a4eb0c3a546cd82502570d786f9bb/spec/frontend/vue_shared/components/filtered_search_bar/tokens/base_token_spec.js#L108). I'm imagining we'll want to just write this component unit test from scratch using our best practice of testing I/O of component template :thinking:","state":"closed","created_at":"2021-07-23T17:58:29.781Z","updated_at":"2022-11-22T19:37:13.701Z","closed_at":"2022-03-09T15:10:06.471Z","closed_by":{"id":10218361,"username":"sgregory2","name":"Sean Gregory","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10218361/avatar.png","web_url":"https://gitlab.com/sgregory2"},"labels":["devops::manage","frontend","group::integrations","section::dev","test","type::maintenance"],"milestone":{"id":2204140,"iid":71,"group_id":9970,"title":"14.9","description":"","state":"active","created_at":"2021-08-26T19:11:46.841Z","updated_at":"2022-03-22T13:29:17.028Z","due_date":"2022-03-17","start_date":"2022-02-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/71"},"assignees":[{"id":10218361,"username":"sgregory2","name":"Sean Gregory","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10218361/avatar.png","web_url":"https://gitlab.com/sgregory2"}],"author":{"id":2233420,"username":"pslaughter","name":"Paul Slaughter","state":"active","avatar_url":"https://secure.gravatar.com/avatar/631b25421eb206ab44cb2793ef09d881?s=80\u0026d=identicon","web_url":"https://gitlab.com/pslaughter"},"type":"ISSUE","assignee":{"id":10218361,"username":"sgregory2","name":"Sean Gregory","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10218361/avatar.png","web_url":"https://gitlab.com/sgregory2"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336791","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 1 checklist item completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336791","notes":"https://gitlab.com/api/v4/projects/278964/issues/336791/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336791/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336791","relative":"#336791","full":"gitlab-org/gitlab#336791"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7402,"epic":{"id":422912,"iid":7402,"title":"Ecosystem::Integrations Test Gaps","url":"/groups/gitlab-org/-/epics/7402","group_id":9970,"human_readable_end_date":"Aug 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90735269,"iid":336767,"project_id":278964,"title":"DevOps Adoption - Replace mocked data with fixtures","description":"The following discussion from !66602 should be addressed:\n\n- [ ] @mrincon started a [discussion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/66602#note_634098736): \n\n    \u003e **Suggestion (non-blocking):** Keeping mock data manually up to date can lead to mistakes and integration problems. I suggest switching to fixtures in the next MR.\n    \u003e \n    \u003e https://docs.gitlab.com/ee/development/testing_guide/frontend_testing.html#graphql-query-fixtures","state":"closed","created_at":"2021-07-23T13:52:20.212Z","updated_at":"2021-10-28T13:54:54.901Z","closed_at":"2021-09-20T06:24:18.827Z","closed_by":{"id":3101551,"username":"blabuschagne","name":"Brandon Labuschagne","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3101551/avatar.png","web_url":"https://gitlab.com/blabuschagne"},"labels":["devops::manage","estimation::completed","frontend","group::optimize","maintenance::refactor","priority::4","section::dev","type::maintenance","workflow::staging"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":3101551,"username":"blabuschagne","name":"Brandon Labuschagne","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3101551/avatar.png","web_url":"https://gitlab.com/blabuschagne"}],"author":{"id":3101551,"username":"blabuschagne","name":"Brandon Labuschagne","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3101551/avatar.png","web_url":"https://gitlab.com/blabuschagne"},"type":"ISSUE","assignee":{"id":3101551,"username":"blabuschagne","name":"Brandon Labuschagne","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3101551/avatar.png","web_url":"https://gitlab.com/blabuschagne"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336767","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 1 checklist item completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336767","notes":"https://gitlab.com/api/v4/projects/278964/issues/336767/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336767/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336767","relative":"#336767","full":"gitlab-org/gitlab#336767"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":90734799,"iid":336765,"project_id":278964,"title":"A `db:migrate` should clearly document what DB is being used for running migrations","description":"Currently, migrations are run properly on many databases, but this is not straighforward to understand in what context they are being run. We should make it clearer.\n\nIf you run `db:migrate` today with two databases. This is what you will see:\n\n```plaintext\n== 20200905013247 AddGolangPackageMaxFileSizeToPlanLimits: migrating ==========\n-- add_column(:plan_limits, :golang_max_file_size, :bigint, {:default=\u003e104857600, :null=\u003efalse})\n   -\u003e 0.0023s\n== 20200905013247 AddGolangPackageMaxFileSizeToPlanLimits: migrated (0.0023s) =\n== 20200905013247 AddGolangPackageMaxFileSizeToPlanLimits: migrating ==========\n-- add_column(:plan_limits, :golang_max_file_size, :bigint, {:default=\u003e104857600, :null=\u003efalse})\n   -\u003e 0.0023s\n== 20200905013247 AddGolangPackageMaxFileSizeToPlanLimits: migrated (0.0023s) =\n```\n\nThis output does not indicate which database is being migrated for each part of the output. We could improve this by including somewhere `migrating on main:` or similar.","state":"closed","created_at":"2021-07-23T13:43:53.053Z","updated_at":"2022-06-30T02:04:49.279Z","closed_at":"2022-06-30T02:04:49.255Z","closed_by":{"id":2535118,"username":"tkuah","name":"Thong Kuah","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f7b51bdd49a4914d29504d7ff4c3f7b9?s=80\u0026d=identicon","web_url":"https://gitlab.com/tkuah"},"labels":["Category:Pods","ci-decomposition-followup","devops::data_stores","group::pods","section::enablement","type::maintenance"],"milestone":{"id":2453024,"iid":74,"group_id":9970,"title":"15.2","description":"","state":"active","created_at":"2022-02-03T22:24:46.818Z","updated_at":"2022-02-03T22:26:32.010Z","due_date":"2022-07-17","start_date":"2022-06-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/74"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336765","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336765","notes":"https://gitlab.com/api/v4/projects/278964/issues/336765/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336765/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336765","relative":"#336765","full":"gitlab-org/gitlab#336765"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7481,"epic":{"id":433545,"iid":7481,"title":"Decomposition: Many database support follow ups","url":"/groups/gitlab-org/-/epics/7481","group_id":9970,"human_readable_end_date":"Aug 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":90720022,"iid":336752,"project_id":278964,"title":"[Feature flag] Rollout of `ci_publish_pipeline_events`","description":"\u003c!-- Title suggestion: [Feature flag] Enable description of feature --\u003e\n\n## Summary\n\nThis issue is to rollout the [Gitlab::EventStore](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/34042) feature which allows Sidekiq workers to subscribe to domain events. During the rollout of this feature flag we are converting one worker to react to a domain event `Ci::PipelineCreatedEvent` and update the head pipeline for related merge requests.\n\n\u003c!-- Short description of what the feature is about and link to relevant other issues. --\u003e\n\n## Owners\n\n- Team: ~\"group::pipeline execution\" \n- Most appropriate slack channel to reach out to: `#g_pipeline-execution`\n- Best individual to reach out to: @fabiopitino \n- PM: @jheimbuck_gl \n\n## Stakeholders\n\n\u003c!--\nAre there any other stages or teams involved that need to be kept in the loop?\n\n- Name of a PM\n- The Support Team\n- The Delivery Team\n--\u003e\n\n## The Rollout Plan\n\n- Partial Rollout on GitLab.com with testing groups\n- Rollout on GitLab.com for a certain period (How long)\n- Percentage Rollout on GitLab.com\n- Rollout Feature for everyone as soon as it's ready\n\n\u003c!-- Which dashboards from https://dashboards.gitlab.net are most relevant? Sentry errors reports can also be useful to review --\u003e\n\n## Testing Groups/Projects/Users\n\n\u003c!-- If applicable, any groups/projects that are happy to have this feature turned on early. Some organizations may wish to test big changes they are interested in with a small subset of users ahead of time for example. --\u003e\n\n- `gitlab-org/gitlab` project\n- `gitlab-org`/`gitlab-com` groups\n- ...\n\n\n## Expectations\n\n### What are we expecting to happen?\n\nNo behaviour change. When a pipeline is created successfully any related merge requests should show the correct head pipeline.\n\n### What might happen if this goes wrong?\n\nWe could see merge requests not having a pipeline or not showing the correct pipeline as the head pipeline.\n\n### What can we monitor to detect problems with this?\n\n- Monitor [Sentry for any unexpected errors](https://sentry.gitlab.net/gitlab/gitlabcom/searches/5/?sort=new)\n- Monitor the [Sidekiq workers](https://dashboards.gitlab.net/d/sidekiq-worker-detail/sidekiq-worker-detail?orgId=1\u0026var-PROMETHEUS_DS=Global\u0026var-environment=gprd\u0026var-stage=main\u0026var-worker=MergeRequests::UpdateHeadPipelineWorker\u0026var-worker=UpdateHeadPipelineForMergeRequestWorker):\n    - `MergeRequests::UpdateHeadPipelineWorker` is the newly introduced worker that reacts to the domain event.\n    - `UpdateHeadPipelineForMergeRequestWorker` is the old worker that was being scheduled inline during the pipeline creation.\n\n## Rollout Steps\n\n### Rollout on non-production environments\n\n- [x] Ensure that the feature MRs have been deployed to non-production environments.\n    - [x] `/chatops run auto_deploy status \u003cmerge-commit-of-your-feature\u003e`\n- [x] Enable the feature globally on non-production environments.\n    - [x] `/chatops run feature set ci_publish_pipeline_events true --dev`\n    - [x] `/chatops run feature set ci_publish_pipeline_events true --staging`\n- [x] Verify that the feature works as expected. Posting the QA result in this issue is preferable.\n\n### Preparation before production rollout\n\n- [x] Ensure that the feature MRs have been deployed to both production and canary.\n    - [x] `/chatops run auto_deploy status \u003cmerge-commit-of-your-feature\u003e`\n- [ ] Check if the feature flag change needs to be accompanied with a\n  [change management issue](https://about.gitlab.com/handbook/engineering/infrastructure/change-management/#feature-flags-and-the-change-management-process).\n  Cross link the issue here if it does.\n- [x] Ensure that you or a representative in development can be available for at least 2 hours after feature flag updates in production.\n  If a different developer will be covering, or an exception is needed, please inform the oncall SRE by using the `@sre-oncall` Slack alias.\n- [x] Ensure that documentation has been updated ([More info](https://docs.gitlab.com/ee/development/documentation/feature_flags.html#features-that-became-enabled-by-default)).\n- [x] Announce on [the feature issue](ISSUE LINK) an estimated time this will be enabled on GitLab.com.\n- [ ] If the feature might impact the user experience, notify `#support_gitlab-com` and your team channel ([more guidance when this is necessary in the dev docs](https://docs.gitlab.com/ee/development/feature_flags/controls.html#communicate-the-change)).\n- [x] If the feature flag in code has [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), enable it on GitLab.com for [testing groups/projects](#testing-groupsprojectsusers).\n    - [x] `/chatops run feature set --project=\u003cactor\u003e ci_publish_pipeline_events true`\n- [x] Verify that the feature works as expected. Posting the QA result in this issue is preferable.\n\n### Global rollout on production\n\n- [x] [Incrementally roll out](https://docs.gitlab.com/ee/development/feature_flags/controls.html#process) the feature.\n  - If the feature flag in code has [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), perform **actor-based** rollout.\n    - [x] `/chatops run feature set ci_publish_pipeline_events \u003crollout-percentage\u003e --actors`\n  - If the feature flag in code does **NOT** have [an actor](https://docs.gitlab.com/ee/development/feature_flags/#feature-actors), perform time-based rollout (**random** rollout).\n    - [ ] `/chatops run feature set ci_publish_pipeline_events \u003crollout-percentage\u003e`\n  - Enable the feature globally on production environment.\n    - [x] `/chatops run feature set ci_publish_pipeline_events true`\n- [x] Announce on [the feature issue](ISSUE LINK) that the feature has been globally enabled.\n- [x] Wait for [at least one day for the verification term](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release).\n\n### (Optional) Release the feature with the feature flag\n\nIf you're still unsure whether the feature is [deemed stable](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release)\nbut want to release it in the current milestone, you can change the default state of the feature flag to be enabled.\nTo do so, follow these steps:\n\n- [ ] Create a merge request with the following changes. Ask for review and merge it.\n    - [ ] Set the `default_enabled` attribute in [the feature flag definition](https://docs.gitlab.com/ee/development/feature_flags/#feature-flag-definition-and-validation) to `true`.\n    - [ ] Create [a changelog entry](https://docs.gitlab.com/ee/development/feature_flags/#changelog).\n- [ ] Ensure that the default-enabling MR has been deployed to both production and canary.\n      If the merge request was deployed before [the code cutoff](https://about.gitlab.com/handbook/engineering/releases/#self-managed-releases-1),\n      the feature can be officially announced in a release blog post.\n    - [ ] `/chatops run auto_deploy status \u003cmerge-commit-of-default-enabling-mr\u003e`\n- [ ] Close [the feature issue](ISSUE LINK) to indicate the feature will be released in the current milestone.\n- [ ] Set the next milestone to this rollout issue for scheduling [the flag removal](#release-the-feature).\n- [ ] (Optional) You can create a separate issue for scheduling the steps below to [Release the feature](#release-the-feature).\n    - [ ] Set the title to \"[Feature flag] Cleanup `ci_publish_pipeline_events`\".\n    - [ ] Execute the `/copy_metadata \u003cthis-rollout-issue-link\u003e` quick action to copy the labels from this rollout issue.\n    - [ ] Link this rollout issue as a related issue.\n    - [ ] Close this rollout issue.\n\n**WARNING:** This approach has the downside that it makes it difficult for us to\n[clean up](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up) the flag.\nFor example, on-premise users could disable the feature on their GitLab instance. But when you\nremove the flag at some point, they suddenly see the feature as enabled and they can't roll it back\nto the previous behavior. To avoid this potential breaking change, use this approach only for urgent\nmatters.\n\n### Release the feature\n\nAfter the feature has been [deemed stable](https://about.gitlab.com/handbook/product-development-flow/feature-flag-lifecycle/#including-a-feature-behind-feature-flag-in-the-final-release),\nthe [clean up](https://docs.gitlab.com/ee/development/feature_flags/controls.html#cleaning-up)\nshould be done as soon as possible to permanently enable the feature and reduce complexity in the\ncodebase.\n\n\u003c!-- The checklist here is to help stakeholders keep track of the feature flag status --\u003e\n- [x] Create a merge request to remove `ci_publish_pipeline_events` feature flag. Ask for review and merge it.\n    - [x] Remove all references to the feature flag from the codebase.\n    - [x] Remove the YAML definitions for the feature from the repository.\n    - [x] Create [a changelog entry](https://docs.gitlab.com/ee/development/feature_flags/#changelog).\n- [x] Ensure that the cleanup MR has been deployed to both production and canary.\n      If the merge request was deployed before [the code cutoff](https://about.gitlab.com/handbook/engineering/releases/#self-managed-releases-1),\n      the feature can be officially announced in a release blog post.\n    - [x] `/chatops run auto_deploy status \u003cmerge-commit-of-cleanup-mr\u003e`\n- [x] Close [the feature issue](ISSUE LINK) to indicate the feature will be released in the current milestone.\n- [x] Clean up the feature flag from all environments by running these chatops command in `#production` channel:\n    - [x] `/chatops run feature delete ci_publish_pipeline_events --dev`\n    - [x] `/chatops run feature delete ci_publish_pipeline_events --staging`\n    - [x] `/chatops run feature delete ci_publish_pipeline_events`\n- [x] Close this rollout issue.\n\n## Rollback Steps\n\n- [ ] This feature can be disabled by running the following Chatops command:\n\n```\n/chatops run feature set ci_publish_pipeline_events false\n```","state":"closed","created_at":"2021-07-23T09:26:37.570Z","updated_at":"2022-01-19T08:10:01.598Z","closed_at":"2022-01-19T08:10:01.578Z","closed_by":{"id":695467,"username":"fabiopitino","name":"Fabio Pitino","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f0db032076c54065b10b3efdfd175e6c?s=80\u0026d=identicon","web_url":"https://gitlab.com/fabiopitino"},"labels":["Category:Continuous Integration","auto updated","backend","devops::verify","feature flag","group::pipeline execution","section::ops","type::maintenance","workflow::production"],"milestone":{"id":2156369,"iid":68,"group_id":9970,"title":"14.7","description":"","state":"active","created_at":"2021-07-21T17:39:41.786Z","updated_at":"2021-07-21T17:39:41.786Z","due_date":"2022-01-17","start_date":"2021-12-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/68"},"assignees":[{"id":695467,"username":"fabiopitino","name":"Fabio Pitino","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f0db032076c54065b10b3efdfd175e6c?s=80\u0026d=identicon","web_url":"https://gitlab.com/fabiopitino"}],"author":{"id":695467,"username":"fabiopitino","name":"Fabio Pitino","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f0db032076c54065b10b3efdfd175e6c?s=80\u0026d=identicon","web_url":"https://gitlab.com/fabiopitino"},"type":"ISSUE","assignee":{"id":695467,"username":"fabiopitino","name":"Fabio Pitino","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f0db032076c54065b10b3efdfd175e6c?s=80\u0026d=identicon","web_url":"https://gitlab.com/fabiopitino"},"user_notes_count":10,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab/-/issues/336752","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":47,"completed_count":31},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"31 of 47 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/278964/issues/336752","notes":"https://gitlab.com/api/v4/projects/278964/issues/336752/notes","award_emoji":"https://gitlab.com/api/v4/projects/278964/issues/336752/award_emoji","project":"https://gitlab.com/api/v4/projects/278964","closed_as_duplicate_of":null},"references":{"short":"#336752","relative":"#336752","full":"gitlab-org/gitlab#336752"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":"on_track"}]