[{"id":13305380,"iid":4698,"project_id":1304532,"title":"pgbouncer in GPRD has an invalid user in SHOW POOLS","description":"While testing the pgbouncer exporter against GPRD, I noticed it was failing hard here:\n\n```golang\ncolumn name is user, data is Ë‡Ë‡Ë‡Ë‡C\npanic: label value \"\\xff\\xff\\xff\\xffC\" is not valid UTF-8\n\ngoroutine 19 [running]:\ngithub.com/prometheus/client_golang/prometheus.MustNewConstMetric(0xc420147500, 0x2, 0x0, 0xc420180340, 0x2, 0x2, 0x0, 0x0)\n        /home/stanhu/go/src/github.com/prometheus/client_golang/prometheus/value.go:98 +0xb0\nmain.queryNamespaceMapping(0xc42012c600, 0xc420110c80, 0x8f7bd9, 0x5, 0xc42011eed0, 0x0, 0x0, 0x0, 0x0, 0x0)\n        /home/stanhu/go/src/github.com/larseen/pgbouncer_exporter/collector.go:146 +0xa51\nmain.queryNamespaceMappings(0xc42012c600, 0xc420110c80, 0xc42011eba0, 0xc420116e60)\n        /home/stanhu/go/src/github.com/larseen/pgbouncer_exporter/collector.go:229 +0x213\nmain.(*Exporter).scrape(0xc42015c900, 0xc42012c600)\n        /home/stanhu/go/src/github.com/larseen/pgbouncer_exporter/collector.go:295 +0x18c\nmain.(*Exporter).Collect(0xc42015c900, 0xc42012c600)\n        /home/stanhu/go/src/github.com/larseen/pgbouncer_exporter/collector.go:276 +0x3c\nmain.(*Exporter).Describe(0xc42015c900, 0xc42012c5a0)\n        /home/stanhu/go/src/github.com/larseen/pgbouncer_exporter/collector.go:269 +0xb0\ngithub.com/prometheus/client_golang/prometheus.(*Registry).Register.func1(0xb09b80, 0xc42015c900, 0xc42012c5a0)\n        /home/stanhu/go/src/github.com/prometheus/client_golang/prometheus/registry.go:250 +0x3b\ncreated by github.com/prometheus/client_golang/prometheus.(*Registry).Register\n```\n\nIf you look at `SHOW POOLS`, you see the `C` under `gitlabhq_production_sidekiq`. I haven't checked production yet, but I wonder where this garbage comes from:\n\n```sql\nroot@pgbouncer-01-db-gprd.c.gitlab-production.internal:/tmp# sudo -u gitlab-psql /opt/gitlab/embedded/bin/psql -h /tmp -p 6432 -U pgbouncer -d pgbouncer\npsql (9.6.5, server 1.7.2/bouncer)\nType \"help\" for help.\n\npgbouncer=# show pools;\n          database           |      user      | cl_active | cl_waiting | sv_active | sv_idle | sv_used | sv_tested | sv_login | maxwait |  pool_mode  \n-----------------------------+----------------+-----------+------------+-----------+---------+---------+-----------+----------+---------+-------------\n gitlabhq_production         | chatops        |         0 |          0 |         0 |       0 |       0 |         0 |        0 |       0 | transaction\n gitlabhq_production         | gitlab         |       274 |          0 |         0 |       4 |       1 |         0 |        0 |       0 | transaction\n gitlabhq_production         | gitlab_geo_fdw |        21 |          0 |         7 |       6 |       4 |         0 |        0 |       0 | transaction\n gitlabhq_production         | pgbouncer      |         0 |          0 |         0 |       1 |       0 |         0 |        0 |       0 | transaction\n gitlabhq_production_sidekiq | gitlab         |         0 |          0 |         0 |       0 |       0 |         0 |        0 |       0 | transaction\n gitlabhq_production_sidekiq | pgbouncer      |         0 |          0 |         0 |       0 |       0 |         0 |        0 |       0 | transaction\n gitlabhq_production_sidekiq | C              |         0 |          0 |         0 |       0 |       0 |         0 |        0 |       0 | transaction\n pgbouncer                   | pgbouncer      |         2 |          0 |         0 |       0 |       0 |         0 |        0 |       0 | statement\n(8 rows)\n```","state":"closed","created_at":"2018-05-01T21:04:38.048Z","updated_at":"2022-08-02T06:08:27.258Z","closed_at":"2022-08-02T06:08:27.230Z","closed_by":{"id":1786152,"username":"gitlab-bot","name":"ðŸ¤– GitLab Bot ðŸ¤–","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1786152/avatar.png","web_url":"https://gitlab.com/gitlab-bot"},"labels":["Database [pl]","Postmigration","Service::Postgres","priority::2"],"milestone":null,"assignees":[],"author":{"id":64248,"username":"stanhu","name":"Stan Hu","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/64248/stanhu.jpg","web_url":"https://gitlab.com/stanhu"},"type":"ISSUE","assignee":null,"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4698","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4698","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4698/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4698/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4698","relative":"#4698","full":"gitlab-com/gl-infra/reliability#4698"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305236,"iid":4684,"project_id":1304532,"title":"Migrate Artifacts from S3 to GCS","description":"We need to migrate artifact object storage from S3 to GCS. This has the added benefit of allowing `direct_upload` of artifacts. Much of the work of this has already been done. We sync the GCS bucket with S3 daily so everything is kept up do date. The process for completing the migration should be as follows:\n\n- [ ] Disable `direct_upload` of artifacts\n- [ ] Run a final sync between S3 and GCS of the artifacts bucket\n- [ ] Change storage location in `gitlab.rb` to point to GCS\n- [ ] Verify artifacts still work\n- [ ] Enable `direct_upload` of artifacts once more\n- [ ] migrate the artifacts that landed on disk to object storage\n\ncc/ @ayufan @jarv @dosuken123","state":"closed","created_at":"2018-04-27T16:11:37.403Z","updated_at":"2019-12-26T16:27:32.133Z","closed_at":"2019-04-20T02:09:50.701Z","closed_by":{"id":429540,"username":"ahanselka","name":"Alex Hanselka","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/429540/avatar.png","web_url":"https://gitlab.com/ahanselka"},"labels":["Cloud Spend","Executing","GCP Migration","Infrastructure","Object Storage","Postmigration","Savings-Estimate::$100k - $200k / QTR","Service::Web","TechnicalDebt","priority::1"],"milestone":{"id":840628,"iid":13,"group_id":1112072,"title":"DS Team 2019 Week 15","description":"","state":"closed","created_at":"2019-04-05T23:03:08.211Z","updated_at":"2019-04-22T22:57:03.216Z","due_date":"2019-04-20","start_date":"2019-04-07","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/13"},"assignees":[{"id":429540,"username":"ahanselka","name":"Alex Hanselka","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/429540/avatar.png","web_url":"https://gitlab.com/ahanselka"}],"author":{"id":429540,"username":"ahanselka","name":"Alex Hanselka","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/429540/avatar.png","web_url":"https://gitlab.com/ahanselka"},"type":"ISSUE","assignee":{"id":429540,"username":"ahanselka","name":"Alex Hanselka","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/429540/avatar.png","web_url":"https://gitlab.com/ahanselka"},"user_notes_count":40,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4684","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":6,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4684","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4684/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4684/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4684","relative":"#4684","full":"gitlab-com/gl-infra/reliability#4684"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13304901,"iid":4673,"project_id":1304532,"title":"Migrate Sentry to GCP","description":"Once the primary failover is complete, migrate Sentry from Azure to GCP.","state":"closed","created_at":"2018-04-27T11:41:14.532Z","updated_at":"2018-09-21T22:43:21.998Z","closed_at":"2018-09-14T14:08:00.346Z","closed_by":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"labels":["Postmigration","moved 1"],"milestone":{"id":637228,"iid":48,"project_id":1304532,"title":"2018-09-22 Completed Milestone","description":"","state":"closed","created_at":"2018-09-04T16:15:06.230Z","updated_at":"2018-10-01T19:15:08.297Z","due_date":"2018-09-22","start_date":"2018-09-09","expired":true,"web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/milestones/48"},"assignees":[{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"}],"author":{"id":895869,"username":"andrewn","name":"Andrew Newdigate","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/895869/avatar.png","web_url":"https://gitlab.com/andrewn"},"type":"ISSUE","assignee":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"user_notes_count":14,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4673","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4673","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4673/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4673/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4673","relative":"#4673","full":"gitlab-com/gl-infra/reliability#4673"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305333,"iid":4690,"project_id":1304532,"title":"Create a canary in gprd/gstg","description":"We don't have a canary environment in gprd yet and we probably should. I think it would be nice to get this done pre failover if possible but for now it will be put in the post-failover milestone.\n\nHere is a summary of the current proposal:\n\n- Do not use a new chef environment, use the existing gprd/gstg environments\n- Have the option to create a gstg cny so we can test configuration changes on gstg before gprd\n- The cny names will be `{web,api,git}-cny-##-sv-{gprd,gstg}`\n- First iteration will just have a single web node, this means we will have the following two new vms\n  - web-cny-01-sv-gstg.c.gitlab-staging-1.internal\n  - web-cny-01-sv-gprd.c.gitlab-production.internal\n- We should run migrations for the canary deploy\n- To identify them in prometheus we will use a new tag stage=canary\n- Will need to make some takeoff adjustments since canary is no longer its own environment\n- Once we have the canary accepting traffic with a cookie set in the browser, we will add weights to the haproxy configuration so that a small percentage of production traffic will go to the canary\n\nFor the work here is what will need to be done:\n\n- [x] Create new shared terraform config for canary\n- [x] Create new chef configuration for the canary roles (gstg, then gprd)\n- [x] Modify takeoff so that we can deploy to canary\n- [x] Create canary specific dashboards\n- [ ] \u003cs\u003eCreate canary specific alerts\u003c/s\u003e Will track this separately, when we start moving some prod traffic to the VM.\n- [ ] \u003cs\u003eUpdate the gitlab-haproxy config so that some production traffic is directed to the canary (this doesn't need to be in the first iteration)\u003c/s\u003e We will track this separately.\n\n\n\n","state":"closed","created_at":"2018-04-25T07:52:10.853Z","updated_at":"2019-07-08T20:01:07.635Z","closed_at":"2018-09-03T12:54:10.719Z","closed_by":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"labels":["Planning","Postmigration","moved 1","priority::2"],"milestone":{"id":629184,"iid":47,"project_id":1304532,"title":"2018-09-08 Completed Milestone","description":"","state":"closed","created_at":"2018-08-24T09:10:56.034Z","updated_at":"2018-09-21T22:56:29.019Z","due_date":"2018-09-08","start_date":"2018-08-26","expired":true,"web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/milestones/47"},"assignees":[{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"}],"author":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"type":"ISSUE","assignee":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"user_notes_count":13,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4690","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":6,"completed_count":4},"weight":4,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4690","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4690/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4690/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4690","relative":"#4690","full":"gitlab-com/gl-infra/reliability#4690"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305386,"iid":4699,"project_id":1304532,"title":"monitoring and metric aggregation for the CI/CD infrastructure in GCP","description":"There might be some additional work to bring in the prometheus servers that the CI/CD team uses so that we are at parity to what was working in Azure.\n\nIn general, it would be better if we could put prometheus servers behind IAP like the current ones and also add them to the prd chef environment.\n\n\n/cc @tmaczukin","state":"closed","created_at":"2018-04-24T16:43:37.664Z","updated_at":"2022-10-28T19:39:21.546Z","closed_at":"2022-10-28T19:39:21.526Z","closed_by":{"id":10167447,"username":"afappiano","name":"Anthony Fappiano","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10167447/avatar.png","web_url":"https://gitlab.com/afappiano"},"labels":["Postmigration","Service::Monitoring-Other","ci","priority::3"],"milestone":null,"assignees":[],"author":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"type":"ISSUE","assignee":null,"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4699","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4699","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4699/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4699/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4699","relative":"#4699","full":"gitlab-com/gl-infra/reliability#4699"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305349,"iid":4692,"project_id":1304532,"title":"Update general information about gitlab.com configuration","description":"This page https://docs.gitlab.com/ee/user/gitlab_com/ appears to be the place where we document general information about gitlab.com settings.\n\n- [ ] Update gitlab.com settings\n- [ ] Update environments documentation on about.gitlab.com","state":"closed","created_at":"2018-04-20T08:59:09.208Z","updated_at":"2022-08-02T06:08:29.187Z","closed_at":"2022-08-02T06:08:29.178Z","closed_by":{"id":1786152,"username":"gitlab-bot","name":"ðŸ¤– GitLab Bot ðŸ¤–","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1786152/avatar.png","web_url":"https://gitlab.com/gitlab-bot"},"labels":["Postmigration","documentation","priority::3"],"milestone":null,"assignees":[],"author":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4692","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":2,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4692","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4692/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4692/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4692","relative":"#4692","full":"gitlab-com/gl-infra/reliability#4692"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305238,"iid":4685,"project_id":1304532,"title":"Add config for a sentry node in gstg","description":"gprd doesn't seem to have such config.","state":"closed","created_at":"2018-04-12T10:22:36.550Z","updated_at":"2018-08-28T18:01:00.552Z","closed_at":"2018-08-28T18:01:00.528Z","closed_by":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"labels":["Postmigration","staging"],"milestone":null,"assignees":[],"author":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"type":"ISSUE","assignee":null,"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4685","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4685","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4685/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4685/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4685","relative":"#4685","full":"gitlab-com/gl-infra/reliability#4685"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305171,"iid":4681,"project_id":1304532,"title":"Drop InfluxDB entirely","description":"This issue is to capture the effort to remove InfluxDB from our infrastructure once our Prometheus metrics are good enough, and obviously post GCP-migration.\n\nMore conversation is here: https://gitlab.com/gitlab-com/migration/issues/145#note_55954264\n\nCheck the tickbox if you're satisfied....\n\n- [ ] **CI Runners**: https://dashboards.gitlab.net/dashboards/f/bpcbFeIiz/ci-runners-service cc @tmaczukin\n- [ ] **GCP Migration Project** https://dashboards.gitlab.net/dashboards/f/vtC8ceSmk/gcp-migration-project cc @andrewn\n- [ ] **Gitaly** https://dashboards.gitlab.net/dashboards/f/SRXyrrSmk/gitaly-service cc @tommy.morgan\n- [ ] **GitLab Rails** https://dashboards.gitlab.net/dashboards/f/KuFJt6Iiz/gitlab-rails-service cc @smcgivern\n- [ ] **HA Proxy** https://dashboards.gitlab.net/dashboards/f/N9YSt6Siz/haproxy-service cc @northrup\n- [ ] **Operations** https://dashboards.gitlab.net/dashboards/f/KN7OgCSiz/operations cc @dawsmith\n- [x] **Pages** https://dashboards.gitlab.net/dashboards/f/v2ZhpeSik/pages-service cc @nick.thomas\n- [x] **Postgres** https://dashboards.gitlab.net/dashboards/f/u3xKRjIiz/postgres-service cc @yorickpeterse\n- [ ] **Prometheus** https://dashboards.gitlab.net/dashboards/f/5dsvpeImz/prometheus-service cc @bjk-gitlab\n- [ ] **Redis** https://dashboards.gitlab.net/dashboards/f/D5R0peIik/redis-service cc @jarv\n- [x] **Workhorse** https://dashboards.gitlab.net/dashboards/f/_OKcteIiz/workhorse-service cc @jacobvosmaer-gitlab\n\nFYI, several other folders exist:\n\n- **Broken** https://dashboards.gitlab.net/dashboards/f/cYFN9rSmz/broken Dashboards that rely on Influxdb and are not currently working\n\n- **Once-off** https://dashboards.gitlab.net/dashboards/f/kGgx9rIiz/once-off Once off dashboards\n\n- ~~**Archives** https://dashboards.gitlab.net/dashboards/f/phfSe3Iiz/archived @northrup and @toon's manually migrated dashboards (first attempt)~~ (cleaned and deleted)\n\n\n/cc @sytses @jarv @andrewn @jtevnan @northrup @ilyaf @ahanselka","state":"closed","created_at":"2018-04-09T18:26:44.837Z","updated_at":"2022-11-23T09:46:37.569Z","closed_at":"2021-08-18T04:10:07.437Z","closed_by":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"labels":["Postmigration","priority::2"],"milestone":null,"assignees":[{"id":895869,"username":"andrewn","name":"Andrew Newdigate","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/895869/avatar.png","web_url":"https://gitlab.com/andrewn"}],"author":{"id":1641321,"username":"edjdev","name":"Eric Johnson","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1641321/avatar.png","web_url":"https://gitlab.com/edjdev"},"type":"ISSUE","assignee":{"id":895869,"username":"andrewn","name":"Andrew Newdigate","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/895869/avatar.png","web_url":"https://gitlab.com/andrewn"},"user_notes_count":59,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4681","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":11,"completed_count":3},"weight":4,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4681","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4681/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4681/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4681","relative":"#4681","full":"gitlab-com/gl-infra/reliability#4681"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305343,"iid":4691,"project_id":1304532,"title":"Lower the size of the besteffort nodes","description":"The current `besteffort` sidekiq nodes on GPRD are absolutely massive. They can and should be scaled down pretty substantially.","state":"closed","created_at":"2018-04-04T16:58:58.147Z","updated_at":"2019-07-08T20:03:08.811Z","closed_at":"2018-08-14T21:03:38.155Z","closed_by":{"id":429540,"username":"ahanselka","name":"Alex Hanselka","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/429540/avatar.png","web_url":"https://gitlab.com/ahanselka"},"labels":["GCP Migration","Postmigration","priority::3"],"milestone":null,"assignees":[{"id":429540,"username":"ahanselka","name":"Alex Hanselka","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/429540/avatar.png","web_url":"https://gitlab.com/ahanselka"}],"author":{"id":429540,"username":"ahanselka","name":"Alex Hanselka","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/429540/avatar.png","web_url":"https://gitlab.com/ahanselka"},"type":"ISSUE","assignee":{"id":429540,"username":"ahanselka","name":"Alex Hanselka","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/429540/avatar.png","web_url":"https://gitlab.com/ahanselka"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4691","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4691","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4691/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4691/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4691","relative":"#4691","full":"gitlab-com/gl-infra/reliability#4691"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305399,"iid":4700,"project_id":1304532,"title":"fluentd parse error on nfs-09 for gitaly logs","description":"Maybe on other servers too, wi'll look into it on monday.\n\n```\n2018-03-24 21:16:54 +0000 [warn]: #0 dump an error event: error_class=Fluent::Plugin::Parser::ParserError error=\"parse failed Empty input at line 1, column 1 [parse.c:926] in 'SCHED 214332569ms: gomaxprocs=8 idleprocs=8 threads=236 spinningthreads=0 idlethreads=220 runqueue=0 [0 0 0 0 0 0 0 0]\" location=\"/opt/td-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.0.2/lib/fluent/plugin/filter_parser.rb:107:in `rescue in filter_with_time'\" tag=\"gitaly\" time=#\u003cFluent::EventTime:0x00007faa965f3050 @sec=1521926214, @nsec=662940000\u003e record={\"ident\"=\u003e\"gitaly\", \"message\"=\u003e\"SCHED 214332569ms: gomaxprocs=8 idleprocs=8 threads=236 spinningthreads=0 idlethreads=220 runqueue=0 [0 0 0 0 0 0 0 0]\"}\n2018-03-24 21:16:55 +0000 [warn]: #0 dump an error event: error_class=Fluent::Plugin::Parser::ParserError error=\"parse failed Empty input at line 1, column 1 [parse.c:926] in 'SCHED 214333575ms: gomaxprocs=8 idleprocs=7 threads=236 spinningthreads=0 idlethreads=220 runqueue=0 [0 0 0 0 0 0 0 0]\" location=\"/opt/td-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.0.2/lib/fluent/plugin/filter_parser.rb:107:in `rescue in filter_with_time'\" tag=\"gitaly\" time=#\u003cFluent::EventTime:0x00007faad0c13a68 @sec=1521926215, @nsec=669740000\u003e record={\"ident\"=\u003e\"gitaly\", \"message\"=\u003e\"SCHED 214333575ms: gomaxprocs=8 idleprocs=7 threads=236 spinningthreads=0 idlethreads=220 runqueue=0 [0 0 0 0 0 0 0 0]\"}\n2018-03-24 21:16:56 +0000 [warn]: #0 dump an error event: error_class=Fluent::Plugin::Parser::ParserError error=\"parse failed Empty input at line 1, column 1 [parse.c:926] in 'SCHED 214334576ms: gomaxprocs=8 idleprocs=8 threads=236 spinningthreads=0 idlethreads=222 runqueue=0 [0 0 0 0 0 0 0 0]\" location=\"/opt/td-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.0.2/lib/fluent/plugin/filter_parser.rb:107:in `rescue in filter_with_time'\" tag=\"gitaly\" time=#\u003cFluent::EventTime:0x00007faabbfea3b8 @sec=1521926216, @nsec=670590000\u003e record={\"ident\"=\u003e\"gitaly\", \"message\"=\u003e\"SCHED 214334576ms: gomaxprocs=8 idleprocs=8 threads=236 spinningthreads=0 idlethreads=222 runqueue=0 [0 0 0 0 0 0 0 0]\"}\n2018-03-24 21:16:57 +0000 [warn]: #0 dump an error event: error_class=Fluent::Plugin::Parser::ParserError error=\"parse failed Empty input at line 1, column 1 [parse.c:926] in 'SCHED 214335582ms: gomaxprocs=8 idleprocs=8 threads=236 spinningthreads=0 idlethreads=220 runqueue=0 [0 0 0 0 0 0 0 0]\" location=\"/opt/td-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.0.2/lib/fluent/plugin/filter_parser.rb:107:in `rescue in filter_with_time'\" tag=\"gitaly\" time=#\u003cFluent::EventTime:0x00007faad0848f28 @sec=1521926217, @nsec=676350000\u003e record={\"ident\"=\u003e\"gitaly\", \"message\"=\u003e\"SCHED 214335582ms: gomaxprocs=8 idleprocs=8 threads=236 spinningthreads=0 idlethreads=220 runqueue=0 [0 0 0 0 0 0 0 0]\"}\n2018-03-24 21:16:58 +0000 [warn]: #0 dump an error event: error_class=Fluent::Plugin::Parser::ParserError error=\"parse failed Empty input at line 1, column 1 [parse.c:926] in 'SCHED 214336583ms: gomaxprocs=8 idleprocs=8 threads=236 spinningthreads=0 idlethreads=222 runqueue=0 [0 0 0 0 0 0 0 0]\" location=\"/opt/td-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.0.2/lib/fluent/plugin/filter_parser.rb:107:in `rescue in filter_with_time'\" tag=\"gitaly\" time=#\u003cFluent::EventTime:0x00007faad0733f98 @sec=1521926218, @nsec=676960000\u003e record={\"ident\"=\u003e\"gitaly\", \"message\"=\u003e\"SCHED 214336583ms: gomaxprocs=8 idleprocs=8 threads=236 spinningthreads=0 idlethreads=222 runqueue=0 [0 0 0 0 0 0 0 0]\"}\n2018-03-24 21:16:59 +0000 [warn]: #0 dump an error event: error_class=Fluent::Plugin::Parser::ParserError error=\"parse failed Empty input at line 1, column 1 [parse.c:926] in 'SCHED 214337584ms: gomaxprocs=8 idleprocs=8 threads=236 spinningthreads=0 idlethreads=222 runqueue=0 [0 0 0 0 0 0 0 0]\" location=\"/opt/td-agent/embedded/lib/ruby/gems/2.4.0/gems/fluentd-1.0.2/lib/fluent/plugin/filter_parser.rb:107:in `rescue in filter_with_time'\" tag=\"gitaly\" time=#\u003cFluent::EventTime:0x00007faada3da9c8 @sec=1521926219, @nsec=678220000\u003e record={\"ident\"=\u003e\"gitaly\", \"message\"=\u003e\"SCHED 214337584ms: gomaxprocs=8 idleprocs=8 threads=236 spinningthreads=0 idlethreads=222 runqueue=0 [0 0 0 0 0 0 0 0]\"}\n```\n\n/cc @gl-infra \n\nFor now, I'll just clean up the tf-agent logs. Longterm, we need visibility and alerting into fluentd state which we never have time to do :disappointed:  \n\n```\n$\u003e be knife ssh 'roles:gitlab-base-stor-nfs' 'sudo du -sh /var/log/td-agent' | sort\nnfs-file-01.stor.gitlab.com 39M /var/log/td-agent\nnfs-file-02.stor.gitlab.com 19M /var/log/td-agent\nnfs-file-03.stor.gitlab.com 36M /var/log/td-agent\nnfs-file-04.stor.gitlab.com 20M /var/log/td-agent\nnfs-file-05.stor.gitlab.com 41M /var/log/td-agent\nnfs-file-06.stor.gitlab.com 49M /var/log/td-agent\nnfs-file-07.stor.gitlab.com 48M /var/log/td-agent\nnfs-file-08.stor.gitlab.com 59M /var/log/td-agent\nnfs-file-09.stor.gitlab.com 4.8G        /var/log/td-agent\nnfs-file-10.stor.gitlab.com 3.9G        /var/log/td-agent\nnfs-file-11.stor.gitlab.com 210M        /var/log/td-agent\nnfs-file-12.stor.gitlab.com 198M        /var/log/td-agent\nnfs-file-13.stor.gitlab.com 56M /var/log/td-agent\nnfs-file-14.stor.gitlab.com 125M        /var/log/td-agent\nnfs-file-15.stor.gitlab.com 48M /var/log/td-agent\nnfs-file-16.stor.gitlab.com 317M        /var/log/td-agent\n```","state":"closed","created_at":"2018-03-24T21:20:24.442Z","updated_at":"2019-07-08T20:01:08.662Z","closed_at":"2018-09-03T14:23:16.518Z","closed_by":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"labels":["Postmigration","logging","priority::2"],"milestone":null,"assignees":[{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"}],"author":{"id":1090814,"username":"ilyaf","name":"Ilya Frolov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1090814/avatar.png","web_url":"https://gitlab.com/ilyaf"},"type":"ISSUE","assignee":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4700","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4700","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4700/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4700/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4700","relative":"#4700","full":"gitlab-com/gl-infra/reliability#4700"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":9846487,"iid":3896,"project_id":1304532,"title":"Should we serve about.gitlab.com from an object storage?","description":"@jarv raised this concern in https://gitlab.com/gitlab-com/infrastructure/issues/3873#note_64028076 since we don't have a redundancy for the www-gitlab-com node.","state":"closed","created_at":"2018-03-21T14:08:39.691Z","updated_at":"2019-12-06T21:46:32.832Z","closed_at":"2019-08-15T01:14:47.135Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro RodrÃ­guez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["auto updated","corrective action","priority::1","team::Reliability"],"milestone":{"id":944730,"iid":34,"group_id":1112072,"title":"CI/CD \u0026 Enablement August 2019","description":"","state":"closed","created_at":"2019-07-25T22:25:27.797Z","updated_at":"2019-09-14T00:06:06.520Z","due_date":"2019-08-31","start_date":"2019-08-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/34"},"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro RodrÃ­guez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro RodrÃ­guez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":44,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/3896","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/3896","notes":"https://gitlab.com/api/v4/projects/1304532/issues/3896/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/3896/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#3896","relative":"#3896","full":"gitlab-com/gl-infra/reliability#3896"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305409,"iid":4702,"project_id":1304532,"title":"create prometheus exporters for elastic cloud","description":"currently, the only metrics we have is 6 graphs in the admin panel, and whatever one can query directly.\n\nWe should setup two dedicated (for HA) nodes with prometheus elasticsearch exporters which point to elastic cloud, and scrape them from our monitoring.\n\nThis is potentially big issue to be split in several.","state":"closed","created_at":"2018-03-03T01:23:54.569Z","updated_at":"2021-03-11T03:00:22.560Z","closed_at":"2021-03-11T03:00:22.475Z","closed_by":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"labels":["Postmigration","logging"],"milestone":null,"assignees":[],"author":{"id":1090814,"username":"ilyaf","name":"Ilya Frolov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1090814/avatar.png","web_url":"https://gitlab.com/ilyaf"},"type":"ISSUE","assignee":null,"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4702","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4702","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4702/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4702/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4702","relative":"#4702","full":"gitlab-com/gl-infra/reliability#4702"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305417,"iid":4703,"project_id":1304532,"title":"Create pipelines for backing up and restoring kibana settings","description":"Currently, we only have password based administrative access to kibana and ES cloud cluster. We need to create backup/restore procedures for kibana configuration before we add a lot to it and lose it due to some mistake.","state":"closed","created_at":"2018-03-03T01:19:50.814Z","updated_at":"2022-08-02T06:08:42.358Z","closed_at":"2022-08-02T06:08:42.347Z","closed_by":{"id":1786152,"username":"gitlab-bot","name":"ðŸ¤– GitLab Bot ðŸ¤–","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1786152/avatar.png","web_url":"https://gitlab.com/gitlab-bot"},"labels":["Postmigration","logging","priority::2"],"milestone":null,"assignees":[],"author":{"id":1090814,"username":"ilyaf","name":"Ilya Frolov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1090814/avatar.png","web_url":"https://gitlab.com/ilyaf"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4703","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4703","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4703/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4703/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4703","relative":"#4703","full":"gitlab-com/gl-infra/reliability#4703"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305422,"iid":4704,"project_id":1304532,"title":"Write documentation and runbooks for elastic cloud setup.","description":"Currently, apart from `gitlab_fluentd` cookbook there's no documentation about elastic cloud setup. This issue is to track this.","state":"closed","created_at":"2018-03-03T01:17:43.202Z","updated_at":"2022-08-02T06:08:43.136Z","closed_at":"2022-08-02T06:08:43.116Z","closed_by":{"id":1786152,"username":"gitlab-bot","name":"ðŸ¤– GitLab Bot ðŸ¤–","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1786152/avatar.png","web_url":"https://gitlab.com/gitlab-bot"},"labels":["Postmigration","logging","priority::2"],"milestone":null,"assignees":[],"author":{"id":1090814,"username":"ilyaf","name":"Ilya Frolov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1090814/avatar.png","web_url":"https://gitlab.com/ilyaf"},"type":"ISSUE","assignee":null,"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4704","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4704","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4704/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4704/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4704","relative":"#4704","full":"gitlab-com/gl-infra/reliability#4704"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305433,"iid":4706,"project_id":1304532,"title":"Migrate existing elastalerts to new elastic cloud cluster","description":"As we move from our current setup to elastic cloud, we should move existing integrations to new infrastructure.","state":"closed","created_at":"2018-03-03T01:16:40.983Z","updated_at":"2021-03-05T00:41:42.111Z","closed_at":"2021-03-05T00:41:41.975Z","closed_by":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"labels":["Postmigration","logging","priority::2"],"milestone":null,"assignees":[],"author":{"id":1090814,"username":"ilyaf","name":"Ilya Frolov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1090814/avatar.png","web_url":"https://gitlab.com/ilyaf"},"type":"ISSUE","assignee":null,"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4706","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4706","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4706/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4706/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4706","relative":"#4706","full":"gitlab-com/gl-infra/reliability#4706"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305425,"iid":4705,"project_id":1304532,"title":"Stop current logstash pipeline and tear down existing elastic cluster","description":"This issue is to track the cleanup progress.\n - [ ] stop current pipeline\n - [ ] tear down current infrastructure","state":"closed","created_at":"2018-03-03T01:15:39.833Z","updated_at":"2019-07-08T20:01:29.714Z","closed_at":"2018-08-30T18:59:47.926Z","closed_by":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"labels":["Postmigration","logging","priority::2"],"milestone":{"id":614477,"iid":46,"project_id":1304532,"title":"2018-August Milestone 1","description":"2 week Milestone to contain work done post GCP migration.\r\n","state":"closed","created_at":"2018-08-06T19:49:50.244Z","updated_at":"2018-09-04T16:14:41.314Z","due_date":"2018-08-24","start_date":"2018-08-13","expired":true,"web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/milestones/46"},"assignees":[{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"}],"author":{"id":1090814,"username":"ilyaf","name":"Ilya Frolov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1090814/avatar.png","web_url":"https://gitlab.com/ilyaf"},"type":"ISSUE","assignee":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4705","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":2,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4705","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4705/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4705/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4705","relative":"#4705","full":"gitlab-com/gl-infra/reliability#4705"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13305222,"iid":4682,"project_id":1304532,"title":"Migrating Non-GitLab.com Production Servers","description":"We have a handful of servers, notably: \n\n* about.gitlab.com\n* version.gitlab.com\n* customers.gitlab.com\n* license.gitlab.com\n\nthat are required for the production usage of GitLab but we have not addressed moving them or standing up replicas in GCP yet.","state":"closed","created_at":"2018-02-09T16:17:16.012Z","updated_at":"2021-03-10T19:26:58.722Z","closed_at":"2020-03-24T21:24:55.273Z","closed_by":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"labels":["Postmigration","priority::2"],"milestone":null,"assignees":[{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"}],"author":{"id":478289,"username":"northrup","name":"John Northrup","state":"active","avatar_url":"https://secure.gravatar.com/avatar/f076b1aa65652a2852e897baf0a65ba0?s=80\u0026d=identicon","web_url":"https://gitlab.com/northrup"},"type":"ISSUE","assignee":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4682","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4682","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4682/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4682/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4682","relative":"#4682","full":"gitlab-com/gl-infra/reliability#4682"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":16,"epic":{"id":1365,"iid":16,"title":"Grouping: Improvements for non core GitLab.com assets","url":"/groups/gitlab-com/gl-infra/-/epics/16","group_id":1112072},"iteration":null,"health_status":null},{"id":13305164,"iid":4680,"project_id":1304532,"title":"Create a runbook and test the manual process for updating the staging database from production","description":"We will need to periodically update the staging database with pseudoanonymization of customer data.\n\nOnce this complete, the next step will be to automate the process.","state":"closed","created_at":"2018-02-09T10:37:44.045Z","updated_at":"2022-08-02T06:08:49.739Z","closed_at":"2022-08-02T06:08:49.729Z","closed_by":{"id":1786152,"username":"gitlab-bot","name":"ðŸ¤– GitLab Bot ðŸ¤–","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1786152/avatar.png","web_url":"https://gitlab.com/gitlab-bot"},"labels":["Database [pl]","Postmigration","auto updated","documentation","staging"],"milestone":null,"assignees":[],"author":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"type":"ISSUE","assignee":null,"user_notes_count":21,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4680","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4680","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4680/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4680/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4680","relative":"#4680","full":"gitlab-com/gl-infra/reliability#4680"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13304990,"iid":4677,"project_id":1304532,"title":"Copy backup configuration from production","description":"All of our backups for customer data in production should be duplicated in staging.","state":"closed","created_at":"2018-02-09T10:35:18.002Z","updated_at":"2018-12-17T13:26:59.461Z","closed_at":"2018-12-17T12:42:28.991Z","closed_by":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"labels":["Postmigration","auto updated","staging"],"milestone":null,"assignees":[],"author":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"type":"ISSUE","assignee":null,"user_notes_count":29,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4677","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4677","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4677/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4677/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4677","relative":"#4677","full":"gitlab-com/gl-infra/reliability#4677"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":14000565,"iid":4973,"project_id":1304532,"title":"[META] Structured (JSON) logging for PostgreSQL","description":"Structured logging would make it easier to ingest and search through logs. In particular this could be useful for searching for slow queries that may spread across multiple lines. We should investigate the options here and if deemed possible/useful enough implement it.\n\nThere are several steps to investigating and deploying this change:\n\n* [x] Build the jsonlog module and manually install it on staging\n* [x] Decide on the destination path for the logs\n* [x] Evaluate the log output and fix any deficencies\n  * [x] https://github.com/michaelpq/pg_plugins/pull/18\n  * [x] https://github.com/michaelpq/pg_plugins/pull/19\n  * [x] https://github.com/michaelpq/pg_plugins/pull/20\n  * [x] https://github.com/michaelpq/pg_plugins/pull/21\n* [x] Configure ELK stack to ingest these logs\n  * [x] https://gitlab.com/gitlab-cookbooks/gitlab_fluentd/merge_requests/5#note_61734780\n  * [ ] Ensure these logs are rotated and cleaned up after some retention period\n  * View \n* [ ] Integrate jsonlog into omnibus\n  * https://gitlab.com/gitlab-org/omnibus-gitlab/merge_requests/2332#note_62951392\n* [ ] Wait for omnibus with jsonlog to be deployed to production\n* [ ] \n\n\nUnanswered questions:\n* [ ] Can we still use mtail or is there an alternate way to get metrics from logs?","state":"closed","created_at":"2017-12-21T16:31:17.789Z","updated_at":"2021-11-09T21:45:11.088Z","closed_at":"2020-03-06T14:41:45.916Z","closed_by":{"id":64248,"username":"stanhu","name":"Stan Hu","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/64248/stanhu.jpg","web_url":"https://gitlab.com/stanhu"},"labels":["Database","Database [pl]","priority::2","workflow-infra::Verify"],"milestone":null,"assignees":[],"author":{"id":209240,"username":"yorickpeterse","name":"Yorick Peterse","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/209240/avatar.png","web_url":"https://gitlab.com/yorickpeterse"},"type":"ISSUE","assignee":null,"user_notes_count":21,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/4973","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":13,"completed_count":9},"weight":4,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/4973","notes":"https://gitlab.com/api/v4/projects/1304532/issues/4973/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/4973/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#4973","relative":"#4973","full":"gitlab-com/gl-infra/reliability#4973"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":7367111,"iid":3082,"project_id":1304532,"title":"[meta] New Geo Testbed","description":"## Updated plan with smaller issues\n\nAzure - geo1.gitlab.com:\n\n- [x] ~1d Create terraform configuration for Azure - https://gitlab.com/gitlab-com/infrastructure/issues/3090\n- [x] ~2d Create new chef environment for Geo testbed - https://gitlab.com/gitlab-com/infrastructure/issues/3091\n- [x] ~2d Setup NFS storage for the geo testbed in Azure (copy of nfs shards) - https://gitlab.com/gitlab-com/infrastructure/issues/3092\n- [x] ~1d Setup Uploads/Attachments for the geo testbed in Azure - https://gitlab.com/gitlab-com/infrastructure/issues/3093\n- [x] ~1d Setup Database that is pseudo-anonimized and only contains projects for the nfs shards  -https://gitlab.com/gitlab-com/infrastructure/issues/3094\n- [x] ~1d Setup monitoring and alarming for the Azure testbed - https://gitlab.com/gitlab-com/infrastructure/issues/3095\n- [x] ~1d Setup automatic deploys for the Azure testbed - https://gitlab.com/gitlab-com/infrastructure/issues/3096\n\nAzure - geo2.gitlab.com:\n\n- [x] ~1d Create terraform configuration for Azure - #3203 \n- [x] ~2d Create new chef environment for Geo testbed - #3204\n- [x] ~2d Setup NFS storage - #3205\n- [x] ~1d Setup Uploads/Attachments - #3206\n- [x] ~1d Setup Database with disk config as geo1 - #3207\n- [x] ~1d Setup monitoring and alarming - #3208\n- [x] ~1d Setup automatic deploys - #3209\n\n\n## Original issue\n\nPer discussions a few days ago, we'd like to have a new Geo testbed (or upgrade the existing one) so that it has GitLab running in HA mode on both the primary and secondary, with at least two web workers on each side, and load balancer in front, to make sure that none of the Geo code / functionality bugs out in an HA setup. \n","state":"closed","created_at":"2017-10-27T00:14:52.213Z","updated_at":"2018-03-05T20:42:20.138Z","closed_at":"2017-12-22T09:48:32.748Z","closed_by":null,"labels":["Geo","meta"],"milestone":{"id":367268,"iid":5,"group_id":6543,"title":"10.3","description":"","state":"closed","created_at":"2017-08-31T11:12:30.507Z","updated_at":"2018-06-28T19:21:57.085Z","due_date":"2017-12-22","start_date":"2017-11-07","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/-/milestones/5"},"assignees":[],"author":{"id":192328,"username":"ernstvn-gitlab","name":"Ernst van Nierop","state":"active","avatar_url":"https://secure.gravatar.com/avatar/36b7c478bbe1e079f10202afa9b30c0d?s=80\u0026d=identicon","web_url":"https://gitlab.com/ernstvn-gitlab"},"type":"ISSUE","assignee":null,"user_notes_count":26,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/3082","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":14,"completed_count":14},"weight":5,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/3082","notes":"https://gitlab.com/api/v4/projects/1304532/issues/3082/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/3082/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#3082","relative":"#3082","full":"gitlab-com/gl-infra/reliability#3082"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":6618867,"iid":2667,"project_id":1304532,"title":"Set up alert on HTTP Queue Timing","description":"Carry over from https://gitlab.com/gitlab-com/infrastructure/issues/2379\n\nWhile we anticipate better ways of measuring web request response timing with more integration of Prometheus, we should not wait on that to set up an alert on HTTP Queue timings. Once those timings go above an SLO that I am about to propose in this issue, the runbook that ties to the alert should describe how to add more unicorn hosts, as a first step. Obviously there can be other reasons for high HTTP Queue Timings, but this is a start.\n\n- Proposed SLO: HTTP Queue Timing p99 \u003c 15 ms.\n- Proposed alert: Alert when p99 has been \u003e 15 ms for more than 30 minutes.\n\nhttps://performance.gitlab.net/dashboard/db/transaction-overview?panelId=13\u0026fullscreen\u0026orgId=1","state":"closed","created_at":"2017-08-30T17:08:35.800Z","updated_at":"2020-07-22T15:22:50.790Z","closed_at":"2020-07-22T15:22:50.741Z","closed_by":{"id":895869,"username":"andrewn","name":"Andrew Newdigate","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/895869/avatar.png","web_url":"https://gitlab.com/andrewn"},"labels":["moved 2","performance","workflow-infra::Ready"],"milestone":null,"assignees":[],"author":{"id":192328,"username":"ernstvn-gitlab","name":"Ernst van Nierop","state":"active","avatar_url":"https://secure.gravatar.com/avatar/36b7c478bbe1e079f10202afa9b30c0d?s=80\u0026d=identicon","web_url":"https://gitlab.com/ernstvn-gitlab"},"type":"ISSUE","assignee":null,"user_notes_count":25,"merge_requests_count":0,"upvotes":0,"downvotes":1,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/2667","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/2667","notes":"https://gitlab.com/api/v4/projects/1304532/issues/2667/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/2667/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#2667","relative":"#2667","full":"gitlab-com/gl-infra/reliability#2667"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":6091522,"iid":2259,"project_id":1304532,"title":"Sync `jws_private_key` between all app servers","description":"Zendesk: https://gitlab.zendesk.com/agent/tickets/79645\n\nThe person that contributed the OpenID Connect feature reported that GitLab.com is returning a different key for each request, presumably because the app servers don't have the private key synced. We should sync `jws_private_key` in `gitlab-secrets.json` across all nodes. \n\nSee https://gitlab.com/gitlab-org/omnibus-gitlab/merge_requests/1222/diffs for where this was implemented.","state":"closed","created_at":"2017-07-14T12:24:59.497Z","updated_at":"2019-07-03T19:39:27.656Z","closed_at":"2018-08-14T17:04:12.468Z","closed_by":{"id":429540,"username":"ahanselka","name":"Alex Hanselka","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/429540/avatar.png","web_url":"https://gitlab.com/ahanselka"},"labels":["Postmigration"],"milestone":{"id":614477,"iid":46,"project_id":1304532,"title":"2018-August Milestone 1","description":"2 week Milestone to contain work done post GCP migration.\r\n","state":"closed","created_at":"2018-08-06T19:49:50.244Z","updated_at":"2018-09-04T16:14:41.314Z","due_date":"2018-08-24","start_date":"2018-08-13","expired":true,"web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/milestones/46"},"assignees":[{"id":2524675,"username":"skarbek","name":"John Skarbek","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c6455ce4726023aac6dd7fb0acd1f236?s=80\u0026d=identicon","web_url":"https://gitlab.com/skarbek"}],"author":{"id":13356,"username":"dblessing","name":"Drew Blessing","state":"active","avatar_url":"https://secure.gravatar.com/avatar/b5bf44866b4eeafa2d8114bfe15da02f?s=80\u0026d=identicon","web_url":"https://gitlab.com/dblessing"},"type":"ISSUE","assignee":{"id":2524675,"username":"skarbek","name":"John Skarbek","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c6455ce4726023aac6dd7fb0acd1f236?s=80\u0026d=identicon","web_url":"https://gitlab.com/skarbek"},"user_notes_count":23,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/2259","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/2259","notes":"https://gitlab.com/api/v4/projects/1304532/issues/2259/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/2259/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#2259","relative":"#2259","full":"gitlab-com/gl-infra/reliability#2259"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":5664260,"iid":1997,"project_id":1304532,"title":"Create a Terraform gym","description":"As a follow-up of #1715 it'd be great if we can create a Terraform gym to fiddle with the tool in an isolated environment. This to allow team members to learn and experiment in complete freedom on the same platform as production without the risk of hurting GitLab.com.\n\nTo do this we should create a separate Azure account (https://gitlab.com/gitlab-com/infrastructure/issues/1906) and decide if we want to limit the exercises to pure infrastructure or if we can spend some time and have a Chef server set up for this. The latter would allow full coverage of the way we provision servers at the moment. Discussion about this from [this comment](https://gitlab.com/gitlab-com/infrastructure/issues/1715#note_31536847). Let's continue it here.\n\n/cc @pcarranza @ernstvn @northrup @jtevnan @stanhu","state":"closed","created_at":"2017-06-09T16:09:20.371Z","updated_at":"2019-05-23T01:28:03.360Z","closed_at":"2019-05-23T01:28:03.327Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["auto updated","automation","documentation"],"milestone":null,"assignees":[{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"}],"author":{"id":897310,"username":"omame-gitlab","name":"Daniele Valeriani [GitLab]","state":"active","avatar_url":"https://secure.gravatar.com/avatar/a03a0f9af42cea20b4914375c8aaae87?s=80\u0026d=identicon","web_url":"https://gitlab.com/omame-gitlab"},"type":"ISSUE","assignee":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"user_notes_count":3,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/1997","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/1997","notes":"https://gitlab.com/api/v4/projects/1304532/issues/1997/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/1997/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#1997","relative":"#1997","full":"gitlab-com/gl-infra/reliability#1997"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":26,"epic":{"id":2761,"iid":26,"title":"Grouping: Ephemeral Environments","url":"/groups/gitlab-com/gl-infra/-/epics/26","group_id":1112072,"human_readable_end_date":"Sep 13, 2019","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":5424965,"iid":1815,"project_id":1304532,"title":"Automate the staging environment creation","description":"Following a call with @ernstvn and @andrewn we agreed that we need a way to create staging environments for testing new features. This is meant to be an intermediate step towards #1504 which remains the ultimate long term goal.\n\nThe way we can achieve this in the short to mid term is to leverage on Terraform for the creation of the nodes. This is already part of an existing effort to better align staging to the production environment and the configuration [is already coded](https://gitlab.com/gitlab-com/gitlab-com-infrastructure/tree/master/staging).\n\nTo make it scalable to a number of different staging environments we will need to define a schema for the chef roles, like `staging-\u003cname\u003e-*`.\n\n@andrewn was also asking about how we would deal with the monitoring, since it's a fundamental component to gather data about the changes. Would we use a global influxdb/prometheus server? Should we use one for all staging environments? Should we create one for each?\n\nLast but not least, the database. We'll probably need to use a copy of the staging data set. If we use the same staging database then the schema will get stale real quick. Also, this could be a good opportunity to test migrations in a controlled way. @northrup has a plan for that.\n\n/cc @gl-infra  @bjk-gitlab","state":"closed","created_at":"2017-05-17T18:12:26.398Z","updated_at":"2020-10-30T19:05:43.885Z","closed_at":"2020-10-30T19:05:43.840Z","closed_by":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"labels":["auto updated","automation","internal"],"milestone":null,"assignees":[{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"}],"author":{"id":897310,"username":"omame-gitlab","name":"Daniele Valeriani [GitLab]","state":"active","avatar_url":"https://secure.gravatar.com/avatar/a03a0f9af42cea20b4914375c8aaae87?s=80\u0026d=identicon","web_url":"https://gitlab.com/omame-gitlab"},"type":"ISSUE","assignee":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"user_notes_count":16,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/1815","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/1815","notes":"https://gitlab.com/api/v4/projects/1304532/issues/1815/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/1815/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#1815","relative":"#1815","full":"gitlab-com/gl-infra/reliability#1815"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":26,"epic":{"id":2761,"iid":26,"title":"Grouping: Ephemeral Environments","url":"/groups/gitlab-com/gl-infra/-/epics/26","group_id":1112072,"human_readable_end_date":"Sep 13, 2019","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":4737052,"iid":1368,"project_id":1304532,"title":"Custom robots recipe applies multiple lines","description":"The [gitlab-server::custom-robots](https://gitlab.com/gitlab-cookbooks/gitlab-server/merge_requests/46/diffs) recipe seems to apply the `Disallow: /snippets/*` line multiple times to `robots.txt` on production. \n\n**Symptoms**\n\n```\n# tail /opt/gitlab/embedded/service/gitlab-rails/public/robots.txt\nDisallow: /snippets/*\nDisallow: /snippets/*\nDisallow: /snippets/*\nDisallow: /snippets/*\nDisallow: /snippets/*\nDisallow: /snippets/*\nDisallow: /snippets/*\n````\n\n__________________\n\nThe issue is probably due to the regex \n\n```\nrobots.insert_line_if_no_match(\"/Disallow: \\/snippets\\/\\*/\", \"Disallow: /snippets/*\")\n```","state":"closed","created_at":"2017-03-16T14:38:01.545Z","updated_at":"2017-12-04T17:43:26.284Z","closed_at":null,"closed_by":null,"labels":["chef"],"milestone":null,"assignees":[],"author":{"id":444214,"username":"MrChrisW","name":"Chris","state":"active","avatar_url":"https://secure.gravatar.com/avatar/897cd632548832626c1eae1f3bc1da08?s=80\u0026d=identicon","web_url":"https://gitlab.com/MrChrisW"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/1368","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/1368","notes":"https://gitlab.com/api/v4/projects/1304532/issues/1368/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/1368/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#1368","relative":"#1368","full":"gitlab-com/gl-infra/reliability#1368"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":3313168,"iid":645,"project_id":1304532,"title":"Enable IPv6 for GitLab.com (redux)","description":"https://gitlab.com/gitlab-com/operations/issues/43 was closed last year because Azure did not offer IPv6 support; now it does.  Please revisit the issue.","state":"closed","created_at":"2016-10-02T01:34:40.896Z","updated_at":"2020-09-14T23:54:47.721Z","closed_at":"2020-03-28T15:43:03.837Z","closed_by":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"labels":["For Prioritization","For Prioritization","auto updated","availability","blocked","moved 2"],"milestone":null,"assignees":[],"author":{"id":122285,"username":"pmarks","name":"Paul Marks","state":"active","avatar_url":"https://secure.gravatar.com/avatar/329841bd87cf95a432fda703c3fe951c?s=80\u0026d=identicon","web_url":"https://gitlab.com/pmarks"},"type":"ISSUE","assignee":null,"user_notes_count":48,"merge_requests_count":0,"upvotes":28,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/645","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":21,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/645","notes":"https://gitlab.com/api/v4/projects/1304532/issues/645/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/645/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#645","relative":"#645","full":"gitlab-com/gl-infra/reliability#645"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":16,"epic":{"id":1365,"iid":16,"title":"Grouping: Improvements for non core GitLab.com assets","url":"/groups/gitlab-com/gl-infra/-/epics/16","group_id":1112072},"iteration":null,"health_status":null},{"id":2472686,"iid":115,"project_id":1304532,"title":"Redirects on blue-moon and status.gitlab.com","description":"We need to create a new node which will be chef controlled and which will hold all the redirects to the domain.\r\nOld domains still point to the blue-moon IP address and this redirects to the current website.\r\nBlue-moon also holds status site.\r\n\r\nTo discontinue blue-moon, we need to:\r\n\r\n- [ ] Move status to a separate node\r\n- [ ] Provision a new node to host all the redirects\r\n- [ ] update the IP for all domains listed in `/etc/nginx/sites-available/www.gitlab.com`\r\n- [ ] Make sure that the redirects in `blog_rewrite_rules.rules` and `org_to_com_rewrite_rules.rules` are still working\r\n\r\ncc @jnijhof @pcarranza ","state":"closed","created_at":"2016-04-07T14:11:35.784Z","updated_at":"2019-09-11T00:28:12.121Z","closed_at":"2019-09-10T23:41:46.859Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro RodrÃ­guez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["auto updated","cleanup"],"milestone":null,"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro RodrÃ­guez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":116,"username":"marin","name":"Marin Jankovski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/5154f0b0eda3f798c8a254962d57192f?s=80\u0026d=identicon","web_url":"https://gitlab.com/marin"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro RodrÃ­guez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":17,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/115","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":4,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/115","notes":"https://gitlab.com/api/v4/projects/1304532/issues/115/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/115/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#115","relative":"#115","full":"gitlab-com/gl-infra/reliability#115"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":2472662,"iid":103,"project_id":1304532,"title":"Send operations notifications email only on failure","description":"(Migrated from chef-repo/issues/366):\r\n\r\nFor a long time I have been reading Cron emails etc. from the operations notifications email and creating issues about things that looked interesting/important to me. Because I am moving out of ops I decided that as of now I am stopping that; I will not read any ops-notifications email anymore.","state":"closed","created_at":"2016-03-17T13:44:48.939Z","updated_at":"2018-06-15T23:05:44.578Z","closed_at":null,"closed_by":null,"labels":["cleanup"],"milestone":null,"assignees":[{"id":344148,"username":"uid0","name":"Ian Wilson","state":"active","avatar_url":"https://secure.gravatar.com/avatar/61bf18440116b372c4fc6b304f7cddf6?s=80\u0026d=identicon","web_url":"https://gitlab.com/uid0"}],"author":{"id":344148,"username":"uid0","name":"Ian Wilson","state":"active","avatar_url":"https://secure.gravatar.com/avatar/61bf18440116b372c4fc6b304f7cddf6?s=80\u0026d=identicon","web_url":"https://gitlab.com/uid0"},"type":"ISSUE","assignee":{"id":344148,"username":"uid0","name":"Ian Wilson","state":"active","avatar_url":"https://secure.gravatar.com/avatar/61bf18440116b372c4fc6b304f7cddf6?s=80\u0026d=identicon","web_url":"https://gitlab.com/uid0"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/103","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/103","notes":"https://gitlab.com/api/v4/projects/1304532/issues/103/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/103/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#103","relative":"#103","full":"gitlab-com/gl-infra/reliability#103"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null}]