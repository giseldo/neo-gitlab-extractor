[{"id":29678381,"iid":8950,"project_id":1304532,"title":"setup secondary  database with the flags in patroni STAGING","description":"In staging add to one of the secondary databases to do not become primary, also, add the flag to do not receive traffic, this is a config in the patroni nodes.\n\n```\ntags:\n  nofailover: true\n  noloadbalance: true\n```","state":"closed","created_at":"2020-01-16T16:15:59.096Z","updated_at":"2021-06-24T08:08:14.570Z","closed_at":"2020-02-05T08:31:47.587Z","closed_by":{"id":3911656,"username":"craigf","name":"Craig Furman","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3911656/avatar.png","web_url":"https://gitlab.com/craigf"},"labels":["Database","OnGres::Support","priority::2","workflow-infra::Done"],"milestone":{"id":1142605,"iid":66,"group_id":1112072,"title":"W6 DBRE","description":"","state":"closed","created_at":"2020-02-02T07:54:53.150Z","updated_at":"2020-03-02T08:54:59.491Z","due_date":"2020-02-14","start_date":"2020-02-03","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/66"},"assignees":[{"id":3911656,"username":"craigf","name":"Craig Furman","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3911656/avatar.png","web_url":"https://gitlab.com/craigf"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":3911656,"username":"craigf","name":"Craig Furman","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3911656/avatar.png","web_url":"https://gitlab.com/craigf"},"user_notes_count":14,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2020-02-14","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8950","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8950","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8950/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8950/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8950","relative":"#8950","full":"gitlab-com/gl-infra/reliability#8950"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":29670681,"iid":8947,"project_id":1304532,"title":"Get elastic cluster operation metrics into prometheus","description":"As Elastic Cloud seems to not provide a way to get time series data for internal cluster metrics (we only can get the current state for things like used storage from it’s API) and the limited possibilities of the Elastic monitoring cluster to get a view at the operation of the production cluster aren't really satisfying, we should consider to setup something like https://github.com/justwatchcom/elasticsearch_exporter to get Elastic cluster metrics into Prometheus.\n\nThis also would make alerting easier and more standard compared to creating watches within Elastic and we could have dashboards in Grafana.","state":"closed","created_at":"2020-01-16T13:23:51.663Z","updated_at":"2021-01-14T22:24:16.343Z","closed_at":"2020-02-20T10:30:28.953Z","closed_by":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"labels":["Observability-reliability","Service::Logging","team::Reliability","workflow-infra::Done"],"milestone":{"id":1089114,"iid":61,"group_id":1112072,"title":"Reliability February 2020","description":"It's a leap year! 29 days this February.","state":"closed","created_at":"2019-12-04T21:56:25.906Z","updated_at":"2020-04-06T19:04:09.864Z","due_date":"2020-02-29","start_date":"2020-02-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/61"},"assignees":[{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"user_notes_count":7,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8947","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":8,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8947","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8947/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8947/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8947","relative":"#8947","full":"gitlab-com/gl-infra/reliability#8947"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":134,"epic":{"id":16079,"iid":134,"title":"clean up after migration to 7.X","url":"/groups/gitlab-com/gl-infra/-/epics/134","group_id":1112072,"human_readable_timestamp":"\u003cstrong\u003e1174\u003c/strong\u003e days elapsed"},"iteration":null,"health_status":null},{"id":29611372,"iid":8923,"project_id":1304532,"title":"Add TXT record for domain verification - Drift","description":"We are setting up Drift for SSO in Okta, and to enable this we need to perform domain verification. \n\nCan we add the following TXT record to gitlab.com domain -\n\ndrift-domain-verification=fa583cfff88c496bcc62651057550656a98ab3e689c314255a1a6ae848e3e56d\n\nFurther information about this request is available in https://gitlab.com/gitlab-com/marketing/marketing-operations/issues/1193","state":"closed","created_at":"2020-01-14T23:39:14.101Z","updated_at":"2022-08-04T17:56:56.216Z","closed_at":"2020-01-21T16:47:38.997Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["SRE:On-call","workflow-infra::Done"],"milestone":{"id":1087804,"iid":60,"group_id":1112072,"title":"Reliability January 2020","description":"","state":"closed","created_at":"2019-12-03T16:29:27.112Z","updated_at":"2020-01-31T23:02:22.156Z","due_date":"2020-01-31","start_date":"2020-01-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/60"},"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":3119931,"username":"gitlab-rmitchell","name":"Robert Mitchell","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3119931/avatar.png","web_url":"https://gitlab.com/gitlab-rmitchell"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8923","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8923","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8923/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8923/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8923","relative":"#8923","full":"gitlab-com/gl-infra/reliability#8923"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":29544814,"iid":8897,"project_id":1304532,"title":"Upgrade DR haproxy to 1.8","description":"staging, prod and preprod are using haproxy 1.8 and Ubuntu 18.04.2 LTS for the front-end lbs. It would be nice if DR did the same so we could unify configuration, for example using the `hard-stop-after` option in the config.\n\nThis means we have an exception in https://gitlab.com/gitlab-com/runbooks/merge_requests/1776 for the DR environment, which isn't ideal.","state":"closed","created_at":"2020-01-13T14:12:59.803Z","updated_at":"2022-08-04T17:57:12.911Z","closed_at":"2020-02-06T20:58:49.689Z","closed_by":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"}],"author":{"id":1254817,"username":"jarv","name":"John Jarvis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1254817/avatar.png","web_url":"https://gitlab.com/jarv"},"type":"ISSUE","assignee":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8897","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8897","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8897/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8897/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8897","relative":"#8897","full":"gitlab-com/gl-infra/reliability#8897"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":29543252,"iid":8893,"project_id":1304532,"title":"Research our log volume and rate","description":"In order to calculate the proper size and costs of our elastic logging clusters we need to research our current log volume and rate. We should have data per index and environment to also make a decision on which indexes we might want to exclude from elastic.","state":"closed","created_at":"2020-01-13T13:26:56.271Z","updated_at":"2020-02-12T17:18:42.992Z","closed_at":"2020-01-28T16:58:00.922Z","closed_by":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"labels":["Observability-reliability","Service::Logging","caplan","logging","team::Reliability","workflow-infra::Done"],"milestone":{"id":1087804,"iid":60,"group_id":1112072,"title":"Reliability January 2020","description":"","state":"closed","created_at":"2019-12-03T16:29:27.112Z","updated_at":"2020-01-31T23:02:22.156Z","due_date":"2020-01-31","start_date":"2020-01-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/60"},"assignees":[{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},{"id":4587775,"username":"davis_townsend","name":"Davis Townsend","state":"active","avatar_url":"https://secure.gravatar.com/avatar/ebb933fd506f8541f62b79663bcc834b?s=80\u0026d=identicon","web_url":"https://gitlab.com/davis_townsend"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"user_notes_count":7,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8893","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8893","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8893/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8893/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8893","relative":"#8893","full":"gitlab-com/gl-infra/reliability#8893"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":136,"epic":{"id":16082,"iid":136,"title":"Stabilize Elasticsearch 7 (ES7) Cluster","url":"/groups/gitlab-com/gl-infra/-/epics/136","group_id":1112072,"human_readable_end_date":"Jan 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":29496485,"iid":8885,"project_id":1304532,"title":"Thanos processes cannot successfully restart while another thanos is uploading to bucket storage","description":"This issue documents findings regarding one form of thanos crash loop.  Action items:\n* [ ]  Add something like the following notes to the [troubleshooting/prometheus-is-down.md runbook](https://gitlab.com/gitlab-com/runbooks/blob/master/troubleshooting/prometheus-is-down.md), which is referenced by the alert that detects frequent thanos restarts.\n* [ ]  File a bug report with the thanos community.  Potentially also work on a patch, if time allows.\n\n----\n\n### Problem statement\n\nThanos appears to have a race condition, such that whenever a thanos instance is uploading a new block directory to bucket storage, if any other thanos instance restarts for any reason, that instance will fail to startup until the upload completes.\n\nThis race condition is a thanos bug.  Automatic restart of the thanos service is the best mitigation we have until this bug is fixed.\n\nSpecial case: If a thanos upload to the bucket aborts uncleanly, it could leave an incomplete directory in the bucket, which would cause this crash-loop to continue indefinitely.  Fixing that would require manually deleting the incomplete block's directory from the object storage bucket.\n\n### Background\n\nPart of Thanos' job is to use an object storage bucket as the primary place to store metrics data (and use the local filesystem as a persistent cache for that data).  Recently we have noticed the `thanos store` process temporarily entering a crash-loop due to an unhandled exception when scanning that bucket for new `meta.json` files.\n\nExample log excerpt:\n\n```\n{\n  \"ts\":\"2020-01-10T17:35:29.319245979Z\",\n  \"msg\":\"syncing blocks failed\",\n  \"err\":\"iter: load meta: download meta.json: get file 01DY7VTGX0PWPHWWXFNZB6NA17/meta.json: storage: object doesn't exist\"\n}\n```\n\nThis log message indicates that the object storage bucket has a \"block directory\" named `01DY7VTGX0PWPHWWXFNZB6NA17` that did not (yet) contain a `meta.json` file.  In this example, that missing `meta.json` file was created 30 minutes later, when `thanos compact` finished uploading data to that block's `chunks` subdirectory.\n\nIn general, when a new \"block\" (directory) is created in the object storage bucket, that dir's `meta.json` file is created as the last step after uploading all the data files and index file for that block.\n\nOur current version of thanos (`v0.9.0`, the latest release) treats the absence of a `meta.json` file from a block directory as an error.  If thanos is starting up, it's a fatal error (hence the crash loop).  In contrast, if thanos is just doing one of its periodic refreshes of its catalog of bucket contents, then the error is treated as a non-fatal warning.\n\nIt can take many minutes between creating a new directory and creating its `meta.json` file, depending on the amount of data to upload and the available network bandwidth.  This is the main window of opportunity for thanos to hit this race condition and enter a crash loop.\n\n### Potential solution\n\nThanos calls `SyncBlocks` on startup and again periodically.  Only the first call (via the `InitialSync` method) treats the absence of a `meta.json` file as fatal.  In contrast, the periodic calls to `SyncBlocks` just logs a warning and stops processing the bucket's remaining dirs.\n\nIf `SyncBlocks` skipped dirs that exist but do not yet have a `meta.json` file, this would:\n* Prevent `InitialSync` from failing and causing the thanos process to exit shortly after startup (i.e. avoids the crash loop).\n* Allow the periodic `SyncBlocks` calls to scan all viable bucket dirs, instead of aborting prematurely.  This should result in fresh data being more reliably available even during slow compaction runs.","state":"closed","created_at":"2020-01-10T21:32:23.292Z","updated_at":"2022-08-04T17:57:22.148Z","closed_at":"2020-01-23T11:12:20.296Z","closed_by":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"labels":["workflow-infra::Done"],"milestone":null,"assignees":[{"id":3947902,"username":"msmiley","name":"Matt Smiley","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3947902/avatar.png","web_url":"https://gitlab.com/msmiley"}],"author":{"id":3947902,"username":"msmiley","name":"Matt Smiley","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3947902/avatar.png","web_url":"https://gitlab.com/msmiley"},"type":"ISSUE","assignee":{"id":3947902,"username":"msmiley","name":"Matt Smiley","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3947902/avatar.png","web_url":"https://gitlab.com/msmiley"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8885","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":2,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8885","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8885/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8885/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8885","relative":"#8885","full":"gitlab-com/gl-infra/reliability#8885"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":29484939,"iid":8883,"project_id":1304532,"title":"Followup: Remove `gcs-` prefix from review apps","description":"After https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8203, remove the transitional `gcs-` prefix from review apps.\n\nAfter doing so, existing MRs with review apps still being server from about-src's file storage will have to be rebased from the latest www-gitlab-com master.\n\n- [x] cookbook change: https://gitlab.com/gitlab-cookbooks/cookbook-about-gitlab-com/merge_requests/78\n- [x] chef-repo cookbook bump: https://ops.gitlab.net/gitlab-cookbooks/chef-repo/merge_requests/2443\n- [x] www-gitlab-com change: https://gitlab.com/gitlab-com/www-gitlab-com/merge_requests/38161","state":"closed","created_at":"2020-01-10T14:00:18.483Z","updated_at":"2022-08-04T17:57:23.759Z","closed_at":"2020-01-14T15:44:40.430Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["workflow-infra::Done"],"milestone":null,"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8883","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":3,"completed_count":3},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8883","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8883/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8883/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8883","relative":"#8883","full":"gitlab-com/gl-infra/reliability#8883"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":29437383,"iid":8872,"project_id":1304532,"title":"Update database diagrams","description":"Update the rolled out changes to pgbouncer to the database diagrams.\nFocus on the changes on the pgbouncers-RW.","state":"closed","created_at":"2020-01-09T10:22:44.385Z","updated_at":"2022-08-04T17:57:29.263Z","closed_at":"2020-01-13T13:01:10.945Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","workflow-infra::Done"],"milestone":{"id":1114392,"iid":63,"group_id":1112072,"title":"W2 DBRE","description":"","state":"closed","created_at":"2020-01-06T15:51:46.677Z","updated_at":"2020-01-23T15:42:54.113Z","due_date":"2020-01-17","start_date":"2020-01-06","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/63"},"assignees":[{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8872","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8872","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8872/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8872/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8872","relative":"#8872","full":"gitlab-com/gl-infra/reliability#8872"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":29383410,"iid":8859,"project_id":1304532,"title":"Create a new file module for nodes served via praefect","description":"This will allow us to differentiate between file storages accessed directly by rails and those accessed via praefect.\n\n- [x] gitlab-com-infrastructure changes: https://ops.gitlab.net/gitlab-com/gitlab-com-infrastructure/merge_requests/1279\n- [x] chef-repo changes: https://ops.gitlab.net/gitlab-cookbooks/chef-repo/merge_requests/2421","state":"closed","created_at":"2020-01-07T19:56:34.421Z","updated_at":"2022-08-04T17:57:35.798Z","closed_at":"2020-01-09T18:26:26.817Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["workflow-infra::Done"],"milestone":{"id":1087804,"iid":60,"group_id":1112072,"title":"Reliability January 2020","description":"","state":"closed","created_at":"2019-12-03T16:29:27.112Z","updated_at":"2020-01-31T23:02:22.156Z","due_date":"2020-01-31","start_date":"2020-01-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/60"},"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8859","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":2,"completed_count":2},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8859","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8859/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8859/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8859","relative":"#8859","full":"gitlab-com/gl-infra/reliability#8859"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":199,"epic":{"id":14582,"iid":199,"title":"HA Gitaly on GitLab.com","url":"/groups/gitlab-com/-/epics/199","group_id":6543,"human_readable_end_date":"Jan 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":29285464,"iid":8842,"project_id":1304532,"title":"Grant SELECT access to the `analytics` user in gitlab_dotcom db","description":"I'm adding a newly created table to our data team ETL and I'm looking for somebody to grant select access to the `analytics` user for all public tables in the gitlab_dotcom db.\n* For context, this is my MR where I'm blocked: https://gitlab.com/gitlab-data/analytics/merge_requests/2098\n* MR for last time this happened: https://gitlab.com/gitlab-data/analytics/merge_requests/1522#note_212269236\n\n* Other relevant issue: https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/7769","state":"closed","created_at":"2020-01-03T21:56:40.815Z","updated_at":"2022-08-04T17:57:56.315Z","closed_at":"2020-01-08T21:19:04.168Z","closed_by":{"id":3914055,"username":"eli_kastelein","name":"Eli Kastelein","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3914055/avatar.png","web_url":"https://gitlab.com/eli_kastelein"},"labels":["Database","OnGres::Project","severity::2","workflow-infra::Done"],"milestone":{"id":1114392,"iid":63,"group_id":1112072,"title":"W2 DBRE","description":"","state":"closed","created_at":"2020-01-06T15:51:46.677Z","updated_at":"2020-01-23T15:42:54.113Z","due_date":"2020-01-17","start_date":"2020-01-06","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/63"},"assignees":[{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},{"id":3715468,"username":"sergio.ostapowicz","name":"Sergio Alejandro Ostapowicz","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3715468/avatar.png","web_url":"https://gitlab.com/sergio.ostapowicz"}],"author":{"id":3914055,"username":"eli_kastelein","name":"Eli Kastelein","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3914055/avatar.png","web_url":"https://gitlab.com/eli_kastelein"},"type":"ISSUE","assignee":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"user_notes_count":10,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2020-01-10","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8842","time_stats":{"time_estimate":0,"total_time_spent":6300,"human_time_estimate":null,"human_total_time_spent":"1h 45m"},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8842","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8842/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8842/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8842","relative":"#8842","full":"gitlab-com/gl-infra/reliability#8842"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":29277728,"iid":8839,"project_id":1304532,"title":"Incident Review: 2019-12-27 Spammers causing large mailers Sidekiq queue","description":"\u003c!--\n**Please note:** if the incident relates to sensitive data, or is security related consider\nlabeling this issue with ~security and mark it confidential.\n*** \n--\u003e\n\nIncidents: \n* https://gitlab.com/gitlab-com/gl-infra/production/issues/1483 (related RCA: https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8694)\n* https://gitlab.com/gitlab-com/gl-infra/production/issues/1491\n* https://gitlab.com/gitlab-com/gl-infra/production/issues/1493\n* https://gitlab.com/gitlab-com/gl-infra/production/issues/1494\n* https://gitlab.com/gitlab-com/gl-infra/production/issues/1532\n\n## Summary\n\nWe experienced several incidents where spam attacks caused large `mailers` sidekiq queues.\n\n\n\n- Service(s) affected : ~\"Service::Sidekiq\" ~\"queue::mailers\" \n- Team attribution : \n- Minutes downtime or degradation : \n\nWe do not have a set SLA for mail queue - for purposes here: using greater than 10 minute latency per job from:\nhttps://dashboards.gitlab.net/d/sidekiq-main/sidekiq-overview?orgId=1\u0026from=1577415600000\u0026to=1577448000000\u0026fullscreen\u0026panelId=14\n\n* https://gitlab.com/gitlab-com/gl-infra/production/issues/1483 - 02:25-04:45 - 140 minutes\n* https://gitlab.com/gitlab-com/gl-infra/production/issues/1491 - 17:00-23:19 - 379 minutes\n* https://gitlab.com/gitlab-com/gl-infra/production/issues/1493 - 11:00-12:07 - 67 minutes\n* https://gitlab.com/gitlab-com/gl-infra/production/issues/1494 - 04:00-06:36 - 156 minutes\n* https://gitlab.com/gitlab-com/gl-infra/production/issues/1532 - 03:35-07:13 - 218 minutes \n\nFor calculating duration of event, use the [Platform Metrics Dashboard](https://dashboards.gitlab.net/d/ZUei7TkWz/platform-metrics?orgId=1) to look at appdex and SLO violations.\n\n## Impact \u0026 Metrics\n\nStart with the following:\n\n- What was the impact of the incident? (i.e. service outage, sub-service brown-out, exposure of sensitive data, ...)\n- Who was impacted by this incident? (i.e. external customers, internal customers, specific teams, ...)\n- How did the incident impact customers? (i.e. preventing them from doing X, incorrect display of Y, ...)\n- How many attempts were made to access the impacted service/feature?\n- How many customers were affected?\n- How many customers tried to access the impacted service/feature?\n\nInclude any additional metrics that are of relevance.\n\nProvide any relevant graphs that could help understand the impact of the incident and its dynamics.\n\n## Detection \u0026 Response\n\nStart with the following:\n\n- How was the incident detected?\n- Did alarming work as expected?\n- How long did it take from the start of the incident to its detection?\n- How long did it take from detection to remediation?\n- Were there any issues with the response to the incident? (i.e. bastion host used to access the service was not available, relevant team memeber wasn't page-able, ...)\n\n## Root Cause Analysis\n\nThe purpose of this document is to understand the reasons that caused an incident, and to create mechanisms to prevent it from recurring in the future. A root cause can **never be a person**, the way of writing has to refer to the system and the context rather than the specific actors.\n\nFollow the \"**5 whys**\" in a **blameless** manner as the core of the root-cause analysis.\n\nFor this it is necessary to start with the incident, and question why it happened. Keep iterating asking \"why?\" 5 times. While it's not a hard rule that it has to be 5 times, it helps to keep questions get deeper in finding the actual root cause. \n\nKeep in min that from one \"why?\" there may come more than one answer, consider following the different branches.\n\n### Example of the usage of \"5 whys\"\nSpam campaigns\n\n1. Why? - The battery is dead. \n2. Why? - The alternator is not functioning.\n3. Why? - The alternator belt has broken.\n4. Why? - The alternator belt was well beyond its useful service life and not replaced. \n5. Why? - The vehicle was not maintained according to the recommended service schedule. (Fifth why, a root cause)\n\n## What went well\n\nStart with the following:\n\n- Identify the things that worked well or as expected.\n- Any additional call-outs for what went particularly well.\n\n## What can be improved\n\n- We should make it harder to create new accounts for spam campaigns.\n- We should have stricter limits for issue/notes creation.\n- While rate limits are a very good thing to have, we need to be careful with the collateral effects for existing use-cases when enabling them.\n- We should have better tooling for cleaning up the sidekiq queue that makes it easier and safe to execute (e.g. preventing to overload Redis).\n\nStart with the following:\n\n- Using the root cause analysis, explain what can be improved to prevent this from happening again.\n- Is there anything that could have been done to improve the detection or time to detection?\n- Is there anything that could have been done to improve the response or time to response?\n- Is there an existing issue that would have either prevented this incident or reduced the impact?\n- Did we have any indication or beforehand knowledge that this incident might take place?\n\n## Corrective actions\n\n- List issues that have been created as corrective actions from this incident.\n- For each issue, include the following:\n    - \u003cBare Issue link\u003e - Issue labeled as ~\"corrective action\".\n    - Include an estimated date of completion of the corrective action.\n    - Incldue the named individual who owns the delivery of the corrective action.\n\n* [ ] make it harder to create bogus accounts for abusive operations\n* [ ] rate limit issue creation (https://gitlab.com/gitlab-org/gitlab/issues/55241)\n* [ ] make it easier to identify (and kill) bad sidekiq jobs (https://gitlab.com/gitlab-com/gl-infra/scalability/issues/9 for identifying)\n* [ ] add troubleshooting runbook for dealing with issue spam (disabling mail sending, cleaning up queue/issues, blocking spammers)\n* [ ] prevent overloading redis master (affecting other queues) when cleaning up the `mailers` queue\n* [ ] make it easier to stop sending out mails\n  * [ ] consider moving the `mailers` queue into a separate cluster (https://gitlab.com/gitlab-com/gl-infra/delivery/issues/611 for testing this idea)\n* [ ] improve protection against spam campaigns: (discussion: https://gitlab.com/gitlab-org/gitlab/issues/103325)\n\n## Guidelines\n\n* [Blameless RCA Guideline](https://about.gitlab.com/handbook/infrastructure/#rca)\n* [5 whys](https://en.wikipedia.org/wiki/5_Whys)","state":"closed","created_at":"2020-01-03T14:53:08.647Z","updated_at":"2022-08-04T17:57:59.210Z","closed_at":"2020-02-12T10:36:06.147Z","closed_by":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"labels":["C2","IncidentReview","SRE:On-call","oncall","severity::2","unscheduled","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8839","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":8,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8839","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8839/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8839/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8839","relative":"#8839","full":"gitlab-com/gl-infra/reliability#8839"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":29240913,"iid":8833,"project_id":1304532,"title":"Fix sidekiq log index mapping","description":"Since 12/30 we get many Pubsubbeat warning alerts on pubsub-duplicate-sidekiq-inf-gprd.c.gitlab-production.internal: https://prometheus.gprd.gitlab.net/graph?g0.range_input=1w\u0026g0.expr=rate(pubsubbeat_warnings_total%5B1m%5D)%20%3E%201\u0026g0.tab=0 - maybe related to a deployment on that day. We should fix the index mapping.","state":"closed","created_at":"2020-01-02T15:28:16.739Z","updated_at":"2020-01-21T16:23:30.078Z","closed_at":"2020-01-21T13:46:42.234Z","closed_by":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"labels":["Observability-reliability","Service::Logging","team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8833","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8833","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8833/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8833/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8833","relative":"#8833","full":"gitlab-com/gl-infra/reliability#8833"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":136,"epic":{"id":16082,"iid":136,"title":"Stabilize Elasticsearch 7 (ES7) Cluster","url":"/groups/gitlab-com/gl-infra/-/epics/136","group_id":1112072,"human_readable_end_date":"Jan 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":29022082,"iid":8810,"project_id":1304532,"title":"Gitaly error-rate exceeds SLO in the Canary stage","description":"The name of this alert: `service_cny_error_ratio_slo_out_of_bounds_upper_5m`\n\nPagerDuty event: https://gitlab.pagerduty.com/incidents/P01BI1F\n\nThis alert self-resolved after a few minutes, but the [dashboard shows](https://dashboards.gitlab.net/d/gitaly-main/gitaly-overview?orgId=1\u0026from=1577133346141\u0026to=1577154946141\u0026var-PROMETHEUS_DS=Global\u0026var-environment=gprd\u0026var-stage=cny\u0026var-sigma=2\u0026fullscreen\u0026panelId=4) the canary-stage has briefly spiked above SLO several times today.\n\n![Screenshot_from_2019-12-23_19-38-18](/uploads/d911065abd6c5684cf972b1addd7ec64/Screenshot_from_2019-12-23_19-38-18.png)","state":"closed","created_at":"2019-12-24T03:39:56.210Z","updated_at":"2022-08-04T17:58:25.942Z","closed_at":"2021-03-04T00:48:56.103Z","closed_by":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"labels":["Service::Gitaly","alert","oncall","toil","unscheduled","workflow-infra::Done"],"milestone":null,"assignees":[],"author":{"id":3947902,"username":"msmiley","name":"Matt Smiley","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3947902/avatar.png","web_url":"https://gitlab.com/msmiley"},"type":"ISSUE","assignee":null,"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8810","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8810","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8810/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8810/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8810","relative":"#8810","full":"gitlab-com/gl-infra/reliability#8810"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":"needs_attention"},{"id":28918188,"iid":8788,"project_id":1304532,"title":"add detailed monitoring to raise alerts in case of network traffic for patroni fleet is lower than average","description":"Create alerts when the network traffic reaches 70% than the average.\n\nEvaluate if 70% is the correct value to detect metrics.\n\nThis alert should raise a severity 2.","state":"closed","created_at":"2019-12-19T13:49:33.183Z","updated_at":"2022-08-04T17:58:54.359Z","closed_at":"2020-07-10T10:50:30.895Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","OnGres::Project","auto updated","priority::3","workflow-infra::Done"],"milestone":{"id":1159113,"iid":69,"group_id":1112072,"title":"W8 DBRE","description":"","state":"closed","created_at":"2020-02-17T07:46:04.317Z","updated_at":"2020-03-02T08:55:22.683Z","due_date":"2020-02-28","start_date":"2020-02-17","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/69"},"assignees":[{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8788","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8788","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8788/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8788/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8788","relative":"#8788","full":"gitlab-com/gl-infra/reliability#8788"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28866342,"iid":8761,"project_id":1304532,"title":"usage of consul.checks for patroni","description":"Investigate the usage consul.checks:\\[\\] at patroni config to be more resilient to short network glitches.\n\nWith this patroni will ensure use the  values from ttl and retry_timeouts and loop_wait instead of the serfcheck.\n\nWe need to proceed with some tests in staging.","state":"closed","created_at":"2019-12-18T09:44:22.479Z","updated_at":"2022-08-04T17:58:58.598Z","closed_at":"2020-02-13T18:01:34.555Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","priority::2","workflow-infra::Done"],"milestone":{"id":1142605,"iid":66,"group_id":1112072,"title":"W6 DBRE","description":"","state":"closed","created_at":"2020-02-02T07:54:53.150Z","updated_at":"2020-03-02T08:54:59.491Z","due_date":"2020-02-14","start_date":"2020-02-03","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/66"},"assignees":[{"id":2493611,"username":"adescoms","name":"Adrián Escoms","state":"active","avatar_url":"https://secure.gravatar.com/avatar/d6f86d318669a8b32174b7132607443d?s=80\u0026d=identicon","web_url":"https://gitlab.com/adescoms"},{"id":3007633,"username":"gerardo.herzig","name":"Gerardo Herzig","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3007633/avatar.png","web_url":"https://gitlab.com/gerardo.herzig"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":2493611,"username":"adescoms","name":"Adrián Escoms","state":"active","avatar_url":"https://secure.gravatar.com/avatar/d6f86d318669a8b32174b7132607443d?s=80\u0026d=identicon","web_url":"https://gitlab.com/adescoms"},"user_notes_count":29,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2020-02-14","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8761","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8761","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8761/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8761/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8761","relative":"#8761","full":"gitlab-com/gl-infra/reliability#8761"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28862059,"iid":8759,"project_id":1304532,"title":"Gitter beta DNS change","description":"Gitter beta environment has recently changed. We created a new ELB and ASG for our webapp servers https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8687.\n\nWe'd like to point the DNS A record for\n\n`beta.gitter.im` to `beta-webapp-elb-1739286740.us-east-1.elb.amazonaws.com`.\n\n(I'm not sure how that is usually done outside of one AWS account).\n\n### Additional notes:\nThe `beta-webapp-elb` ELB is in Gitter's AWS account.\n\nRight now, the `beta.gitter.im` DNS record points directly to one of our EC2 instances [gitter-beta-01](https://console.aws.amazon.com/ec2/home?region=us-east-1#Instances:search=i-007a3fd34e0535967;sort=tag:Name)`54.226.100.160`","state":"closed","created_at":"2019-12-18T08:03:33.712Z","updated_at":"2020-11-18T19:39:12.944Z","closed_at":"2019-12-18T08:47:14.962Z","closed_by":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"labels":["Gitter","Infrastructure","group::gitter","team::Reliability","workflow-infra::Done"],"milestone":{"id":1087796,"iid":59,"group_id":1112072,"title":"Reliability December 2019","description":"","state":"closed","created_at":"2019-12-03T16:20:55.704Z","updated_at":"2020-01-16T17:21:46.339Z","due_date":"2019-12-31","start_date":"2019-12-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/59"},"assignees":[],"author":{"id":3457201,"username":"viktomas","name":"Tomas Vik (OOO back on 2023-05-10)","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3457201/avatar.png","web_url":"https://gitlab.com/viktomas"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8759","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8759","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8759/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8759/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8759","relative":"#8759","full":"gitlab-com/gl-infra/reliability#8759"},"severity":"UNKNOWN","moved_to_id":74586533,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28838617,"iid":8747,"project_id":1304532,"title":"Remove residual firewall rule definitions that would re-apply on next reboot","description":"Recently some iptables DROP rules were unintentionally applied to Patroni hosts, causing connectivity loss to the database servers ([incident](https://gitlab.com/gitlab-com/gl-infra/production/issues/1421) and [review](https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8528)).  The immediate recovery steps included unassigning Chef role `gitlab-iptables` and manually remove iptables rules from the affected hosts (especially the Patroni hosts).\n\nThat left some residual unmanaged configuration on those hosts.  As part of an incident follow-up corrective action, that residual config was [discovered and found to probably be dangerous](https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8600#note_261924370).\n\nThe \"gitlab-iptables\" cookbook's \"default\" recipe uses cookbook \"iptables-ng\" to define iptables rules.  That \"iptables-ng\" cookbook installs deb package \"iptables-persistent\" (and implicitly also the \"netfilter-persistent\" deb package), whose job is to persist those iptables rules across reboots.\n\nThe \"iptables-ng\" cookbook stores its version of the rules in `/etc/iptables.d/[table]/[chain]/[named_rule]`, but as far as I know, those are only used by chef-client to support that cookbook.  So those files by themselves may be harmless.\n\nIn contrast, the contents of `/etc/iptables/rules.v4` and `rules.v6` are actively loaded during reboot by the \"netfilter-persistent\" systemd service.\n\nFor all hosts that unintentionally had the \"gitlab-iptables\" cookbook applied, if that cookbook has been removed and not reapplied, we should apply some clean up steps that at least include one of the following:\n\n* Option A: Disable systemd unit \"netfilter-persistent.service\"\n* Option B: Remove files /etc/iptables/rules.*\n* Option C: Remove deb package \"iptables-persistent\" and optionally also \"netfilter-persistent\"","state":"closed","created_at":"2019-12-17T19:14:15.780Z","updated_at":"2021-09-27T20:04:48.422Z","closed_at":"2021-09-21T17:56:29.922Z","closed_by":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"labels":["corrective action","severity::2","team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"}],"author":{"id":3947902,"username":"msmiley","name":"Matt Smiley","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3947902/avatar.png","web_url":"https://gitlab.com/msmiley"},"type":"ISSUE","assignee":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"user_notes_count":20,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8747","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8747","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8747/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8747/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8747","relative":"#8747","full":"gitlab-com/gl-infra/reliability#8747"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":"at_risk"},{"id":28838043,"iid":8746,"project_id":1304532,"title":"Many `PagesDomainSslRenewalWorker` sidekiq exceptions","description":"**Queue: `pages_domain_ssl_renewal`**\n\nToday I noticed that there have been many instances of `PagesDomainSslRenewalWorker` sidekiq exceptions lately.\n\nHere is the grafana chart for the past 36 hours:\n\n![Screen_Shot_2019-12-17_at_12.15.10_PM](/uploads/2c8c58290c31acb6146fa41a9bc1b118/Screen_Shot_2019-12-17_at_12.15.10_PM.png)\n\nHere are the logs for the past 7 days, with 320,716 hits, about 45,000 errors per day.\n\n![Screen_Shot_2019-12-17_at_12.42.37_PM](/uploads/65c261c0ddbcefa65d914e44dae94056/Screen_Shot_2019-12-17_at_12.42.37_PM.png)\n\nThe errors in the logs tend to be one of the following:\n\n```\nAcme::Client::Error::RateLimited: Rate limit for '/acme' reached\n\nAcme::Client::Error::Timeout\n\nFaraday::ConnectionFailed: Net::OpenTimeout\n\nFaraday::ConnectionFailed: Connection reset by peer - SSL_connect\n\nAcme::Client::Error::BadNonce: JWS has no anti-replay nonce\n\nAcme::Client::Error::UnsupportedOperation: Directory at https://acme-v02.api.letsencrypt.org/directory does not include `new_account`\n```","state":"closed","created_at":"2019-12-17T18:45:39.584Z","updated_at":"2022-08-04T17:59:07.188Z","closed_at":"2020-04-24T06:46:46.601Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Service::Sidekiq","devops::release","group::release","workflow-infra::Done"],"milestone":{"id":1152027,"iid":94,"group_id":6543,"title":"13.0","description":"","state":"closed","created_at":"2020-02-11T06:40:30.243Z","updated_at":"2020-05-13T19:47:39.583Z","due_date":"2020-04-22","start_date":"2020-03-23","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/-/milestones/94"},"assignees":[{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"}],"author":{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"},"type":"ISSUE","assignee":{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"},"user_notes_count":7,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8746","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8746","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8746/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8746/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8746","relative":"#8746","full":"gitlab-com/gl-infra/reliability#8746"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28833806,"iid":8741,"project_id":1304532,"title":"check replication on patroni-10","description":"please check the status the streaming replication on patroni-10.\nwe need to have this replica up to date and without receiving traffic and not being able to become a primary of the cluster.\n\nPlease evaluate if we need to create alerts for nodes that are not replicating properly.\n\nPlease check the replication slot of this node.","state":"closed","created_at":"2019-12-17T16:14:08.259Z","updated_at":"2022-08-04T17:59:09.849Z","closed_at":"2020-01-06T15:52:25.316Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","OnGres::Project","priority::2","workflow-infra::Done"],"milestone":{"id":1099881,"iid":62,"group_id":1112072,"title":"DBRE W51","description":"","state":"closed","created_at":"2019-12-16T13:11:17.324Z","updated_at":"2020-01-16T17:23:54.827Z","due_date":"2019-12-27","start_date":"2019-12-16","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/62"},"assignees":[{"id":2780522,"username":"kadaffy","name":"Kadaffy Talavera","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2780522/avatar.png","web_url":"https://gitlab.com/kadaffy"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":2780522,"username":"kadaffy","name":"Kadaffy Talavera","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2780522/avatar.png","web_url":"https://gitlab.com/kadaffy"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2019-12-20","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8741","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8741","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8741/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8741/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8741","relative":"#8741","full":"gitlab-com/gl-infra/reliability#8741"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28823296,"iid":8737,"project_id":1304532,"title":"Evaluate Elastic APM as distributed tracing solution","description":"Elastic APM has an OpenTracing bridge and thus could be an easy plugin solution to send tracing data to (https://gitlab.com/gitlab-org/labkit/merge_requests/40). We should evaluate if we can use it for distributed tracing of GitLab.com.\n\n* technical requirements\n* are there missing features (e.g. which features of OpenTracing are supported/missing)?\n* correlation with logs?\n* estimate data volume\n* cost factor","state":"closed","created_at":"2019-12-17T11:24:42.100Z","updated_at":"2022-08-04T17:59:12.525Z","closed_at":"2020-04-27T20:02:11.140Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["Distributed Tracing","Observability-reliability","Service::Logging","team::Reliability","workflow-infra::Done"],"milestone":{"id":1237326,"iid":74,"group_id":1112072,"title":"Observability Team - April 2020","description":"This is a first attempt at planning with the new team structure. Without a planning process, I'm targeting the end of the month. Our best mechanism for organizing a single pane of glass using GitLab boards is using two boards: one for in the active milestone and another for everything without a milestone.","state":"closed","created_at":"2020-04-13T02:47:34.907Z","updated_at":"2020-05-13T19:49:03.277Z","due_date":"2020-04-30","start_date":"2020-04-13","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/74"},"assignees":[{"id":3417286,"username":"mwasilewski-gitlab","name":"Michal Wasilewski","state":"blocked","avatar_url":"https://secure.gravatar.com/avatar/2a9fc70321a9df494ecdc8f178df11dd?s=80\u0026d=identicon","web_url":"https://gitlab.com/mwasilewski-gitlab"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3417286,"username":"mwasilewski-gitlab","name":"Michal Wasilewski","state":"blocked","avatar_url":"https://secure.gravatar.com/avatar/2a9fc70321a9df494ecdc8f178df11dd?s=80\u0026d=identicon","web_url":"https://gitlab.com/mwasilewski-gitlab"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8737","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8737","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8737/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8737/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8737","relative":"#8737","full":"gitlab-com/gl-infra/reliability#8737"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":210,"epic":{"id":43409,"iid":210,"title":"Jaeger Distributed Tracing Enabled for GitLab.com","url":"/groups/gitlab-com/gl-infra/-/epics/210","group_id":1112072,"human_readable_end_date":"Apr 30, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":"needs_attention"},{"id":28779954,"iid":8721,"project_id":1304532,"title":"cookbook-license-gitlab-com needs the same fixes for deploy that cookbook-customers-gitlab-com needed","description":"Review the license cookbook and incorporate customers changes that broke when ruby was updated.","state":"closed","created_at":"2019-12-16T17:27:20.723Z","updated_at":"2022-08-04T17:59:22.077Z","closed_at":"2020-07-06T14:29:39.602Z","closed_by":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"labels":["auto updated","workflow-infra::Done"],"milestone":null,"assignees":[{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"}],"author":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"type":"ISSUE","assignee":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8721","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8721","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8721/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8721/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8721","relative":"#8721","full":"gitlab-com/gl-infra/reliability#8721"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28770014,"iid":8719,"project_id":1304532,"title":"Help I.W. as an onboarding buddy","description":"As an onboarding buddy for I. W., I want to make the process for him as smooth as possible.\n\n* [x] Introductory Coffee chat\n* [x] Make sure he has access to his onboarding issue (https://gitlab.com/gitlab-com/people-group/employment/issues/1678).\n  * [x] Clarify if new account still needs to be created (https://gitlab.com/gitlab-com/people-group/employment/issues/1678#note_260789516).\n* [x] Provide resources\n  * [x] relevant slack channels\n* [x] Schedule follow-up meeting in first week of new year.\n* [x] Make sure there is an SRE onboarding issue.\n* [x] Help with SRE onboarding\n* [ ] See if we can meet in person on a co-working day.\n* [ ] Improve onboarding issues / handbook where necessary.","state":"closed","created_at":"2019-12-16T14:03:00.970Z","updated_at":"2021-06-24T08:10:01.501Z","closed_at":"2020-02-17T15:06:48.083Z","closed_by":{"id":876203,"username":"igorwwwwwwwwwwwwwwwwwwww","name":"Igor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/876203/avatar.png","web_url":"https://gitlab.com/igorwwwwwwwwwwwwwwwwwwww"},"labels":["onboarding","team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":876203,"username":"igorwwwwwwwwwwwwwwwwwwww","name":"Igor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/876203/avatar.png","web_url":"https://gitlab.com/igorwwwwwwwwwwwwwwwwwwww"},{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":876203,"username":"igorwwwwwwwwwwwwwwwwwwww","name":"Igor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/876203/avatar.png","web_url":"https://gitlab.com/igorwwwwwwwwwwwwwwwwwwww"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8719","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":10,"completed_count":8},"weight":5,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8719","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8719/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8719/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8719","relative":"#8719","full":"gitlab-com/gl-infra/reliability#8719"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28643682,"iid":8707,"project_id":1304532,"title":"Remove deprecated Digital Ocean instance of design.gitlab.com","description":"Since `design.gitlab.com` has been moved to a Kubernetes cluster, managed by [the project's Auto Devops configuration](https://gitlab.com/gitlab-org/gitlab-services/design-gitlab-com/), it is time to remove the previous Digital Ocean instance of the application.\n\nThis Droplet is in the `GitLab Production` Project in the Digital Ocean console.\n\nOnce the instance is deleted, the chef configuration should be removed from the chef server.","state":"closed","created_at":"2019-12-13T21:26:51.862Z","updated_at":"2022-08-04T17:59:37.355Z","closed_at":"2020-03-18T19:41:15.290Z","closed_by":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"labels":["Infrastructure","chef","workflow-infra::Done"],"milestone":null,"assignees":[{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"}],"author":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"type":"ISSUE","assignee":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8707","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8707","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8707/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8707/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8707","relative":"#8707","full":"gitlab-com/gl-infra/reliability#8707"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28643658,"iid":8706,"project_id":1304532,"title":"Remove deprecated AWS instance of version.gitlab.com","description":"Since `version.gitlab.com` has been moved to a Kubernetes cluster, managed by [the project's Auto Devops configuration](https://gitlab.com/gitlab-services/version-gitlab-com/), it is time to remove the previous AWS instance of the application.\n\nOnce the instance is deleted, the chef configuration should be removed from the chef server.\n\nThe instance is in `us-east-1` and it is named `redash.gitlab.com`","state":"closed","created_at":"2019-12-13T21:25:36.350Z","updated_at":"2022-08-04T17:59:38.046Z","closed_at":"2020-09-10T19:27:23.075Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["Infrastructure","chef","workflow-infra::Done"],"milestone":null,"assignees":[],"author":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"type":"ISSUE","assignee":null,"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8706","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8706","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8706/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8706/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8706","relative":"#8706","full":"gitlab-com/gl-infra/reliability#8706"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28634530,"iid":8700,"project_id":1304532,"title":"Setup logging for Praefect on gprd","description":"Most of the work was done when setting logging on gstg (https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8142) we just have to create the pubsub host.\n\n- [x] gitlab-com-infrastructure MR: https://ops.gitlab.net/gitlab-com/gitlab-com-infrastructure/merge_requests/1237/","state":"closed","created_at":"2019-12-13T16:27:40.926Z","updated_at":"2022-08-04T17:59:42.647Z","closed_at":"2020-01-06T19:36:16.113Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["workflow-infra::Done"],"milestone":{"id":1087804,"iid":60,"group_id":1112072,"title":"Reliability January 2020","description":"","state":"closed","created_at":"2019-12-03T16:29:27.112Z","updated_at":"2020-01-31T23:02:22.156Z","due_date":"2020-01-31","start_date":"2020-01-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/60"},"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8700","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":1},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8700","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8700/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8700/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8700","relative":"#8700","full":"gitlab-com/gl-infra/reliability#8700"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":199,"epic":{"id":14582,"iid":199,"title":"HA Gitaly on GitLab.com","url":"/groups/gitlab-com/-/epics/199","group_id":6543,"human_readable_end_date":"Jan 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":28499784,"iid":8697,"project_id":1304532,"title":"Cloudflare: Fix HAProxy ACLs to also check Cloudflare headers","description":"From @asaba in https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8409#note_259451396:\n\u003e The `require-recaptcha.lst` is used here: https://ops.gitlab.net/gitlab-cookbooks/gitlab-haproxy/blob/master/templates/default/haproxy-frontend.cfg.erb#L141. When configured like that, do you know if haproxy will check against additional IP address associated with the request (e.g. the extra X-Forwarded-For from cloudflare)?\n\nWe need to fix all ACLs using `src` to also look at the Cloudflare headers when `src` is a Cloudflare IP.","state":"closed","created_at":"2019-12-13T08:50:29.229Z","updated_at":"2020-01-27T16:23:19.545Z","closed_at":"2020-01-27T16:18:29.964Z","closed_by":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"labels":["priority::2","team::Reliability","workflow-infra::Done"],"milestone":{"id":1087804,"iid":60,"group_id":1112072,"title":"Reliability January 2020","description":"","state":"closed","created_at":"2019-12-03T16:29:27.112Z","updated_at":"2020-01-31T23:02:22.156Z","due_date":"2020-01-31","start_date":"2020-01-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/60"},"assignees":[{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"}],"author":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"type":"ISSUE","assignee":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"user_notes_count":29,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8697","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8697","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8697/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8697/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8697","relative":"#8697","full":"gitlab-com/gl-infra/reliability#8697"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":115,"epic":{"id":15220,"iid":115,"title":"Cloudflare: general dependencies \u0026 infrastructure preparations","url":"/groups/gitlab-com/gl-infra/-/epics/115","group_id":1112072,"human_readable_end_date":"Feb 28, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":28419151,"iid":8689,"project_id":1304532,"title":"investigate RCA from production/issues/1476","description":"## RCA Deep Dive\nFrom https://gitlab.com/gitlab-com/gl-infra/production/issues/1476\n\n\n### What happened\nA network glitch causes quorum loss and trigger a failover routine. As nothing was really wrong with the current leader (`patroni-06`), there was no leader change.\n\nPatroni behaves as expected, triggering a failover (thus never completing it, since `patroni-06` was detected healthy)\n\n\n\n### Evidence\n\n[Prometheus graph](https://prometheus.gprd.gitlab.net/graph?g0.range_input=1h\u0026g0.end_input=2019-12-12%2008%3A15\u0026g0.expr=rate(node_network_receive_bytes_total%7Btype%3D%22patroni%22%2Cdevice%3D%22ens4%22%7D%5B1m%5D)\u0026g0.tab=0) showing network interruption:\n![image](/uploads/c521e16497dbc7d8f1ebf0c66a0be432/image.png)\n\nAt `Dec 12 07:31:24` consul report missing contact with the current leader, `patroni-06`, followed by a quick re-join\n```\nDec 12 07:31:24 pgbouncer-02-db-gprd consul[26816]:     2019/12/12 07:31:24 [INFO] serf: EventMemberFailed: patroni-06-db-gprd 10.220.16.106\nDec 12 07:31:24 pgbouncer-02-db-gprd consul[26816]: serf: EventMemberFailed: patroni-06-db-gprd 10.220.16.106\nDec 12 07:31:25 pgbouncer-02-db-gprd consul[26816]:     2019/12/12 07:31:25 [INFO] serf: EventMemberJoin: patroni-06-db-gprd 10.220.16.106\nDec 12 07:31:25 pgbouncer-02-db-gprd consul[26816]: serf: EventMemberJoin: patroni-06-db-gprd 10.220.16.106\n```\n\nAt `2019-12-12 07:31:26.317 GMT` the same network failure causes an error during walfile upload:\n```\n2019-12-12 07:31:26.317 GMT [45589, 0]: [3-1] user=gitlab-replicator,db=[unknown],app=patroni-10-db-gprd.c.gitlab-production.internal,client=10.220.16.110 LOG:  disconnection: session time: 461:46:01.162 user=gitlab-replicator database= host=10.220.16.110 port=49464\nwal_e.worker.upload INFO     MSG: begin archiving a file\n        DETAIL: Uploading \"pg_xlog/0000001F0001862000000009\" to \"gs://gitlab-gprd-postgres-backup/pitr-wale-v1/wal_005/0000001F0001862000000009.lzo\".\n        STRUCTURED: time=2019-12-12T07:31:26.981242-00 pid=62869 action=push-wal key=gs://gitlab-gprd-postgres-backup/pitr-wale-v1/wal_005/0000001F0001862000000009.lzo prefix=pitr-wale-v1/ seg=0000001F0001862000000009 state=begin\nTraceback (most recent call last):\n  File \"/opt/wal-e/lib/python3.5/site-packages/google/cloud/storage/blob.py\", line 1158, in upload_from_file\n    client, file_obj, content_type, size, num_retries, predefined_acl\n  File \"/opt/wal-e/lib/python3.5/site-packages/google/cloud/storage/blob.py\", line 1068, in _do_upload\n    client, stream, content_type, size, num_retries, predefined_acl\n  File \"/opt/wal-e/lib/python3.5/site-packages/google/cloud/storage/blob.py\", line 1015, in _do_resumable_upload\n    response = upload.transmit_next_chunk(transport)\n  File \"/opt/wal-e/lib/python3.5/site-packages/google/resumable_media/requests/upload.py\", line 396, in transmit_next_chunk\n    self._process_response(result, len(payload))\n  File \"/opt/wal-e/lib/python3.5/site-packages/google/resumable_media/_upload.py\", line 574, in _process_response\n    self._get_status_code, callback=self._make_invalid)\n  File \"/opt/wal-e/lib/python3.5/site-packages/google/resumable_media/_helpers.py\", line 93, in require_status_code\n    status_code, u'Expected one of', *status_codes)\ngoogle.resumable_media.common.InvalidResponse: ('Request failed with status code', 410, 'Expected one of', \u003cHTTPStatus.OK: 200\u003e, 308)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"src/gevent/greenlet.py\", line 766, in gevent._greenlet.Greenlet.run\n  File \"/opt/wal-e/lib/python3.5/site-packages/wal_e/worker/upload.py\", line 59, in __call__\n    self.gpg_key_id)\n  File \"/opt/wal-e/lib/python3.5/site-packages/wal_e/worker/worker_util.py\", line 40, in do_lzop_put\n    k = blobstore.uri_put_file(creds, url, tf)\n  File \"/opt/wal-e/lib/python3.5/site-packages/wal_e/blobstore/gs/utils.py\", line 38, in uri_put_file\n    blob.upload_from_file(fp, size=size, content_type=content_type)\n  File \"/opt/wal-e/lib/python3.5/site-packages/google/cloud/storage/blob.py\", line 1162, in upload_from_file\n    _raise_from_invalid_response(exc)\n  File \"/opt/wal-e/lib/python3.5/site-packages/google/cloud/storage/blob.py\", line 2038, in _raise_from_invalid_response\n    raise exceptions.from_http_status(response.status_code, message, response=response)\ngoogle.api_core.exceptions.GoogleAPICallError: 410 PUT https://www.googleapis.com/upload/storage/v1/b/gitlab-gprd-postgres-backup/o?uploadType=resumable\u0026upload_id=AEnB2UomUBipRkns50Aj6FpTMxL-d_WXjfMyLkcAj-9bSnwLLeBl47ZHEC2olCg8340SDRyTC2qbYq_bntvY_9gipuG_v-9PBA: ('Request failed with status code', 410, 'Expected one of', \u003cHTTPStatus.OK: 200\u003e, 308)\n2019-12-12T07:31:29Z \u003cGreenlet at 0x7ffb667bf748: \u003cwal_e.worker.upload.WalUploader object at 0x7ffb6668b6d8\u003e(\u003cwal_e.worker.pg.wal_transfer.WalSegment object at)\u003e failed with GoogleAPICallError\n\nwal_e.main   CRITICAL MSG: An unprocessed exception has avoided all error handling\n        DETAIL: Traceback (most recent call last):\n          File \"/opt/wal-e/lib/python3.5/site-packages/google/cloud/storage/blob.py\", line 1158, in upload_from_file\n            client, file_obj, content_type, size, num_retries, predefined_acl\n          File \"/opt/wal-e/lib/python3.5/site-packages/google/cloud/storage/blob.py\", line 1068, in _do_upload\n            client, stream, content_type, size, num_retries, predefined_acl\n          File \"/opt/wal-e/lib/python3.5/site-packages/google/cloud/storage/blob.py\", line 1015, in _do_resumable_upload\n            response = upload.transmit_next_chunk(transport)\n          File \"/opt/wal-e/lib/python3.5/site-packages/google/resumable_media/requests/upload.py\", line 396, in transmit_next_chunk\n            self._process_response(result, len(payload))\n          File \"/opt/wal-e/lib/python3.5/site-packages/google/resumable_media/_upload.py\", line 574, in _process_response\n            self._get_status_code, callback=self._make_invalid)\n          File \"/opt/wal-e/lib/python3.5/site-packages/google/resumable_media/_helpers.py\", line 93, in require_status_code\n            status_code, u'Expected one of', *status_codes)\n        google.resumable_media.common.InvalidResponse: ('Request failed with status code', 410, 'Expected one of', \u003cHTTPStatus.OK: 200\u003e, 308)\n        \n        During handling of the above exception, another exception occurred:\n        \n        Traceback (most recent call last):\n          File \"/opt/wal-e/lib/python3.5/site-packages/wal_e/cmd.py\", line 666, in main\n            concurrency=args.pool_size)\n          File \"/opt/wal-e/lib/python3.5/site-packages/wal_e/operator/backup.py\", line 283, in wal_archive\n            group.join()\n          File \"/opt/wal-e/lib/python3.5/site-packages/wal_e/worker/pg/wal_transfer.py\", line 144, in join\n            raise val\n          File \"src/gevent/greenlet.py\", line 766, in gevent._greenlet.Greenlet.run\n          File \"/opt/wal-e/lib/python3.5/site-packages/wal_e/worker/upload.py\", line 59, in __call__\n            self.gpg_key_id)\n          File \"/opt/wal-e/lib/python3.5/site-packages/wal_e/worker/worker_util.py\", line 40, in do_lzop_put\n            k = blobstore.uri_put_file(creds, url, tf)\n          File \"/opt/wal-e/lib/python3.5/site-packages/wal_e/blobstore/gs/utils.py\", line 38, in uri_put_file\n            blob.upload_from_file(fp, size=size, content_type=content_type)\n          File \"/opt/wal-e/lib/python3.5/site-packages/google/cloud/storage/blob.py\", line 1162, in upload_from_file\n            _raise_from_invalid_response(exc)\n          File \"/opt/wal-e/lib/python3.5/site-packages/google/cloud/storage/blob.py\", line 2038, in _raise_from_invalid_response\n            raise exceptions.from_http_status(response.status_code, message, response=response)\n        google.api_core.exceptions.GoogleAPICallError: 410 PUT https://www.googleapis.com/upload/storage/v1/b/gitlab-gprd-postgres-backup/o?uploadType=resumable\u0026upload_id=AEnB2UomUBipRkns50Aj6FpTMxL-d_WXjfMyLkcAj-9bSnwLLeBl47ZHEC2olCg8340SDRyTC2qbYq_bntvY_9gipuG_v-9PBA: ('Request failed with status code', 410, 'Expected one of', \u003cHTTPStatus.OK: 200\u003e, 308)\n        \n        STRUCTURED: time=2019-12-12T07:31:29.645893-00 pid=62869\n```\n### Starting the leader election\nNext, every replica with at least one peer with the wal position _ahead_ of themselves, downvotes himself:\n```\npatroni-01-db-gprd.c.gitlab-production.internal/syslog.1:Dec 12 07:31:25 patroni-01-db-gprd patroni[58612]: 2019-12-12 07:31:25,249 INFO: Wal position of patroni-09-db-gprd.c.gitlab-production.internal is ahead of my wal position\n\npatroni-02-db-gprd.c.gitlab-production.internal/syslog.1:Dec 12 07:31:25 patroni-02-db-gprd patroni[92454]: 2019-12-12 07:31:25,232 INFO: Wal position of patroni-08-db-gprd.c.gitlab-production.internal is ahead of my wal position\n\npatroni-03-db-gprd.c.gitlab-production.internal/patroni.log.1:2019-12-12_07:31:26 patroni-03-db-gprd patroni[97589]:  2019-12-12 07:31:26,121 INFO: Wal position of patroni-05-db-gprd.c.gitlab-production.internal is ahead of my wal position\n\npatroni-04-db-gprd.c.gitlab-production.internal/syslog.1:Dec 12 07:31:26 patroni-04-db-gprd patroni[38752]: 2019-12-12 07:31:26,162 INFO: Wal position of patroni-02-db-gprd.c.gitlab-production.internal is ahead of my wal position\n\npatroni-05-db-gprd.c.gitlab-production.internal/syslog.1:Dec 12 07:31:25 patroni-05-db-gprd patroni[24338]: 2019-12-12 07:31:25,228 INFO: Wal position of patroni-07-db-gprd.c.gitlab-production.internal is ahead of my wal position\n\npatroni-07-db-gprd.c.gitlab-production.internal/syslog.1:Dec 12 07:31:25 patroni-07-db-gprd patroni[2378]: 2019-12-12 07:31:25,276 INFO: Wal position of patroni-03-db-gprd.c.gitlab-production.internal is ahead of my wal position\n\npatroni-09-db-gprd.c.gitlab-production.internal/patroni.log.1:2019-12-12_07:31:26 patroni-09-db-gprd patroni[59084]:  2019-12-12 07:31:26,153 INFO: Wal position of patroni-03-db-gprd.c.gitlab-production.internal is ahead of my wal position\n\npatroni-10-db-gprd.c.gitlab-production.internal/syslog.1:Dec 12 07:31:25 patroni-10-db-gprd patroni[1712]: 2019-12-12 07:31:25,263 INFO: Wal position of patroni-01-db-gprd.c.gitlab-production.internal is ahead of my wal position\n\npatroni-11-db-gprd.c.gitlab-production.internal/syslog.1:Dec 12 07:31:25 patroni-11-db-gprd patroni[54181]: 2019-12-12 07:31:25,281 INFO: Wal position of patroni-02-db-gprd.c.gitlab-production.internal is ahead of my wal position\n\npatroni-12-db-gprd.c.gitlab-production.internal/syslog.1:Dec 12 07:31:26 patroni-12-db-gprd patroni[59289]: 2019-12-12 07:31:26,117 INFO: Wal position of patroni-01-db-gprd.c.gitlab-production.internal is ahead of my wal position\n\n\n```\nLeaving `patroni-08` as the best candidate for new ledear. Logs from `patroni-08`:\n```\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:25,081 INFO: Got response from patroni-05-db-gprd.c.gitlab-production.internal http://10.220.16.105:8009/patroni: b'{\"database_system_identifier\": \"6343687859876602183\", \"role\": \"replica\", \"cluster_unlocked\": true, \"timeline\": 31, \"patroni\": {\"scope\": \"pg-ha-cluster\", \"version\": \"1.6.0\"}, \"postmaster_start_time\": \"2019-10-29 09:21:50.461 GMT\", \"xlog\": {\"replayed_timestamp\": \"2019-12-12 07:31:25.054 GMT\", \"received_location\": 428947133460896, \"replayed_location\": 428947133460896, \"paused\": false}, \"state\": \"running\", \"server_version\": 90614}'\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:25,081 INFO: Got response from patroni-06-db-gprd.c.gitlab-production.internal http://10.220.16.106:8009/patroni: b'{\"state\": \"running\", \"database_system_identifier\": \"6343687859876602183\", \"timeline\": 31, \"role\": \"master\", \"replication\": [{\"state\": \"streaming\", \"client_addr\": \"10.220.16.107\", \"application_name\": \"patroni-07-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\": 0, \"sync_state\": \"async\"}, {\"state\": \"streaming\", \"client_addr\": \"10.220.16.109\", \"application_name\": \"patroni-09-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\": 0, \"sync_state\": \"async\"}, {\"state\": \"streaming\", \"client_addr\": \"10.220.16.111\", \"application_name\": \"patroni-11-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\": 0, \"sync_state\": \"async\"}, {\"state\": \"streaming\", \"client_addr\": \"10.220.16.112\", \"application_name\": \"patroni-12-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\": 0, \"sync_state\": \"async\"}, {\"state\": \"streaming\", \"client_addr\": \"10.220.16.108\", \"application_name\": \"patroni-08-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\": 0, \"sync_state\": \"async\"}, {\"state\": \"streaming\", \"client_addr\": \"10.220.16.103\", \"application_name\": \"patroni-03-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\": 0, \"sync_state\": \"async\"}, {\"state\": \"streaming\", \"client_addr\": \"10.220.16.104\", \"application_name\": \"patroni-04-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\": 0, \"sync_state\": \"async\"}, {\"state\": \"streaming\", \"client_addr\": \"10.220.16.102\", \"application_name\": \"patroni-02-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\": 0, \"sync_state\": \"async\"}, {\"state\": \"streaming\", \"client_addr\": \"10.220.16.105\", \"application_name\": \"patroni-05-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\":\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  0, \"sync_state\": \"async\"}, {\"state\": \"streaming\", \"client_addr\": \"10.220.16.110\", \"application_name\": \"patroni-10-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\": 0, \"sync_state\": \"async\"}, {\"state\": \"streaming\", \"client_addr\": \"10.220.16.101\", \"application_name\": \"patroni-01-db-gprd.c.gitlab-production.internal\", \"usename\": \"gitlab-replicator\", \"sync_priority\": 0, \"sync_state\": \"async\"}], \"server_version\": 90614, \"postmaster_start_time\": \"2019-10-28 16:07:16.645 GMT\", \"patroni\": {\"scope\": \"pg-ha-cluster\", \"version\": \"1.6.0\"}, \"xlog\": {\"location\": 428947133581640}, \"cluster_unlocked\": false}'\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:25,084 INFO: Got response from patroni-10-db-gprd.c.gitlab-production.internal http://10.220.16.110:8009/patroni: b'{\"postmaster_start_time\": \"2019-11-23 01:39:04.569 GMT\", \"cluster_unlocked\": true, \"timeline\": 31, \"xlog\": {\"replayed_timestamp\": \"2019-12-12 07:31:25.063 GMT\", \"replayed_location\": 428947133566072, \"paused\": false, \"received_location\": 428947133566072}, \"state\": \"running\", \"server_version\": 90615, \"role\": \"replica\", \"database_system_identifier\": \"6343687859876602183\", \"patroni\": {\"version\": \"1.6.0\", \"scope\": \"pg-ha-cluster\"}}'\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:25,088 INFO: Got response from patroni-07-db-gprd.c.gitlab-production.internal http://10.220.16.107:8009/patroni: b'{\"patroni\": {\"version\": \"1.6.0\", \"scope\": \"pg-ha-cluster\"}, \"server_version\": 90615, \"database_system_identifier\": \"6343687859876602183\", \"state\": \"running\", \"role\": \"replica\", \"cluster_unlocked\": true, \"timeline\": 31, \"postmaster_start_time\": \"2019-10-29 17:48:07.243 GMT\", \"xlog\": {\"received_location\": 428947133581640, \"paused\": false, \"replayed_location\": 428947133581640, \"replayed_timestamp\": \"2019-12-12 07:31:25.070 GMT\"}}'\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:25,092 INFO: Got response from patroni-01-db-gprd.c.gitlab-production.internal http://10.220.16.101:8009/patroni: b'{\"state\": \"running\", \"cluster_unlocked\": true, \"xlog\": {\"replayed_location\": 428947133581640, \"replayed_timestamp\": \"2019-12-12 07:31:25.070 GMT\", \"received_location\": 428947133582952, \"paused\": false}, \"database_system_identifier\": \"6343687859876602183\", \"server_version\": 90615, \"role\": \"replica\", \"postmaster_start_time\": \"2019-11-27 23:12:39.985 GMT\", \"patroni\": {\"scope\": \"pg-ha-cluster\", \"version\": \"1.6.0\"}, \"timeline\": 31}'\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:25,105 INFO: Got response from patroni-09-db-gprd.c.gitlab-production.internal http://10.220.16.109:8009/patroni: b'{\"database_system_identifier\": \"6343687859876602183\", \"server_version\": 90615, \"timeline\": 31, \"state\": \"running\", \"cluster_unlocked\": true, \"xlog\": {\"paused\": false, \"replayed_location\": 428947133581640, \"received_location\": 428947133581640, \"replayed_timestamp\": \"2019-12-12 07:31:25.070 GMT\"}, \"postmaster_start_time\": \"2019-10-29 09:21:52.573 GMT\", \"role\": \"replica\", \"patroni\": {\"scope\": \"pg-ha-cluster\", \"version\": \"1.6.0\"}}'\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:25,120 INFO: Got response from patroni-02-db-gprd.c.gitlab-production.internal http://10.220.16.102:8009/patroni: b'{\"cluster_unlocked\": true, \"timeline\": 31, \"state\": \"running\", \"postmaster_start_time\": \"2019-10-29 09:21:50.651 GMT\", \"patroni\": {\"scope\": \"pg-ha-cluster\", \"version\": \"1.6.0\"}, \"xlog\": {\"received_location\": 428947133600792, \"replayed_timestamp\": \"2019-12-12 07:31:25.079 GMT\", \"paused\": false, \"replayed_location\": 428947133600792}, \"database_system_identifier\": \"6343687859876602183\", \"server_version\": 90614, \"role\": \"replica\"}'\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:25,187 INFO: Got response from patroni-04-db-gprd.c.gitlab-production.internal http://10.220.16.104:8009/patroni: b'{\"role\": \"replica\", \"server_version\": 90614, \"database_system_identifier\": \"6343687859876602183\", \"cluster_unlocked\": true, \"patroni\": {\"scope\": \"pg-ha-cluster\", \"version\": \"1.6.0\"}, \"postmaster_start_time\": \"2019-10-29 09:21:51.098 GMT\", \"timeline\": 31, \"state\": \"running\", \"xlog\": {\"replayed_timestamp\": \"2019-12-12 07:31:25.067 GMT\", \"replayed_location\": 428947133580968, \"paused\": false, \"received_location\": 428947133580968}}'\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:25,190 INFO: Got response from patroni-03-db-gprd.c.gitlab-production.internal http://10.220.16.103:8009/patroni: b'{\"patroni\": {\"version\": \"1.6.0\", \"scope\": \"pg-ha-cluster\"}, \"state\": \"running\", \"timeline\": 31, \"cluster_unlocked\": true, \"server_version\": 90614, \"role\": \"replica\", \"database_system_identifier\": \"6343687859876602183\", \"xlog\": {\"replayed_location\": 428947133721400, \"replayed_timestamp\": \"2019-12-12 07:31:25.123 GMT\", \"received_location\": 428947133721400, \"paused\": false}, \"postmaster_start_time\": \"2019-10-29 09:21:50.671 GMT\"}'\n2019-12-12_07:31:25 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:25,202 INFO: Got response from patroni-11-db-gprd.c.gitlab-production.internal http://10.220.16.111:8009/patroni: b'{\"patroni\": {\"scope\": \"pg-ha-cluster\", \"version\": \"1.6.0\"}, \"postmaster_start_time\": \"2019-10-29 09:21:50.985 GMT\", \"cluster_unlocked\": true, \"timeline\": 31, \"xlog\": {\"replayed_location\": 428947134134856, \"replayed_timestamp\": \"2019-12-12 07:31:25.173 GMT\", \"paused\": false, \"received_location\": 428947134134856}, \"role\": \"replica\", \"database_system_identifier\": \"6343687859876602183\", \"server_version\": 90615, \"state\": \"running\"}'\n2019-12-12_07:31:26 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:26,088 INFO: Got response from patroni-12-db-gprd.c.gitlab-production.internal http://10.220.16.112:8009/patroni: b'{\"role\": \"replica\", \"state\": \"running\", \"database_system_identifier\": \"6343687859876602183\", \"postmaster_start_time\": \"2019-10-29 09:21:52.046 GMT\", \"xlog\": {\"replayed_timestamp\": \"2019-12-12 07:31:26.067 GMT\", \"replayed_location\": 428947138866080, \"received_location\": 428947138866080, \"paused\": false}, \"timeline\": 31, \"server_version\": 90615, \"cluster_unlocked\": true, \"patroni\": {\"scope\": \"pg-ha-cluster\", \"version\": \"1.6.0\"}}'\n2019-12-12_07:31:26 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:26,153 WARNING: Master (patroni-06-db-gprd.c.gitlab-production.internal) is still alive\n2019-12-12_07:31:26 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:26,173 INFO: following a different leader because i am not the healthiest node\n2019-12-12_07:31:34 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:34,905 INFO: Lock owner: patroni-06-db-gprd.c.gitlab-production.internal; I am patroni-08-db-gprd.c.gitlab-production.internal\n2019-12-12_07:31:34 patroni-08-db-gprd patroni[29808]:  2019-12-12 07:31:34,917 INFO: changing primary_conninfo and restarting in progress\n\n```\nSo, as nothing really were wrong with `patroni-06` and was still online, leader role was preserved, and timeline is still 31:\n\n```\n+---------------+-------------------------------------------------+---------------+--------+---------+----+-----------+\n|    Cluster    |                      Member                     |      Host     |  Role  |  State  | TL | Lag in MB |\n+---------------+-------------------------------------------------+---------------+--------+---------+----+-----------+\n| pg-ha-cluster | patroni-01-db-gprd.c.gitlab-production.internal | 10.220.16.101 |        | running | 31 |        39 |\n| pg-ha-cluster | patroni-02-db-gprd.c.gitlab-production.internal | 10.220.16.102 |        | running | 31 |        43 |\n| pg-ha-cluster | patroni-03-db-gprd.c.gitlab-production.internal | 10.220.16.103 |        | running | 31 |        32 |\n| pg-ha-cluster | patroni-04-db-gprd.c.gitlab-production.internal | 10.220.16.104 |        | running | 31 |        39 |\n| pg-ha-cluster | patroni-05-db-gprd.c.gitlab-production.internal | 10.220.16.105 |        | running | 31 |           |\n| pg-ha-cluster | patroni-06-db-gprd.c.gitlab-production.internal | 10.220.16.106 | Leader | running | 31 |         0 |\n| pg-ha-cluster | patroni-07-db-gprd.c.gitlab-production.internal | 10.220.16.107 |        | running | 31 |        51 |\n| pg-ha-cluster | patroni-08-db-gprd.c.gitlab-production.internal | 10.220.16.108 |        | running | 31 |        46 |\n| pg-ha-cluster | patroni-09-db-gprd.c.gitlab-production.internal | 10.220.16.109 |        | running | 31 |        42 |\n| pg-ha-cluster | patroni-10-db-gprd.c.gitlab-production.internal | 10.220.16.110 |        | running | 31 |        31 |\n| pg-ha-cluster | patroni-11-db-gprd.c.gitlab-production.internal | 10.220.16.111 |        | running | 31 |        50 |\n| pg-ha-cluster | patroni-12-db-gprd.c.gitlab-production.internal | 10.220.16.112 |        | running | 31 |        34 |\n+---------------+-------------------------------------------------+---------------+--------+---------+----+-----------+\n\n\n```\n\n\n## Consecuences\n\n- ~ 1 minute downtime in the replicas ( because of the restarting)\n\n\n\n## Corrective actions\n\n- Investigate the usage consul.checks:[] at patroni config to be more resilient ti short network glitches.","state":"closed","created_at":"2019-12-12T16:25:54.796Z","updated_at":"2022-08-04T17:59:50.151Z","closed_at":"2019-12-23T01:57:25.396Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","Database","OnGres::Project","priority::1","severity::1","workflow-infra::Done"],"milestone":{"id":1099881,"iid":62,"group_id":1112072,"title":"DBRE W51","description":"","state":"closed","created_at":"2019-12-16T13:11:17.324Z","updated_at":"2020-01-16T17:23:54.827Z","due_date":"2019-12-27","start_date":"2019-12-16","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/62"},"assignees":[{"id":3007633,"username":"gerardo.herzig","name":"Gerardo Herzig","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3007633/avatar.png","web_url":"https://gitlab.com/gerardo.herzig"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":3007633,"username":"gerardo.herzig","name":"Gerardo Herzig","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3007633/avatar.png","web_url":"https://gitlab.com/gerardo.herzig"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8689","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8689","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8689/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8689/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8689","relative":"#8689","full":"gitlab-com/gl-infra/reliability#8689"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28331221,"iid":8679,"project_id":1304532,"title":"Hosted discourse forum PoC testing / readiness review","description":"Once we have a PoC environment provisioned and accessible under \u0026139, with a recently [restored backup](https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8677) and [authentication configured](https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8678), we need to perform thorough validation. This should include working through a [readiness review](https://gitlab.com/gitlab-com/gl-infra/readiness).","state":"closed","created_at":"2019-12-11T20:54:44.906Z","updated_at":"2020-02-11T00:27:56.747Z","closed_at":"2020-02-10T23:03:22.575Z","closed_by":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"labels":["Service::Forum","forum.gitlab.com","team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"}],"author":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"type":"ISSUE","assignee":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8679","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8679","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8679/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8679/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8679","relative":"#8679","full":"gitlab-com/gl-infra/reliability#8679"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":139,"epic":{"id":16107,"iid":139,"title":"Migrate forum.gitlab.com to hosted Discourse SaaS","url":"/groups/gitlab-com/gl-infra/-/epics/139","group_id":1112072,"human_readable_end_date":"Jan 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":28318751,"iid":8672,"project_id":1304532,"title":"Transparency into API requests by IP and project ID","description":"As an SRE on call, I need to be able to quickly identify problem users and projects in unicorn and workhorse, specifically with respect to API calls.","state":"closed","created_at":"2019-12-11T16:15:04.740Z","updated_at":"2022-08-04T18:00:05.299Z","closed_at":"2020-08-13T15:46:29.050Z","closed_by":{"id":2222520,"username":"dawsmith","name":"Dave Smith","state":"active","avatar_url":"https://secure.gravatar.com/avatar/ef341e061f6b86461626e64c5fbcfe52?s=80\u0026d=identicon","web_url":"https://gitlab.com/dawsmith"},"labels":["corrective action","severity::3","workflow-infra::Done"],"milestone":null,"assignees":[],"author":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8672","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8672","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8672/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8672/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8672","relative":"#8672","full":"gitlab-com/gl-infra/reliability#8672"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28314510,"iid":8668,"project_id":1304532,"title":"Learn about Elastic Search 7.x","description":"Gain knowledge about Elastic Search v 7.x to be able to setup and support it as log search solution.\n\n* [ ] Find learning material, share findings\n* [ ] Evaluate possible training options / certifications\n* [ ] Read stuff, try things\n* [ ] improve docs","state":"closed","created_at":"2019-12-11T14:18:02.977Z","updated_at":"2020-03-02T15:09:00.098Z","closed_at":"2020-03-02T14:37:50.070Z","closed_by":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"labels":["Observability-reliability","Service::Logging","Vendor::Elastic","team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8668","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":4,"completed_count":0},"weight":8,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8668","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8668/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8668/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8668","relative":"#8668","full":"gitlab-com/gl-infra/reliability#8668"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":130,"epic":{"id":16037,"iid":130,"title":"Elastic Logging Cluster Upgrade from 5.X to 7.X","url":"/groups/gitlab-com/gl-infra/-/epics/130","group_id":1112072,"human_readable_end_date":"Feb 7, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":28310903,"iid":8667,"project_id":1304532,"title":"Verification step of postgres-gprd is failing","description":"Related to https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8643\n\nThe actual verification script is failing to return successfully.\n\nExample: https://ops.gitlab.net/gitlab-com/gl-infra/gitlab-restore/postgres-gprd/-/jobs/785011","state":"closed","created_at":"2019-12-11T13:01:39.208Z","updated_at":"2021-06-24T08:08:16.051Z","closed_at":"2019-12-11T16:47:26.065Z","closed_by":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"labels":["SRE:On-call","priority::1","workflow-infra::Done"],"milestone":null,"assignees":[{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"}],"author":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"type":"ISSUE","assignee":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8667","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8667","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8667/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8667/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8667","relative":"#8667","full":"gitlab-com/gl-infra/reliability#8667"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28242485,"iid":8659,"project_id":1304532,"title":"Turn down Azure/DO blackbox prober","description":"We don't get alerts from Azure anymore, and we're trying to clean out this infra.\n\nRemove the blackbox exporter server and jobs from Azure/DO production.","state":"closed","created_at":"2019-12-10T13:01:05.448Z","updated_at":"2022-08-04T18:00:14.646Z","closed_at":"2019-12-12T07:39:58.953Z","closed_by":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"}],"author":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"type":"ISSUE","assignee":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8659","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8659","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8659/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8659/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8659","relative":"#8659","full":"gitlab-com/gl-infra/reliability#8659"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28082432,"iid":8646,"project_id":1304532,"title":"A \"5% disk space left\" alert gets fired, but resolves almost immediately","description":"A \"5% disk space left\" alert gets fired, and I get paged through PagerDuty, but then when I go to take a look at the disks on the system, everything appears normal.\n\n```\nnelsnelson@sidekiq-export-04-sv-gprd.c.gitlab-production.internal:~$ df -h\nFilesystem                                                                                       Size  Used Avail Use% Mounted on\nudev                                                                                              26G     0   26G   0% /dev\ntmpfs                                                                                            5.2G  550M  4.6G  11% /run\n/dev/sda1                                                                                         20G   11G  9.1G  54% /\ntmpfs                                                                                             26G  4.0K   26G   1% /dev/shm\ntmpfs                                                                                            5.0M     0  5.0M   0% /run/lock\ntmpfs                                                                                             26G     0   26G   0% /sys/fs/cgroup\n/dev/sdb                                                                                          50G  151M   49G   1% /var/log\nshare-01-stor-gprd.c.gitlab-production.internal:/var/opt/gitlab/gitlab-rails/shared/artifacts     20T   11T  9.4T  52% /var/opt/gitlab/gitlab-rails/shared/artifacts\nshare-01-stor-gprd.c.gitlab-production.internal:/var/opt/gitlab/gitlab-ci/builds                  20T   11T  9.4T  52% /var/opt/gitlab/gitlab-ci/builds\nshare-01-stor-gprd.c.gitlab-production.internal:/var/opt/gitlab/gitlab-rails/shared/lfs-objects   20T   11T  9.4T  52% /var/opt/gitlab/gitlab-rails/shared/lfs-objects\npages-01-stor-gprd.c.gitlab-production.internal:/var/opt/gitlab/gitlab-rails/shared/pages         16T  5.0T   11T  32% /var/opt/gitlab/gitlab-rails/shared/pages\nshare-01-stor-gprd.c.gitlab-production.internal:/var/opt/gitlab/gitlab-rails/uploads              20T   11T  9.4T  52% /var/opt/gitlab/gitlab-rails/uploads\ntmpfs                                                                                            5.2G     0  5.2G   0% /run/user/1017\n```\n\nI suppose this is because the disk capacity dip is so brief, and I did not run the `df` check quickly enough.\n\n![Screen_Shot_2019-12-08_at_10.28.35_AM](/uploads/eccbfa2bcd3905705dc14990017f9a0a/Screen_Shot_2019-12-08_at_10.28.35_AM.png)","state":"closed","created_at":"2019-12-08T16:30:44.191Z","updated_at":"2022-08-04T18:00:35.002Z","closed_at":"2021-02-16T21:53:13.306Z","closed_by":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"labels":["Service::Sidekiq","auto updated","workflow-infra::Done"],"milestone":null,"assignees":[{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"}],"author":{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"},"type":"ISSUE","assignee":{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2019-12-08","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8646","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8646","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8646/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8646/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8646","relative":"#8646","full":"gitlab-com/gl-infra/reliability#8646"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28070585,"iid":8643,"project_id":1304532,"title":"Failed to connect to 10.226.1.4 port 9091: Operation timed out","description":"It seems that the deadman's switch for a few hosts may not be operational or reachable on their normal port 9091.\n\n\u003e Can anyone help understand what is 10.226.1.4?\n\u003e It's hardcoded in gitlab-restore as a destination for the final signal about successful restoration  https://ops.gitlab.net/gitlab-com/gl-infra/gitlab-restore/postgres-gprd/blob/master/common.sh#L45 – looks like it's not available anymore\n```* Failed to connect to 10.226.1.4 port 9091: Operation timed out```\n\u003e So, the verification for staging backups is always failing https://ops.gitlab.net/gitlab-com/gl-infra/gitlab-restore/postgres-gprd/-/jobs/779052.\n\u003e Any recent changes with that address and should it be changed?\n\u003e 10.226.1.3 is also unavailable. And 10.250.8.9\n\n-- https://gitlab.slack.com/archives/CB3LSMEJV/p1575757987020800","state":"closed","created_at":"2019-12-07T23:09:56.131Z","updated_at":"2021-06-24T08:08:17.081Z","closed_at":"2019-12-13T02:40:22.196Z","closed_by":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"labels":["SRE:On-call","priority::1","workflow-infra::Done"],"milestone":null,"assignees":[{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"}],"author":{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"},"type":"ISSUE","assignee":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"user_notes_count":16,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2019-12-09","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8643","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8643","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8643/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8643/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8643","relative":"#8643","full":"gitlab-com/gl-infra/reliability#8643"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":28027466,"iid":8629,"project_id":1304532,"title":"Weird wobbling of web/haproxy latency+error ratios","description":"Noticed this happening today.  The onset of the wobbling seems to correspond with the natural increase of traffic as Europe and Americas comes online.\n\n![Screen_Shot_2019-12-06_at_10.16.46_AM](/uploads/8c2977c15a540300e6247dc48f656de5/Screen_Shot_2019-12-06_at_10.16.46_AM.png)\n\n![Screen_Shot_2019-12-06_at_10.14.32_AM](/uploads/4a9a3cd8ae8de9fcac7d0c02ef35af51/Screen_Shot_2019-12-06_at_10.14.32_AM.png)\n\n![Screen_Shot_2019-12-06_at_10.13.36_AM](/uploads/3bb1a6f192f62ddf90056bbc35ae479b/Screen_Shot_2019-12-06_at_10.13.36_AM.png)\n\n![Screen_Shot_2019-12-06_at_10.13.35_AM](/uploads/09976c0a5c513bf1934226b922f9ba14/Screen_Shot_2019-12-06_at_10.13.35_AM.png)","state":"closed","created_at":"2019-12-06T16:20:27.496Z","updated_at":"2022-08-04T18:00:48.019Z","closed_at":"2021-03-04T00:47:16.250Z","closed_by":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"labels":["Service::HAProxy","auto updated","workflow-infra::Done"],"milestone":null,"assignees":[{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"}],"author":{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"},"type":"ISSUE","assignee":{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8629","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8629","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8629/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8629/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8629","relative":"#8629","full":"gitlab-com/gl-infra/reliability#8629"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27996584,"iid":8603,"project_id":1304532,"title":"Upgrade to terraform GCP provider 3.x","description":"The most recent major version upgrade of the Google Cloud Terraform provider has been released, and includes [several changes](https://github.com/terraform-providers/terraform-provider-google/blob/master/CHANGELOG.md) we will want/need in the near future. Note that this impacts how we manage GCP projects, however (see #8122)\n\nNote that this will require a fair amount of review and testing to ensure we don't have any issues in any modules and/or when rolling out deployments across environments. This issue should be updated according to the [upgrade guide](https://www.terraform.io/docs/providers/google/guides/version_3_upgrade.html) or split into further tasks as required.\n\n/cc @gitlab-com/gl-infra","state":"closed","created_at":"2019-12-05T21:46:22.257Z","updated_at":"2020-11-13T12:09:36.558Z","closed_at":"2020-11-13T12:09:36.521Z","closed_by":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"labels":["terraform","workflow-infra::Done"],"milestone":{"id":1380225,"iid":93,"group_id":1112072,"title":"Observability Team - November 2020","description":"","state":"closed","created_at":"2020-07-24T19:09:13.783Z","updated_at":"2020-11-30T20:11:36.173Z","due_date":"2020-11-30","start_date":"2020-11-02","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/93"},"assignees":[{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"}],"author":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"type":"ISSUE","assignee":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"user_notes_count":8,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8603","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8603","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8603/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8603/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8603","relative":"#8603","full":"gitlab-com/gl-infra/reliability#8603"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":219,"epic":{"id":46451,"iid":219,"title":"Terraform Improvements Backlog","url":"/groups/gitlab-com/gl-infra/-/epics/219","group_id":1112072},"iteration":null,"health_status":null},{"id":27995476,"iid":8602,"project_id":1304532,"title":"Match existing chef server config in gitlab-chef-server cookbook","description":"Once the base cookbook to [automate chef-server installation](#8601) has been completed, we need to document and replicate the existing chef server configuration in the cookbook attributes, and validate via chefspec/inspec.","state":"closed","created_at":"2019-12-05T20:35:59.631Z","updated_at":"2020-12-01T15:50:58.588Z","closed_at":"2020-12-01T15:50:41.118Z","closed_by":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"labels":["chef","workflow-infra::Done"],"milestone":null,"assignees":[{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"}],"author":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"type":"ISSUE","assignee":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8602","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8602","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8602/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8602/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8602","relative":"#8602","full":"gitlab-com/gl-infra/reliability#8602"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":138,"epic":{"id":16102,"iid":138,"title":"Migrate Chef from DO to GCP","url":"/groups/gitlab-com/gl-infra/-/epics/138","group_id":1112072,"human_readable_end_date":"Oct 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27995407,"iid":8601,"project_id":1304532,"title":"Automate chef-server install","description":"Follow-up / breakout from #8028 - while the terraform code is in place for an instance in us-central, the bootstrap needs to be improved. Our current chef server was built manually, and has little to no automation for the installation and configuration of the chef server itself. There is a [chef-server cookbook](https://github.com/chef-cookbooks/chef-server) that was added to a [new role](https://ops.gitlab.net/gitlab-cookbooks/chef-repo/blob/master/roles/chef-gitlab-net.json) based on the prior one.\n\nWith this configuration, however, we do not have any ability to test independently of deploying changes to the role onto the chef server; this issue is to track the creation of a container build/test/deployment pipeline (if possible), or a \"standard\" wrapper cookbook around `chef-server`, and the corresponding test-kitchen/chefspec/inspec config to validate, otherwise.","state":"closed","created_at":"2019-12-05T20:31:58.951Z","updated_at":"2022-08-04T18:01:06.261Z","closed_at":"2020-10-01T06:13:04.819Z","closed_by":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"labels":["chef","workflow-infra::Done"],"milestone":null,"assignees":[{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"}],"author":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"type":"ISSUE","assignee":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"user_notes_count":16,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8601","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8601","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8601/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8601/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8601","relative":"#8601","full":"gitlab-com/gl-infra/reliability#8601"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":138,"epic":{"id":16102,"iid":138,"title":"Migrate Chef from DO to GCP","url":"/groups/gitlab-com/gl-infra/-/epics/138","group_id":1112072,"human_readable_end_date":"Oct 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27994920,"iid":8600,"project_id":1304532,"title":"Investigate application start failures when all known read-only replicas are not responsive.","description":"## Summary\n\nIn the Incident Review meeting earlier today (05 December), corrective action item 13 in https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8528 was skipped in favor of a more in-depth discussion.\n\n\u003e We need to investigate why losing just 2 patroni node affected us\n\nThe meeting was nearly over, so I stated that a follow-up meeting should be scheduled to discuss the concern. Most of the individuals in the call assembled for shortly after for a separate call, and wed ended up discussing the matter then. It became evident quickly that more information needs to be uncovered before a fruitful conversation can take place.\n\n## Definition of Done\n\n- [x] Outline the technical conditions under which the failure occurred.\n  - [x] Provide steps to reproduce the behavior.\n- [ ] Document this scenario in the appropriate section of our runbook.\n- [x] @ansdval will determine a priority level and bring it to the attention of the development teams in the Performance \u0026 Availability meeting using `~infradev` and ~gitlab.com label combination.","state":"closed","created_at":"2019-12-05T20:05:27.534Z","updated_at":"2021-07-07T10:29:43.855Z","closed_at":"2020-09-10T21:11:47.404Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["Database","corrective action","priority::2","severity::3","workflow-infra::Done"],"milestone":{"id":1601715,"iid":96,"group_id":1112072,"title":"Datastores Team - From 24-Aug-2020","description":"Ongoing","state":"closed","created_at":"2020-08-24T16:42:42.935Z","updated_at":"2021-01-06T15:06:17.571Z","due_date":"2020-09-20","start_date":"2020-08-24","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/96"},"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":20,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8600","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":4,"completed_count":3},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8600","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8600/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8600/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8600","relative":"#8600","full":"gitlab-com/gl-infra/reliability#8600"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":"at_risk"},{"id":27988400,"iid":8599,"project_id":1304532,"title":"evaluate migration to Postgresql 12","description":"It is needed to plan a migration for PostgreSQL to a newer version.\n\nFor this task, we need to evaluate the options for the migration","state":"closed","created_at":"2019-12-05T17:09:50.339Z","updated_at":"2021-06-24T08:08:17.553Z","closed_at":"2020-02-02T07:59:18.472Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","OnGres::Project","priority::2","workflow-infra::Done"],"milestone":{"id":1128198,"iid":64,"group_id":1112072,"title":"W4 DBRE","description":"","state":"closed","created_at":"2020-01-20T06:26:40.274Z","updated_at":"2020-02-10T07:10:19.720Z","due_date":"2020-01-31","start_date":"2020-01-20","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/64"},"assignees":[{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"user_notes_count":2,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8599","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":20,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8599","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8599/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8599/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8599","relative":"#8599","full":"gitlab-com/gl-infra/reliability#8599"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":106,"epic":{"id":14061,"iid":106,"title":"Upgrade Postgresql to version 11.7 on GitLab.com","url":"/groups/gitlab-com/gl-infra/-/epics/106","group_id":1112072,"human_readable_end_date":"Apr 30, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27986142,"iid":8597,"project_id":1304532,"title":"Create metrics catalog for Praefect","description":"To establish Apdex and error rate metrics and alerting, and graphana dashboards\n\n/cc @johncai @nnelson","state":"closed","created_at":"2019-12-05T16:04:17.620Z","updated_at":"2022-08-04T18:01:08.381Z","closed_at":"2020-01-06T19:50:58.711Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["workflow-infra::Done"],"milestone":{"id":1087804,"iid":60,"group_id":1112072,"title":"Reliability January 2020","description":"","state":"closed","created_at":"2019-12-03T16:29:27.112Z","updated_at":"2020-01-31T23:02:22.156Z","due_date":"2020-01-31","start_date":"2020-01-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/60"},"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8597","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8597","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8597/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8597/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8597","relative":"#8597","full":"gitlab-com/gl-infra/reliability#8597"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":199,"epic":{"id":14582,"iid":199,"title":"HA Gitaly on GitLab.com","url":"/groups/gitlab-com/-/epics/199","group_id":6543,"human_readable_end_date":"Jan 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27981854,"iid":8592,"project_id":1304532,"title":"Use custom instance type for Patroni nodes","description":"We currently use `n1-highmem-96` to get 600GB memory PostgreSQL server instances. This leads to very under-utilized CPU. This is currently wasting 20% of our GCP CPU quota. Not to mention the cost of reserving 1000 cores we don't use.\n\nWe can easily cut this down by using a custom node type.\n\n![image](/uploads/648dbc4c6d5168258331866c1f164784/image.png)\n\nBased on this \"worst case\" CPU utilization, we peak at about 30 cores in use. We can safely cut the allocated cores by 50% to 48 CPUs.\n\nProposal: Switch allocation to `custom-48-614400`.","state":"closed","created_at":"2019-12-05T14:00:43.120Z","updated_at":"2022-08-04T18:01:12.916Z","closed_at":"2020-07-09T11:35:46.202Z","closed_by":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"labels":["Database","caplan","priority::3","workflow-infra::Done"],"milestone":{"id":1239654,"iid":76,"group_id":1112072,"title":"W16 DBRE","description":"","state":"closed","created_at":"2020-04-14T09:14:09.392Z","updated_at":"2020-05-13T19:56:10.734Z","due_date":"2020-05-08","start_date":"2020-04-14","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/76"},"assignees":[{"id":2493611,"username":"adescoms","name":"Adrián Escoms","state":"active","avatar_url":"https://secure.gravatar.com/avatar/d6f86d318669a8b32174b7132607443d?s=80\u0026d=identicon","web_url":"https://gitlab.com/adescoms"},{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"}],"author":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"type":"ISSUE","assignee":{"id":2493611,"username":"adescoms","name":"Adrián Escoms","state":"active","avatar_url":"https://secure.gravatar.com/avatar/d6f86d318669a8b32174b7132607443d?s=80\u0026d=identicon","web_url":"https://gitlab.com/adescoms"},"user_notes_count":26,"merge_requests_count":0,"upvotes":3,"downvotes":0,"due_date":"2020-05-29","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8592","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8592","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8592/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8592/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8592","relative":"#8592","full":"gitlab-com/gl-infra/reliability#8592"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27947632,"iid":8580,"project_id":1304532,"title":"Problems with license  db extraction","description":"## We're unable to read from license_db\n\n```\n2019-12-04 08:10:54,086] INFO - [2019-12-04 08:10:54,086] INFO - b'psycopg2.OperationalError: could not connect to server: Connection timed out\\n'\n[2019-12-04 08:10:54,086] INFO - [2019-12-04 08:10:54,086] INFO - b'\\tIs the server running on host \"10.138.16.11\" and accepting\\n'\n[2019-12-04 08:10:54,087] INFO - [2019-12-04 08:10:54,087] INFO - b'\\tTCP/IP connections on port 5432?\\n'\n```\n\n---\n\nhttp://35.190.127.73/log?dag_id=license_db_extract\u0026task_id=license-db-incremental\u0026execution_date=2019-12-04T00%3A00%3A00%2B00%3A00\n\nFull log:\n\n```\n*** Reading local file: /usr/local/airflow/logs/license_db_extract/license-db-incremental/2019-12-04T00:00:00+00:00/2.log\n[2019-12-04 08:06:17,093] INFO - Dependencies all met for \u003cTaskInstance: license_db_extract.license-db-incremental 2019-12-04T00:00:00+00:00 [queued]\u003e\n[2019-12-04 08:06:17,102] INFO - Dependencies all met for \u003cTaskInstance: license_db_extract.license-db-incremental 2019-12-04T00:00:00+00:00 [queued]\u003e\n[2019-12-04 08:06:17,102] INFO - \n--------------------------------------------------------------------------------\n[2019-12-04 08:06:17,102] INFO - Starting attempt 2 of 2\n[2019-12-04 08:06:17,103] INFO - \n--------------------------------------------------------------------------------\n[2019-12-04 08:06:17,129] INFO - Executing \u003cTask(KubernetesPodOperator): license-db-incremental\u003e on 2019-12-04T00:00:00+00:00\n[2019-12-04 08:06:17,130] INFO - Running: ['airflow', 'run', 'license_db_extract', 'license-db-incremental', '2019-12-04T00:00:00+00:00', '--job_id', '22469', '--raw', '-sd', 'DAGS_FOLDER/extract/gitlab_dbs.py', '--cfg_path', '/tmp/tmpy57gwtvp']\n[2019-12-04 08:06:17,774] INFO - Job 22469: Subtask license-db-incremental [2019-12-04 08:06:17,774] INFO - settings.configure_orm(): Using pool settings. pool_size=6, pool_recycle=1800, pid=1892444\n[2019-12-04 08:06:17,932] INFO - Job 22469: Subtask license-db-incremental [2019-12-04 08:06:17,932] INFO - Using executor LocalExecutor\n[2019-12-04 08:06:18,227] INFO - Job 22469: Subtask license-db-incremental [2019-12-04 08:06:18,226] INFO - Filling up the DagBag from /usr/local/airflow/analytics/dags/extract/gitlab_dbs.py\n[2019-12-04 08:06:18,618] INFO - Job 22469: Subtask license-db-incremental [2019-12-04 08:06:18,618] INFO - Running \u003cTaskInstance: license_db_extract.license-db-incremental 2019-12-04T00:00:00+00:00 [running]\u003e on host airflow-deployment-b666dd78d-dzz4r\n[2019-12-04 08:06:18,890] INFO - [2019-12-04 08:06:18,890] INFO - Event: license-db-incremental-df1efe5e had an event of type Pending\n[2019-12-04 08:06:19,897] INFO - [2019-12-04 08:06:19,897] INFO - Event: license-db-incremental-df1efe5e had an event of type Pending\n[2019-12-04 08:06:20,904] INFO - [2019-12-04 08:06:20,904] INFO - Event: license-db-incremental-df1efe5e had an event of type Pending\n[2019-12-04 08:06:21,912] INFO - [2019-12-04 08:06:21,912] INFO - Event: license-db-incremental-df1efe5e had an event of type Pending\n[2019-12-04 08:06:22,920] INFO - [2019-12-04 08:06:22,920] INFO - Event: license-db-incremental-df1efe5e had an event of type Pending\n[2019-12-04 08:06:23,927] INFO - [2019-12-04 08:06:23,927] INFO - Event: license-db-incremental-df1efe5e had an event of type Pending\n[2019-12-04 08:06:24,933] INFO - [2019-12-04 08:06:24,933] INFO - Event: license-db-incremental-df1efe5e had an event of type Pending\n[2019-12-04 08:06:25,940] INFO - [2019-12-04 08:06:25,940] INFO - Event: license-db-incremental-df1efe5e had an event of type Pending\n[2019-12-04 08:06:26,948] INFO - [2019-12-04 08:06:26,948] INFO - Event: license-db-incremental-df1efe5e had an event of type Pending\n[2019-12-04 08:06:27,957] INFO - [2019-12-04 08:06:27,956] INFO - Event: license-db-incremental-df1efe5e had an event of type Pending\n[2019-12-04 08:06:28,964] INFO - [2019-12-04 08:06:28,964] INFO - Event: license-db-incremental-df1efe5e had an event of type Running\n[2019-12-04 08:06:29,009] INFO - [2019-12-04 08:06:29,009] INFO - b\"Cloning into 'analytics'...\\n\"\n[2019-12-04 08:06:30,579] INFO - [2019-12-04 08:06:30,579] INFO - b'INFO:root:Reading manifest at location: ../manifests/license_db_manifest.yaml\\n'\n[2019-12-04 08:06:30,589] INFO - [2019-12-04 08:06:30,589] INFO - b'INFO:root:Creating database engines...\\n'\n[2019-12-04 08:06:30,616] INFO - [2019-12-04 08:06:30,616] INFO - b'INFO:root:Engine(postgresql://postgres:***@10.138.16.11:5432/license_gitlab_com_production)\\n'\n[2019-12-04 08:06:30,718] INFO - [2019-12-04 08:06:30,718] INFO - b'INFO:root:Engine(snowflake://airflow:***@gitlab/RAW/tap_postgres?role=LOADER\u0026warehouse=LOADING)\\n'\n[2019-12-04 08:06:30,718] INFO - [2019-12-04 08:06:30,718] INFO - b'INFO:root:Processing Table: add_ons\\n'\n[2019-12-04 08:06:30,723] INFO - [2019-12-04 08:06:30,723] INFO - b'INFO:botocore.vendored.requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): gitlab.snowflakecomputing.com\\n'\n[2019-12-04 08:06:30,911] INFO - [2019-12-04 08:06:30,911] INFO - b'INFO:botocore.vendored.requests.packages.urllib3.connectionpool:Starting new HTTP connection (1): ocsp.snowflakecomputing.com\\n'\n[2019-12-04 08:10:54,065] INFO - [2019-12-04 08:10:54,065] INFO - b'Traceback (most recent call last):\\n'\n[2019-12-04 08:10:54,066] INFO - [2019-12-04 08:10:54,066] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2158, in _wrap_pool_connect\\n'\n[2019-12-04 08:10:54,067] INFO - [2019-12-04 08:10:54,067] INFO - b'    return fn()\\n'\n[2019-12-04 08:10:54,068] INFO - [2019-12-04 08:10:54,067] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 400, in connect\\n'\n[2019-12-04 08:10:54,068] INFO - [2019-12-04 08:10:54,068] INFO - b'    return _ConnectionFairy._checkout(self)\\n'\n[2019-12-04 08:10:54,069] INFO - [2019-12-04 08:10:54,069] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 788, in _checkout\\n'\n[2019-12-04 08:10:54,070] INFO - [2019-12-04 08:10:54,070] INFO - b'    fairy = _ConnectionRecord.checkout(pool)\\n'\n[2019-12-04 08:10:54,071] INFO - [2019-12-04 08:10:54,071] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 529, in checkout\\n'\n[2019-12-04 08:10:54,071] INFO - [2019-12-04 08:10:54,071] INFO - b'    rec = pool._do_get()\\n'\n[2019-12-04 08:10:54,072] INFO - [2019-12-04 08:10:54,072] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 1193, in _do_get\\n'\n[2019-12-04 08:10:54,072] INFO - [2019-12-04 08:10:54,072] INFO - b'    self._dec_overflow()\\n'\n[2019-12-04 08:10:54,073] INFO - [2019-12-04 08:10:54,073] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__\\n'\n[2019-12-04 08:10:54,074] INFO - [2019-12-04 08:10:54,074] INFO - b'    compat.reraise(exc_type, exc_value, exc_tb)\\n'\n[2019-12-04 08:10:54,075] INFO - [2019-12-04 08:10:54,075] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 249, in reraise\\n'\n[2019-12-04 08:10:54,075] INFO - [2019-12-04 08:10:54,075] INFO - b'    raise value\\n'\n[2019-12-04 08:10:54,076] INFO - [2019-12-04 08:10:54,076] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 1190, in _do_get\\n'\n[2019-12-04 08:10:54,076] INFO - [2019-12-04 08:10:54,076] INFO - b'    return self._create_connection()\\n'\n[2019-12-04 08:10:54,077] INFO - [2019-12-04 08:10:54,077] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 347, in _create_connection\\n'\n[2019-12-04 08:10:54,078] INFO - [2019-12-04 08:10:54,078] INFO - b'    return _ConnectionRecord(self)\\n'\n[2019-12-04 08:10:54,079] INFO - [2019-12-04 08:10:54,079] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 474, in __init__\\n'\n[2019-12-04 08:10:54,079] INFO - [2019-12-04 08:10:54,079] INFO - b'    self.__connect(first_connect_check=True)\\n'\n[2019-12-04 08:10:54,080] INFO - [2019-12-04 08:10:54,080] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 671, in __connect\\n'\n[2019-12-04 08:10:54,080] INFO - [2019-12-04 08:10:54,080] INFO - b'    connection = pool._invoke_creator(self)\\n'\n[2019-12-04 08:10:54,081] INFO - [2019-12-04 08:10:54,081] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py\", line 106, in connect\\n'\n[2019-12-04 08:10:54,082] INFO - [2019-12-04 08:10:54,082] INFO - b'    return dialect.connect(*cargs, **cparams)\\n'\n[2019-12-04 08:10:54,083] INFO - [2019-12-04 08:10:54,083] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 412, in connect\\n'\n[2019-12-04 08:10:54,083] INFO - [2019-12-04 08:10:54,083] INFO - b'    return self.dbapi.connect(*cargs, **cparams)\\n'\n[2019-12-04 08:10:54,084] INFO - [2019-12-04 08:10:54,084] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/psycopg2/__init__.py\", line 130, in connect\\n'\n[2019-12-04 08:10:54,085] INFO - [2019-12-04 08:10:54,085] INFO - b'    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\\n'\n[2019-12-04 08:10:54,086] INFO - [2019-12-04 08:10:54,086] INFO - b'psycopg2.OperationalError: could not connect to server: Connection timed out\\n'\n[2019-12-04 08:10:54,086] INFO - [2019-12-04 08:10:54,086] INFO - b'\\tIs the server running on host \"10.138.16.11\" and accepting\\n'\n[2019-12-04 08:10:54,087] INFO - [2019-12-04 08:10:54,087] INFO - b'\\tTCP/IP connections on port 5432?\\n'\n[2019-12-04 08:10:54,087] INFO - [2019-12-04 08:10:54,087] INFO - b'\\n'\n[2019-12-04 08:10:54,087] INFO - [2019-12-04 08:10:54,087] INFO - b'\\n'\n[2019-12-04 08:10:54,088] INFO - [2019-12-04 08:10:54,088] INFO - b'The above exception was the direct cause of the following exception:\\n'\n[2019-12-04 08:10:54,088] INFO - [2019-12-04 08:10:54,088] INFO - b'\\n'\n[2019-12-04 08:10:54,088] INFO - [2019-12-04 08:10:54,088] INFO - b'Traceback (most recent call last):\\n'\n[2019-12-04 08:10:54,089] INFO - [2019-12-04 08:10:54,089] INFO - b'  File \"main.py\", line 341, in \u003cmodule\u003e\\n'\n[2019-12-04 08:10:54,089] INFO - [2019-12-04 08:10:54,089] INFO - b'    Fire({\"tap\": main})\\n'\n[2019-12-04 08:10:54,090] INFO - [2019-12-04 08:10:54,090] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/fire/core.py\", line 127, in Fire\\n'\n[2019-12-04 08:10:54,091] INFO - [2019-12-04 08:10:54,091] INFO - b'    component_trace = _Fire(component, args, context, name)\\n'\n[2019-12-04 08:10:54,092] INFO - [2019-12-04 08:10:54,092] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/fire/core.py\", line 366, in _Fire\\n'\n[2019-12-04 08:10:54,092] INFO - [2019-12-04 08:10:54,092] INFO - b'    component, remaining_args)\\n'\n[2019-12-04 08:10:54,093] INFO - [2019-12-04 08:10:54,093] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/fire/core.py\", line 542, in _CallCallable\\n'\n[2019-12-04 08:10:54,093] INFO - [2019-12-04 08:10:54,093] INFO - b'    result = fn(*varargs, **kwargs)\\n'\n[2019-12-04 08:10:54,094] INFO - [2019-12-04 08:10:54,094] INFO - b'  File \"main.py\", line 319, in main\\n'\n[2019-12-04 08:10:54,094] INFO - [2019-12-04 08:10:54,094] INFO - b'    table_name,\\n'\n[2019-12-04 08:10:54,095] INFO - [2019-12-04 08:10:54,095] INFO - b'  File \"/analytics/extract/postgres_pipeline/postgres_pipeline/utils.py\", line 260, in check_if_schema_changed\\n'\n[2019-12-04 08:10:54,096] INFO - [2019-12-04 08:10:54,096] INFO - b'    con=source_engine,\\n'\n[2019-12-04 08:10:54,097] INFO - [2019-12-04 08:10:54,097] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/pandas/io/sql.py\", line 397, in read_sql\\n'\n[2019-12-04 08:10:54,097] INFO - [2019-12-04 08:10:54,097] INFO - b'    chunksize=chunksize)\\n'\n[2019-12-04 08:10:54,098] INFO - [2019-12-04 08:10:54,098] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/pandas/io/sql.py\", line 1099, in read_query\\n'\n[2019-12-04 08:10:54,099] INFO - [2019-12-04 08:10:54,099] INFO - b'    result = self.execute(*args)\\n'\n[2019-12-04 08:10:54,099] INFO - [2019-12-04 08:10:54,099] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/pandas/io/sql.py\", line 990, in execute\\n'\n[2019-12-04 08:10:54,100] INFO - [2019-12-04 08:10:54,100] INFO - b'    return self.connectable.execute(*args, **kwargs)\\n'\n[2019-12-04 08:10:54,101] INFO - [2019-12-04 08:10:54,101] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2074, in execute\\n'\n[2019-12-04 08:10:54,102] INFO - [2019-12-04 08:10:54,102] INFO - b'    connection = self.contextual_connect(close_with_result=True)\\n'\n[2019-12-04 08:10:54,103] INFO - [2019-12-04 08:10:54,103] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2123, in contextual_connect\\n'\n[2019-12-04 08:10:54,103] INFO - [2019-12-04 08:10:54,103] INFO - b'    self._wrap_pool_connect(self.pool.connect, None),\\n'\n[2019-12-04 08:10:54,104] INFO - [2019-12-04 08:10:54,104] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2162, in _wrap_pool_connect\\n'\n[2019-12-04 08:10:54,105] INFO - [2019-12-04 08:10:54,105] INFO - b'    e, dialect, self)\\n'\n[2019-12-04 08:10:54,106] INFO - [2019-12-04 08:10:54,106] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1476, in _handle_dbapi_exception_noconnection\\n'\n[2019-12-04 08:10:54,106] INFO - [2019-12-04 08:10:54,106] INFO - b'    exc_info\\n'\n[2019-12-04 08:10:54,107] INFO - [2019-12-04 08:10:54,107] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 265, in raise_from_cause\\n'\n[2019-12-04 08:10:54,108] INFO - [2019-12-04 08:10:54,108] INFO - b'    reraise(type(exception), exception, tb=exc_tb, cause=cause)\\n'\n[2019-12-04 08:10:54,109] INFO - [2019-12-04 08:10:54,109] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 248, in reraise\\n'\n[2019-12-04 08:10:54,109] INFO - [2019-12-04 08:10:54,109] INFO - b'    raise value.with_traceback(tb)\\n'\n[2019-12-04 08:10:54,111] INFO - [2019-12-04 08:10:54,111] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2158, in _wrap_pool_connect\\n'\n[2019-12-04 08:10:54,111] INFO - [2019-12-04 08:10:54,111] INFO - b'    return fn()\\n'\n[2019-12-04 08:10:54,113] INFO - [2019-12-04 08:10:54,112] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 400, in connect\\n'\n[2019-12-04 08:10:54,113] INFO - [2019-12-04 08:10:54,113] INFO - b'    return _ConnectionFairy._checkout(self)\\n'\n[2019-12-04 08:10:54,114] INFO - [2019-12-04 08:10:54,114] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 788, in _checkout\\n'\n[2019-12-04 08:10:54,114] INFO - [2019-12-04 08:10:54,114] INFO - b'    fairy = _ConnectionRecord.checkout(pool)\\n'\n[2019-12-04 08:10:54,115] INFO - [2019-12-04 08:10:54,115] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 529, in checkout\\n'\n[2019-12-04 08:10:54,116] INFO - [2019-12-04 08:10:54,116] INFO - b'    rec = pool._do_get()\\n'\n[2019-12-04 08:10:54,117] INFO - [2019-12-04 08:10:54,117] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 1193, in _do_get\\n'\n[2019-12-04 08:10:54,117] INFO - [2019-12-04 08:10:54,117] INFO - b'    self._dec_overflow()\\n'\n[2019-12-04 08:10:54,118] INFO - [2019-12-04 08:10:54,118] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 66, in __exit__\\n'\n[2019-12-04 08:10:54,119] INFO - [2019-12-04 08:10:54,119] INFO - b'    compat.reraise(exc_type, exc_value, exc_tb)\\n'\n[2019-12-04 08:10:54,120] INFO - [2019-12-04 08:10:54,120] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 249, in reraise\\n'\n[2019-12-04 08:10:54,120] INFO - [2019-12-04 08:10:54,120] INFO - b'    raise value\\n'\n[2019-12-04 08:10:54,121] INFO - [2019-12-04 08:10:54,121] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 1190, in _do_get\\n'\n[2019-12-04 08:10:54,122] INFO - [2019-12-04 08:10:54,122] INFO - b'    return self._create_connection()\\n'\n[2019-12-04 08:10:54,123] INFO - [2019-12-04 08:10:54,123] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 347, in _create_connection\\n'\n[2019-12-04 08:10:54,123] INFO - [2019-12-04 08:10:54,123] INFO - b'    return _ConnectionRecord(self)\\n'\n[2019-12-04 08:10:54,124] INFO - [2019-12-04 08:10:54,124] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 474, in __init__\\n'\n[2019-12-04 08:10:54,125] INFO - [2019-12-04 08:10:54,125] INFO - b'    self.__connect(first_connect_check=True)\\n'\n[2019-12-04 08:10:54,126] INFO - [2019-12-04 08:10:54,126] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/pool.py\", line 671, in __connect\\n'\n[2019-12-04 08:10:54,126] INFO - [2019-12-04 08:10:54,126] INFO - b'    connection = pool._invoke_creator(self)\\n'\n[2019-12-04 08:10:54,127] INFO - [2019-12-04 08:10:54,127] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py\", line 106, in connect\\n'\n[2019-12-04 08:10:54,128] INFO - [2019-12-04 08:10:54,128] INFO - b'    return dialect.connect(*cargs, **cparams)\\n'\n[2019-12-04 08:10:54,129] INFO - [2019-12-04 08:10:54,129] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 412, in connect\\n'\n[2019-12-04 08:10:54,130] INFO - [2019-12-04 08:10:54,129] INFO - b'    return self.dbapi.connect(*cargs, **cparams)\\n'\n[2019-12-04 08:10:54,131] INFO - [2019-12-04 08:10:54,131] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/psycopg2/__init__.py\", line 130, in connect\\n'\n[2019-12-04 08:10:54,132] INFO - [2019-12-04 08:10:54,132] INFO - b'    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\\n'\n[2019-12-04 08:10:54,133] INFO - [2019-12-04 08:10:54,133] INFO - b'sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not connect to server: Connection timed out\\n'\n[2019-12-04 08:10:54,133] INFO - [2019-12-04 08:10:54,133] INFO - b'\\tIs the server running on host \"10.138.16.11\" and accepting\\n'\n[2019-12-04 08:10:54,134] INFO - [2019-12-04 08:10:54,134] INFO - b'\\tTCP/IP connections on port 5432?\\n'\n[2019-12-04 08:10:54,134] INFO - [2019-12-04 08:10:54,134] INFO - b' (Background on this error at: http://sqlalche.me/e/e3q8)\\n'\n[2019-12-04 08:10:59,152] INFO - [2019-12-04 08:10:59,152] INFO - b'ERROR:snowflake.connector.network:could not find io module state (interpreter shutdown?)\\n'\n[2019-12-04 08:10:59,152] INFO - [2019-12-04 08:10:59,152] INFO - b'Traceback (most recent call last):\\n'\n[2019-12-04 08:10:59,153] INFO - [2019-12-04 08:10:59,153] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/snowflake/connector/network.py\", line 781, in _request_exec\\n'\n[2019-12-04 08:10:59,154] INFO - [2019-12-04 08:10:59,154] INFO - b'    auth=SnowflakeAuth(token),\\n'\n[2019-12-04 08:10:59,155] INFO - [2019-12-04 08:10:59,155] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/botocore/vendored/requests/sessions.py\", line 451, in request\\n'\n[2019-12-04 08:10:59,155] INFO - [2019-12-04 08:10:59,155] INFO - b'    prep = self.prepare_request(req)\\n'\n[2019-12-04 08:10:59,156] INFO - [2019-12-04 08:10:59,156] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/botocore/vendored/requests/sessions.py\", line 382, in prepare_request\\n'\n[2019-12-04 08:10:59,157] INFO - [2019-12-04 08:10:59,157] INFO - b'    hooks=merge_hooks(request.hooks, self.hooks),\\n'\n[2019-12-04 08:10:59,158] INFO - [2019-12-04 08:10:59,158] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/botocore/vendored/requests/models.py\", line 307, in prepare\\n'\n[2019-12-04 08:10:59,158] INFO - [2019-12-04 08:10:59,158] INFO - b'    self.prepare_body(data, files, json)\\n'\n[2019-12-04 08:10:59,160] INFO - [2019-12-04 08:10:59,159] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/botocore/vendored/requests/models.py\", line 436, in prepare_body\\n'\n[2019-12-04 08:10:59,160] INFO - [2019-12-04 08:10:59,160] INFO - b'    length = super_len(data)\\n'\n[2019-12-04 08:10:59,161] INFO - [2019-12-04 08:10:59,161] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/botocore/vendored/requests/utils.py\", line 59, in super_len\\n'\n[2019-12-04 08:10:59,161] INFO - [2019-12-04 08:10:59,161] INFO - b'    fileno = o.fileno()\\n'\n[2019-12-04 08:10:59,162] INFO - [2019-12-04 08:10:59,162] INFO - b'RuntimeError: could not find io module state (interpreter shutdown?)\\n'\n[2019-12-04 08:10:59,162] INFO - [2019-12-04 08:10:59,162] INFO - b'\\n'\n[2019-12-04 08:10:59,163] INFO - [2019-12-04 08:10:59,163] INFO - b'During handling of the above exception, another exception occurred:\\n'\n[2019-12-04 08:10:59,163] INFO - [2019-12-04 08:10:59,163] INFO - b'\\n'\n[2019-12-04 08:10:59,163] INFO - [2019-12-04 08:10:59,163] INFO - b'Traceback (most recent call last):\\n'\n[2019-12-04 08:10:59,164] INFO - [2019-12-04 08:10:59,164] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/snowflake/connector/network.py\", line 648, in _request_exec_wrapper\\n'\n[2019-12-04 08:10:59,164] INFO - [2019-12-04 08:10:59,164] INFO - b'    **kwargs)\\n'\n[2019-12-04 08:10:59,165] INFO - [2019-12-04 08:10:59,165] INFO - b'  File \"/usr/local/lib/python3.7/site-packages/snowflake/connector/network.py\", line 871, in _request_exec\\n'\n[2019-12-04 08:10:59,166] INFO - [2019-12-04 08:10:59,166] INFO - b'    raise RetryRequest(err)\\n'\n[2019-12-04 08:10:59,167] INFO - [2019-12-04 08:10:59,167] INFO - b'snowflake.connector.network.RetryRequest: could not find io module state (interpreter shutdown?)\\n'\n[2019-12-04 08:11:04,486] INFO - [2019-12-04 08:11:04,486] INFO - Event: license-db-incremental-df1efe5e had an event of type Failed\n[2019-12-04 08:11:04,487] INFO - [2019-12-04 08:11:04,487] INFO - Event with job id license-db-incremental-df1efe5e Failed\n[2019-12-04 08:11:04,493] INFO - [2019-12-04 08:11:04,493] INFO - Event: license-db-incremental-df1efe5e had an event of type Failed\n[2019-12-04 08:11:04,493] INFO - [2019-12-04 08:11:04,493] INFO - Event with job id license-db-incremental-df1efe5e Failed\n[2019-12-04 08:11:04,564] ERROR - Pod Launching failed: Pod returned a failure: failed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.6/site-packages/airflow/contrib/operators/kubernetes_pod_operator.py\", line 142, in execute\n    'Pod returned a failure: {state}'.format(state=final_state)\nairflow.exceptions.AirflowException: Pod returned a failure: failed\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.6/site-packages/airflow/models/__init__.py\", line 1441, in _run_raw_task\n    result = task_copy.execute(context=context)\n  File \"/usr/local/lib/python3.6/site-packages/airflow/contrib/operators/kubernetes_pod_operator.py\", line 147, in execute\n    raise AirflowException('Pod Launching failed: {error}'.format(error=ex))\nairflow.exceptions.AirflowException: Pod Launching failed: Pod returned a failure: failed\n[2019-12-04 08:11:04,565] INFO - All retries failed; marking task as FAILED\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental Traceback (most recent call last):\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental   File \"/usr/local/lib/python3.6/site-packages/airflow/contrib/operators/kubernetes_pod_operator.py\", line 142, in execute\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental     'Pod returned a failure: {state}'.format(state=final_state)\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental airflow.exceptions.AirflowException: Pod returned a failure: failed\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental \n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental During handling of the above exception, another exception occurred:\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental \n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental Traceback (most recent call last):\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental   File \"/usr/local/bin/airflow\", line 32, in \u003cmodule\u003e\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental     args.func(args)\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental   File \"/usr/local/lib/python3.6/site-packages/airflow/utils/cli.py\", line 74, in wrapper\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental     return f(*args, **kwargs)\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental   File \"/usr/local/lib/python3.6/site-packages/airflow/bin/cli.py\", line 523, in run\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental     _run(args, dag, ti)\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental   File \"/usr/local/lib/python3.6/site-packages/airflow/bin/cli.py\", line 442, in _run\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental     pool=args.pool,\n[2019-12-04 08:11:04,894] INFO - Job 22469: Subtask license-db-incremental   File \"/usr/local/lib/python3.6/site-packages/airflow/utils/db.py\", line 73, in wrapper\n[2019-12-04 08:11:04,895] INFO - Job 22469: Subtask license-db-incremental     return func(*args, **kwargs)\n[2019-12-04 08:11:04,895] INFO - Job 22469: Subtask license-db-incremental   File \"/usr/local/lib/python3.6/site-packages/airflow/models/__init__.py\", line 1441, in _run_raw_task\n[2019-12-04 08:11:04,895] INFO - Job 22469: Subtask license-db-incremental     result = task_copy.execute(context=context)\n[2019-12-04 08:11:04,895] INFO - Job 22469: Subtask license-db-incremental   File \"/usr/local/lib/python3.6/site-packages/airflow/contrib/operators/kubernetes_pod_operator.py\", line 147, in execute\n[2019-12-04 08:11:04,895] INFO - Job 22469: Subtask license-db-incremental     raise AirflowException('Pod Launching failed: {error}'.format(error=ex))\n[2019-12-04 08:11:04,895] INFO - Job 22469: Subtask license-db-incremental airflow.exceptions.AirflowException: Pod Launching failed: Pod returned a failure: failed\n[2019-12-04 08:11:07,868] INFO - [2019-12-04 08:11:07,867] INFO - Task exited with return code 1\n```","state":"closed","created_at":"2019-12-04T17:43:12.601Z","updated_at":"2021-06-24T08:08:18.151Z","closed_at":"2020-02-10T11:49:13.357Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","OnGres::Support","priority::4","workflow-infra::Done"],"milestone":{"id":1142605,"iid":66,"group_id":1112072,"title":"W6 DBRE","description":"","state":"closed","created_at":"2020-02-02T07:54:53.150Z","updated_at":"2020-03-02T08:54:59.491Z","due_date":"2020-02-14","start_date":"2020-02-03","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/66"},"assignees":[{"id":3007633,"username":"gerardo.herzig","name":"Gerardo Herzig","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3007633/avatar.png","web_url":"https://gitlab.com/gerardo.herzig"}],"author":{"id":4554632,"username":"jjstark","name":"Justin Stark","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4554632/avatar.png","web_url":"https://gitlab.com/jjstark"},"type":"ISSUE","assignee":{"id":3007633,"username":"gerardo.herzig","name":"Gerardo Herzig","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3007633/avatar.png","web_url":"https://gitlab.com/gerardo.herzig"},"user_notes_count":29,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2020-02-07","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8580","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8580","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8580/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8580/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8580","relative":"#8580","full":"gitlab-com/gl-infra/reliability#8580"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27939523,"iid":8575,"project_id":1304532,"title":"gitlab-restore: implement cleanup procedure to avoid \"out of quota\" events","description":"It's quite common now the cases when gitlab-restore project reaches some quotas because some instances are stalled. If, during restoration, some error occurs, in some cases it doesn't lead to hard failure and auto-cleanup.\n\nWe need some job that would clean up instances periodically, based on certain mask for instance name and rules like \"If the backup verification started 3 days ago and hasn't finished yet, and if the instance is not protected from deletion, it's time to consider backup verification as failed, send all the signals about it, and destroy the instance\".\n\nTo discuss: how should it be organized? Cronjob or CI/CD pipelines with special task? Anyhow else?","state":"closed","created_at":"2019-12-04T14:53:12.490Z","updated_at":"2022-08-04T18:01:41.634Z","closed_at":"2020-03-10T08:16:59.896Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","priority::3","workflow-infra::Done"],"milestone":{"id":1176149,"iid":70,"group_id":1112072,"title":"W10 DBRE","description":"","state":"closed","created_at":"2020-03-02T08:36:37.826Z","updated_at":"2020-03-30T08:30:41.949Z","due_date":"2020-03-13","start_date":"2020-03-02","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/70"},"assignees":[{"id":1906296,"username":"NikolayS","name":"Nikolay Samokhvalov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1906296/avatar.png","web_url":"https://gitlab.com/NikolayS"}],"author":{"id":1906296,"username":"NikolayS","name":"Nikolay Samokhvalov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1906296/avatar.png","web_url":"https://gitlab.com/NikolayS"},"type":"ISSUE","assignee":{"id":1906296,"username":"NikolayS","name":"Nikolay Samokhvalov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1906296/avatar.png","web_url":"https://gitlab.com/NikolayS"},"user_notes_count":11,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2020-02-28","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8575","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8575","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8575/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8575/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8575","relative":"#8575","full":"gitlab-com/gl-infra/reliability#8575"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":27,"epic":{"id":3033,"iid":27,"title":"Backup Masterless","url":"/groups/gitlab-com/gl-infra/-/epics/27","group_id":1112072,"human_readable_end_date":"Dec 14, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27914122,"iid":8567,"project_id":1304532,"title":"Adjust praefect storage node config in gstg to new format","description":"After the changes in https://gitlab.com/gitlab-org/omnibus-gitlab/merge_requests/3699 and https://gitlab.com/gitlab-org/omnibus-gitlab/merge_requests/3754 we need to adjust our gstg configuration","state":"closed","created_at":"2019-12-04T02:40:49.217Z","updated_at":"2022-08-04T18:01:51.220Z","closed_at":"2019-12-04T18:59:30.953Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["workflow-infra::Done"],"milestone":{"id":1087796,"iid":59,"group_id":1112072,"title":"Reliability December 2019","description":"","state":"closed","created_at":"2019-12-03T16:20:55.704Z","updated_at":"2020-01-16T17:21:46.339Z","due_date":"2019-12-31","start_date":"2019-12-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/59"},"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8567","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8567","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8567/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8567/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8567","relative":"#8567","full":"gitlab-com/gl-infra/reliability#8567"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":199,"epic":{"id":14582,"iid":199,"title":"HA Gitaly on GitLab.com","url":"/groups/gitlab-com/-/epics/199","group_id":6543,"human_readable_end_date":"Jan 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27912638,"iid":8565,"project_id":1304532,"title":"Setup sentry for praefect in gstg","description":"As part of the readiness [review for praefect](https://gitlab.com/gitlab-com/gl-infra/readiness/merge_requests/10), let's setup Sentry reporting, initially on gstg but later it will have to be replicated on gprd","state":"closed","created_at":"2019-12-04T00:19:00.074Z","updated_at":"2022-08-04T18:01:52.284Z","closed_at":"2019-12-04T02:12:27.593Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["workflow-infra::Done"],"milestone":{"id":1087796,"iid":59,"group_id":1112072,"title":"Reliability December 2019","description":"","state":"closed","created_at":"2019-12-03T16:20:55.704Z","updated_at":"2020-01-16T17:21:46.339Z","due_date":"2019-12-31","start_date":"2019-12-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/59"},"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8565","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8565","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8565/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8565/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8565","relative":"#8565","full":"gitlab-com/gl-infra/reliability#8565"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":199,"epic":{"id":14582,"iid":199,"title":"HA Gitaly on GitLab.com","url":"/groups/gitlab-com/-/epics/199","group_id":6543,"human_readable_end_date":"Jan 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27906899,"iid":8563,"project_id":1304532,"title":"The \"View in AlertManager\" link in a PagerDuty incident is not alerts.gprd.gitlab.net, but instead ops.gitlab.net/gitlab-com/runbooks","description":"I'd expect to go to https://alerts.gprd.gitlab.net/#/alerts or something.\n\nBut instead, for example, the \"View in GitLab Alertmanager\" link in https://gitlab.pagerduty.com/incidents/P5VDQCW goes to https://ops.gitlab.net/gitlab-com/runbooks/blob/master/troubleshooting/chef.md.  This is not what I would expect.","state":"closed","created_at":"2019-12-03T19:54:28.173Z","updated_at":"2022-08-04T18:01:53.956Z","closed_at":"2020-09-28T12:43:21.378Z","closed_by":{"id":876203,"username":"igorwwwwwwwwwwwwwwwwwwww","name":"Igor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/876203/avatar.png","web_url":"https://gitlab.com/igorwwwwwwwwwwwwwwwwwwww"},"labels":["Alerting","Observability","PagerDuty","Service::Monitoring-Other","alert","priority::3","workflow-infra::Done"],"milestone":{"id":1380223,"iid":92,"group_id":1112072,"title":"Observability Team - FY21-Q3","description":"","state":"closed","created_at":"2020-07-24T19:07:22.800Z","updated_at":"2020-11-02T23:56:39.868Z","due_date":"2020-10-30","start_date":"2020-08-03","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/92"},"assignees":[],"author":{"id":4006601,"username":"nnelson","name":"Nels Nelson","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4006601/avatar.png","web_url":"https://gitlab.com/nnelson"},"type":"ISSUE","assignee":null,"user_notes_count":5,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8563","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8563","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8563/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8563/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8563","relative":"#8563","full":"gitlab-com/gl-infra/reliability#8563"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27904748,"iid":8562,"project_id":1304532,"title":"document troubleshooting of restore backups failure","description":"Please document the steps to troubleshoot the database backups and restore.\n\nWe would like to involve SRE to troubleshoot.\n\nPlease write a runbook to explain all the steps that you execute usually to fix those alerts.","state":"closed","created_at":"2019-12-03T19:00:45.089Z","updated_at":"2022-08-04T18:01:54.547Z","closed_at":"2020-01-28T16:56:21.257Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","priority::3","workflow-infra::Done"],"milestone":{"id":1128198,"iid":64,"group_id":1112072,"title":"W4 DBRE","description":"","state":"closed","created_at":"2020-01-20T06:26:40.274Z","updated_at":"2020-02-10T07:10:19.720Z","due_date":"2020-01-31","start_date":"2020-01-20","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/64"},"assignees":[{"id":1906296,"username":"NikolayS","name":"Nikolay Samokhvalov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1906296/avatar.png","web_url":"https://gitlab.com/NikolayS"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":1906296,"username":"NikolayS","name":"Nikolay Samokhvalov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1906296/avatar.png","web_url":"https://gitlab.com/NikolayS"},"user_notes_count":3,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":"2020-01-17","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8562","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8562","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8562/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8562/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8562","relative":"#8562","full":"gitlab-com/gl-infra/reliability#8562"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":27,"epic":{"id":3033,"iid":27,"title":"Backup Masterless","url":"/groups/gitlab-com/gl-infra/-/epics/27","group_id":1112072,"human_readable_end_date":"Dec 14, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27892387,"iid":8559,"project_id":1304532,"title":"Nodes with incomplete Chef runs","description":"There seem to be a lot of nodes with missing chef-client metric data in gprd/gstg/etc.\n\nhttps://prometheus.gprd.gitlab.net/graph?g0.range_input=1h\u0026g0.expr=up%7Bjob%3D%22node%22%7D%20unless%20chef_client_error\u0026g0.tab=1\n\nSome of them have chef-client disabled. Some never complete the first client run.","state":"closed","created_at":"2019-12-03T14:15:02.965Z","updated_at":"2022-08-04T18:01:56.884Z","closed_at":"2019-12-07T14:30:36.024Z","closed_by":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"labels":["priority::2","team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"}],"author":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"type":"ISSUE","assignee":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8559","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8559","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8559/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8559/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8559","relative":"#8559","full":"gitlab-com/gl-infra/reliability#8559"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27752364,"iid":8534,"project_id":1304532,"title":"Replace datasources for data analytics team","description":"We would like to propose to change the datasources that the data analytics team (datawarehouse), the actual mechanism to restore a database and apply the wals, can be optimised.\n\nWe would like to provide extra replicas from the following databases that will stay updated by streaming replication: \n-[ ] license\n-[ ] version\n-[ ] customers\n-[ ] gitlab.com","state":"closed","created_at":"2019-11-29T14:05:12.619Z","updated_at":"2022-08-04T18:02:36.239Z","closed_at":"2020-07-17T12:39:58.035Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","auto updated","priority::4","workflow-infra::Done"],"milestone":{"id":1128198,"iid":64,"group_id":1112072,"title":"W4 DBRE","description":"","state":"closed","created_at":"2020-01-20T06:26:40.274Z","updated_at":"2020-02-10T07:10:19.720Z","due_date":"2020-01-31","start_date":"2020-01-20","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/64"},"assignees":[{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"user_notes_count":11,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2019-12-13","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8534","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8534","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8534/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8534/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8534","relative":"#8534","full":"gitlab-com/gl-infra/reliability#8534"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":116,"epic":{"id":15222,"iid":116,"title":"Admin DW databases","url":"/groups/gitlab-com/gl-infra/-/epics/116","group_id":1112072,"human_readable_end_date":"Feb 14, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27752138,"iid":8533,"project_id":1304532,"title":"Onboard datawarehouse databases","description":"It is needed to onboard the datawarehouse databases :\n\n- license\n- version\n- customers\n\nFor this we need to execute the following steps : \n- [ ] Check hardware available for those databases. Recommend if an upgrade is needed.\n- [ ] Check the number of replicas. Create a replica from the primary if does not exists. \n- [ ] Create a dashboard and add metrics to all the databases. Suggestion: create an overview dashboard for all of them, and an specific for each one.\n- [ ] Verify the backups, create a restore project and add to deadmansnith. ( I.e. we have for gitlab.com ).\n- [ ] Verify if we have alerts in place.","state":"closed","created_at":"2019-11-29T13:59:28.286Z","updated_at":"2022-08-04T18:02:39.421Z","closed_at":"2020-06-26T08:51:12.704Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","auto updated","priority::4","workflow-infra::Done"],"milestone":{"id":1128198,"iid":64,"group_id":1112072,"title":"W4 DBRE","description":"","state":"closed","created_at":"2020-01-20T06:26:40.274Z","updated_at":"2020-02-10T07:10:19.720Z","due_date":"2020-01-31","start_date":"2020-01-20","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/64"},"assignees":[{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2019-12-13","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8533","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":5,"completed_count":0},"weight":8,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8533","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8533/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8533/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8533","relative":"#8533","full":"gitlab-com/gl-infra/reliability#8533"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":116,"epic":{"id":15222,"iid":116,"title":"Admin DW databases","url":"/groups/gitlab-com/gl-infra/-/epics/116","group_id":1112072,"human_readable_end_date":"Feb 14, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27701789,"iid":8530,"project_id":1304532,"title":"grant access to ongres to ops.gitlab.net","description":"The ongres team does not have access to ops.gitlab.net, the chef-repo, and dashboards.gitlab.net.\n\nWe would like to check the possibility to grant access to ops.gitlab.net to Ongres using SAML.\n\nCould we configure multiple omniauth providers?","state":"closed","created_at":"2019-11-28T15:27:35.633Z","updated_at":"2022-08-04T18:02:44.977Z","closed_at":"2020-05-04T14:02:21.022Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","priority::3","workflow-infra::Done"],"milestone":{"id":1239654,"iid":76,"group_id":1112072,"title":"W16 DBRE","description":"","state":"closed","created_at":"2020-04-14T09:14:09.392Z","updated_at":"2020-05-13T19:56:10.734Z","due_date":"2020-05-08","start_date":"2020-04-14","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/76"},"assignees":[{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2020-04-30","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8530","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8530","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8530/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8530/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8530","relative":"#8530","full":"gitlab-com/gl-infra/reliability#8530"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27561703,"iid":8510,"project_id":1304532,"title":"Improve the on-call handover and labels","description":"Looking for feedback on the following board and labels: https://gitlab.com/groups/gitlab-com/gl-infra/-/boards/1424188?\u0026label_name[]=SRE%3AOn-call\n\nThe premise is that all incidents will get labelled ~\"SRE:On-call\" by the incident template, and automatically go on this board.  Any other work which is triaged as On Call work will get tagged that way as well.  The EOC will triage those items and either remove ~\"SRE:On-call\" and re-label, or move it to their region.  At the end of the shift, items can be handed off to the next region, or not as the EOC sees fit.\n\nThis will work best if the ~\"SRE:On-call\" label is not used for ongoing work, unless that ongoing work needs to be handed off.  That means there should not be anything labelled both ~\"corrective action\" and ~\"SRE:On-call\".  We could consider using scoped tags to ensure this.\n\nIt might be better to use another tag for all of this - for example `SRE::Handoff` - and possibly `SRE::Corrective Action`\n\nOpening it up for discussion, comments and opinions","state":"closed","created_at":"2019-11-26T05:18:25.619Z","updated_at":"2022-08-04T18:03:06.987Z","closed_at":"2020-03-27T20:47:52.357Z","closed_by":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"labels":["Discussion","auto updated","workflow-infra::Done"],"milestone":null,"assignees":[{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"}],"author":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"type":"ISSUE","assignee":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8510","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8510","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8510/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8510/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8510","relative":"#8510","full":"gitlab-com/gl-infra/reliability#8510"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27479514,"iid":8494,"project_id":1304532,"title":"Monitor \"autovacuum queue\" on Postgres primary","description":"The query https://gitlab.com/snippets/1889668 can be used to monitor the \"autovacuum queue\": the list of tables that need to be processed by autovacuum but not yet being processed + size of this list.\n\nGoals:\n1. be able to see if some tables that need processing don't get it and \"wait\" (we could even use some metric that is similar to \"load average\" and have some alerts: if we have N workers, and 2*N tables are \"waiting\" to be processed, it is time to trigger an alert). Here we need to know only the size of the \"queue\". @emanuel_ongres do you think it is easy to add it to Prometheus?\n2. in case if troubleshooting is needed, it would be great to see details in logs. I usually achieve this using some cronjob with plpgsql form of that query, running every N minutes and logging details. What is the best option to do it in the case of GitLab.com infrastructure?\n\nI think we should split the achieving of these two goals. Having item 1 is much more important. However, having item 2 can be extremely helpful as well, for the troubleshooting of autovacuum behavior.\n\nRunning this query (https://gitlab.com/snippets/1889668) makes sense only for the Postgres master. So we can wrap it to `pg_is_in_recovery()` check, not to run it on replicas, but have it everywhere.\n\ncc @Finotto @gerardo.herzig @ahachete","state":"closed","created_at":"2019-11-22T19:36:38.728Z","updated_at":"2022-08-04T18:03:38.890Z","closed_at":"2020-02-04T07:49:55.371Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","OnGres::Support","priority::2","workflow-infra::Done"],"milestone":{"id":1142605,"iid":66,"group_id":1112072,"title":"W6 DBRE","description":"","state":"closed","created_at":"2020-02-02T07:54:53.150Z","updated_at":"2020-03-02T08:54:59.491Z","due_date":"2020-02-14","start_date":"2020-02-03","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/66"},"assignees":[{"id":2780522,"username":"kadaffy","name":"Kadaffy Talavera","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2780522/avatar.png","web_url":"https://gitlab.com/kadaffy"}],"author":{"id":1906296,"username":"NikolayS","name":"Nikolay Samokhvalov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1906296/avatar.png","web_url":"https://gitlab.com/NikolayS"},"type":"ISSUE","assignee":{"id":2780522,"username":"kadaffy","name":"Kadaffy Talavera","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2780522/avatar.png","web_url":"https://gitlab.com/kadaffy"},"user_notes_count":15,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":"2020-01-23","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8494","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8494","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8494/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8494/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8494","relative":"#8494","full":"gitlab-com/gl-infra/reliability#8494"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6,"epic":{"id":1055,"iid":6,"title":"Configure properly Postgresql Autovacuum","url":"/groups/gitlab-com/gl-infra/-/epics/6","group_id":1112072,"human_readable_end_date":"Feb 14, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27423355,"iid":8489,"project_id":1304532,"title":"Test Postgres database restoration from GCP snapshots on staging","description":"I'm going to test how GCP snapshots can be used for restoration of Postgres database:\n- first, manually on staging (an instance with prefix `nik-` will be manually created\n- next, I'll find a way to use snapshots from staging to restore to a instance in \"gitlab-restore\"\n\nAdditionally, an open question is: do we need pg_start_backup()/pg_stop_backup() when creating a snapshot.\n\nCc @Finotto","state":"closed","created_at":"2019-11-22T06:14:47.767Z","updated_at":"2022-08-04T18:03:42.671Z","closed_at":"2020-12-14T11:31:01.458Z","closed_by":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"labels":["Database","auto updated","priority::3","workflow-infra::Done"],"milestone":{"id":1216307,"iid":73,"group_id":1112072,"title":"W14 DBRE","description":"","state":"closed","created_at":"2020-03-30T08:31:20.801Z","updated_at":"2020-04-28T08:58:15.566Z","due_date":"2020-04-10","start_date":"2020-03-30","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/73"},"assignees":[{"id":1906296,"username":"NikolayS","name":"Nikolay Samokhvalov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1906296/avatar.png","web_url":"https://gitlab.com/NikolayS"}],"author":{"id":1906296,"username":"NikolayS","name":"Nikolay Samokhvalov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1906296/avatar.png","web_url":"https://gitlab.com/NikolayS"},"type":"ISSUE","assignee":{"id":1906296,"username":"NikolayS","name":"Nikolay Samokhvalov","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1906296/avatar.png","web_url":"https://gitlab.com/NikolayS"},"user_notes_count":10,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2020-04-24","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8489","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":8,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8489","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8489/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8489/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8489","relative":"#8489","full":"gitlab-com/gl-infra/reliability#8489"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":27,"epic":{"id":3033,"iid":27,"title":"Backup Masterless","url":"/groups/gitlab-com/gl-infra/-/epics/27","group_id":1112072,"human_readable_end_date":"Dec 14, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27419624,"iid":8488,"project_id":1304532,"title":"Add alert and monitoring to ops.gitlab.net","description":"While working on the steps to migrate ops, I noticed that ops does not have any type of monitoring or alerting with the exception of a [blackbox rule checking the sign on endpoint running](https://gitlab.com/gitlab-com/runbooks/blob/master/rules/ops-gitlab-nets.yml) in [gprd prometheus](https://ops.gitlab.net/gitlab-cookbooks/chef-repo/blob/68f0e9d101ea2271a7d5a62f7e432e6d6a023d61/roles/gprd-infra-prometheus-server.json#L178). We should enable node and gitlab exporter and add some alerts.","state":"closed","created_at":"2019-11-22T00:57:29.820Z","updated_at":"2022-08-04T18:03:43.375Z","closed_at":"2020-08-27T15:50:38.206Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["priority::2","workflow-infra::Done"],"milestone":{"id":1380223,"iid":92,"group_id":1112072,"title":"Observability Team - FY21-Q3","description":"","state":"closed","created_at":"2020-07-24T19:07:22.800Z","updated_at":"2020-11-02T23:56:39.868Z","due_date":"2020-10-30","start_date":"2020-08-03","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/92"},"assignees":[],"author":{"id":136229,"username":"cindy","name":"Cindy Pallares 🦉","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/136229/avatar.png","web_url":"https://gitlab.com/cindy"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8488","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8488","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8488/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8488/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8488","relative":"#8488","full":"gitlab-com/gl-infra/reliability#8488"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":"needs_attention"},{"id":27398783,"iid":8477,"project_id":1304532,"title":"Terraform env gprd (and possibly others) will not plan in CI","description":"See https://ops.gitlab.net/gitlab-com/gitlab-com-infrastructure/-/jobs/751731 for an example.\n\nLocal planning works so this appears to be a service account permissions issue, but as the error message says, the API in question really doesn't appear to be enabled: https://console.developers.google.com/apis/library/container.googleapis.com?project=gitlab-production","state":"closed","created_at":"2019-11-21T12:02:46.082Z","updated_at":"2020-03-13T23:09:26.063Z","closed_at":"2020-03-13T22:13:44.823Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"}],"author":{"id":3911656,"username":"craigf","name":"Craig Furman","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3911656/avatar.png","web_url":"https://gitlab.com/craigf"},"type":"ISSUE","assignee":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8477","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8477","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8477/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8477/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8477","relative":"#8477","full":"gitlab-com/gl-infra/reliability#8477"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27342916,"iid":8472,"project_id":1304532,"title":"Missing permissions on gitlab-ops terraform service account","description":"While applying the changes for [gitlab-com-infrastructure!1195](https://ops.gitlab.net/gitlab-com/gitlab-com-infrastructure/merge_requests/1195), the [apply job](https://ops.gitlab.net/gitlab-com/gitlab-com-infrastructure/-/jobs/750625) returned a permissions error and failed to apply an update to the ops GKE cluster; we need to add cluster admin privileges to the environments where we're utilizing GKE","state":"closed","created_at":"2019-11-20T23:08:55.041Z","updated_at":"2019-12-06T21:42:19.127Z","closed_at":"2019-11-21T01:30:20.234Z","closed_by":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"labels":["team::Reliability","terraform","workflow-infra::Done"],"milestone":null,"assignees":[{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"}],"author":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"type":"ISSUE","assignee":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8472","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8472","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8472/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8472/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8472","relative":"#8472","full":"gitlab-com/gl-infra/reliability#8472"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27271403,"iid":8466,"project_id":1304532,"title":"Cloudflare: Prototype log shipping","description":"As discussed in https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8377.\n\nCreate a prototype, that used Cloudflare Logpull and pushes that to a filebeat.  \nBonus points for metric extraction.","state":"closed","created_at":"2019-11-20T18:45:33.002Z","updated_at":"2019-12-06T21:45:58.719Z","closed_at":"2019-11-22T16:23:41.736Z","closed_by":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":{"id":1057451,"iid":54,"group_id":1112072,"title":"CI/CD \u0026 Enablement - November 2019","description":"","state":"closed","created_at":"2019-11-01T22:45:09.199Z","updated_at":"2019-12-04T21:44:40.512Z","due_date":"2019-11-30","start_date":"2019-11-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/54"},"assignees":[{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"}],"author":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"type":"ISSUE","assignee":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8466","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8466","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8466/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8466/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8466","relative":"#8466","full":"gitlab-com/gl-infra/reliability#8466"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":115,"epic":{"id":15220,"iid":115,"title":"Cloudflare: general dependencies \u0026 infrastructure preparations","url":"/groups/gitlab-com/gl-infra/-/epics/115","group_id":1112072,"human_readable_end_date":"Feb 28, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27176545,"iid":8441,"project_id":1304532,"title":"[staging] add extra pgbouncer node for the primary database and rebalance connection pool","description":"add an extra pgbouncer node to the pool of the primary database on the staging cluster\n\nSetup the applications to use  2 nodes for the web-api, and 1 node for the sideqik.","state":"closed","created_at":"2019-11-18T15:07:13.973Z","updated_at":"2022-08-04T19:01:59.247Z","closed_at":"2019-12-05T16:19:26.766Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","OnGres::Project","priority::1","workflow-infra::Done"],"milestone":{"id":1086169,"iid":57,"group_id":1112072,"title":"W49 DBRE","description":"","state":"closed","created_at":"2019-12-02T11:12:51.548Z","updated_at":"2020-01-16T17:23:47.770Z","due_date":"2019-12-13","start_date":"2019-12-02","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/57"},"assignees":[],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2019-12-04","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8441","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8441","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8441/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8441/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8441","relative":"#8441","full":"gitlab-com/gl-infra/reliability#8441"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":114,"epic":{"id":15115,"iid":114,"title":"PGBouncer Saturation","url":"/groups/gitlab-com/gl-infra/-/epics/114","group_id":1112072,"human_readable_end_date":"Nov 22, 2019","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27152618,"iid":8433,"project_id":1304532,"title":"RCA: 2019-11-18 daily 08:07 UTC latency spike","description":"\u003c!--\n**Please note:** if the incident relates to sensitive data, or is security related consider\nlabeling this issue with ~security and mark it confidential.\n*** \n--\u003e\n\nIncident: https://gitlab.com/gitlab-com/gl-infra/production/issues/1372\n\n## Summary\n\nWe see a daily spike in latencies every morning around 08:07 UTC. This issue will serve to collect evidence for investigating and mitigating the root cause.\n\n**Update**: This is a duplicate of https://gitlab.com/gitlab-com/gl-infra/production/issues/1316\n\n- Service(s) affected : ~\"Service:Web\" \n- Team attribution : ~Infrastructure \n- Minutes downtime or degradation : \n\nFor calculating duration of event, use the [Platform Metrics Dashboard](https://dashboards.gitlab.net/d/ZUei7TkWz/platform-metrics?orgId=1) to look at appdex and SLO violations.\n\n## Impact \u0026 Metrics\n\nStart with the following:\n\n- What was the impact of the incident? (i.e. service outage, sub-service brown-out, exposure of sensitive data, ...)\n- Who was impacted by this incident? (i.e. external customers, internal customers, specific teams, ...)\n- How did the incident impact customers? (i.e. preventing them from doing X, incorrect display of Y, ...)\n- How many attempts were made to access the impacted service/feature?\n- How many customers were affected?\n- How many customers tried to access the impacted service/feature?\n\nInclude any additional metrics that are of relevance.\n\nProvide any relevant graphs that could help understand the impact of the incident and its dynamics.\n\n## Detection \u0026 Response\n\nStart with the following:\n\n- How was the incident detected?\n- Did alarming work as expected?\n- How long did it take from the start of the incident to its detection?\n- How long did it take from detection to remediation?\n- Were there any issues with the response to the incident? (i.e. bastion host used to access the service was not available, relevant team memeber wasn't page-able, ...)\n\n## Root Cause Analysis\n\nThe purpose of this document is to understand the reasons that caused an incident, and to create mechanisms to prevent it from recurring in the future. A root cause can **never be a person**, the way of writing has to refer to the system and the context rather than the specific actors.\n\nFollow the \"**5 whys**\" in a **blameless** manner as the core of the root-cause analysis.\n\nFor this it is necessary to start with the incident, and question why it happened. Keep iterating asking \"why?\" 5 times. While it's not a hard rule that it has to be 5 times, it helps to keep questions get deeper in finding the actual root cause. \n\nKeep in min that from one \"why?\" there may come more than one answer, consider following the different branches.\n\n### Example of the usage of \"5 whys\"\nThe vehicle will not start. (the problem)\n\n1. Why? - The battery is dead. \n2. Why? - The alternator is not functioning.\n3. Why? - The alternator belt has broken.\n4. Why? - The alternator belt was well beyond its useful service life and not replaced. \n5. Why? - The vehicle was not maintained according to the recommended service schedule. (Fifth why, a root cause)\n\n## What went well\n\nStart with the following:\n\n- Identify the things that worked well or as expected.\n- Any additional call-outs for what went particularly well.\n\n## What can be improved\n\nStart with the following:\n\n- Using the root cause analysis, explain what can be improved to prevent this from happening again.\n- Is there anything that could have been done to improve the detection or time to detection?\n- Is there anything that could have been done to improve the response or time to response?\n- Is there an existing issue that would have either prevented this incident or reduced the impact?\n- Did we have any indication or beforehand knowledge that this incident might take place?\n\n## Corrective actions\n\n- List issues that have been created as corrective actions from this incident.\n- For each issue, include the following:\n    - \u003cBare Issue link\u003e - Issue labeled as ~\"corrective action\".\n    - Include an estimated date of completion of the corrective action.\n    - Incldue the named individual who owns the delivery of the corrective action.\n\n## Guidelines\n\n* [Blameless RCA Guideline](https://about.gitlab.com/handbook/infrastructure/#rca)\n* [5 whys](https://en.wikipedia.org/wiki/5_Whys)\n*","state":"closed","created_at":"2019-11-18T09:05:29.635Z","updated_at":"2022-08-04T19:02:17.314Z","closed_at":"2019-11-18T16:58:27.092Z","closed_by":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"labels":["IncidentReview","SRE:On-call","oncall","severity::4","unscheduled","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8433","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8433","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8433/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8433/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8433","relative":"#8433","full":"gitlab-com/gl-infra/reliability#8433"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27173904,"iid":8440,"project_id":1304532,"title":"create change to separate pools for pgbouncer production read write","description":"As we plan to execute in all the read-only databases we have to split the traffic between the pools at the pgbouncer level from sideqik and web.\nPlease test in staging, and create the change request to apply in production.\n\nWe will need an extra node to organize this change.","state":"closed","created_at":"2019-11-14T11:20:03.453Z","updated_at":"2022-08-04T19:02:48.531Z","closed_at":"2019-12-12T02:46:09.155Z","closed_by":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"labels":["Database","Database","priority::2","workflow-infra::Done"],"milestone":{"id":1086169,"iid":57,"group_id":1112072,"title":"W49 DBRE","description":"","state":"closed","created_at":"2019-12-02T11:12:51.548Z","updated_at":"2020-01-16T17:23:47.770Z","due_date":"2019-12-13","start_date":"2019-12-02","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/57"},"assignees":[{"id":2493611,"username":"adescoms","name":"Adrián Escoms","state":"active","avatar_url":"https://secure.gravatar.com/avatar/d6f86d318669a8b32174b7132607443d?s=80\u0026d=identicon","web_url":"https://gitlab.com/adescoms"}],"author":{"id":2759709,"username":"Finotto","name":"Jose Finotto","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2759709/avatar.png","web_url":"https://gitlab.com/Finotto"},"type":"ISSUE","assignee":{"id":2493611,"username":"adescoms","name":"Adrián Escoms","state":"active","avatar_url":"https://secure.gravatar.com/avatar/d6f86d318669a8b32174b7132607443d?s=80\u0026d=identicon","web_url":"https://gitlab.com/adescoms"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2019-12-06","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8440","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8440","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8440/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8440/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8440","relative":"#8440","full":"gitlab-com/gl-infra/reliability#8440"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":114,"epic":{"id":15115,"iid":114,"title":"PGBouncer Saturation","url":"/groups/gitlab-com/gl-infra/-/epics/114","group_id":1112072,"human_readable_end_date":"Nov 22, 2019","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":27015529,"iid":8416,"project_id":1304532,"title":"Deploy Thanos sidecar --min-time flag","description":"After rolling out Thanos v0.8.1, we now have a `--min-time` flag[0]. This limits the sidecar lookback into Prometheus for Thanos query frontend. This allows us to reduce load on Prometheus, while still maintaining longer history in Prometheus itself.","state":"closed","created_at":"2019-11-13T13:36:42.083Z","updated_at":"2022-08-04T19:02:52.591Z","closed_at":"2019-11-13T15:24:15.958Z","closed_by":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"}],"author":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"type":"ISSUE","assignee":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8416","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8416","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8416/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8416/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8416","relative":"#8416","full":"gitlab-com/gl-infra/reliability#8416"},"severity":"UNKNOWN","moved_to_id":27021803,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27013533,"iid":8415,"project_id":1304532,"title":"RCA: 2019-11-12: Latency Apdex score degradation because of pgbouncer saturation","description":"\u003c!--\n**Please note:** if the incident relates to sensitive data, or is security related consider\nlabeling this issue with ~security and mark it confidential.\n*** \n--\u003e\n\nIncident: gitlab-com/gl-infra/production#1357\n\n## Summary\n\nA failover of pgbouncer nodes led to imbalanced connection distribution to the 2 active pgbouncer instances, which in turn led to saturated pgbouncer connections and caused Apdex degradations.\n\n- Service(s) affected : ~\"Service:Web\" \n- Team attribution : ~Infrastructure \n- Minutes downtime or degradation : 19,5h\n\nFor calculating duration of event, use the [Platform Metrics Dashboard](https://dashboards.gitlab.net/d/ZUei7TkWz/platform-metrics?orgId=1) to look at appdex and SLO violations.\n\n## Impact \u0026 Metrics\n\nStart with the following:\n\n- What was the impact of the incident? (i.e. service outage, sub-service brown-out, exposure of sensitive data, ...)\n- Who was impacted by this incident? (i.e. external customers, internal customers, specific teams, ...)\n- How did the incident impact customers? (i.e. preventing them from doing X, incorrect display of Y, ...)\n- How many attempts were made to access the impacted service/feature?\n- How many customers were affected?\n- How many customers tried to access the impacted service/feature?\n\nInclude any additional metrics that are of relevance.\n\nProvide any relevant graphs that could help understand the impact of the incident and its dynamics.\n\n![image](/uploads/b579c5383a885b92af6407a1243cd86d/image.png)\n\n![image](/uploads/b4f0dc2322b0995f41682009b3c622fe/image.png)\n\n## Detection \u0026 Response\n\nStart with the following:\n\n- How was the incident detected?\n- Did alarming work as expected?\n- How long did it take from the start of the incident to its detection?\n- How long did it take from detection to remediation?\n- Were there any issues with the response to the incident? (i.e. bastion host used to access the service was not available, relevant team memeber wasn't page-able, ...)\n\n## Root Cause Analysis\n\nThe purpose of this document is to understand the reasons that caused an incident, and to create mechanisms to prevent it from recurring in the future. A root cause can **never be a person**, the way of writing has to refer to the system and the context rather than the specific actors.\n\nFollow the \"**5 whys**\" in a **blameless** manner as the core of the root-cause analysis.\n\nFor this it is necessary to start with the incident, and question why it happened. Keep iterating asking \"why?\" 5 times. While it's not a hard rule that it has to be 5 times, it helps to keep questions get deeper in finding the actual root cause. \n\nKeep in min that from one \"why?\" there may come more than one answer, consider following the different branches.\n\n### Example of the usage of \"5 whys\"\nThe vehicle will not start. (the problem)\n\n1. Why? - The battery is dead. \n2. Why? - The alternator is not functioning.\n3. Why? - The alternator belt has broken.\n4. Why? - The alternator belt was well beyond its useful service life and not replaced. \n5. Why? - The vehicle was not maintained according to the recommended service schedule. (Fifth why, a root cause)\n\n## What went well\n\nStart with the following:\n\n- Identify the things that worked well or as expected.\n- Any additional call-outs for what went particularly well.\n\n## What can be improved\n\nStart with the following:\n\n- Using the root cause analysis, explain what can be improved to prevent this from happening again.\n- Is there anything that could have been done to improve the detection or time to detection?\n- Is there anything that could have been done to improve the response or time to response?\n- Is there an existing issue that would have either prevented this incident or reduced the impact?\n- Did we have any indication or beforehand knowledge that this incident might take place?\n\n## Corrective actions\n\n- List issues that have been created as corrective actions from this incident.\n- For each issue, include the following:\n    - \u003cBare Issue link\u003e - Issue labeled as ~\"corrective action\".\n    - Include an estimated date of completion of the corrective action.\n    - Incldue the named individual who owns the delivery of the corrective action.\n\n## Guidelines\n\n* [Blameless RCA Guideline](https://about.gitlab.com/handbook/infrastructure/#rca)\n* [5 whys](https://en.wikipedia.org/wiki/5_Whys)\n*","state":"closed","created_at":"2019-11-13T12:36:33.054Z","updated_at":"2022-08-04T19:02:53.299Z","closed_at":"2019-12-08T20:39:00.587Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["IncidentReview","SRE:On-call","oncall","unscheduled","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8415","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8415","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8415/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8415/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8415","relative":"#8415","full":"gitlab-com/gl-infra/reliability#8415"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27002656,"iid":8412,"project_id":1304532,"title":"Large number of failing blackbox probes","description":"Currently 16.5% (23/139) blackbox probes are failing continuously.\n\n* [x] Update blackbox_exporter to 0.16.0. (Fix for https host header in redirects)\n* [x] Fix all broken blackbox probes.\n* [x] Add alert for blackbox probes failing.","state":"closed","created_at":"2019-11-13T07:44:59.103Z","updated_at":"2020-09-03T22:12:59.244Z","closed_at":"2020-09-02T14:56:49.029Z","closed_by":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"labels":["Observability","workflow-infra::Done"],"milestone":{"id":1380223,"iid":92,"group_id":1112072,"title":"Observability Team - FY21-Q3","description":"","state":"closed","created_at":"2020-07-24T19:07:22.800Z","updated_at":"2020-11-02T23:56:39.868Z","due_date":"2020-10-30","start_date":"2020-08-03","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/92"},"assignees":[{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"}],"author":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"type":"ISSUE","assignee":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"user_notes_count":1,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8412","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":3,"completed_count":3},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8412","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8412/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8412/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8412","relative":"#8412","full":"gitlab-com/gl-infra/reliability#8412"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26986385,"iid":8406,"project_id":1304532,"title":"Cleanup stage/tier/type labels","description":"There are a lot of Prometheus monitoring targets that are missing `stage, `tier`, and `type` labels. These are necessary for correct identification in the generic service alerts/rules and correct routing to alertmanager.","state":"closed","created_at":"2019-11-12T15:36:55.826Z","updated_at":"2022-08-04T19:03:06.819Z","closed_at":"2020-05-14T06:32:44.059Z","closed_by":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"labels":["Observability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"}],"author":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"type":"ISSUE","assignee":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8406","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8406","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8406/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8406/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8406","relative":"#8406","full":"gitlab-com/gl-infra/reliability#8406"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26981123,"iid":8405,"project_id":1304532,"title":"Fix sidekiq error ratio metrics","description":"The [sidekiq error ration panel](https://dashboards.gitlab.net/d/general-service/general-service-platform-metrics?orgId=1\u0026from=1573553266211\u0026to=1573564066211\u0026panelId=8\u0026tz=UTC\u0026fullscreen\u0026var-PROMETHEUS_DS=Global\u0026var-environment=gprd\u0026var-type=sidekiq\u0026var-stage=main\u0026var-sigma=2) in Grafana is showing error ratios higher than 100% which can't be true and is causing alerts.","state":"closed","created_at":"2019-11-12T13:10:10.814Z","updated_at":"2022-08-04T19:03:10.363Z","closed_at":"2019-12-31T12:42:01.250Z","closed_by":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"labels":["SRE:On-call","oncall","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8405","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8405","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8405/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8405/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8405","relative":"#8405","full":"gitlab-com/gl-infra/reliability#8405"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26974433,"iid":8404,"project_id":1304532,"title":"Sync folders to public Grafana dashboards","description":"The current Grafana sync script doesn't support updating the folders. This causes all dashboards to be squashed into a flat namespace.","state":"closed","created_at":"2019-11-12T11:06:25.806Z","updated_at":"2022-08-04T19:03:12.238Z","closed_at":"2021-11-15T10:17:43.471Z","closed_by":{"id":210928,"username":"steveazz","name":"Steve Azzopardi","state":"active","avatar_url":"https://secure.gravatar.com/avatar/4a5eeed7ec5c80642df9ee708bb496d7?s=80\u0026d=identicon","web_url":"https://gitlab.com/steveazz"},"labels":["Service::PublicGrafana","priority::4","team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[],"author":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"type":"ISSUE","assignee":null,"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8404","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8404","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8404/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8404/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8404","relative":"#8404","full":"gitlab-com/gl-infra/reliability#8404"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26958032,"iid":8402,"project_id":1304532,"title":"Handle DNS entries for the gitlab-review.app hosted zone in terraform","description":"This might come into play at https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8203 but we should do it regardless","state":"closed","created_at":"2019-11-12T03:51:29.171Z","updated_at":"2022-08-04T19:03:14.420Z","closed_at":"2019-11-13T15:04:06.038Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["workflow-infra::Done"],"milestone":null,"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8402","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8402","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8402/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8402/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8402","relative":"#8402","full":"gitlab-com/gl-infra/reliability#8402"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26947132,"iid":8399,"project_id":1304532,"title":"RCA: 2019-11-11 GCP Service Disruption","description":"\u003c!--\n**Please note:** if the incident relates to sensitive data, or is security related consider\nlabeling this issue with ~security and mark it confidential.\n*** \n--\u003e\n\nIncident: https://gitlab.com/gitlab-com/gl-infra/production/issues/1349 , https://gitlab.com/gitlab-com/gl-infra/production/issues/1348\n\n## Summary\n\nA brief summary of what happened. Try to make it as executive-friendly as possible.\n\n- Service(s) affected : \n- Team attribution : \n- Minutes downtime or degradation : \n\nFor calculating duration of event, use the [Platform Metrics Dashboard](https://dashboards.gitlab.net/d/ZUei7TkWz/platform-metrics?orgId=1) to look at appdex and SLO violations.\n\n## Impact \u0026 Metrics\n\nStart with the following:\n\n- What was the impact of the incident? (i.e. service outage, sub-service brown-out, exposure of sensitive data, ...)\n- Who was impacted by this incident? (i.e. external customers, internal customers, specific teams, ...)\n- How did the incident impact customers? (i.e. preventing them from doing X, incorrect display of Y, ...)\n- How many attempts were made to access the impacted service/feature?\n- How many customers were affected?\n- How many customers tried to access the impacted service/feature?\n\nInclude any additional metrics that are of relevance.\n\nProvide any relevant graphs that could help understand the impact of the incident and its dynamics.\n\n## Detection \u0026 Response\n\nStart with the following:\n\n- How was the incident detected?\n- Did alarming work as expected?\n- How long did it take from the start of the incident to its detection?\n- How long did it take from detection to remediation?\n- Were there any issues with the response to the incident? (i.e. bastion host used to access the service was not available, relevant team memeber wasn't page-able, ...)\n\n## Root Cause Analysis\n\nThe purpose of this document is to understand the reasons that caused an incident, and to create mechanisms to prevent it from recurring in the future. A root cause can **never be a person**, the way of writing has to refer to the system and the context rather than the specific actors.\n\nFollow the \"**5 whys**\" in a **blameless** manner as the core of the root-cause analysis.\n\nFor this it is necessary to start with the incident, and question why it happened. Keep iterating asking \"why?\" 5 times. While it's not a hard rule that it has to be 5 times, it helps to keep questions get deeper in finding the actual root cause. \n\nKeep in min that from one \"why?\" there may come more than one answer, consider following the different branches.\n\n### Example of the usage of \"5 whys\"\nThe vehicle will not start. (the problem)\n\n1. Why? - The battery is dead. \n2. Why? - The alternator is not functioning.\n3. Why? - The alternator belt has broken.\n4. Why? - The alternator belt was well beyond its useful service life and not replaced. \n5. Why? - The vehicle was not maintained according to the recommended service schedule. (Fifth why, a root cause)\n\n## What went well\n\nStart with the following:\n\n- Identify the things that worked well or as expected.\n- Any additional call-outs for what went particularly well.\n\n## What can be improved\n\nStart with the following:\n\n- Using the root cause analysis, explain what can be improved to prevent this from happening again.\n- Is there anything that could have been done to improve the detection or time to detection?\n- Is there anything that could have been done to improve the response or time to response?\n- Is there an existing issue that would have either prevented this incident or reduced the impact?\n- Did we have any indication or beforehand knowledge that this incident might take place?\n\n## Corrective actions\n\n- List issues that have been created as corrective actions from this incident.\n- For each issue, include the following:\n    - \u003cBare Issue link\u003e - Issue labeled as ~\"corrective action\".\n    - Include an estimated date of completion of the corrective action.\n    - Incldue the named individual who owns the delivery of the corrective action.\n\n## Guidelines\n\n* [Blameless RCA Guideline](https://about.gitlab.com/handbook/infrastructure/#rca)\n* [5 whys](https://en.wikipedia.org/wiki/5_Whys)\n*","state":"closed","created_at":"2019-11-11T17:18:08.372Z","updated_at":"2022-08-04T19:03:16.360Z","closed_at":"2020-02-18T20:05:43.924Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["IncidentReview","workflow-infra::Done"],"milestone":null,"assignees":[],"author":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8399","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8399","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8399/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8399/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8399","relative":"#8399","full":"gitlab-com/gl-infra/reliability#8399"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26909720,"iid":8391,"project_id":1304532,"title":"Corrupt WAL in GKE prometheus","description":"One of the prometheus servers in the gitlab-production GKE cluster (https://console.cloud.google.com/kubernetes/pod/us-east1/gprd-gitlab-gke/monitoring/prometheus-gitlab-monitoring-promethe-prometheus-0?project=gitlab-production) has a corrupt WAL:\n`\"reload blocks: head truncate failed: create checkpoint: read segments: corruption in segment /prometheus/wal/00002079 at 81103202: unexpected full record\"`\n\nAFAIK the correct way to fix that is to kick prometheus over so it can do a repair.","state":"closed","created_at":"2019-11-11T03:50:37.653Z","updated_at":"2020-03-14T01:08:24.803Z","closed_at":"2020-03-13T22:09:09.199Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"}],"author":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"type":"ISSUE","assignee":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8391","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8391","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8391/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8391/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8391","relative":"#8391","full":"gitlab-com/gl-infra/reliability#8391"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26909449,"iid":8390,"project_id":1304532,"title":"prometheus-app-02-inf-gprd failing to upload to object store","description":"```Firing 1 - Thanos compaction has not run in 24 hours.```\n\n```Thanos compact prometheus-app-02-inf-gprd.c.gitlab-production.internal:10902 has not uploaded any blocks in 24 hours.```","state":"closed","created_at":"2019-11-11T03:20:10.542Z","updated_at":"2019-12-06T21:42:18.477Z","closed_at":"2019-11-11T03:24:03.432Z","closed_by":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"}],"author":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"type":"ISSUE","assignee":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8390","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8390","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8390/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8390/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8390","relative":"#8390","full":"gitlab-com/gl-infra/reliability#8390"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26908797,"iid":8389,"project_id":1304532,"title":"postgres-01-inf-dr:/opt/prometheus is full","description":"Not sure how long, just that it is.\n\nCurrently 50GB; will expand to 100GB","state":"closed","created_at":"2019-11-11T02:10:18.178Z","updated_at":"2019-12-06T21:42:18.315Z","closed_at":"2019-11-11T02:21:54.387Z","closed_by":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"}],"author":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"type":"ISSUE","assignee":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8389","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8389","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8389/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8389/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8389","relative":"#8389","full":"gitlab-com/gl-infra/reliability#8389"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26833795,"iid":8380,"project_id":1304532,"title":"Fix path to PPA in gitlab-sentry cookbook","description":"The gitlab-sentry cookbook adds a PPA for redis, but it has a `not-if` pointing to an old `trusty` path.   This leads to add-apt-repository running every chef run, and each time it adds an additional commented out deb-src line, leading to multi-thousand line files and chef-client timeouts when it runs at busy times (add-apt-repository rewrites the file repeatedly, for some reason I don't care to investigate).","state":"closed","created_at":"2019-11-08T00:28:40.511Z","updated_at":"2019-12-06T21:42:05.940Z","closed_at":"2019-11-08T01:05:53.840Z","closed_by":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"}],"author":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"type":"ISSUE","assignee":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8380","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8380","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8380/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8380/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8380","relative":"#8380","full":"gitlab-com/gl-infra/reliability#8380"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26824818,"iid":8376,"project_id":1304532,"title":"Provision AWS IAM account for customer cross-account role access","description":"For the request in gitlab-com/access-requests#2606, we need to provision an account for use by `gitlab.com` to [assume customer-owned cross-account IAM roles](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html) with permissions to provision EKS clusters into their account. At least to start, I think the `aws-account` terraform configuration in gitlab-com/gitlab-com-infrastructure\u003e is the most likely place for this resource, though we can move/adjust if necessary at a later date.\n\nThe account should be assigned an IAM policy which allows `sts:AssumeRole` and a condition(https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_condition_operators.html) that prevents the user from assuming a role in our own account (for now?). If we need to enable EKS provisioning, we will need to stipulate that they can not be hosted in our current production account, or make other policy adjustments to ensure that the provisioning account cannot assume other roles that grant unwanted elevated permissions.\n\nAs an example of how to negate access to roles in our production account, something like the following will be needed (change ACCOUNT_ID accordingly). (See [here](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_notresource.html#notresource-element-combinations) for additional context on why this is actually desirable in our case)\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": {\n    \"Effect\": \"Allow\",\n    \"Action\": \"sts:AssumeRole\",\n    \"NotResource\": [\n      \"arn:aws:iam::ACCOUNT_ID:role/*\"\n    ]\n  }\n}\n```\n\nFurther, since we require an external ID for all cross-account roles being accessed, we _should_ be able to limit the account to only assume roles when an external id is provided, like this using the [Null](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_condition_operators.html#Conditions_Null) condition and the [`sts:ExternalId`](https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awssecuritytokenservice.html#awssecuritytokenservice-policy-keys) condition key to ensure that the permissions are only granted when that condition key is present.\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": {\n    \"Effect\": \"Allow\",\n    \"Action\": \"sts:AssumeRole\",\n    \"NotResource\": [\n      \"arn:aws:iam::ACCOUNT_ID:role/*\"\n    ],\n    \"Condition\":{\"Null\":{\"sts:ExternalId\":\"false\"}}\n  }\n}\n```","state":"closed","created_at":"2019-11-07T18:28:15.142Z","updated_at":"2019-12-06T21:42:05.747Z","closed_at":"2019-11-18T20:55:50.490Z","closed_by":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"labels":["team::Reliability","terraform","unscheduled","workflow-infra::Done"],"milestone":{"id":1038522,"iid":52,"group_id":1112072,"title":"W47 Secure \u0026 Defend","description":"## Calendar\r\n\r\n|             \t| M 18 Nov \t| T 19 Nov \t| W 20 Nov \t| Th 21 Nov  | F 22 Nov\r\n|-------------\t|----------\t|----------\t|----------\t|---------- |----------\t\r\n| @bjk-gitlab \t| 🏙 Kubecon | 🏙 Kubecon | 🏙 Kubecon | 🏙 Kubecon |\r\n| @craig      \t| 📟 | 📟 | 📟 | 📟 | 📟 \r\n| @craigf     \t| 📟 | 📟 | 📟 | 📟 | 📟 \r\n| @cmiskell   \t| | | | |\r\n| @hphilipps  \t| | | | |\r\n| @msmiley    \t| 📟 | 📟 | 📟 | 📟 | 📟 \r\n\r\nW47 working days: 11\r\n\r\n|             \t| M 25 Nov \t| T 26 Nov \t| W 27 Nov \t| Th 28 Nov  | F 29 Nov \r\n|-------------\t|----------\t|----------\t|----------\t|----------- |----------\r\n| @bjk-gitlab \t| | | | |\r\n| @craig      \t| | | | 🦃 U.S. Thanksgiving |\r\n| @craigf     \t| | | | |\r\n| @cmiskell   \t| | | | |\r\n| @hphilipps  \t| | | | |\r\n| @msmiley    \t| | | | 🦃 U.S. Thanksgiving |\r\n\r\nW48 working days: 28\r\n\r\n\u003chr\u003e\r\n\r\n**Total working days: 39**","state":"closed","created_at":"2019-10-18T14:57:33.457Z","updated_at":"2019-12-04T20:40:19.167Z","due_date":"2019-12-01","start_date":"2019-11-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/52"},"assignees":[{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"}],"author":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"type":"ISSUE","assignee":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8376","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8376","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8376/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8376/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8376","relative":"#8376","full":"gitlab-com/gl-infra/reliability#8376"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26820785,"iid":8375,"project_id":1304532,"title":"Add about.gitlab.com redirect rule for index.html","description":"## Problem\n\nCrawlers are reporting duplicate content for some pages on about.gitlab.com ending with a URL `index.html`. \n\nExample:\n- https://about.gitlab.com/analysts/forrester-vsm/\n- https://about.gitlab.com/analysts/forrester-vsm/index.html\n\n## Solution\n\nAdd a redirect rule on about.gitlab.com for any URL ending with `index.html` back to `/`.\n\n## Concerns\n\n@brandon_lyon @laurenbarker do you know of any templates that require their URL to end with index.html?\n\n@gitlab-com/gl-infra/managers tagged for prioritization","state":"closed","created_at":"2019-11-07T16:58:20.488Z","updated_at":"2022-08-04T19:03:41.320Z","closed_at":"2019-11-12T02:12:19.617Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["priority::4","team::Reliability","workflow-infra::Done"],"milestone":{"id":1057451,"iid":54,"group_id":1112072,"title":"CI/CD \u0026 Enablement - November 2019","description":"","state":"closed","created_at":"2019-11-01T22:45:09.199Z","updated_at":"2019-12-04T21:44:40.512Z","due_date":"2019-11-30","start_date":"2019-11-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/54"},"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":2453970,"username":"shanerice","name":"Shane Rice","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2453970/avatar.png","web_url":"https://gitlab.com/shanerice"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":11,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8375","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8375","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8375/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8375/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8375","relative":"#8375","full":"gitlab-com/gl-infra/reliability#8375"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26784630,"iid":8372,"project_id":1304532,"title":"Tweak alert for disk use of /var/log on patroni servers to alert sooner","description":"The current alert for /var/log filling up comes when 1% of the space is remaining. When /var/log is filled up, it can have negative impacts on WAL-E shipping and the node performance as a whole. We should alert a little more aggressively on the /var/log disk filling up. Perhaps at 10% remaining space.","state":"closed","created_at":"2019-11-06T20:03:17.428Z","updated_at":"2022-08-04T19:03:44.591Z","closed_at":"2019-11-07T18:51:41.357Z","closed_by":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"labels":["SRE:On-call","corrective action","workflow-infra::Done"],"milestone":null,"assignees":[{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"}],"author":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"type":"ISSUE","assignee":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8372","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8372","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8372/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8372/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8372","relative":"#8372","full":"gitlab-com/gl-infra/reliability#8372"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26776728,"iid":8369,"project_id":1304532,"title":"Update runbooks to provide good documentation on how to associate sidekiq jobs with projects (or users).","description":"Update runbooks to describe how we can find sidekiq queue jobs per project (or user), and review sidekiq queues to look for problematic projects (or users).\n\nhttps://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8368\n\n@ansdval FYI","state":"closed","created_at":"2019-11-06T15:49:29.957Z","updated_at":"2022-08-04T19:03:46.534Z","closed_at":"2020-08-13T17:06:32.353Z","closed_by":{"id":2222520,"username":"dawsmith","name":"Dave Smith","state":"active","avatar_url":"https://secure.gravatar.com/avatar/ef341e061f6b86461626e64c5fbcfe52?s=80\u0026d=identicon","web_url":"https://gitlab.com/dawsmith"},"labels":["corrective action","workflow-infra::Done"],"milestone":null,"assignees":[],"author":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8369","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8369","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8369/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8369/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8369","relative":"#8369","full":"gitlab-com/gl-infra/reliability#8369"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26756847,"iid":8367,"project_id":1304532,"title":"Make cloudflare DNS terraformable","description":"Since we are keeping seperate zones in cloudflare for gitlab.com and staging.gitlab.com for cloudflare configuration purposes we are going to keep the split as it is right now. This means we can extend the `dns` environment in terraform to allow managing the `staging.gitlab.com.` zone via the cloudflare provider without impacting production.\n\nThis also resolves diversion from production, because even though the underlying DNS is different, there is no difference in managing it, then.\n\nWe should be able to keep the same structure for configuring that via the json files as we do for route53.","state":"closed","created_at":"2019-11-06T10:49:06.190Z","updated_at":"2019-12-19T16:11:39.218Z","closed_at":"2019-12-19T15:10:58.781Z","closed_by":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":{"id":1087796,"iid":59,"group_id":1112072,"title":"Reliability December 2019","description":"","state":"closed","created_at":"2019-12-03T16:20:55.704Z","updated_at":"2020-01-16T17:21:46.339Z","due_date":"2019-12-31","start_date":"2019-12-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/59"},"assignees":[{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"}],"author":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"type":"ISSUE","assignee":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"user_notes_count":14,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8367","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8367","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8367/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8367/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8367","relative":"#8367","full":"gitlab-com/gl-infra/reliability#8367"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":115,"epic":{"id":15220,"iid":115,"title":"Cloudflare: general dependencies \u0026 infrastructure preparations","url":"/groups/gitlab-com/gl-infra/-/epics/115","group_id":1112072,"human_readable_end_date":"Feb 28, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":26739422,"iid":8364,"project_id":1304532,"title":"Rails Consoles for Auto DevOps Deployments","description":"Currently most of our rails consoles are running on VM's, and the code that they run is deployed along with all of the other nodes.\n\nIn non-core applications running from Auto DevOps, we have no way to get a rails console at the moment.\n\nWhen connecting directly to an application pod, this is the result\n```\n$ kubectl exec -it production-5fdb8f947-5rpxq -- /bin/bash\nroot@production-5fdb8f947-5rpxq:/# cd /app/bin\nroot@production-5fdb8f947-5rpxq:/app/bin# ./rails console\nTraceback (most recent call last):\n\t4: from ./rails:3:in `\u003cmain\u003e'\n\t3: from ./rails:3:in `require_relative'\n\t2: from /app/config/boot.rb:3:in `\u003ctop (required)\u003e'\n\t1: from /usr/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n/usr/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require': cannot load such file -- bundler/setup (LoadError)\nroot@production-5fdb8f947-5rpxq:/app/bin# rails console\n```\nAlso:\n```\nkubectl exec -it production-5fdb8f947-5rpxq -- /bin/bash\nroot@production-5fdb8f947-5rpxq:/# bundle exec rails c\nbash: bundle: command not found\nroot@production-5fdb8f947-5rpxq:/# cd /app/bin/\nroot@production-5fdb8f947-5rpxq:/app/bin# ./bundle exec rails c\nTraceback (most recent call last):\n\t2: from ./bundle:3:in '\u003cmain\u003e'\n\t1: from /usr/lib/ruby/2.5.0/rubygems.rb:263:in 'bin_path'\n/usr/lib/ruby/2.5.0/rubygems.rb:289:in 'find_spec_for_exe': Could not find 'bundler' (1.17.3) required by your /app/Gemfile.lock. (Gem::GemNotFoundException)\nTo update to the lastest version installed on your system, run `bundle update --bundler`.\nTo install the missing version, run 'gem install bundler:1.17.3'\n```\n\nIf we simply deploy a VM as we do now, we would have to manually set it up and there is no mechanism in Auto DevOps to deploy code updates to that VM.\n\nIf we deploy to a pod, then we have to give full access to the cluster via `kubectl` to anyone who needs to run `kubectl exec` to get a rails console.\n\nNeither of these are ideal.  Lets discuss options.","state":"closed","created_at":"2019-11-05T21:54:53.033Z","updated_at":"2022-08-04T19:03:49.376Z","closed_at":"2020-10-24T00:19:22.220Z","closed_by":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"labels":["Discussion","kubernetes","workflow-infra::Done"],"milestone":null,"assignees":[],"author":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8364","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8364","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8364/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8364/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8364","relative":"#8364","full":"gitlab-com/gl-infra/reliability#8364"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26683973,"iid":8346,"project_id":1304532,"title":"Redis traffic analysis - gitlab-com/www-gitlab-com#5708","description":"","state":"closed","created_at":"2019-11-04T20:30:53.170Z","updated_at":"2022-08-04T19:04:09.072Z","closed_at":"2019-11-21T19:28:21.971Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["workflow-infra::Done"],"milestone":{"id":1037343,"iid":51,"group_id":1112072,"title":"W45 Secure \u0026 Defend","description":"## Calendar\r\n\r\n|             \t| M 04 Nov \t| T 05 Nov \t| W 06 Nov \t| Th 07 Nov  | F 08 Nov\r\n|-------------\t|----------\t|----------\t|----------\t|---------- |----------\t\r\n| @bjk-gitlab \t|         \t|        \t| 🏙 PromCon | 🏙 PromCon | 🏙 PromCon\r\n| @craig      \t|      \t|         \t|         \t|           |          \t\r\n| @craigf     \t| 🌴    \t| 🌴        | 🌴       | 🌴    | 🌴\r\n| @cmiskell   \t|         \t| 📟   | 📟  \t| 📟    | 📟\r\n| @hphilipps  \t|       \t|       \t|      \t|           | \r\n| @msmiley    \t|        \t|       \t|       \t|           | \r\n\r\nW45 working days: 18\r\n\r\n|             \t| M 11 Nov \t| T 12 Nov \t| W 13 Nov \t| Th 14 Nov  | F 15 Nov \r\n|-------------\t|----------\t|----------\t|----------\t|----------- |----------\r\n| @bjk-gitlab \t|         \t|         \t|    \t    |           |    \r\n| @craig      \t|         \t|        \t|        \t|           |  \r\n| @craigf     \t| 🌴  \t| 🌴  \t| 🌴  \t| 🌴    | 🌴\r\n| @cmiskell   \t| 📟   | \\      \t| \\       \t| \\           | \\ \r\n| @hphilipps  \t|   \t    | 📟   | 📟  \t| 📟    | 📟\r\n| @msmiley    \t|       \t|       \t|       \t|           | \r\n\r\nW46 working days: 20\r\n\r\n\u003chr\u003e\r\n\r\n**Total working days: 38**","state":"closed","created_at":"2019-10-17T15:40:11.302Z","updated_at":"2019-11-19T14:39:12.000Z","due_date":"2019-11-17","start_date":"2019-11-04","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/51"},"assignees":[{"id":3947902,"username":"msmiley","name":"Matt Smiley","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3947902/avatar.png","web_url":"https://gitlab.com/msmiley"}],"author":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"type":"ISSUE","assignee":{"id":3947902,"username":"msmiley","name":"Matt Smiley","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3947902/avatar.png","web_url":"https://gitlab.com/msmiley"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8346","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8346","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8346/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8346/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8346","relative":"#8346","full":"gitlab-com/gl-infra/reliability#8346"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26670540,"iid":8345,"project_id":1304532,"title":"Deploy a prototype of dynamic Image rescaling to CloudFlare workers on staging","description":"Context: https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8209#note_238007871\n\nSomething like this should work\n\n```javascript\naddEventListener('fetch', event =\u003e {\n  event.respondWith(handleRequest(event.request))\n})\n\nasync function handleRequest(request) {\n  let url = new URL(request.url);\n  let fetchParams = {\n    cf: {\n      image: {\n        fit: 'scale-down'\n      }\n  };\n\n  let width = parseInt(url.searchParams.get(\"width\"), 10);\n  if (isNaN(width) || !width) {\n    return fetch(request);\n  } else {\n    fetchParams.cf.image.width = width;\n  }\n\n  // When we do not need the `x-with` header anymore:\n  // return fetch(request, fetchParams);\n\n  let response = await fetch(request, fetchParams);\n  response = new Response(response.body, response)\n  response.headers.set('x-with', 'cloudflare worker')\n  return response\n}\n\n```\n\nAccording to @timzallmann These are the required routes:\n\n- User Avatar URL `https://assets.gitlab-static.net/uploads/-/system/user/avatar/1149402/avatar.png?width=24`\n- Project Avatar URL `https://assets.gitlab-static.net/uploads/-/system/project/avatar/7764/about_logo.png?width=40`\n- Group Avatar URL `https://gitlab.com/uploads/-/system/group/avatar/9970/logo-extra-whitespace.png`\n\nso the `/uploads/-/system/**` pattern should be good.","state":"closed","created_at":"2019-11-04T15:24:57.400Z","updated_at":"2020-09-23T12:00:11.703Z","closed_at":"2019-11-08T16:09:08.084Z","closed_by":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":{"id":1060421,"iid":55,"group_id":1112072,"title":"W45 Dev \u0026 Ops","description":"","state":"closed","created_at":"2019-11-05T10:13:26.190Z","updated_at":"2019-12-03T22:08:39.621Z","due_date":"2019-11-17","start_date":"2019-11-04","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/55"},"assignees":[{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"}],"author":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"type":"ISSUE","assignee":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"user_notes_count":16,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8345","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8345","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8345/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8345/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8345","relative":"#8345","full":"gitlab-com/gl-infra/reliability#8345"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26670291,"iid":8344,"project_id":1304532,"title":"Update runbooks with documentation on how to use and manage one-off commands.","description":"As an SRE, I need to know how to create, install, and trigger ansible based commands to help manage actions on large numbers of nodes.\n\nThe runbooks should be updated to include sections on how to accomplish each of these tasks.\n\nThis is the original issue with details on what was to be made: https://gitlab.com/gitlab-com/gl-infra/delivery/issues/75","state":"closed","created_at":"2019-11-04T15:19:16.783Z","updated_at":"2022-08-04T19:04:10.119Z","closed_at":"2019-12-09T20:19:11.452Z","closed_by":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"labels":["runbook","team::Reliability","workflow-infra::Done"],"milestone":{"id":1057451,"iid":54,"group_id":1112072,"title":"CI/CD \u0026 Enablement - November 2019","description":"","state":"closed","created_at":"2019-11-01T22:45:09.199Z","updated_at":"2019-12-04T21:44:40.512Z","due_date":"2019-11-30","start_date":"2019-11-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/54"},"assignees":[{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"}],"author":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"type":"ISSUE","assignee":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8344","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8344","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8344/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8344/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8344","relative":"#8344","full":"gitlab-com/gl-infra/reliability#8344"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26670201,"iid":8343,"project_id":1304532,"title":"Make CloudFlare workers terraformable","description":"In order to deploy a prototype for https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8209#note_238224109, we need to have a way to deploy cloudflare worker scrips and routes vie terraform.\n\nThis issue's goal is to have a way to deploy worker scripts (https://www.terraform.io/docs/providers/cloudflare/r/worker_script.html) and worker routes (https://www.terraform.io/docs/providers/cloudflare/r/worker_route.html) to staging.gitlab.com.","state":"closed","created_at":"2019-11-04T15:17:37.451Z","updated_at":"2019-12-06T21:47:33.599Z","closed_at":"2019-11-07T10:33:56.190Z","closed_by":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":{"id":1060421,"iid":55,"group_id":1112072,"title":"W45 Dev \u0026 Ops","description":"","state":"closed","created_at":"2019-11-05T10:13:26.190Z","updated_at":"2019-12-03T22:08:39.621Z","due_date":"2019-11-17","start_date":"2019-11-04","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/55"},"assignees":[{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"}],"author":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"type":"ISSUE","assignee":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8343","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8343","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8343/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8343/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8343","relative":"#8343","full":"gitlab-com/gl-infra/reliability#8343"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":115,"epic":{"id":15220,"iid":115,"title":"Cloudflare: general dependencies \u0026 infrastructure preparations","url":"/groups/gitlab-com/gl-infra/-/epics/115","group_id":1112072,"human_readable_end_date":"Feb 28, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":26669985,"iid":8342,"project_id":1304532,"title":"Use `web_exporter/metrics` for staging and production.","description":"The `/-/metrics` is a very bad citizen now when we run Puma. It does effectively block the worker process for the time required to render all metrics, thus increase the latency and processing time across the fleet substantially: https://dashboards.gitlab.net/d/thYzurImk/rails-controllers?orgId=1\u0026var-action=MetricsController%23index\u0026var-database=influxdb-01-inf-gprd. We do run around 1k of `/-/metrics` requests per-minute, the mean time is 400ms, p95 1s. Anything that escapes to native, is not interruptible by default due to Ruby GVL and effectively blocks the requests processing for the given period of time.\n\nLooking at actual implementation, it is actually very inefficient: https://gitlab.com/gitlab-org/prometheus-client-mmap/blob/master/lib%2Fprometheus%2Fclient%2Fformats%2Ftext.rb#L34. We get a list of all files, and escape to native to present them.\n\nWe do have `/metrics` on implemented already on separate endpoint, it is not yet fully tested, but I would assume that we might prefer to switch to that: https://gitlab.com/gitlab-org/gitlab/issues/30037.\n\nWe should validate and switch it on staging/production to use `/metrics` endpoint.","state":"closed","created_at":"2019-11-04T15:09:45.537Z","updated_at":"2022-08-04T19:04:11.385Z","closed_at":"2019-11-12T17:09:38.162Z","closed_by":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"labels":["Multithreaded App Server","group::application performance","team::Reliability","workflow-infra::Done"],"milestone":{"id":1033920,"iid":63,"group_id":6543,"title":"12.5","description":"","state":"closed","created_at":"2019-10-15T08:55:34.286Z","updated_at":"2020-05-13T19:32:16.140Z","due_date":"2019-11-22","start_date":"2019-10-23","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/-/milestones/63"},"assignees":[{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzciński","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"user_notes_count":12,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8342","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8342","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8342/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8342/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8342","relative":"#8342","full":"gitlab-com/gl-infra/reliability#8342"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":78,"epic":{"id":8807,"iid":78,"title":"Enable Puma on GitLab.com","url":"/groups/gitlab-com/gl-infra/-/epics/78","group_id":1112072,"human_readable_end_date":"Feb 17, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":26572236,"iid":8335,"project_id":1304532,"title":"Environment name for new ops environment","description":"When provisioning the new Chef server infrastructure, we received the following error on bootstrap: `chef-01-sv-ops-us-central startup-script: INFO startup-script: Cannot load environment ops-us-central#033[0m` because we've overloaded that variable/term.\n\nAt first glance, I was inclined to set this value to `ops` in `environments/ops-us-central/variables.tf`, thinking that our intention is to lift-and-shift the current ops environment to the new region, destroy the old infrastructure, then update the terraform config directory name and state file to `ops` and let it be the new primary. However - currently there are a few areas where `ops-us-central` is hard-coded that might still be problematic, and prevent this approach; most notably [the name for the GCP network](https://gitlab.com/gitlab-com/gitlab-com-infrastructure/blob/d2f51e5d709943cad25a305c73a6eb4f69581b90/environments/ops-us-central/main.tf#L52), and subsequent references under downstream dependent resources.\n\nIn order to facilitate the migration, I anticipate that we will be limited in our options for names we can use while still effectively running both environments in parallel, but `ops-us-central` is likely not the best choice, in terms of length, and region-specificity to start; I'm sure that we'll encounter other issues as we continue, as well. `ops-too` was used for the first aborted migration, but that received pushback due to being somewhat flippant.\n\nSince we're restarting the efforts to move ops away from the `us-east1` region, I suspect now is the time to figure this out, while we can reasonably easily destroy/recreate infrastructure without impacting running services. If we _do_ have to use an entirely new name, that means duplication of our chef configs, at least; what else would be impacted?\n\nTL;DR - what shall we call the new ops environment / how do we address the naming issues? \n\n/cc @ahanselka @cmcfarland @cindy","state":"closed","created_at":"2019-11-01T22:20:55.483Z","updated_at":"2019-12-06T21:42:05.249Z","closed_at":"2019-11-04T22:56:39.617Z","closed_by":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"labels":["Discussion","Research","chef","team::Reliability","workflow-infra::Done"],"milestone":{"id":1037343,"iid":51,"group_id":1112072,"title":"W45 Secure \u0026 Defend","description":"## Calendar\r\n\r\n|             \t| M 04 Nov \t| T 05 Nov \t| W 06 Nov \t| Th 07 Nov  | F 08 Nov\r\n|-------------\t|----------\t|----------\t|----------\t|---------- |----------\t\r\n| @bjk-gitlab \t|         \t|        \t| 🏙 PromCon | 🏙 PromCon | 🏙 PromCon\r\n| @craig      \t|      \t|         \t|         \t|           |          \t\r\n| @craigf     \t| 🌴    \t| 🌴        | 🌴       | 🌴    | 🌴\r\n| @cmiskell   \t|         \t| 📟   | 📟  \t| 📟    | 📟\r\n| @hphilipps  \t|       \t|       \t|      \t|           | \r\n| @msmiley    \t|        \t|       \t|       \t|           | \r\n\r\nW45 working days: 18\r\n\r\n|             \t| M 11 Nov \t| T 12 Nov \t| W 13 Nov \t| Th 14 Nov  | F 15 Nov \r\n|-------------\t|----------\t|----------\t|----------\t|----------- |----------\r\n| @bjk-gitlab \t|         \t|         \t|    \t    |           |    \r\n| @craig      \t|         \t|        \t|        \t|           |  \r\n| @craigf     \t| 🌴  \t| 🌴  \t| 🌴  \t| 🌴    | 🌴\r\n| @cmiskell   \t| 📟   | \\      \t| \\       \t| \\           | \\ \r\n| @hphilipps  \t|   \t    | 📟   | 📟  \t| 📟    | 📟\r\n| @msmiley    \t|       \t|       \t|       \t|           | \r\n\r\nW46 working days: 20\r\n\r\n\u003chr\u003e\r\n\r\n**Total working days: 38**","state":"closed","created_at":"2019-10-17T15:40:11.302Z","updated_at":"2019-11-19T14:39:12.000Z","due_date":"2019-11-17","start_date":"2019-11-04","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/51"},"assignees":[{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"}],"author":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"type":"ISSUE","assignee":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8335","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8335","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8335/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8335/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8335","relative":"#8335","full":"gitlab-com/gl-infra/reliability#8335"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26542980,"iid":8330,"project_id":1304532,"title":"Add AWS GovCloud Account to Okta","description":"This issue is primarily a placeholder, so we have something to track effort towards https://gitlab.com/gitlab-com/gl-security/zero-trust/okta/issues/112 in our milestone planning on the infrastructure issue board. All notes/updates/follow-up should be logged on that issue, directly.","state":"closed","created_at":"2019-10-31T23:45:57.991Z","updated_at":"2022-08-04T20:02:20.930Z","closed_at":"2022-08-02T06:03:53.132Z","closed_by":{"id":1786152,"username":"gitlab-bot","name":"🤖 GitLab Bot 🤖","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1786152/avatar.png","web_url":"https://gitlab.com/gitlab-bot"},"labels":["workflow-infra::Done"],"milestone":null,"assignees":[],"author":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8330","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8330","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8330/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8330/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8330","relative":"#8330","full":"gitlab-com/gl-infra/reliability#8330"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26542132,"iid":8329,"project_id":1304532,"title":"Thanos compact disk filling up","description":"The `/opt/prometheus` disk on `thanos-compact-01-inf-gprd.c.gitlab-production.internal` is almost full.\n\nThis is similar to this issue: https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/6776\n\nThe alert was cleared by following the runbook here: https://gitlab.com/gitlab-com/runbooks/blob/master/troubleshooting/thanos-compact.md\n\nThe following commands were executed:\n\n```\ndf -h\nsudo systemctl stop thanos-compact\nsudo systemctl start thanos-compact\ndf -h\n```\n\n/cc @bjk-gitlab","state":"closed","created_at":"2019-10-31T22:25:09.299Z","updated_at":"2022-08-04T20:02:21.604Z","closed_at":"2019-10-31T22:32:03.342Z","closed_by":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"labels":["workflow-infra::Done"],"milestone":null,"assignees":[{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"}],"author":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"type":"ISSUE","assignee":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8329","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8329","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8329/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8329/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8329","relative":"#8329","full":"gitlab-com/gl-infra/reliability#8329"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26534975,"iid":8327,"project_id":1304532,"title":"Validate scraping of Praefect on gstg","description":"Staging has Praefect enabled, though I couldn't find the metrics in Prometheus. One metric I looked for specifically is `gitaly_praefect_replication_latency`. That one is always created, regardless if it has input. Given it was missing I think we're not scraping the target, or we're not exposing metrics on the target.\n\n/cc @alejandro","state":"closed","created_at":"2019-10-31T17:51:23.314Z","updated_at":"2022-08-04T20:02:22.879Z","closed_at":"2019-11-05T06:54:06.029Z","closed_by":{"id":4849,"username":"balasankarc","name":"Balasankar 'Balu' C","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4849/avatar.png","web_url":"https://gitlab.com/balasankarc"},"labels":["workflow-infra::Done"],"milestone":null,"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":101578,"username":"zj-gitlab","name":"Zeger-Jan van de Weg","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/101578/avatar.png","web_url":"https://gitlab.com/zj-gitlab"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":2,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8327","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8327","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8327/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8327/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8327","relative":"#8327","full":"gitlab-com/gl-infra/reliability#8327"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26511361,"iid":8319,"project_id":1304532,"title":"Intermittent HTTP failures to Ingress controllers","description":"We have been seeing intermittent HTTP failures when trying to connect to ingress controllers.  \n\nThe first instance was the `design.gitlab.com` site in this issue: https://gitlab.com/gitlab-org/gitlab-services/design.gitlab.com/issues/432\n\nThat was resolved by upgrading the K8s cluster and provisioning a new ingress, then re-deploying the app to it.  We tried provisioning a new ingress alone, and it didn't resolve it.\n\nThe second instance is some suspicious failures on the `version.gitlab.com` app.  We got a Pingdom check failure, and `httping` is returning some intermittent timeouts.\n\nThese may not be related, but this issue can be a place to capture information and explore the possibility.\n\n```\n$  httping -c 15 -t 2 http://version.gitlab.com\nPING version.gitlab.com:80 (/):\nconnected to 104.196.17.203:80 (208 bytes), seq=0 time=294.46 ms\nconnected to 104.196.17.203:80 (208 bytes), seq=1 time=293.93 ms\nconnected to 104.196.17.203:80 (208 bytes), seq=2 time=292.10 ms\nconnected to 104.196.17.203:80 (208 bytes), seq=3 time=296.31 ms\nconnected to 104.196.17.203:80 (208 bytes), seq=4 time=293.10 ms\nconnected to 104.196.17.203:80 (208 bytes), seq=5 time=294.27 ms\ntimeout while receiving reply-headers from host\ntimeout while receiving reply-headers from host\nconnected to 104.196.17.203:80 (208 bytes), seq=8 time=293.68 ms\nconnected to 104.196.17.203:80 (208 bytes), seq=9 time=294.75 ms\nconnected to 104.196.17.203:80 (208 bytes), seq=10 time=293.74 ms\nconnected to 104.196.17.203:80 (208 bytes), seq=11 time=295.00 ms\nconnected to 104.196.17.203:80 (208 bytes), seq=12 time=361.12 ms\nconnected to 104.196.17.203:80 (208 bytes), seq=13 time=301.54 ms\n--- http://version.gitlab.com/ ping statistics ---\n15 connects, 12 ok, 13.33% failed, time 22342ms\nround-trip min/avg/max = 292.1/300.3/361.1 ms\n```","state":"closed","created_at":"2019-10-31T07:46:49.701Z","updated_at":"2022-08-04T20:02:30.218Z","closed_at":"2020-02-24T14:11:15.494Z","closed_by":{"id":30915,"username":"plafoucriere","name":"Philippe Lafoucrière","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/30915/avatar.png","web_url":"https://gitlab.com/plafoucriere"},"labels":["workflow-infra::Done"],"milestone":null,"assignees":[{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"}],"author":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"type":"ISSUE","assignee":{"id":2336046,"username":"devin","name":"Devin Sylva","state":"active","avatar_url":"https://secure.gravatar.com/avatar/424b025122218e9a586245e301c1c725?s=80\u0026d=identicon","web_url":"https://gitlab.com/devin"},"user_notes_count":66,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8319","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8319","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8319/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8319/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8319","relative":"#8319","full":"gitlab-com/gl-infra/reliability#8319"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26503320,"iid":8318,"project_id":1304532,"title":"Documentation for new Chef Infra Server","description":"Broken out from #8037; the infrastructure has been provisioned, and in conjunction with / once #8028 is completed, we need to document the changes to the infrastructure, and conduct a [readiness review](https://gitlab.com/gitlab-com/gl-infra/readiness/-/issues/11) before proceeding with a production change for the migration. This issue should include discussion centered around documentation and lead into the production readiness review.","state":"closed","created_at":"2019-10-30T22:11:37.637Z","updated_at":"2020-11-17T20:53:24.960Z","closed_at":"2020-11-17T20:52:36.822Z","closed_by":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"labels":["chef","documentation","workflow-infra::Done"],"milestone":{"id":1690629,"iid":110,"group_id":1112072,"title":"Core-Infra Chef server in GCP Wrap up","description":"Milestone to make sure we establish \"done\" for the move of the Chef server to GCP.  ","state":"closed","created_at":"2020-10-23T18:34:47.801Z","updated_at":"2021-01-11T18:40:34.413Z","due_date":"2020-12-31","start_date":"2020-11-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/110"},"assignees":[{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"}],"author":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"type":"ISSUE","assignee":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"user_notes_count":2,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8318","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8318","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8318/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8318/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8318","relative":"#8318","full":"gitlab-com/gl-infra/reliability#8318"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":138,"epic":{"id":16102,"iid":138,"title":"Migrate Chef from DO to GCP","url":"/groups/gitlab-com/gl-infra/-/epics/138","group_id":1112072,"human_readable_end_date":"Oct 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":26503275,"iid":8317,"project_id":1304532,"title":"Implement/update monitoring for Chef server in GCP","description":"Broken out from #8037; the infrastructure has been provisioned, and in conjunction with / once #8028 is completed, we need to implement [monitoring](https://docs.chef.io/server_monitor.html) for the Chef Infra Server application.\n\nDefinition of done:\n* up check on port 443\n* hook up the node exporter\n* make a basic jsonnet def in the dashboards","state":"closed","created_at":"2019-10-30T22:08:26.263Z","updated_at":"2022-08-04T20:02:31.432Z","closed_at":"2021-01-07T19:31:01.596Z","closed_by":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"labels":["Observability-reliability","chef","workflow-infra::Done"],"milestone":{"id":1690629,"iid":110,"group_id":1112072,"title":"Core-Infra Chef server in GCP Wrap up","description":"Milestone to make sure we establish \"done\" for the move of the Chef server to GCP.  ","state":"closed","created_at":"2020-10-23T18:34:47.801Z","updated_at":"2021-01-11T18:40:34.413Z","due_date":"2020-12-31","start_date":"2020-11-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/110"},"assignees":[{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"}],"author":{"id":693144,"username":"craig","name":"Craig Barrett","state":"active","avatar_url":"https://secure.gravatar.com/avatar/c8dfa1ca41754b9409068e5e42080cd2?s=80\u0026d=identicon","web_url":"https://gitlab.com/craig"},"type":"ISSUE","assignee":{"id":194566,"username":"cmcfarland","name":"Cameron McFarland","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0fea59864aa5c034e15089251bf9fa8f?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmcfarland"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8317","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8317","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8317/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8317/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8317","relative":"#8317","full":"gitlab-com/gl-infra/reliability#8317"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":138,"epic":{"id":16102,"iid":138,"title":"Migrate Chef from DO to GCP","url":"/groups/gitlab-com/gl-infra/-/epics/138","group_id":1112072,"human_readable_end_date":"Oct 31, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":26482037,"iid":8311,"project_id":1304532,"title":"Update cookbook-gitlab-runner to use new Docker packages","description":"[cookbook-gitlab-runner](https://gitlab.com/gitlab-org/cookbook-gitlab-runner) is still using the obsolete `docker-engine` package repo. This should be updated to use the new [docker-ce package](https://docs.docker.com/install/linux/docker-ce/ubuntu/) repo.\n\nCC: @jarv @tmaczukin","state":"closed","created_at":"2019-10-30T12:07:06.187Z","updated_at":"2021-06-24T08:10:05.324Z","closed_at":"2019-12-18T15:16:11.517Z","closed_by":{"id":215818,"username":"tmaczukin","name":"Tomasz Maczukin","state":"active","avatar_url":"https://secure.gravatar.com/avatar/0a9a99b9665ab7eda2cd7bffd54b1836?s=80\u0026d=identicon","web_url":"https://gitlab.com/tmaczukin"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"}],"author":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"type":"ISSUE","assignee":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"user_notes_count":1,"merge_requests_count":2,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8311","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8311","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8311/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8311/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8311","relative":"#8311","full":"gitlab-com/gl-infra/reliability#8311"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26390744,"iid":8286,"project_id":1304532,"title":"Quality tests failing due to praefect in staging","description":"See https://gitlab.slack.com/archives/C3ER3TQBT/p1572293689252600\n\nWe're seeing 500 errors on staging.gitlab.com with\n\n```\nGRPC::InvalidArgument\n3:only messages for praefect are allowed\n```","state":"closed","created_at":"2019-10-28T20:43:31.065Z","updated_at":"2022-08-04T20:03:00.994Z","closed_at":"2019-10-28T20:53:14.619Z","closed_by":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"labels":["oncall","workflow-infra::Done"],"milestone":null,"assignees":[{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"}],"author":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"type":"ISSUE","assignee":{"id":367626,"username":"alejandro","name":"Alejandro Rodríguez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/367626/avatar.png","web_url":"https://gitlab.com/alejandro"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8286","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8286","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8286/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8286/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8286","relative":"#8286","full":"gitlab-com/gl-infra/reliability#8286"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26338837,"iid":8273,"project_id":1304532,"title":"Add runbook for design.gitlab.com","description":"design.gitlab.com seems down. I can't find a runbook or other instructions for how to diagnose or repair it.\nSee https://gitlab.com/gitlab-com/gl-infra/production/issues/1279\n\n/cc @devin","state":"closed","created_at":"2019-10-26T15:20:41.119Z","updated_at":"2022-08-04T20:03:34.383Z","closed_at":"2022-03-03T04:11:56.220Z","closed_by":{"id":136229,"username":"cindy","name":"Cindy Pallares 🦉","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/136229/avatar.png","web_url":"https://gitlab.com/cindy"},"labels":["Service::Design","auto updated","corrective action","priority::3","severity::3","workflow-infra::Done"],"milestone":{"id":2332331,"iid":160,"group_id":1112072,"title":"Squad 6 Q1","description":"","state":"closed","created_at":"2021-11-15T22:58:26.651Z","updated_at":"2022-10-26T08:40:41.654Z","due_date":"2022-04-30","start_date":"2022-02-01","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/160"},"assignees":[],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":null,"user_notes_count":6,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8273","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8273","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8273/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8273/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8273","relative":"#8273","full":"gitlab-com/gl-infra/reliability#8273"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26338071,"iid":8272,"project_id":1304532,"title":"blackbox-exporter not closing connections","description":"blackbox-exporter isn't closing connections to targets that don't respond. That is leading to exhaustion of file descriptors after 6h with the current limit of 1024 FDs. Also, blackbox_exporter doesn't seem to alert for those targets. See incident https://gitlab.com/gitlab-com/gl-infra/production/issues/1279.","state":"closed","created_at":"2019-10-26T14:13:19.353Z","updated_at":"2019-12-06T21:42:17.390Z","closed_at":"2019-10-31T10:39:06.655Z","closed_by":{"id":928230,"username":"bjk-gitlab","name":"Ben Kochie","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/928230/avatar.png","web_url":"https://gitlab.com/bjk-gitlab"},"labels":["Observability","team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8272","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8272","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8272/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8272/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8272","relative":"#8272","full":"gitlab-com/gl-infra/reliability#8272"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26329956,"iid":8270,"project_id":1304532,"title":"Cloudflare: Accept and forward original Client IP","description":"With the current configuration, IPs from Cloudflare (https://www.cloudflare.com/ips/) are being reported by the application as the IP for the session and in the logs.","state":"closed","created_at":"2019-10-25T21:20:22.416Z","updated_at":"2019-12-06T21:47:32.970Z","closed_at":"2019-11-14T14:08:17.569Z","closed_by":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"labels":["team::Reliability","workflow-infra::Done"],"milestone":{"id":1060421,"iid":55,"group_id":1112072,"title":"W45 Dev \u0026 Ops","description":"","state":"closed","created_at":"2019-11-05T10:13:26.190Z","updated_at":"2019-12-03T22:08:39.621Z","due_date":"2019-11-17","start_date":"2019-11-04","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/55"},"assignees":[{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"}],"author":{"id":2165775,"username":"asaba","name":"Antony Saba","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2165775/avatar.png","web_url":"https://gitlab.com/asaba"},"type":"ISSUE","assignee":{"id":555989,"username":"T4cC0re","name":"Hendrik Meyer","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/555989/avatar.png","web_url":"https://gitlab.com/T4cC0re"},"user_notes_count":17,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8270","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8270","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8270/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8270/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8270","relative":"#8270","full":"gitlab-com/gl-infra/reliability#8270"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":115,"epic":{"id":15220,"iid":115,"title":"Cloudflare: general dependencies \u0026 infrastructure preparations","url":"/groups/gitlab-com/gl-infra/-/epics/115","group_id":1112072,"human_readable_end_date":"Feb 28, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":26310715,"iid":8268,"project_id":1304532,"title":"Audit kubernetes workloads and ensure all that can be scraped, is scraped","description":"Split from https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8186","state":"closed","created_at":"2019-10-25T10:50:37.814Z","updated_at":"2019-12-06T21:42:17.203Z","closed_at":"2019-10-30T10:05:43.913Z","closed_by":{"id":3911656,"username":"craigf","name":"Craig Furman","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3911656/avatar.png","web_url":"https://gitlab.com/craigf"},"labels":["Observability-reliability","team::Reliability","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3911656,"username":"craigf","name":"Craig Furman","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3911656/avatar.png","web_url":"https://gitlab.com/craigf"}],"author":{"id":3911656,"username":"craigf","name":"Craig Furman","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3911656/avatar.png","web_url":"https://gitlab.com/craigf"},"type":"ISSUE","assignee":{"id":3911656,"username":"craigf","name":"Craig Furman","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3911656/avatar.png","web_url":"https://gitlab.com/craigf"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8268","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8268","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8268/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8268/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8268","relative":"#8268","full":"gitlab-com/gl-infra/reliability#8268"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26283490,"iid":8262,"project_id":1304532,"title":"RCA: 2019-10-24: Elevated CI job queue durations","description":"\u003c!--\n**Please note:** if the incident relates to sensitive data, or is security related consider\nlabeling this issue with ~security and mark it confidential.\n*** \n--\u003e\n\nIncident: gitlab-com/gl-infra/production#1275\n\n## Summary\n\nDue to a project import bug, some jobs had an options attribute with a wrong data type, which lead to failures assigning jobs so they were put back into the queue in an endless loop. The fair usage job scheduling algorithm was preferring them over most other jobs as they were belonging to a short pipeline and so only a few other jobs got the chance to also run on shared runners. This increased the overall queue time and the number of pending jobs was rising.\n\n- Service(s) affected : ~\"Service:CI Runners\" \n- Team attribution : \n- Minutes downtime or degradation : 10:00 UTC - 20:20 UTC = 10h 20m\n\nFor calculating duration of event, use the [Platform Metrics Dashboard](https://dashboards.gitlab.net/d/ZUei7TkWz/platform-metrics?orgId=1) to look at appdex and SLO violations.\n\n## Impact \u0026 Metrics\n\nStart with the following:\n\n- What was the impact of the incident?\n  - many jobs pending for a long time\n- Who was impacted by this incident?\n  - all users running jobs\n- How did the incident impact customers?\n  - customers needed to wait a long time to get their jobs scheduled\n- How many attempts were made to access the impacted service/feature?\n- How many customers were affected?\n- How many customers tried to access the impacted service/feature?\n\nJob duration [for 50th percentile](https://thanos-query.ops.gitlab.net/graph?g0.range_input=12h\u0026g0.expr=histogram_quantile(0.5%2C%20sum(rate(job_queue_duration_seconds_bucket%7Benvironment%3D~%22gprd%22%2C%20jobs_running_for_project%3D~%220%22%7D%5B5m%5D))%20by%20(shared_runner%2C%20jobs_running_for_project%2C%20le))\u0026g0.tab=0):\n\n![image](/uploads/a2ddc504fa56bad09669250c1afa2470/image.png)\n\nJob duration [for 90th percentile](https://thanos-query.ops.gitlab.net/graph?g0.range_input=12h\u0026g0.expr=histogram_quantile(0.9%2C%20sum(rate(job_queue_duration_seconds_bucket%7Benvironment%3D~%22gprd%22%2C%20jobs_running_for_project%3D~%220%22%7D%5B5m%5D))%20by%20(shared_runner%2C%20jobs_running_for_project%2C%20le))\u0026g0.tab=0):\n\n![image](/uploads/0484cbc10faba0b0b9fe2e07c6b67fe0/image.png)\n\n![image](/uploads/ca7f96dd91a80f981cf45dabcdea96bb/image.png)\n\nProvide any relevant graphs that could help understand the impact of the incident and its dynamics.\n\n## Detection \u0026 Response\n\nStart with the following:\n\n- How was the incident detected?\n  - reports from customer support about users seeing pending jobs\n- Did alarming work as expected?\n  - we got no alerts, as the SLO APDEX for ci runner latency was defined to alert on the 50th percentile but in the first hours only the 70th percentile was severely affected\n- How long did it take from the start of the incident to its detection?\n  - 42m (support [reported](https://gitlab.slack.com/archives/C101F3796/p1571913724286000) customer issues at 10:42)\n- How long did it take from detection to remediation?\n - 10:42 - 20:20 = 9h 38m\n- Were there any issues with the response to the incident? (i.e. bastion host used to access the service was not available, relevant team member wasn't page-able, ...)\n  - It took a long time to identify the root cause and to understand the impact.\n\n## Root Cause Analysis\n\nJobs were getting stuck in pending state.\n\n1. Why? - They only had a low chance of getting assigned to a shared runners.\n2. Why? - The shared runners were mostly occupied with a few jobs with corrupt options being retried indefinitely.\n3. Why? - The `Ci::Build#options` attribute was a string instead of a hash.\n4. Why? - The jobs came from imported projects and the importer has a bug in 12.4.0 (12.3.5 works).\n5. Why? \n\n## What went well\n\n- customer support escalating to infra team\n- dev and infra working together to debug a tricky issue\n\n## What can be improved\n\n- Alerting for pending jobs and rising job queues.\n- Better understanding of job scheduling and the impact of elevated job queue times.\n\nStart with the following:\n\n- Using the root cause analysis, explain what can be improved to prevent this from happening again.\n- Is there anything that could have been done to improve the detection or time to detection?\n- Is there anything that could have been done to improve the response or time to response?\n- Is there an existing issue that would have either prevented this incident or reduced the impact?\n- Did we have any indication or beforehand knowledge that this incident might take place?\n\n## Corrective actions\n\n- List issues that have been created as corrective actions from this incident.\n- For each issue, include the following:\n    - \u003cBare Issue link\u003e - Issue labeled as ~\"corrective action\".\n    - Include an estimated date of completion of the corrective action.\n    - Incldue the named individual who owns the delivery of the corrective action.\n\n* [x] Prevent corrupt job options: https://gitlab.com/gitlab-org/gitlab/merge_requests/19122, https://gitlab.com/gitlab-org/gitlab/merge_requests/19124\n* [x] Prevent jobs from being rescheduled indefinitely: https://gitlab.com/gitlab-org/gitlab/issues/34897\n* [ ] Improve alerting for elevated job queue times\n* [ ] Make it easier to identify which job is picked from which project by which runner: https://gitlab.com/gitlab-org/gitlab/issues/34889\n\n## Guidelines\n\n* [Blameless RCA Guideline](https://about.gitlab.com/handbook/infrastructure/#rca)\n* [5 whys](https://en.wikipedia.org/wiki/5_Whys)","state":"closed","created_at":"2019-10-24T15:35:24.552Z","updated_at":"2022-08-04T20:03:51.078Z","closed_at":"2019-12-09T21:10:15.543Z","closed_by":{"id":528408,"username":"asandov","name":"AnthonySandoval","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/528408/avatar.png","web_url":"https://gitlab.com/asandov"},"labels":["IncidentReview","severity::2","wg-isolation","workflow-infra::Done"],"milestone":null,"assignees":[{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"}],"author":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"type":"ISSUE","assignee":{"id":3059703,"username":"hphilipps","name":"Henri Philipps","state":"blocked","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3059703/avatar.png","web_url":"https://gitlab.com/hphilipps"},"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8262","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":4,"completed_count":2},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8262","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8262/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8262/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8262","relative":"#8262","full":"gitlab-com/gl-infra/reliability#8262"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26256776,"iid":8255,"project_id":1304532,"title":"Mirror or Move infra-vault to ops","description":"Pending the outcome of https://gitlab.com/gitlab-com/gl-infra/infrastructure/-/issues/10126 we will need to either mirror https://gitlab.com/gitlab-com/gl-infra/infra-vault/ to ops.gitlab.net or move it there entirely (and mirror it back to gitlab.com)","state":"closed","created_at":"2019-10-24T03:17:02.383Z","updated_at":"2022-08-04T20:03:57.502Z","closed_at":"2020-06-19T03:11:45.431Z","closed_by":{"id":4337537,"username":"ggillies","name":"Graeme Gillies","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4337537/avatar.png","web_url":"https://gitlab.com/ggillies"},"labels":["workflow-infra::Done"],"milestone":{"id":1301310,"iid":83,"group_id":1112072,"title":"Core Infra Team - June 2020","description":"Core themes:\r\n1. [Roll out Okta ASA / improved Console Access](https://gitlab.com/groups/gitlab-com/gl-infra/-/epics/122)\r\n2. [Increment on secrets management with Vault](https://gitlab.com/groups/gitlab-com/gl-infra/-/epics/62)","state":"closed","created_at":"2020-05-27T23:10:12.172Z","updated_at":"2020-07-07T23:38:37.667Z","due_date":"2020-06-26","start_date":"2020-05-29","expired":true,"web_url":"https://gitlab.com/groups/gitlab-com/gl-infra/-/milestones/83"},"assignees":[{"id":4337537,"username":"ggillies","name":"Graeme Gillies","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4337537/avatar.png","web_url":"https://gitlab.com/ggillies"}],"author":{"id":3623028,"username":"cmiskell","name":"Craig Miskell","state":"active","avatar_url":"https://secure.gravatar.com/avatar/852a93b505b1f4a5549595792035f445?s=80\u0026d=identicon","web_url":"https://gitlab.com/cmiskell"},"type":"ISSUE","assignee":{"id":4337537,"username":"ggillies","name":"Graeme Gillies","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4337537/avatar.png","web_url":"https://gitlab.com/ggillies"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-com/gl-infra/reliability/-/issues/8255","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/1304532/issues/8255","notes":"https://gitlab.com/api/v4/projects/1304532/issues/8255/notes","award_emoji":"https://gitlab.com/api/v4/projects/1304532/issues/8255/award_emoji","project":"https://gitlab.com/api/v4/projects/1304532","closed_as_duplicate_of":null},"references":{"short":"#8255","relative":"#8255","full":"gitlab-com/gl-infra/reliability#8255"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":62,"epic":{"id":7471,"iid":62,"title":"Deploy Vault to provide a solution for secrets management and use","url":"/groups/gitlab-com/gl-infra/-/epics/62","group_id":1112072},"iteration":null,"health_status":null}]