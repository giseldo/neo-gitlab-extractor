[{"id":118056437,"iid":810,"project_id":734943,"title":"Follow-up from \"Add auth-cookie-session-timeout flag\" - In Auth constructor use options struct","description":"The following discussion from !834 should be addressed:\n\n- [ ] @proglottis started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/834#note_1156512951): \n\n    \u003e nit, not directly related to your change, but this constructor has enough arguments now that it's probably worth extracting an options struct.","state":"closed","created_at":"2022-11-03T07:20:58.432Z","updated_at":"2023-01-19T06:14:13.300Z","closed_at":"2023-01-19T06:12:52.732Z","closed_by":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/12750949/avatar.png","web_url":"https://gitlab.com/ngala"},"labels":["Category:Pages","Stretch","backend","devops::create","group::editor","maintenance::refactor","section::dev","type::maintenance"],"milestone":{"id":2745650,"iid":84,"group_id":9970,"title":"15.9","description":"","state":"active","created_at":"2022-08-22T16:58:02.303Z","updated_at":"2022-08-22T16:58:02.303Z","due_date":"2023-02-17","start_date":"2023-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/84"},"assignees":[{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/12750949/avatar.png","web_url":"https://gitlab.com/ngala"}],"author":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/12750949/avatar.png","web_url":"https://gitlab.com/ngala"},"type":"ISSUE","assignee":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/12750949/avatar.png","web_url":"https://gitlab.com/ngala"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/810","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/810","notes":"https://gitlab.com/api/v4/projects/734943/issues/810/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/810/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#810","relative":"#810","full":"gitlab-org/gitlab-pages#810"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":117942630,"iid":809,"project_id":734943,"title":"`cache_pages_domain_api` feature flag cause failures in staging","description":"### Summary\n\nDuring the rollout of `cache_pages_domain_api` feature flag, the gitlab pages qa tests on staging started to fail.\n\nAfter some investigation with `@vshushlin`, we found out that the application settings are different between rails nodes (where the cache is created) and sidekiq nodes (where the cache is invalidated). Since we us a hash for the application settings in the cache key, the sidekiq job never finds the cache key to invalide it.\n\nRelated:\n- https://gitlab.com/gitlab-org/gitlab/-/issues/376332+\n- https://gitlab.com/gitlab-org/gitlab/-/issues/364127+\n\n### Possible fixes\n\n```json:table\n{\n    \"items\" : [\n{\n\"option\": \"üÖ∞Ô∏è\",\n\"description\": \"Instead of using the application settings hash in the cache key we could insert the hash in the cached value and validate it when reading the cache. This way the app settings is not part of the cache key, so it should get invalidated in the sidekiq nodes.\",\n\"cons\": \"validating the cache manually based on the cached value.\"\n},\n{\n\"option\": \"üÖ±Ô∏è\",\n\"description\": \"Instead of using the application settings hash in the cache key we could have a two layers cache. The main cache key would save the app settings hash, which would be the key to the payload itself.\",\n\"cons\": \"two reads on redis to find the cached value.\"\n}\n]\n}\n```","state":"closed","created_at":"2022-11-01T13:43:17.770Z","updated_at":"2022-12-01T09:53:47.624Z","closed_at":"2022-12-01T09:53:47.601Z","closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"labels":["Category:Pages","bug::functional","devops::create","group::editor","section::dev","type::bug","workflow::in review"],"milestone":null,"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"}],"author":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/809","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/809","notes":"https://gitlab.com/api/v4/projects/734943/issues/809/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/809/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#809","relative":"#809","full":"gitlab-org/gitlab-pages#809"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7920,"epic":{"id":503228,"iid":7920,"title":"Pages Internal API Caching","url":"/groups/gitlab-org/-/epics/7920","group_id":9970,"human_readable_end_date":"May 17, 2023","human_readable_timestamp":"\u003cstrong\u003e11\u003c/strong\u003e days remaining"},"iteration":null,"health_status":null},{"id":117645763,"iid":808,"project_id":734943,"title":"Support HSTS on GitLab Pages on per domain basis (also on gitlab.com)","description":"## Problem to Solve\n\nSome users want to enforce no access to their web content without HTTPS/certificates. \n\nThis can be done with [HTTP Strict Transport Security (HSTS) policy](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security), but we do not currently support enabling this for GitLab Pages sites on GitLab.com.\n\n## Solution \n\nAllow users to enable HSTS for Pages on GitLab.com.","state":"closed","created_at":"2022-10-26T19:52:12.963Z","updated_at":"2022-10-31T01:37:39.641Z","closed_at":"2022-10-31T01:37:39.614Z","closed_by":{"id":1646689,"username":"oregand","name":"David O'Regan","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1646689/avatar.png","web_url":"https://gitlab.com/oregand"},"labels":["Category:Pages","GitLab Free","backend","devops::create","feature::enhancement","frontend","group::editor","section::dev","type::feature","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[],"author":{"id":1646689,"username":"oregand","name":"David O'Regan","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1646689/avatar.png","web_url":"https://gitlab.com/oregand"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":0,"upvotes":3,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/808","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/808","notes":"https://gitlab.com/api/v4/projects/734943/issues/808/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/808/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#808","relative":"#808","full":"gitlab-org/gitlab-pages#808"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":115192449,"iid":806,"project_id":734943,"title":"Session timeout after 10 minutes","description":"### Summary\n\nWe use gitlab-pages for several internal website hostings and our users experience annoying session timeouts due to the short lifetime of the gitlab-pages cookie of 10 minutes. As an example, a single page web app can't load further assets (e.g. images) after the session timeout and a (hard) refresh in the browser is necessary.\n\nThe `authSessionMaxAge` constant is hardcoded in [`internal/auth/auth.go`](https://gitlab.com/gitlab-org/gitlab-pages/-/blob/14e310074668254398d13f74e647dd16df2cb12c/internal/auth/auth.go#L40):\n\n```go\nauthSessionMaxAge      = 60 * 10 // 10 minutes\n```\n\nIt seems that this was introduced with https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/178.\n\nSo we have a few questions:\n- Why was the timeout set to exactly 10 minutes? Is there a reason for this (e.g. a standard)?\n- If there is no specific reason, would it be possible to increase this value?\n- Or would it be possible to make this value configurable?\n\n\nWDYT?\n\nIf desired, we would be happy to support you as ~\"Leading Organization\"  with a ~\"Community contribution\".\n\n### Example Project\n\n\u003c!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. --\u003e\n\n### What is the current *bug* behavior?\n\nThere's a session timeout after 10 minutes.\n\n### What is the expected *correct* behavior?\n\nThe duration to a session timeout is higher or can be configured.\n\n### Goal\n\nMake the timeout configurable:\n\n1. [x] Add a new flag to Pages e.g. `auth-cookie-session-timeout` with default value of `10m` :arrow_right: https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/834\n1. [x] Add the flag to Omnibus, see [sample MR](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/6144/diffs) :arrow_right: https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/6495\n1. [x] Add the flag to the Helm charts, see [sample MR](https://gitlab.com/gitlab-org/charts/gitlab/-/merge_requests/2338/diffs) :arrow_right: https://gitlab.com/gitlab-org/charts/gitlab/-/merge_requests/2838\n1. [x] Update the admin documentation, see [sample MR](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/89780/diffs) :arrow_right: https://gitlab.com/gitlab-org/gitlab/-/merge_requests/102996","state":"closed","created_at":"2022-09-16T09:14:32.428Z","updated_at":"2022-11-16T04:46:17.763Z","closed_at":"2022-11-16T04:46:17.736Z","closed_by":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/12750949/avatar.png","web_url":"https://gitlab.com/ngala"},"labels":["devops::create","feature::addition","group::editor","section::dev","type::feature","workflow::in dev"],"milestone":{"id":2687593,"iid":81,"group_id":9970,"title":"15.6","description":"","state":"active","created_at":"2022-07-06T19:22:27.893Z","updated_at":"2022-07-06T19:22:27.893Z","due_date":"2022-11-17","start_date":"2022-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/81"},"assignees":[{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/12750949/avatar.png","web_url":"https://gitlab.com/ngala"}],"author":{"id":2742410,"username":"wwwjon","name":"Jonas W√§lter","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2742410/avatar.png","web_url":"https://gitlab.com/wwwjon"},"type":"ISSUE","assignee":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/12750949/avatar.png","web_url":"https://gitlab.com/ngala"},"user_notes_count":15,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/806","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":4,"completed_count":4},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/806","notes":"https://gitlab.com/api/v4/projects/734943/issues/806/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/806/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#806","relative":"#806","full":"gitlab-org/gitlab-pages#806"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":115128713,"iid":805,"project_id":734943,"title":"GCS ranged requests sometimes fails with 400","description":"\u003c!---\n\nPlease read this!\n\n**NOTE**: Please check https://gitlab.com/gitlab-org/gitlab/-/issues/331699 if you had issues upgrading to 14.0+\n\nBefore opening a new issue, make sure to search for keywords in the issues (including closed ones)\n- https://gitlab.com/gitlab-org/gitlab-pages/issues\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n\n### Summary\n\nIn GitLab.com, we recently ran into an [incident](https://gitlab.com/gitlab-com/gl-infra/production/-/issues/7727) where a small number of Pages hosts failed with 500 errors. Digging into it we found that this resulted from internal error where ranged requests to GCS were failing with \"400 Bad Request\".\n\nThis behavior seems recent (started Sepetmeber 8th), judging by graphs from GCS:\n![image](/uploads/795e5836674f380e1ada61233dd81ff8/image.png).\n\nKibana logs doesn't provide much info beside the error itself, so perhaps we may need to consider logging the response body of 400 responses.\n\n\u003c!-- DO NOT CHANGE --\u003e","state":"closed","created_at":"2022-09-15T12:07:38.985Z","updated_at":"2022-09-29T10:42:07.773Z","closed_at":"2022-09-23T15:29:07.212Z","closed_by":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"labels":["Category:Pages","bug::availability","devops::create","golang","group::editor","infradev","priority::3","section::dev","severity::4","type::bug"],"milestone":{"id":2453027,"iid":77,"group_id":9970,"title":"15.5","description":"","state":"active","created_at":"2022-02-03T22:29:56.909Z","updated_at":"2022-02-03T22:29:56.909Z","due_date":"2022-10-17","start_date":"2022-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/77"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"}],"author":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/805","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/805","notes":"https://gitlab.com/api/v4/projects/734943/issues/805/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/805/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#805","relative":"#805","full":"gitlab-org/gitlab-pages#805"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":111236649,"iid":792,"project_id":734943,"title":"Update documentation to state _redirects limits are now configurable","description":"Based on the work in https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/778+, we want to update the ~documentation guides to let users know that the Pages ` _redirects limits` are now configurable.","state":"closed","created_at":"2022-07-06T08:16:37.411Z","updated_at":"2022-07-11T09:07:48.242Z","closed_at":"2022-07-11T09:07:48.222Z","closed_by":{"id":1646689,"username":"oregand","name":"David O'Regan","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1646689/avatar.png","web_url":"https://gitlab.com/oregand"},"labels":["Category:Pages","Technical Writing","backend","devops::create","documentation","frontend","group::editor","section::dev","type::feature","workflow::ready for development"],"milestone":{"id":2453024,"iid":74,"group_id":9970,"title":"15.2","description":"","state":"active","created_at":"2022-02-03T22:24:46.818Z","updated_at":"2022-02-03T22:26:32.010Z","due_date":"2022-07-17","start_date":"2022-06-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/74"},"assignees":[],"author":{"id":1646689,"username":"oregand","name":"David O'Regan","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1646689/avatar.png","web_url":"https://gitlab.com/oregand"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/792","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/792","notes":"https://gitlab.com/api/v4/projects/734943/issues/792/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/792/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#792","relative":"#792","full":"gitlab-org/gitlab-pages#792"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":110795348,"iid":787,"project_id":734943,"title":"Flaky TestDomainResolverError race","description":"I've seen an increase in race test failures for `TestDomainResolverError` recently, I think it's worth investigating a bit more.\n\nJob [#2647463990](https://gitlab.com/gitlab-org/gitlab-pages/-/jobs/2647463990) failed for be06885fdd167a523dd8e1e103bcbb23bb32db61:","state":"closed","created_at":"2022-06-28T00:12:00.958Z","updated_at":"2022-06-30T07:18:38.638Z","closed_at":"2022-06-30T07:18:38.608Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","devops::create","failure::flaky-test","golang","group::editor","section::dev","type::bug","workflow::in review"],"milestone":{"id":2453024,"iid":74,"group_id":9970,"title":"15.2","description":"","state":"active","created_at":"2022-02-03T22:24:46.818Z","updated_at":"2022-02-03T22:26:32.010Z","due_date":"2022-07-17","start_date":"2022-06-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/74"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"user_notes_count":4,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/787","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/787","notes":"https://gitlab.com/api/v4/projects/734943/issues/787/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/787/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#787","relative":"#787","full":"gitlab-org/gitlab-pages#787"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":110261083,"iid":781,"project_id":734943,"title":"Move Gitlab Pages documentation menu in the sidebar one level up","description":"### Summary\n\nGitlab Pages contribution documentation was recently moved to the docs site. I think it deserves to be a bit more discoverable/easier to access. For that, I propose to move it to its own *contributing* submenu.\n| before | after |\n|--------|-------|\n| \u003cimg alt=\"SCR-20220616-l99\" src=\"https://gitlab.com/gitlab-org/gitlab-docs/uploads/76a348a3f1c32c69d18dfb674aa7780d/SCR-20220616-l99.png\" width=\"300\"/\u003e | \u003cimg alt=\"image\" src=\"https://gitlab.com/gitlab-org/gitlab-docs/uploads/0abb0e10552412569fa43e60ffc03de1/image.png\" width=\"300\"/\u003e |","state":"closed","created_at":"2022-06-16T20:24:21.528Z","updated_at":"2022-06-21T14:56:43.569Z","closed_at":"2022-06-21T14:56:43.551Z","closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"labels":["Category:Pages","Technical Writing","devops::create","group::editor","type::maintenance","workflow::production"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/73"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"}],"author":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/781","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/781","notes":"https://gitlab.com/api/v4/projects/734943/issues/781/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/781/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#781","relative":"#781","full":"gitlab-org/gitlab-pages#781"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7829,"epic":{"id":488235,"iid":7829,"title":"üìñ Pages documentation cleanup","url":"/groups/gitlab-org/-/epics/7829","group_id":9970,"human_readable_end_date":"May 17, 2023","human_readable_timestamp":"\u003cstrong\u003e11\u003c/strong\u003e days remaining"},"iteration":null,"health_status":null},{"id":109935782,"iid":774,"project_id":734943,"title":"Remove doc/development in favor of https://gitlab.com/gitlab-org/gitlab/-/blob/master/doc/development/pages/index.md","description":"\u003c!---\n\nPlease read this!\n\n**NOTE**: Please check https://gitlab.com/gitlab-org/gitlab/-/issues/331699 if you had issues upgrading to 14.0+\n\nBefore opening a new issue, make sure to search for keywords in the issues (including closed ones)\n- https://gitlab.com/gitlab-org/gitlab-pages/issues\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n\n### Summary\n\n### Steps to reproduce\n\n\u003c!-- Describe how one can reproduce the issue - this is very important. Please use an ordered list. --\u003e\n\n### Example Project\n\n\u003c!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. --\u003e\n\n### What is the current *bug* behavior?\n\n\u003c!-- Describe what actually happens. --\u003e\n\n### What is the expected *correct* behavior?\n\n\u003c!-- Describe what you should see instead. --\u003e\n\n### Relevant logs and/or screenshots\n\n\u003c!-- Paste any relevant logs - please use code blocks (```) to format console output, logs, and code\n as it's tough to read otherwise. --\u003e\n\n### Output of checks\n\n\u003c!-- If you are reporting a bug on GitLab.com, write: This bug happens on GitLab.com --\u003e\n\n### Possible fixes\n\n\u003c!-- If you can, link to the line of code that might be responsible for the problem. --\u003e\n\n\u003c!-- DO NOT CHANGE --\u003e","state":"closed","created_at":"2022-06-10T18:09:27.774Z","updated_at":"2022-06-17T09:23:45.068Z","closed_at":"2022-06-17T09:23:45.048Z","closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"labels":["Category:Pages","Technical Writing","devops::create","golang","group::editor","section::dev","type::maintenance","workflow::in review"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/73"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"}],"author":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/774","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/774","notes":"https://gitlab.com/api/v4/projects/734943/issues/774/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/774/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#774","relative":"#774","full":"gitlab-org/gitlab-pages#774"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7829,"epic":{"id":488235,"iid":7829,"title":"üìñ Pages documentation cleanup","url":"/groups/gitlab-org/-/epics/7829","group_id":9970,"human_readable_end_date":"May 17, 2023","human_readable_timestamp":"\u003cstrong\u003e11\u003c/strong\u003e days remaining"},"iteration":null,"health_status":null},{"id":108886739,"iid":763,"project_id":734943,"title":"[SPIKE] create a gitlab-pages router","description":"### Goal\n\nTry to improve how routes are handled in gitlab-pages. \n\n### Expected Outcome\n\nAn example of how to organize gitlab-pages routes and a plan of action in how to do that in small steps.","state":"closed","created_at":"2022-05-20T17:11:50.237Z","updated_at":"2022-06-16T09:37:13.167Z","closed_at":"2022-06-16T09:37:13.147Z","closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"labels":["Category:Pages","backend","devops::create","golang","group::editor","maintenance::refactor","section::dev","type::maintenance","workflow::verification"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/73"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"}],"author":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/763","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/763","notes":"https://gitlab.com/api/v4/projects/734943/issues/763/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/763/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#763","relative":"#763","full":"gitlab-org/gitlab-pages#763"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":8116,"epic":{"id":527286,"iid":8116,"title":"Gitlab Pages routes refactoring","url":"/groups/gitlab-org/-/epics/8116","group_id":9970,"human_readable_end_date":"Jul 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":108336188,"iid":758,"project_id":734943,"title":"Investigate and configure bundle on CI to disallow any changes to Gemfile.lock","description":"This is a ~\"corrective action\" of sirt-2266.\n\nDetermine whether this project (https://gitlab.com/gitlab-org/gitlab-pages) uses `bundle` or `bundle install` in CI. Per the Rubygems.org advisory, we should use either the `frozen` or `deployment` options as defense-in-depth to mitigate supply chain attacks. This project needs to use the `frozen` or `deployment` options if not yet.\n\n## More background\n\nSee https://github.com/rubygems/rubygems.org/security/advisories/GHSA-hccv-rwq6-vh79:\n\n\u003e Using Bundler in --frozen or --deployment mode in CI and during deploys, as the Bundler team has always recommended, will guarantee that your application does not silently switch to versions created using this exploit.\n\nNote that the `deployment` option installs gems to `vendor`, which we may not want. So `frozen` will usually be the smaller change.\n\nNote that:\n\n\u003e \\[DEPRECATED\\] The `--frozen` flag is deprecated because it relies on being remembered across bundler invocations, which bundler will no longer do in future versions. Instead please use `bundle config set --local frozen 'true'`, and stop using this flag","state":"closed","created_at":"2022-05-10T23:08:57.856Z","updated_at":"2022-05-23T02:58:01.177Z","closed_at":"2022-05-19T21:46:58.345Z","closed_by":{"id":5407295,"username":"a_mcdonald","name":"Anastasia McDonald","state":"active","avatar_url":"https://secure.gravatar.com/avatar/1bb6df5df2f37b7a058f0f1d6d2b64d3?s=80\u0026d=identicon","web_url":"https://gitlab.com/a_mcdonald"},"labels":["Category:Pages","Quality","corrective action","devops::create","feature::enhancement","group::editor","section::dev","security","severity::2","type::feature"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/73"},"assignees":[{"id":5407295,"username":"a_mcdonald","name":"Anastasia McDonald","state":"active","avatar_url":"https://secure.gravatar.com/avatar/1bb6df5df2f37b7a058f0f1d6d2b64d3?s=80\u0026d=identicon","web_url":"https://gitlab.com/a_mcdonald"}],"author":{"id":3753003,"username":"cdu1","name":"Chun Du","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3753003/avatar.png","web_url":"https://gitlab.com/cdu1"},"type":"ISSUE","assignee":{"id":5407295,"username":"a_mcdonald","name":"Anastasia McDonald","state":"active","avatar_url":"https://secure.gravatar.com/avatar/1bb6df5df2f37b7a058f0f1d6d2b64d3?s=80\u0026d=identicon","web_url":"https://gitlab.com/a_mcdonald"},"user_notes_count":7,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/758","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/758","notes":"https://gitlab.com/api/v4/projects/734943/issues/758/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/758/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#758","relative":"#758","full":"gitlab-org/gitlab-pages#758"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":8028,"epic":{"id":518339,"iid":8028,"title":"Use `deployment` or `frozen` options with `bundle install` in CI on all Ruby projects and Chef cookbooks that use Ruby gems","url":"/groups/gitlab-org/-/epics/8028","group_id":9970,"human_readable_end_date":"Sep 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":107117140,"iid":749,"project_id":734943,"title":"Add early return and tests for internal/handlers/https","description":"The following discussion from !735 should be addressed:\n\n- [ ] @vshushlin started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/735#note_922396637): \n\n    \u003e I would add \n    \u003e \n    \u003e ```golang\n    \u003e if !redirect {\n    \u003e \treturn handler\n    \u003e }\n    \u003e \n    \u003e and tests for this handler. But let's move it to the follow-up issue. This is already a nice improvement :thumbs-up:","state":"closed","created_at":"2022-04-25T07:47:32.009Z","updated_at":"2022-04-26T18:43:43.621Z","closed_at":"2022-04-26T18:43:43.604Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Seeking community contributions","[deprecated] good for new contributors","devops::create","golang","group::editor","section::dev"],"milestone":{"id":2095271,"iid":65,"group_id":9970,"title":"15.0","description":"","state":"active","created_at":"2021-06-08T15:35:34.814Z","updated_at":"2021-11-02T18:23:35.115Z","due_date":"2022-05-17","start_date":"2022-04-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/65"},"assignees":[{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https://secure.gravatar.com/avatar/40569112d16323eb878ebdead2117943?s=80\u0026d=identicon","web_url":"https://gitlab.com/feistel"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https://secure.gravatar.com/avatar/40569112d16323eb878ebdead2117943?s=80\u0026d=identicon","web_url":"https://gitlab.com/feistel"},"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/749","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/749","notes":"https://gitlab.com/api/v4/projects/734943/issues/749/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/749/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#749","relative":"#749","full":"gitlab-org/gitlab-pages#749"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":106881635,"iid":747,"project_id":734943,"title":"Infer artifacts-server from internalGitlabServerFromFlags() unless it's set explicitly","description":"### Summary\n\nWe have a lot of config options pointing to the gitlab server. We use them for different reasons:\n\n1. getting domain information\n2. redirecting to authentication\n3. fetching OAuth token\n4. proxying artifacts\n\nIn the simplest case, it should be possible to infer all of them from a single URL.\n\nNote:\n1. some of these URL work in the `internal` network (e.g. OAuth token, gitlab domain information)\n2. while others should be public(e.g. OAuth redirects), because we can redirect the user to this URL\n\nSo we should have at least 2 parameters:\n- `gitlab-server`\n- `gitlab-internal-server`\n\nAnd all of the rest can be inferred from this.\n\nRight now `artifacts-server` should always be set in the config, I suggest we infer if from `internalGitlabServerFromFlags()` unless it's set.\n\n**Optional:** mark `artifacts-server` as deprecated an remove it on the next major release.\n\n## Implementation details\n\n```golang\nfunc artifactsServerFromFlags() string {\n\tif *artifactsServer != \"\" {\n\t\treturn *artifactsServer\n\t}\n\n\treturn internalGitlabServerFromFlags() + \"/api/v4\"\n}\n```","state":"closed","created_at":"2022-04-20T06:50:39.305Z","updated_at":"2022-06-03T05:59:44.112Z","closed_at":"2022-06-03T05:59:44.080Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Seeking community contributions","[deprecated] good for new contributors","backend","devops::create","golang","group::editor","section::ops","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":4,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/747","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/747","notes":"https://gitlab.com/api/v4/projects/734943/issues/747/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/747/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#747","relative":"#747","full":"gitlab-org/gitlab-pages#747"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":106318294,"iid":731,"project_id":734943,"title":"TLS Ciphers are breaking in FIPS Mode","description":"### Summary\n\nWhen Pages is running in FIPS mode, some [ciphers](https://gitlab.com/gitlab-org/gitlab-pages/blob/master/internal/tls/tls.go#L13-L13) do not work.\n\n### Steps to reproduce\n\nFollow steps in https://gitlab.com/gitlab-org/gitlab-pages/-/issues/718#note_904531139\n\nIt also has the list of which ciphers do not work in FIPS mode.\n\n### What is the current *bug* behavior?\n\nAll the ciphers mentioned below work when Pages is running as part of GDK but do not work when Pages is hosted on a FIPS enabled RHEL server\n\n#### `TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305` and `TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305`\n\nThese are TLS 1.2 ciphers. By default the curl connection goes for TLS1.3 connection unless explicitly specified using `--tlsv1.2 --tls-max 1.2`\n\n\n\u003cdetails\u003e\n\u003csummary\u003eLogs when Pages is running in GDK and explicit TLS versions not specified in curl\u003c/summary\u003e\n\n```sh\n$ curl https://127.0.0.1:3012 -H 'Host: t1.vishaltak.com' --verbose --insecure --cipher ECDHE-RSA-CHACHA20-POLY1305\n*   Trying 127.0.0.1:3012...\n* Connected to 127.0.0.1 (127.0.0.1) port 3012 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* Cipher selection: ECDHE-RSA-CHACHA20-POLY1305\n* successfully set certificate verify locations:\n*  CAfile: /etc/ssl/cert.pem\n*  CApath: none\n* (304) (OUT), TLS handshake, Client hello (1):\n* (304) (IN), TLS handshake, Server hello (2):\n* (304) (IN), TLS handshake, Unknown (8):\n* (304) (IN), TLS handshake, Certificate (11):\n* (304) (IN), TLS handshake, CERT verify (15):\n* (304) (IN), TLS handshake, Finished (20):\n* (304) (OUT), TLS handshake, Finished (20):\n* SSL connection using TLSv1.3 / AEAD-CHACHA20-POLY1305-SHA256\n* ALPN, server accepted to use h2\n* Server certificate:\n*  subject: C=IN; ST=MH; L=Mumbai; O=GitLab; OU=Create; CN=pages.gdk.test; emailAddress=vtak@gitlab.com\n*  start date: Apr  7 10:38:07 2022 GMT\n*  expire date: Apr  7 10:38:07 2023 GMT\n*  issuer: C=IN; ST=MH; L=Mumbai; O=GitLab; OU=Create; CN=pages.gdk.test; emailAddress=vtak@gitlab.com\n*  SSL certificate verify result: self signed certificate (18), continuing anyway.\n* Using HTTP2, server supports multiplexing\n* Connection state changed (HTTP/2 confirmed)\n* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0\n* Using Stream ID: 1 (easy handle 0x12100e600)\n\u003e GET / HTTP/2\n\u003e Host: t1.vishaltak.com\n\u003e user-agent: curl/7.79.1\n\u003e accept: */*\n\u003e\n* Connection state changed (MAX_CONCURRENT_STREAMS == 250)!\n\u003c HTTP/2 200\n\u003c cache-control: max-age=600\n\u003c content-type: text/html; charset=utf-8\n\u003c etag: \"7918027bec724fb2a62bcc049eef34f25848f0d4e0aaa5955107e3fb87859dba\"\n\u003c expires: Fri, 08 Apr 2022 09:03:39 UTC\n\u003c last-modified: Tue, 22 Mar 2022 14:11:29 GMT\n\u003c vary: Origin\n\u003c content-length: 632\n\u003c date: Fri, 08 Apr 2022 08:53:39 GMT\n...\n```\n\n\u003c/details\u003e\n\n\n**Logs when Pages is running in FIPS RHEL**\n\nCurl logs\n\n```sh \n$ curl https://127.0.0.1:3012 -H 'Host: t1.vishaltak.com' --verbose --insecure --cipher ECDHE-ECDSA-CHACHA20-POLY1305 --tlsv1.2 --tls-max 1.2\n*   Trying 127.0.0.1:3012...\n* Connected to 127.0.0.1 (127.0.0.1) port 3012 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* Cipher selection: ECDHE-ECDSA-CHACHA20-POLY1305\n* successfully set certificate verify locations:\n*  CAfile: /etc/ssl/cert.pem\n*  CApath: none\n* (304) (OUT), TLS handshake, Client hello (1):\n* error:1404B410:SSL routines:ST_CONNECT:sslv3 alert handshake failure\n* Closing connection 0\ncurl: (35) error:1404B410:SSL routines:ST_CONNECT:sslv3 alert handshake failure\n```\n\nPages Server logs\n```json\n{\"level\":\"info\",\"msg\":\"http: TLS handshake error from 127.0.0.1:34048: tls: no cipher suite supported by both client and server\",\"time\":\"2022-04-08T09:10:37Z\"}\n```\n\n\n#### `TLS_AES_128_GCM_SHA256` , `TLS_AES_256_GCM_SHA384` and `TLS_CHACHA20_POLY1305_SHA256`\n\nThese are TLS v1.3 ciphers. \n\nCurl logs\n\n```sh\n$ curl https://127.0.0.1:3012 -H 'Host: t1.vishaltak.com' --verbose --insecure  --tls13-ciphers TLS_AES_128_GCM_SHA256 --tlsv1.3\n*   Trying 127.0.0.1:3012...\n* TCP_NODELAY set\n* Connected to 127.0.0.1 (127.0.0.1) port 3012 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* TLS 1.3 cipher selection: TLS_AES_128_GCM_SHA256\n* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n  CApath: /etc/ssl/certs\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\n* TLSv1.3 (IN), TLS alert, protocol version (582):\n* error:1409442E:SSL routines:ssl3_read_bytes:tlsv1 alert protocol version\n* Closing connection 0\ncurl: (35) error:1409442E:SSL routines:ssl3_read_bytes:tlsv1 alert protocol version\n```\n\nPages server logs\n\n```json\n{\"level\":\"info\",\"msg\":\"http: TLS handshake error from 127.0.0.1:34066: tls: client offered only unsupported versions: [304]\",\"time\":\"2022-04-08T09:15:42Z\"}\n```\n\n### What is the expected *correct* behavior?\n\nThe HTML should be served while respecting the TLS version and the cipher\n\n### Comments\n\nI think, for TLS 1.2, ciphers `ECDHE-RSA-CHACHA20-POLY1305` and `ECDHE-ECDSA-CHACHA20-POLY1305` are not supported in FIPS mode\n\n**Reason**\n```sh\n$ openssl ciphers -v -stdname  | grep TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305    # when run of RHEL FIPS machine, gives empty result\n$ openssl ciphers -v -stdname  | grep TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305  # when run of RHEL FIPS machine, gives empty result\n```\n\n\nI think TLS v1.3 is not supported in FIPS mode and that is why the Pages server logs `tls: client offered only unsupported versions: [304]` . `304` refers to TLS v1.3 as can be seen [here](https://cs.opensource.google/go/go/+/refs/tags/go1.18:src/crypto/tls/common.go;l=33) . \n\nHowever, out of the 3 TLSv.13 ciphers mentioned above, the first two can be seen as available in FIPS RHEL OpenSSL.\n\n```sh\n$ openssl ciphers -v -stdname -s -tls1_3         # when run of RHEL FIPS machine\nTLS_AES_256_GCM_SHA384 - TLS_AES_256_GCM_SHA384  TLSv1.3 Kx=any      Au=any  Enc=AESGCM(256) Mac=AEAD\nTLS_AES_128_GCM_SHA256 - TLS_AES_128_GCM_SHA256  TLSv1.3 Kx=any      Au=any  Enc=AESGCM(128) Mac=AEAD\nTLS_AES_128_CCM_SHA256 - TLS_AES_128_CCM_SHA256  TLSv1.3 Kx=any      Au=any  Enc=AESCCM(128) Mac=AEAD\n```\n\n`TLS_CHACHA20_POLY1305_SHA256` is not available in the list\n\n#### OpenSSL Version Details\n- Local Mac - `LibreSSL 2.8.3`\n- GDK (Ubuntu) - `OpenSSL 1.1.1f  31 Mar 2020`\n- FIPS Pages(RHEL) - `OpenSSL 1.1.1k  FIPS 25 Mar 2021`\n\nIf you are using Mac, you would want to spin up some server(Ubuntu) which has openssl installed or install a separate openssl on Mac. The default openssl installed in Mac does have TLS v1.3 ciphers available for some reason. \n\n\n### Note\n\nWhile testing this, I've generated certificates for the pages domain (`pages.gdk.test`) and not for the custom domain (`t1.vishaltak.com`) .\n\n\u003c!-- DO NOT CHANGE --\u003e","state":"closed","created_at":"2022-04-08T09:46:42.625Z","updated_at":"2022-05-24T12:00:37.533Z","closed_at":"2022-05-12T04:53:08.089Z","closed_by":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"labels":["Category:Pages","Deliverable","FIPS","backend","devops::create","feature flag","golang","group::editor","quad-planning::complete-no-action","section::dev","workflow::in dev"],"milestone":{"id":2095271,"iid":65,"group_id":9970,"title":"15.0","description":"","state":"active","created_at":"2021-06-08T15:35:34.814Z","updated_at":"2021-11-02T18:23:35.115Z","due_date":"2022-05-17","start_date":"2022-04-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/65"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"}],"author":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/731","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/731","notes":"https://gitlab.com/api/v4/projects/734943/issues/731/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/731/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#731","relative":"#731","full":"gitlab-org/gitlab-pages#731"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7744,"epic":{"id":471545,"iid":7744,"title":"Editor BE FIPS Compliance","url":"/groups/gitlab-org/-/epics/7744","group_id":9970,"human_readable_end_date":"Jul 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":106238762,"iid":730,"project_id":734943,"title":"Revamp gitlab-pages development docs","description":"\u003c!---\n\nPlease read this!\n\n**NOTE**: Please check https://gitlab.com/gitlab-org/gitlab/-/issues/331699 if you had issues upgrading to 14.0+\n\nBefore opening a new issue, make sure to search for keywords in the issues (including closed ones)\n- https://gitlab.com/gitlab-org/gitlab-pages/issues\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n\n### Summary\n\nWhile setting up my gitlab-pages environment I got confused with some information on `doc/development.md`. It was also confusing to have some duplicated information in https://gitlab.com/gitlab-org/gitlab-development-kit/-/blob/main/doc/howto/pages.md.\n\nI propose to have all the information regarding gitlab-pages development in one place (a Single Source Of Truth - SSOT). For that, I:\n\n1. Revamped the `gitlab-pages/doc/development.md` to have all the required information to start a gitlab-pages developing environment (this MR)\n1. If this MR is approve, I'll open another MR in the GDK repository to point the `GDK/doc/howto/pages.md` to the `gitlab-pages/doc/development.md`.","state":"closed","created_at":"2022-04-07T09:58:59.934Z","updated_at":"2022-08-11T13:00:45.840Z","closed_at":"2022-06-09T15:25:28.237Z","closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"labels":["Category:Pages","backend","devops::create","golang","group::editor","section::dev","workflow::production"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/73"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},{"id":5133434,"username":"aqualls","name":"Amy Qualls","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5133434/avatar.png","web_url":"https://gitlab.com/aqualls"}],"author":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/730","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/730","notes":"https://gitlab.com/api/v4/projects/734943/issues/730/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/730/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#730","relative":"#730","full":"gitlab-org/gitlab-pages#730"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7829,"epic":{"id":488235,"iid":7829,"title":"üìñ Pages documentation cleanup","url":"/groups/gitlab-org/-/epics/7829","group_id":9970,"human_readable_end_date":"May 17, 2023","human_readable_timestamp":"\u003cstrong\u003e11\u003c/strong\u003e days remaining"},"iteration":null,"health_status":null},{"id":106045796,"iid":728,"project_id":734943,"title":"Arbitrary protocol redirection","description":"\u003c!---\n\nPlease read this!\n\n**NOTE**: Please check https://gitlab.com/gitlab-org/gitlab/-/issues/331699 if you had issues upgrading to 14.0+\n\nBefore opening a new issue, make sure to search for keywords in the issues (including closed ones)\n- https://gitlab.com/gitlab-org/gitlab-pages/issues\n\nand verify the issue you're about to submit isn't a duplicate.\n---\u003e\n\n\n### Summary\n\n\u003c!-- Summarize the bug encountered concisely. --\u003e\n\nGitLab pages can be used to redirect to arbitrary protocols in the authentication flow.\n\n\n### Steps to reproduce\n\n\u003c!-- Describe how one can reproduce the issue - this is very important. Please use an ordered list. --\u003e\n\nConsider the following URL:\n\n```\nhttps://projects.gitlab.io/auth?domain=mailto://gitlab-com.gitlab.io?body=OMGWTF\u0026state=aaa\n```\n\nIt will, after the login redirect to `gitlab.com` redirect the user to their mail client.\n\n![image](/uploads/44a20d4331d7cc8ee9699884c47d8bc7/image.png)\n\nThis might be potentially used e.g. on mobile devices to exfiltrate authentication token via custom URL handler.\n\n### Example Project\n\n\u003c!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. --\u003e\n\n### What is the current *bug* behavior?\n\n\u003c!-- Describe what actually happens. --\u003e\n\nRedirect to arbitrary protocols is possible.\n\n### What is the expected *correct* behavior?\n\nRedirect should only be possible to `https` or `http` URLs.\n\u003c!-- Describe what you should see instead. --\u003e\n\n### Relevant logs and/or screenshots\n\n\u003c!-- Paste any relevant logs - please use code blocks (```) to format console output, logs, and code\n as it's tough to read otherwise. --\u003e\n\n### Output of checks\n\n\u003c!-- If you are reporting a bug on GitLab.com, write: This bug happens on GitLab.com --\u003e\n\n### Possible fixes\n\n\u003c!-- If you can, link to the line of code that might be responsible for the problem. --\u003e\n\n\u003c!-- DO NOT CHANGE --\u003e","state":"closed","created_at":"2022-04-04T15:48:48.597Z","updated_at":"2023-02-09T15:42:22.665Z","closed_at":"2023-01-10T06:37:13.426Z","closed_by":{"id":9043659,"username":"rshambhuni","name":"Rohit Shambhuni","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9043659/avatar.png","web_url":"https://gitlab.com/rshambhuni"},"labels":["Category:Pages","Deliverable","devops::create","golang","group::editor","priority::4","section::dev","severity::4","type::bug","workflow::in dev"],"milestone":{"id":2745648,"iid":83,"group_id":9970,"title":"15.8","description":"","state":"active","created_at":"2022-08-22T16:57:34.875Z","updated_at":"2022-08-22T16:57:34.875Z","due_date":"2023-01-17","start_date":"2022-12-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/83"},"assignees":[{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/12750949/avatar.png","web_url":"https://gitlab.com/ngala"}],"author":{"id":104376,"username":"joernchen","name":"Joern Schneeweisz","state":"active","avatar_url":"https://secure.gravatar.com/avatar/5a29ccf0244143eb2faed20bcf7fe8bd?s=80\u0026d=identicon","web_url":"https://gitlab.com/joernchen"},"type":"ISSUE","assignee":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/12750949/avatar.png","web_url":"https://gitlab.com/ngala"},"user_notes_count":13,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2022-10-04","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/728","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/728","notes":"https://gitlab.com/api/v4/projects/734943/issues/728/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/728/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#728","relative":"#728","full":"gitlab-org/gitlab-pages#728"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":105901313,"iid":725,"project_id":734943,"title":"Unable to download large files from gitlab.io","description":"### Summary\n\nIf you try to download a large file from gitlab.io the connection is closed after about 37s. This is probably a regression of the recent security fix. \n\n### Steps to reproduce\n\nTry to download a large file over a slow connection or try to rate limit your connection (`wget --limit-rate` works to reproduce this issue). This affects f.e. https://gitlab.com/paulcarroty/vscodium-deb-rpm-repo. (see https://gitlab.com/paulcarroty/vscodium-deb-rpm-repo/-/issues/77) If you try to download the mentioned `codium_1.66.0-1648720116_amd64.deb` (80Mb) and the download requires more than about 37s the connection is closed and the download is not finished.\n\n\n## TODO\n\n- [x] change the default to 5 minutes https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/722\n- [x] make backports to versions we backported security fix to\n   - 1.51: https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/723\n   - 1.54: https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/724\n   - 1.56: https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/725\n- [x] make these parameters configurable in charts and omnibus\n   - charts: https://gitlab.com/gitlab-org/charts/gitlab/-/merge_requests/2504\n   - omnibus: https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/6029\n- [x] log them in http://gitlab.com/gitlab-org/gitlab-pages/blob/4b1afecbb6ae1886bfd3a31f256909ca2770bce4/internal/config/config.go#L331-L331\n- [x] remove the hot fix from https://gitlab.com/gitlab-com/gl-infra/k8s-workloads/gitlab-com/-/merge_requests/1697\n   - https://gitlab.com/gitlab-com/gl-infra/k8s-workloads/gitlab-com/-/merge_requests/1731","state":"closed","created_at":"2022-04-01T16:01:55.060Z","updated_at":"2022-05-17T14:30:51.597Z","closed_at":"2022-05-17T14:30:51.580Z","closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"labels":["Category:Pages","backend","bug::availability","devops::create","group::editor","section::dev","type::bug","workflow::in dev"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/72"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"}],"author":{"id":11261867,"username":"AnimuxAlex","name":"Alexander Sulfrian","state":"active","avatar_url":"https://secure.gravatar.com/avatar/db1f1780753690b4cddccc2fd1ac01c3?s=80\u0026d=identicon","web_url":"https://gitlab.com/AnimuxAlex"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"user_notes_count":35,"merge_requests_count":0,"upvotes":7,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/725","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":5,"completed_count":5},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/725","notes":"https://gitlab.com/api/v4/projects/734943/issues/725/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/725/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#725","relative":"#725","full":"gitlab-org/gitlab-pages#725"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":102683500,"iid":706,"project_id":734943,"title":"Remove rate limits feature flags","description":"### Summary\n\nWe rolled out rate limits for gitlab pages, so now we can remove feature flags guarding it.\n\nSO we need to:\n1. remove 4 relevant feature flags from https://gitlab.com/gitlab-org/gitlab-pages/-/blob/a8be317a96f2dfb4ab30e338daee2b51833c2322/internal/feature/feature.go#L12-L12 \n1. remove `enforce` flag from https://gitlab.com/gitlab-org/gitlab-pages/-/blob/master/internal/ratelimiter/ratelimiter.go#L48, and all tests using it\n1. clean our production to not mention these feature flags: https://gitlab.com/gitlab-com/gl-infra/k8s-workloads/gitlab-com/-/blob/96a3bf149c1cd2847f29c3ed666c480e6b8d15b7/releases/gitlab/values/values.yaml.gotmpl#L449 , https://gitlab.com/gitlab-com/gl-infra/k8s-workloads/gitlab-com/-/blob/96a3bf149c1cd2847f29c3ed666c480e6b8d15b7/releases/gitlab/values/gprd.yaml.gotmpl#L97 , and other files, **grep the repository for each of them**\n1. remove mentions of feature flags in https://docs.gitlab.com/ee/administration/pages/#rate-limits","state":"closed","created_at":"2022-02-18T12:21:07.463Z","updated_at":"2023-04-28T12:39:30.992Z","closed_at":"2022-10-27T13:17:42.598Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Deliverable","backend","devops::create","feature flag","group::editor","quad-planning::complete-no-action","section::dev","type::maintenance","workflow::ready for development"],"milestone":{"id":2453024,"iid":74,"group_id":9970,"title":"15.2","description":"","state":"active","created_at":"2022-02-03T22:24:46.818Z","updated_at":"2022-02-03T22:26:32.010Z","due_date":"2022-07-17","start_date":"2022-06-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/74"},"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/706","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/706","notes":"https://gitlab.com/api/v4/projects/734943/issues/706/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/706/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#706","relative":"#706","full":"gitlab-org/gitlab-pages#706"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":102495890,"iid":705,"project_id":734943,"title":"TLS security for GitLab Pages metrics endpoints","description":"Refer https://gitlab.com/groups/gitlab-org/-/epics/7479\n\nGitLab components report metrics via Prometheus, and sometimes start a pprof listener to aid live profiling. Either of these may be open and listening when running GitLab in production, as they are on GitLab.com\n\n1. Inventory which endpoints report to Prometheus\n1. Determine of those endpoints are already or can be TLS-secured\n1. Secure each unsecured endpoint\n\n~\"devops::release\" ~\"group::release\" ~\"Category:Pages\"","state":"closed","created_at":"2022-02-15T17:33:07.002Z","updated_at":"2022-06-23T11:25:24.538Z","closed_at":"2022-06-09T04:06:43.787Z","closed_by":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"labels":["Category:Pages","FIPS","backend","blocked","devops::create","frontend","group::editor","infrastructure","quad-planning::complete-no-action","section::dev","type::maintenance"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/73"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"}],"author":{"id":4391348,"username":"sean_carroll","name":"Sean Carroll","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4391348/avatar.png","web_url":"https://gitlab.com/sean_carroll"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"user_notes_count":27,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/705","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/705","notes":"https://gitlab.com/api/v4/projects/734943/issues/705/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/705/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#705","relative":"#705","full":"gitlab-org/gitlab-pages#705"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7744,"epic":{"id":471545,"iid":7744,"title":"Editor BE FIPS Compliance","url":"/groups/gitlab-org/-/epics/7744","group_id":9970,"human_readable_end_date":"Jul 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":101609858,"iid":694,"project_id":734943,"title":"Intermittent 404s with gitlab-org.gitlab.io due to \"domain does not exist\"","description":"### Summary\n\n@marcel.amirault mentioned that he was seeing intermittent 404s while visiting https://gitlab-org.gitlab.io/gitlab-roulette/ today.\n\nhttps://log.gprd.gitlab.net/goto/e5236f50-82bc-11ec-a649-b7cbb8e4f62e shows that the `domain does not exist` error pops up quite frequently for this host:\n\n![image](/uploads/81fd4b665c5aded40fe716eb759cbe7f/image.png)\n\nThe issue seems distributed across multiple pods:\n\n![image](/uploads/082536dceb7b114b7a8e247abbc4b629/image.png)\n\nCurious why these URLs seem to be involved?\n\n![image](/uploads/520b15b310d4e7bc88608728cf42568b/image.png)\n\nhttps://gitlab-org.gitlab.io/trello-power-up/scripts/api.js should exist.\n\n\u003c!-- Summarize the bug encountered concisely. --\u003e\n\n### Steps to reproduce\n\n\u003c!-- Describe how one can reproduce the issue - this is very important. Please use an ordered list. --\u003e\n\n### Example Project\n\n\u003c!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. --\u003e\n\n### What is the current *bug* behavior?\n\n\u003c!-- Describe what actually happens. --\u003e\n\n### What is the expected *correct* behavior?\n\n\u003c!-- Describe what you should see instead. --\u003e\n\n### Relevant logs and/or screenshots\n\n\u003c!-- Paste any relevant logs - please use code blocks (```) to format console output, logs, and code\n as it's tough to read otherwise. --\u003e\n\n### Output of checks\n\n\u003c!-- If you are reporting a bug on GitLab.com, write: This bug happens on GitLab.com --\u003e\n\n### Possible fixes\n\n\u003c!-- If you can, link to the line of code that might be responsible for the problem. --\u003e\n\n\u003c!-- DO NOT CHANGE --\u003e\n\n~\"devops::release\" ~\"group::release\" ~\"Category:Pages\"","state":"closed","created_at":"2022-01-31T17:47:18.142Z","updated_at":"2022-06-21T12:02:14.414Z","closed_at":"2022-06-13T09:56:42.216Z","closed_by":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"labels":["Category:Pages","Deliverable","devops::create","group::editor","internal customer","priority::2","section::dev","severity::2","type::bug","workflow::verification"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/73"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"}],"author":{"id":64248,"username":"stanhu","name":"Stan Hu","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/64248/stanhu.jpg","web_url":"https://gitlab.com/stanhu"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"user_notes_count":24,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/694","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/694","notes":"https://gitlab.com/api/v4/projects/734943/issues/694/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/694/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#694","relative":"#694","full":"gitlab-org/gitlab-pages#694"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":100941602,"iid":688,"project_id":734943,"title":"feat: make server shutdown timeout configurable","description":"The following discussion from !664 should be addressed:\n\n- [x] @jaime started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/664#note_815813893): \n\n    \u003e // TODO: make this timeout configurable\n\n# Proposal\n\nAdd a new config flag `server-shutdown-timeout` of type `time.Duration`.\n\n- [x] Add to Pages server\n- [x] Add to Omnibus config (example https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/5832/diffs)\n- [x] Add to GitLab Charts (example https://gitlab.com/gitlab-org/charts/gitlab/-/merge_requests/2338)\n- [x] Document in the admin docs (example https://gitlab.com/gitlab-org/gitlab/-/merge_requests/77969)","state":"closed","created_at":"2022-01-19T22:28:41.956Z","updated_at":"2022-03-22T04:25:50.151Z","closed_at":"2022-03-22T04:25:50.139Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Community contribution","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::feature"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/72"},"assignees":[{"id":10660827,"username":"HuseyinEmreAksoy","name":"H√ºseyin Emre Aksoy","state":"active","avatar_url":"https://secure.gravatar.com/avatar/22476f2f3088298f5a1e0ce14f6c4788?s=80\u0026d=identicon","web_url":"https://gitlab.com/HuseyinEmreAksoy"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":10660827,"username":"HuseyinEmreAksoy","name":"H√ºseyin Emre Aksoy","state":"active","avatar_url":"https://secure.gravatar.com/avatar/22476f2f3088298f5a1e0ce14f6c4788?s=80\u0026d=identicon","web_url":"https://gitlab.com/HuseyinEmreAksoy"},"user_notes_count":16,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/688","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":5,"completed_count":5},"weight":4,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/688","notes":"https://gitlab.com/api/v4/projects/734943/issues/688/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/688/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#688","relative":"#688","full":"gitlab-org/gitlab-pages#688"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":99072743,"iid":677,"project_id":734943,"title":"Include correlation ID and remote IP in Sentry tags","description":"### Summary\n\nWhile investigating https://gitlab.com/gitlab-com/gl-infra/production/-/issues/6074, it was hard correlating 50x requests to Sentry errors because the latter don't include things like correlation ID or remote IP. Having those tags (and preferably even more) could aid greatly in tracking down problems.","state":"closed","created_at":"2021-12-15T10:32:37.139Z","updated_at":"2022-03-15T15:09:57.018Z","closed_at":"2022-03-15T15:09:57.000Z","closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"labels":["Category:Pages","corrective action","devops::create","group::editor","section::ops"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/72"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"}],"author":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https://secure.gravatar.com/avatar/bd6d0ec4213b91601956c9f801cbfe9b?s=80\u0026d=identicon","web_url":"https://gitlab.com/ahmadsherif"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/677","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/677","notes":"https://gitlab.com/api/v4/projects/734943/issues/677/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/677/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#677","relative":"#677","full":"gitlab-org/gitlab-pages#677"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":99052899,"iid":673,"project_id":734943,"title":"refactor: revert back to archive/zip once go1.17 is no longer supported","description":"### Summary\n\nDue to a bug in go1.17, we had to introduced a forked version of the `archive/zip` package: https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/646.\n\nThis bug is fixed in go1.18, so eventually, we can revert back to using `archive/zip` in place of `gitlab.com/gitlab-org/golang-archive-zip` once support for go1.17 has been dropped.\n\n\u003c!-- DO NOT CHANGE --\u003e\n\n~\"devops::release\" ~\"group::release\" ~\"Category:Pages\"","state":"closed","created_at":"2021-12-15T02:42:07.837Z","updated_at":"2023-02-14T14:11:54.158Z","closed_at":"2023-02-14T14:11:54.137Z","closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"labels":["Category:Pages","devops::create","group::editor","maintenance::refactor","section::dev","type::maintenance","workflow::complete"],"milestone":{"id":2745650,"iid":84,"group_id":9970,"title":"15.9","description":"","state":"active","created_at":"2022-08-22T16:58:02.303Z","updated_at":"2022-08-22T16:58:02.303Z","due_date":"2023-02-17","start_date":"2023-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/84"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"}],"author":{"id":5878538,"username":"ajwalker","name":"Arran Walker","state":"active","avatar_url":"https://secure.gravatar.com/avatar/13209547f9f01b0bbb1d3b340263573c?s=80\u0026d=identicon","web_url":"https://gitlab.com/ajwalker"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be7919dfa5d1e8b8826bf51bfc747055?s=80\u0026d=identicon","web_url":"https://gitlab.com/kassio"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2022-08-22","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/673","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/673","notes":"https://gitlab.com/api/v4/projects/734943/issues/673/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/673/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#673","relative":"#673","full":"gitlab-org/gitlab-pages#673"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":98258008,"iid":668,"project_id":734943,"title":"Allow customizing the artifacts path (\"public\") in GitLab Pages","description":"### Reasoning \n\nCurrently GitLab Pages will only publish built files from a folder named `public` inside the project root.\n\nExcept for a few minor Frameworks this requires changing the default behaviour of the framework the user is using:\n\nFor example, Next.js uses `.next`, Nuxt and Astro use `dist`, Eleventy uses `_site`, etc... \u0026mdash; what all of them have in common is the fact, that the `public` folder (sometimes in the root directory, sometimes not) often has a slightly different use: It stores static public files that don't need to go through the build process.\n\nThis means that in order to deploy a site with pages not only does the user need to configure the build path, they also often need to change where files from the *original* `public` folders live.\n\nSo the default behaviour of Pages is almost never what the user needs. It almost always is in conflict with the default behaviour of the frameworks. This causes confusion because it's not clearly documented (gitlab#340682).\n\nThe most user-centric way to approach this is to refactor GitLab Pages so that it obtains the artifacts folder from the `.gitlab-ci.yml` file and uses whatever has been specified there.\n\n### Proposal\n\n#### The initial idea\n\nThe easiest way would be to just **drop** the requirement entirely and do the following:\n - If there's only one folder in artifacts, use that as the pages root\n - If there's multiple folders, do some educated guessing which one to use (quoted from the original MR):\n   \u003e In the case where `artifacts.paths` contains more than one folder, it will check for the presence of any of the     following folders. These are the output folders generated by the [most popular frontend frameworks](https://gitlab.com/gitlab-org/incubation-engineering/jamstack/meta/-/issues/12#popular-frameworks), ordered by the popularity of the related framework (but `public` first, because backwards compatibility):\n   \u003e - `public` (previous GitLab behaviour, Hugo, Gatsby, Svelte)\n   \u003e - `build` (React)\n   \u003e - `dist` (Vue, Nuxt.js, Angular, Astro, Vite)\n   \u003e - `out` (Next.js)\n   \u003e - `_site` (Eleventy, Jekyll)\n\nThe problem with that approach is that it would *change GitLab Pages behavior* for existing pages. If someone had previously uploaded files inside the `pages` job that's not in a `public` directory, they would start to be exposed at the time the change came into effect. \nAlthough it's rather unlikely that users uploaded artifacts in the pages job they *did not want* to be exposed, this case cannot be excluded, so following the principle of least surprise, we should require the user to opt in to a behaviour like this.\n\n#### The better idea\n\nLet's introduce a new property to the pipeline. One that's specific to the `pages` job. Say, `publish`\n\n```yaml\npages:\n  script: ...\n  publish: some/dir\n```\n\nSo this new `publish` property has a semantic meaning: \"This is the folder I want to publish\".\n\nIn the background this does two things:\n\n1. It behaves as `artifacts.paths` with a single entry. (Pages needs a single root directory anyway, so it doesn't make much sense to allow more than one dir, at least for Pages. The user is allowed to add a classic `artifacts` property if they want to publish artifacts from that repo too, but it would be ignored by the pages server)\n\n2. It causes the GitLab Pages server to treat a folder of that name as the pages root. I guess the best implementation to do this would be via the API, but I'm open to suggestions.\n\nNow, if there's no `publish` property in the pages job definition, we just keep the legacy behaviour: Without a `publish` property, Pages will only ever expose the `public` folder. No surprises for anyone. Users would have to explicitly enable the new behaviour.","state":"closed","created_at":"2021-11-10T13:37:42.502Z","updated_at":"2023-05-02T07:17:04.487Z","closed_at":"2023-03-21T10:53:22.216Z","closed_by":{"id":9622933,"username":"janis","name":"Janis Altherr","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9622933/avatar.png","web_url":"https://gitlab.com/janis"},"labels":["Category:Pages","Deliverable","GitLab Core","GitLab Premium","GitLab Ultimate","devops::plan","group::knowledge","section::dev","type::feature","workflow::in dev"],"milestone":{"id":2910456,"iid":86,"group_id":9970,"title":"15.11","description":"","state":"active","created_at":"2022-12-13T20:08:46.985Z","updated_at":"2022-12-13T20:08:46.985Z","due_date":"2023-04-17","start_date":"2023-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/86"},"assignees":[{"id":9622933,"username":"janis","name":"Janis Altherr","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9622933/avatar.png","web_url":"https://gitlab.com/janis"}],"author":{"id":9622933,"username":"janis","name":"Janis Altherr","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9622933/avatar.png","web_url":"https://gitlab.com/janis"},"type":"ISSUE","assignee":{"id":9622933,"username":"janis","name":"Janis Altherr","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9622933/avatar.png","web_url":"https://gitlab.com/janis"},"user_notes_count":11,"merge_requests_count":1,"upvotes":14,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/668","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/668","notes":"https://gitlab.com/api/v4/projects/734943/issues/668/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/668/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#668","relative":"#668","full":"gitlab-org/gitlab-pages#668"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":"on_track"},{"id":96169536,"iid":655,"project_id":734943,"title":"Enable domain-base rate-limiting","description":"Choose rate-limit for gitlab.com based on results of https://gitlab.com/gitlab-org/gitlab-pages/-/issues/654 and enable rate-limiting. Remove feature flags for self-hosted version.","state":"closed","created_at":"2021-10-26T14:01:39.855Z","updated_at":"2022-01-26T16:24:35.090Z","closed_at":"2022-01-26T16:24:35.076Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Eng-Consumer::Infrastructure","Eng-Producer::Development","Engineering Allocation","Next Up","automation:infradev-missing-labels","backend","devops::release [DEPRECATED]","group::release [DEPRECATED]","infradev","section::ops","severity::3"],"milestone":null,"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":10,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/655","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/655","notes":"https://gitlab.com/api/v4/projects/734943/issues/655/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/655/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#655","relative":"#655","full":"gitlab-org/gitlab-pages#655"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6972,"epic":{"id":375387,"iid":6972,"title":"Add per IP/domain rate-limits to GitLab Pages","url":"/groups/gitlab-org/-/epics/6972","group_id":9970,"human_readable_end_date":"Feb 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":96169359,"iid":654,"project_id":734943,"title":"Enable domain-based rate-limiting in the test mode","description":"Enable rate-limiting introduced in https://gitlab.com/gitlab-org/gitlab-pages/-/issues/630 in test-only mode(only report how many requests were rejected without actually rejecting them)","state":"closed","created_at":"2021-10-26T13:59:44.935Z","updated_at":"2022-02-18T07:02:32.681Z","closed_at":"2022-01-26T16:21:05.102Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Deliverable","Next Up","backend","devops::release [DEPRECATED]","documentation","group::release [DEPRECATED]","section::ops","workflow::ready for development"],"milestone":{"id":2161849,"iid":70,"group_id":9970,"title":"14.8","description":"","state":"active","created_at":"2021-07-26T16:51:47.677Z","updated_at":"2021-07-26T16:51:47.677Z","due_date":"2022-02-17","start_date":"2022-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/70"},"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/654","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/654","notes":"https://gitlab.com/api/v4/projects/734943/issues/654/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/654/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#654","relative":"#654","full":"gitlab-org/gitlab-pages#654"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6972,"epic":{"id":375387,"iid":6972,"title":"Add per IP/domain rate-limits to GitLab Pages","url":"/groups/gitlab-org/-/epics/6972","group_id":9970,"human_readable_end_date":"Feb 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":96079199,"iid":652,"project_id":734943,"title":"Try to build GitLab Pages with FIPS compliant libraries","description":"See https://gitlab.com/gitlab-org/gitlab/-/issues/296017#note_487842290 as reference.","state":"closed","created_at":"2021-10-25T11:52:37.359Z","updated_at":"2022-05-03T21:09:17.824Z","closed_at":"2022-03-23T12:26:23.239Z","closed_by":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"labels":["Category:Pages","Deliverable","FIPS","Next Up","backend","devops::create","group::editor","section::dev","workflow::ready for development"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/72"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"user_notes_count":30,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2022-05-22","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/652","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/652","notes":"https://gitlab.com/api/v4/projects/734943/issues/652/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/652/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#652","relative":"#652","full":"gitlab-org/gitlab-pages#652"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7744,"epic":{"id":471545,"iid":7744,"title":"Editor BE FIPS Compliance","url":"/groups/gitlab-org/-/epics/7744","group_id":9970,"human_readable_end_date":"Jul 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":95676479,"iid":649,"project_id":734943,"title":"Wildcard redirects break Let's Encrypt integration","description":"From https://gitlab.com/gitlab-org/gitlab/-/merge_requests/72069: \n\n\u003e The Let's encrypt automatic integration for gitlab pages is not working when using wildcard redirects.\n\u003e \n\u003e I.e. `/* /index.html 200` in _redirects file for pages.\n\nThis happens because https://gitlab.com/gitlab-org/gitlab-pages/blob/5e86747b6287381e2f23afe837ede1820876cf8d/internal/acme/acme.go#L33-L33 checks if project has a file in it, and we handle redirects, so our acme middleware doesn't redirect to gitlab.\n\nI see a few ways of fixing this:\n\n1. stop redirecting any `\"/.well-known/acme-challenge/*\"` files\n1. remove this `if domain.ServeFileHTTP(w, r)` check completely. This was originally done to allow users to manually implement their integration with Let's Encrypt. People were doing this before we had our one integration.\n1. In the API response for domain add `redirect_for_acme_challenges: true` and replace `if domain.ServeFileHTTP(w, r) {` with `if !domain.RedirectForAcmeChallenges {`\n1. In the API response return the actually acme challenges like `{acme_challenges: [{path: \"/.well-known/acme-challenge/somehting\", value: \"somevalue\"}]}`. Currently, we rely on the main gitlab instance being public and reachable from Let's Encrypt, so we just redirect to it. If we go with the last option, we can get rid of this requirement. \n\nHowever, last 2 options will also slow down the Let's Encrypt integration, as we update domain config cache not that often.\n\nActually, I'm(@vshushlin) in favor of the first option - it shouldn't break anything for existing users, as not many people use redirects yet. And it doesn't slow down the Let's Encrypt integraiton.","state":"closed","created_at":"2021-10-19T10:01:54.301Z","updated_at":"2022-07-27T00:24:26.484Z","closed_at":"2022-07-26T07:53:42.873Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Next Up","devops::create","group::editor","priority::3","section::dev","severity::3","type::bug","workflow::planning breakdown"],"milestone":{"id":2453025,"iid":75,"group_id":9970,"title":"15.3","description":"","state":"active","created_at":"2022-02-03T22:28:50.229Z","updated_at":"2022-02-03T22:28:50.229Z","due_date":"2022-08-17","start_date":"2022-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/75"},"assignees":[{"id":9938509,"username":"faleksic","name":"Filip Aleksic","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9938509/avatar.png","web_url":"https://gitlab.com/faleksic"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":9938509,"username":"faleksic","name":"Filip Aleksic","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/9938509/avatar.png","web_url":"https://gitlab.com/faleksic"},"user_notes_count":15,"merge_requests_count":2,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/649","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/649","notes":"https://gitlab.com/api/v4/projects/734943/issues/649/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/649/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#649","relative":"#649","full":"gitlab-org/gitlab-pages#649"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":95409156,"iid":648,"project_id":734943,"title":"Replace GetCompressedPageFromListener, GetPageFromListenerWithCookie and GetProxiedPageFromListener with GetPageFromListenerWithHeaders","description":"In https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/594/diffs#b0462893f1f2c58c31c518d3cfb09feb2cb3dc57_402_402 we introduced GetPageFromListenerWithHeaders.\n\nNow we can replace GetCompressedPageFromListener, GetPageFromListenerWithCookie and GetProxiedPageFromListener with it. They all are very similar and differ only be headers.\n\n~\"devops::release\" ~\"group::release\" ~\"Category:Pages\"","state":"closed","created_at":"2021-10-14T09:19:21.675Z","updated_at":"2021-11-01T10:35:56.364Z","closed_at":"2021-11-01T10:35:56.352Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops"],"milestone":null,"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/648","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/648","notes":"https://gitlab.com/api/v4/projects/734943/issues/648/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/648/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#648","relative":"#648","full":"gitlab-org/gitlab-pages#648"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":95406544,"iid":647,"project_id":734943,"title":"Make internal/lru metrics optional","description":"### Summary\n\nCurrently, https://gitlab.com/gitlab-org/gitlab-pages/blob/247bd7ba2fd9139711218c6a42ed03c551f958d9/internal/lru/lru.go#L30-L30 makes metric parameters required.\n\nSo in https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/594#note_703313432 we needed to make them required for rate-limiter too.\n\nIf these parameters were optional:\n* it may be easier to test without need for things like https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/594/diffs#16df871fa23e530eb52c7b56cc4ea5ce8a5e5997_108_113 (unless we want to test metrics specifically)\n* `ratelimiter.New` interface would be cleaner\n\nSo I suggest:\n* Allow `nil` for metrics in https://gitlab.com/gitlab-org/gitlab-pages/blob/247bd7ba2fd9139711218c6a42ed03c551f958d9/internal/lru/lru.go#L30-L30. Or use functional options for them.\n* Convert metrics in ratelimiter.New to functional options as well\n\n**This is a very low priority and just nice to have refactoring**\n\n\u003c!-- DO NOT CHANGE --\u003e\n\n~\"devops::release\" ~\"group::release\" ~\"Category:Pages\"","state":"closed","created_at":"2021-10-14T08:45:50.412Z","updated_at":"2021-12-01T09:20:10.088Z","closed_at":"2021-12-01T00:34:59.372Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops"],"milestone":null,"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":2,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/647","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/647","notes":"https://gitlab.com/api/v4/projects/734943/issues/647/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/647/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#647","relative":"#647","full":"gitlab-org/gitlab-pages#647"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":93685391,"iid":631,"project_id":734943,"title":"Allow to configure IP-rate-limits in Omnibus/CNG","description":"Follow-up from https://gitlab.com/gitlab-org/gitlab-pages/-/issues/490\n\n* Add flags support to omnibus -\u003e 1 MR\n* Add flags to CNG -\u003e 1 MR\n* Add documentation to admin guide -\u003e 1 MR","state":"closed","created_at":"2021-09-15T04:18:16.657Z","updated_at":"2021-11-16T09:06:38.359Z","closed_at":"2021-11-16T09:06:38.334Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","devops::release [DEPRECATED]","documentation","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/66"},"assignees":[{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/631","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/631","notes":"https://gitlab.com/api/v4/projects/734943/issues/631/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/631/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#631","relative":"#631","full":"gitlab-org/gitlab-pages#631"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6972,"epic":{"id":375387,"iid":6972,"title":"Add per IP/domain rate-limits to GitLab Pages","url":"/groups/gitlab-org/-/epics/6972","group_id":9970,"human_readable_end_date":"Feb 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":93685350,"iid":630,"project_id":734943,"title":"Add rate limiting per domain name","description":"- Add per-domain rate limiting, this could be added much more quickly -\u003e 1-2 MRs\n- Enable per-source-IP in all environments -\u003e 2 MRs\n\n\nFollow-up from https://gitlab.com/gitlab-org/gitlab-pages/-/issues/490#note_676655191","state":"closed","created_at":"2021-09-15T04:16:36.597Z","updated_at":"2022-01-18T07:02:14.124Z","closed_at":"2022-01-17T10:43:06.537Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Deliverable","Next Up","Technical Writing","backend","devops::release [DEPRECATED]","documentation","feature::addition","group::release [DEPRECATED]","section::ops","type::feature","workflow::verification"],"milestone":{"id":2156369,"iid":68,"group_id":9970,"title":"14.7","description":"","state":"active","created_at":"2021-07-21T17:39:41.786Z","updated_at":"2021-07-21T17:39:41.786Z","due_date":"2022-01-17","start_date":"2021-12-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/68"},"assignees":[{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/630","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/630","notes":"https://gitlab.com/api/v4/projects/734943/issues/630/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/630/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#630","relative":"#630","full":"gitlab-org/gitlab-pages#630"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6972,"epic":{"id":375387,"iid":6972,"title":"Add per IP/domain rate-limits to GitLab Pages","url":"/groups/gitlab-org/-/epics/6972","group_id":9970,"human_readable_end_date":"Feb 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":93685291,"iid":628,"project_id":734943,"title":"Enable rate limit per source IP without dropping requests","description":"Follow-up 3 https://gitlab.com/gitlab-org/gitlab-pages/-/issues/490#note_676655191\n\nAdd configuration flags to Pages, integrate with the `ratelimit` package and add acceptance tests. The flags disable the rate limiter by default so this needs to be enabled in our environments manually. That means 1 MR for staging and another one for production.\n\nFollow approach described in https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/575#note_675965682 where we deploy the code and start collecting metrics as-if-enabled to understand the impact of this functionality.\n\n- [ ] pre-prod environments, blocked by https://gitlab.com/gitlab-com/gl-infra/delivery/-/issues/2083\n- [ ] prod, blocked by  https://gitlab.com/gitlab-com/gl-infra/production/-/issues/5706\n- [ ] create a dashboard in Grafana or Kibana","state":"closed","created_at":"2021-09-15T04:12:54.113Z","updated_at":"2022-01-24T17:00:26.535Z","closed_at":"2022-01-24T14:47:53.284Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Eng-Consumer::Infrastructure","Eng-Producer::Development","Engineering Allocation","Next Up","corrective action","devops::release [DEPRECATED]","feature::addition","group::release [DEPRECATED]","infradev","priority::2","section::ops","severity::2","tw-weight::5","type::feature","workflow::ready for development"],"milestone":{"id":2161849,"iid":70,"group_id":9970,"title":"14.8","description":"","state":"active","created_at":"2021-07-26T16:51:47.677Z","updated_at":"2021-07-26T16:51:47.677Z","due_date":"2022-02-17","start_date":"2022-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/70"},"assignees":[{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"user_notes_count":30,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2022-01-31","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/628","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":3,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/628","notes":"https://gitlab.com/api/v4/projects/734943/issues/628/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/628/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#628","relative":"#628","full":"gitlab-org/gitlab-pages#628"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6972,"epic":{"id":375387,"iid":6972,"title":"Add per IP/domain rate-limits to GitLab Pages","url":"/groups/gitlab-org/-/epics/6972","group_id":9970,"human_readable_end_date":"Feb 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":93685212,"iid":627,"project_id":734943,"title":"GitLab Pages Source IP Rate Limiting","description":"Follow-up 2 https://gitlab.com/gitlab-org/gitlab-pages/-/issues/490#note_676655191\n\n- Add a `ratelimit` package with support for source IP rate limit\n- Add middleware\n- Add metrics\n\n### Release notes\nGitLab Pages can become quite popular. When too many users are trying to access the Page at the same time, this can lead to an outage.\n\nIn this release, GitLab is introducing rate limiting per source IP. This will make Pages hosted on gitlab.com more stable. For users with a self hosted GitLab instance, you can also limit the number of concurrent requesters.","state":"closed","created_at":"2021-09-15T04:11:27.580Z","updated_at":"2021-10-27T00:09:17.824Z","closed_at":"2021-10-18T00:09:36.801Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Deliverable","Eng-Consumer::Infrastructure","Eng-Producer::Development","Engineering Allocation","GitLab Free","devops::release [DEPRECATED]","feature::addition","group::release [DEPRECATED]","infradev","priority::2","release post item::secondary","section::ops","severity::2","type::feature","workflow::production"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":14,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/627","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/627","notes":"https://gitlab.com/api/v4/projects/734943/issues/627/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/627/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#627","relative":"#627","full":"gitlab-org/gitlab-pages#627"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6729,"epic":{"id":346861,"iid":6729,"title":"Make GitLab Pages more resilient","url":"/groups/gitlab-org/-/epics/6729","group_id":9970,"human_readable_end_date":"Oct 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":93685144,"iid":626,"project_id":734943,"title":"Extract lru cache to its own package so it can be reused","description":"Follow-up 1 https://gitlab.com/gitlab-org/gitlab-pages/-/issues/490#note_676655191","state":"closed","created_at":"2021-09-15T04:10:15.429Z","updated_at":"2021-10-28T13:52:31.301Z","closed_at":"2021-09-21T23:06:57.765Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::production"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/626","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/626","notes":"https://gitlab.com/api/v4/projects/734943/issues/626/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/626/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#626","relative":"#626","full":"gitlab-org/gitlab-pages#626"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6729,"epic":{"id":346861,"iid":6729,"title":"Make GitLab Pages more resilient","url":"/groups/gitlab-org/-/epics/6729","group_id":9970,"human_readable_end_date":"Oct 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":92972812,"iid":619,"project_id":734943,"title":"Enable FF_ENABLE_PLACEHOLDERS by default","description":"We should enable `FF_ENABLE_PLACEHOLDERS` by default after this feature has been validated for a longer time, perhaps in %\"14.4\"","state":"closed","created_at":"2021-09-02T05:11:51.921Z","updated_at":"2022-12-05T11:25:23.536Z","closed_at":"2022-07-05T15:44:41.379Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Deliverable","[deprecated] low hanging fruit","backend","devops::create","frontend","group::editor","maintenance::refactor","quad-planning::complete-no-action","section::dev","type::maintenance","workflow::in review"],"milestone":{"id":2453024,"iid":74,"group_id":9970,"title":"15.2","description":"","state":"active","created_at":"2022-02-03T22:24:46.818Z","updated_at":"2022-02-03T22:26:32.010Z","due_date":"2022-07-17","start_date":"2022-06-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/74"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":2,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/619","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":1,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/619","notes":"https://gitlab.com/api/v4/projects/734943/issues/619/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/619/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#619","relative":"#619","full":"gitlab-org/gitlab-pages#619"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":92972789,"iid":618,"project_id":734943,"title":"Remove FF_ENABLE_REDIRECTS feature flag","description":"`FF_ENABLE_REDIRECTS` has been enabled by default since the feature was merged https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/336 in %\"13.4\"","state":"closed","created_at":"2021-09-02T05:10:20.890Z","updated_at":"2022-06-20T01:05:07.935Z","closed_at":"2021-12-14T13:32:19.989Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] low hanging fruit","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops"],"milestone":{"id":2114820,"iid":67,"group_id":9970,"title":"14.6","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-06-23T05:00:52.094Z","updated_at":"2022-04-21T07:26:38.271Z","due_date":"2021-12-17","start_date":"2021-11-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/67"},"assignees":[{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/618","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/618","notes":"https://gitlab.com/api/v4/projects/734943/issues/618/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/618/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#618","relative":"#618","full":"gitlab-org/gitlab-pages#618"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":92897197,"iid":615,"project_id":734943,"title":"Investigate and test sentry integration","description":"### Summary\n\nSeems like Pages is not reporting any errors to Sentry at all https://sentry.gitlab.net/gitlab/gitlab-pages/.\n\n- We ignore the error when initializing the error tracker in https://gitlab.com/gitlab-org/gitlab-pages/-/blob/master/main.go#L28 so we might be blindly assuming it‚Äôs working, when in fact is not.\n- There is a way to deploy a local instance of Sentry for testing purposes and integrate with the GDK https://gitlab.com/gitlab-org/gitlab-development-kit/-/issues/748\n- Consider implementing some sort of catch-all error reporting.\n- Verify the DSN set in https://gitlab.com/gitlab-com/gl-infra/chef-repo/-/blob/master/roles/gprd-base-fe-web-pages.json#L32 is correct","state":"closed","created_at":"2021-08-31T23:35:50.657Z","updated_at":"2021-10-18T13:47:44.165Z","closed_at":"2021-10-07T23:36:11.033Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","devops::release [DEPRECATED]","group::release [DEPRECATED]","kubernetes-migration-blocker","section::ops","wg_k8s-migration"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/64"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":16,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/615","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/615","notes":"https://gitlab.com/api/v4/projects/734943/issues/615/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/615/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#615","relative":"#615","full":"gitlab-org/gitlab-pages#615"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":92242264,"iid":607,"project_id":734943,"title":"Replace defer with t.Cleanup in tests","description":"At least split into 2 MRs\n\n- unit tests\n- acceptance tests\n\nBut smaller chunks would be great and easier to review\n\n\nThe following discussion from !546 should be addressed:\n\n- [ ] @jaime started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/546#note_654658851):  (+1 comment)\n\n    \u003e **suggestion**: thinking if we should use `t.Cleanup` and extract this into the `testhelpers`\n    \u003e \n    \u003e ```diff\n    \u003e git diff --color=always --exit-code\n    \u003e diff --git a/internal/auth/auth_test.go b/internal/auth/auth_test.go\n    \u003e index d03407a52..d2f219c83 100644\n    \u003e --- a/internal/auth/auth_test.go\n    \u003e +++ b/internal/auth/auth_test.go\n    \u003e @@ -15,6 +15,7 @@ import (\n    \u003e \n    \u003e  \t\"gitlab.com/gitlab-org/gitlab-pages/internal/request\"\n    \u003e  \t\"gitlab.com/gitlab-org/gitlab-pages/internal/source\"\n    \u003e +\t\"gitlab.com/gitlab-org/gitlab-pages/internal/testhelpers\"\n    \u003e  )\n    \u003e \n    \u003e  func createTestAuth(t *testing.T, internalServer string, publicServer string) *Auth {\n    \u003e @@ -211,7 +212,7 @@ func testTryAuthenticateWithCodeAndState(t *testing.T, https bool) {\n    \u003e  \trequire.Equal(t, true, auth.TryAuthenticate(result, r, source.NewMockSource()))\n    \u003e \n    \u003e  \tres := result.Result()\n    \u003e -\tdefer res.Body.Close()\n    \u003e +\ttesthelpers.Close(t, res.Body)\n    \u003e \n    \u003e  \trequire.Equal(t, http.StatusFound, result.Code)\n    \u003e  \trequire.Equal(t, \"https://pages.gitlab-example.com/project/\", result.Header().Get(\"Location\"))\n    \u003e diff --git a/internal/testhelpers/testhelpers.go b/internal/testhelpers/testhelpers.go\n    \u003e index 3ec97a79c..46d4932ca 100644\n    \u003e --- a/internal/testhelpers/testhelpers.go\n    \u003e +++ b/internal/testhelpers/testhelpers.go\n    \u003e @@ -2,6 +2,7 @@ package testhelpers\n    \u003e \n    \u003e  import (\n    \u003e  \t\"fmt\"\n    \u003e +\t\"io\"\n    \u003e  \t\"mime\"\n    \u003e  \t\"net/http\"\n    \u003e  \t\"net/http/httptest\"\n    \u003e @@ -68,6 +69,15 @@ func ToFileProtocol(t *testing.T, path string) string {\n    \u003e  \treturn fmt.Sprintf(\"file://%s/%s\", wd, path)\n    \u003e  }\n    \u003e \n    \u003e +// Close a closer like response.Body as part of testing.T.Cleanup\n    \u003e +func Close(t *testing.T, c io.Closer) {\n    \u003e +\tt.Helper()\n    \u003e +\n    \u003e +\tt.Cleanup(func() {\n    \u003e +\t\trequire.NoError(t, c.Close())\n    \u003e +\t})\n    \u003e +}\n    \u003e +\n    \u003e  // Getwd must return current working directory\n    \u003e  func Getwd(t *testing.T) string {\n    \u003e  \tt.Helper()\n    \u003e ```\n    \u003e \n    \u003e WDYT?","state":"closed","created_at":"2021-08-19T05:34:27.799Z","updated_at":"2022-02-21T10:04:14.624Z","closed_at":"2022-02-21T10:04:14.550Z","closed_by":{"id":10678907,"username":"yigithankardas","name":"Yiƒüithan Karda≈ü","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10678907/avatar.png","web_url":"https://gitlab.com/yigithankardas"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":{"id":2161849,"iid":70,"group_id":9970,"title":"14.8","description":"","state":"active","created_at":"2021-07-26T16:51:47.677Z","updated_at":"2021-07-26T16:51:47.677Z","due_date":"2022-02-17","start_date":"2022-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/70"},"assignees":[{"id":10678907,"username":"yigithankardas","name":"Yiƒüithan Karda≈ü","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10678907/avatar.png","web_url":"https://gitlab.com/yigithankardas"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":10678907,"username":"yigithankardas","name":"Yiƒüithan Karda≈ü","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10678907/avatar.png","web_url":"https://gitlab.com/yigithankardas"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/607","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/607","notes":"https://gitlab.com/api/v4/projects/734943/issues/607/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/607/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#607","relative":"#607","full":"gitlab-org/gitlab-pages#607"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":89642676,"iid":589,"project_id":734943,"title":"Disable jailing mechanism by default","description":"### Release notes\nWe disable the jailing mechanism for GitLab Pages by default. The main reason for this is that [many users complain that it causes a lot of problems \nafter upgrading to 14.0](https://gitlab.com/gitlab-org/gitlab/-/issues/331699). It also lost it relevance since we stopped serving directly from the \ndisk starting from 14.0. You can still [enable jailing back](LINK TO https://gitlab.com/gitlab-org/gitlab/-/merge_requests/65791/diffs ONCE IT'S \nMERGED) if disabling it will break something for you. In that case please reach to us on the [feedback issue](https://gitlab.com/gitlab-org/gitlab/-/issues/331699).\n\n### Background\n\nStarting from GitLab 14.1 the [jailing/chroot mechanism is disabled by default](https://gitlab.com/gitlab-org/gitlab-pages/-/issues/589).\nIf you are using API-based configuration and the new [Zip storage architecture](#zip-storage)\nthere is nothing you need to do.\n\nIf you run into any problems please [open a new issue](https://gitlab.com/gitlab-org/gitlab-pages/-/issues/new)\nand enable the jail again by setting the environment variable:\n\n1. Edit `/etc/gitlab/gitlab.rb`.\n1. Set the `DAEMON_ENABLE_JAIL` environment variable to `true` for GitLab Pages:\n\n   ```ruby\n   gitlab_pages['env']['DAEMON_ENABLE_JAIL'] = \"true\"\n   ```\n\n\nDisabling the jail will hopefully fix a bunch of issues related to DNS resolution when running Pages inside a Docker container and ease the transition to the new Pages architecture.\n\n\nPer @vshushlin suggestion https://gitlab.com/gitlab-org/gitlab-pages/-/issues/589#note_618738893\n\n- Add `daemon-enable-jail` flag to Pages available for source installations\n- For Omnibus installations, you can enable this by setting the following environment variable in your `/etc/gitlab/gitlab.rb` file\n\n```rb\ngitlab_pages['env']['DAEMON_ENABLE_JAIL'] = \"true\"\n```","state":"closed","created_at":"2021-07-02T01:32:09.467Z","updated_at":"2021-09-16T00:25:06.231Z","closed_at":"2021-07-19T01:51:18.400Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","GitLab Core","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","release post item::in review","section::ops","type::feature","workflow::verification"],"milestone":{"id":1850118,"iid":61,"group_id":9970,"title":"14.1","description":"","state":"closed","created_at":"2021-01-26T16:56:41.887Z","updated_at":"2022-04-21T07:25:22.879Z","due_date":"2021-07-17","start_date":"2021-06-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/61"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/589","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/589","notes":"https://gitlab.com/api/v4/projects/734943/issues/589/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/589/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#589","relative":"#589","full":"gitlab-org/gitlab-pages#589"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":89577791,"iid":587,"project_id":734943,"title":"Internal API access drops URL path component","description":"I am using the GitLab CE Docker images for 13.12 and run GitLab Pages on a [separate server](https://docs.gitlab.com/ee/administration/pages/#running-gitlab-pages-on-a-separate-server).  My setup still uses disk based configuration and all pages are accessible.  I have `gitlab_pages['inplace_chroot'] = true` and set `external_url` to point to my GitLab instance.\n\nPreparing for an upgrade to 14.0 on a test setup I ran into an issue contacting the GitLab server's API.  This seems to be caused by the fact that my GitLab instance is hosted on a URL like `http://server.example.internal/gitlab`.\n\nOn 13.12, I see the following in the GitLab Pages logs\n``` console\n==\u003e /var/log/gitlab/gitlab-pages/current \u003c==\n{\"level\":\"info\",\"msg\":\"Checking GitLab internal API availability\",\"time\":\"2021-07-01T01:03:21Z\"}\n{\"error\":\"failed to connect to internal Pages API: Get \\\"http://server.example.internal/api/v4/internal/pages/status\\\": dial tcp: lookup maniac.machine.easy on [::1]:53: dial udp [::1]:53: connect: cannot assign requested address\",\"level\":\"warning\",\"msg\":\"attempted to connect to the API\",\"time\":\"2021-07-01T01:03:21Z\"}\n```\nNote the absence of the `/gitlab` path component in the URL!\n\nAfter I copied `/etc/resolv.conf` to an `etc/` directory directly below `gitlab_rails['pages_path']`, that changed to\n``` console\n==\u003e /var/log/gitlab/gitlab-pages/current \u003c==\n{\"level\":\"info\",\"msg\":\"Checking GitLab internal API availability\",\"time\":\"2021-07-01T01:20:45Z\"}\n{\"error\":\"failed to connect to internal Pages API: HTTP status: 404\",\"level\":\"warning\",\"msg\":\"attempted to connect to the API\",\"time\":\"2021-07-01T01:20:45Z\"}\n```\nFor the above GitLab Pages log entry, I see the following in the logs on my GitLab server\n``` console\n==\u003e /var/log/gitlab/nginx/gitlab_access.log \u003c==\n10.11.55.227 - - [01/Jul/2021:01:20:45 +0000] \"GET /api/v4/internal/pages/status HTTP/1.1\" 404 1576 \"\" \"Go-http-client/1.1\" 1.99\n```\nconfirming that the `/gitlab` path component is ignored.\n\nI have tried setting `gitlab_pages['internal_gitlab_server'] = http://server.example.internal/gitlab` but that didn't make a difference.\n\nDespite all of the above, I am able to access pages using 13.12.  So far so good :thinking:  \nHowever, when I add `gitlab_pages['domain_config_source'] = \"gitlab\"` to my 13.12 configuration, all I get is `502` HTTP status error pages :sob:  \n\nSeeing that 14.0 requires access to the internal API, it seems I will loose GitLab Pages functionality if I upgrade :worried:","state":"closed","created_at":"2021-07-01T01:54:39.659Z","updated_at":"2021-09-14T05:35:14.912Z","closed_at":"2021-07-06T07:45:56.361Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Stuff that should Just Work","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::bug","workflow::in review"],"milestone":{"id":1850118,"iid":61,"group_id":9970,"title":"14.1","description":"","state":"closed","created_at":"2021-01-26T16:56:41.887Z","updated_at":"2022-04-21T07:25:22.879Z","due_date":"2021-07-17","start_date":"2021-06-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/61"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":133754,"username":"paddy-hack","name":"Olaf Meeuwissen","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/133754/6804372.png","web_url":"https://gitlab.com/paddy-hack"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":9,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/587","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/587","notes":"https://gitlab.com/api/v4/projects/734943/issues/587/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/587/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#587","relative":"#587","full":"gitlab-org/gitlab-pages#587"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":88716490,"iid":582,"project_id":734943,"title":"Add flag to disable ACME challenge","description":"Currently Pages depends on [`-gitlab-server` to enable support for the ACME challenge middleware](https://gitlab.com/gitlab-org/gitlab-pages/-/blob/39c7efd7a9045cfde6ca230e5586d8ae1842ddb0/app.go#L517). \nThis means it's enabled by default now that the API is on by default. We should have a flag to allow users to disable the middleware if needed.\n\n```go\n\tif config.GitLab.Server != \"\" {\n\t\ta.AcmeMiddleware = \u0026acme.Middleware{GitlabURL: config.GitLab.Server}\n\t}\n```\n\n## Proposal \n\n- Add `-disable-acme-middleware` flag to `internal/config/flags.go`\n- Add `disable_acme_middleware` to Omnibus default to `nil`","state":"closed","created_at":"2021-06-15T05:50:27.785Z","updated_at":"2021-10-28T13:55:58.514Z","closed_at":"2021-06-22T00:44:41.663Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/582","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/582","notes":"https://gitlab.com/api/v4/projects/734943/issues/582/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/582/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#582","relative":"#582","full":"gitlab-org/gitlab-pages#582"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":88715846,"iid":581,"project_id":734943,"title":"Use internal-gitlab-server in ACME Middleware and Auth package","description":"ACME middleware and the `auth` package both talk to the GitLab server. Currently uses the value of `-gitlab-server`. However, this may cause issues in networks with local access only. We should use the value of `config.GitLab.InternalServer` instead, which uses `-interanl-gitlab-server`.","state":"closed","created_at":"2021-06-15T05:26:15.608Z","updated_at":"2021-10-28T13:55:58.903Z","closed_at":"2021-07-23T00:16:04.739Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","[deprecated] low hanging fruit","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/581","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/581","notes":"https://gitlab.com/api/v4/projects/734943/issues/581/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/581/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#581","relative":"#581","full":"gitlab-org/gitlab-pages#581"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":87172523,"iid":571,"project_id":734943,"title":"Refactor acceptance tests to use GitLab API stub","description":"As part of removing support of disc source configuration, we need to make sure that acceptance tests are running using the API as well. Most of the current tests use disk source so this effort would likely take 2-3 MRs to get through.\n\nhttps://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/483#note_576522305","state":"closed","created_at":"2021-05-17T07:32:33.337Z","updated_at":"2021-10-28T13:56:42.665Z","closed_at":"2021-08-17T09:14:46.414Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","type::maintenance","workflow::in dev"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/62"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":7,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/571","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/571","notes":"https://gitlab.com/api/v4/projects/734943/issues/571/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/571/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#571","relative":"#571","full":"gitlab-org/gitlab-pages#571"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":86252215,"iid":568,"project_id":734943,"title":"Remove use-legacy-storage from Pages","description":"Decided to remove unnecessary flag use-legacy-storage from Pages during our last Pages sync. The logic will be handled by omnibus instead https://gitlab.com/gitlab-org/omnibus-gitlab/-/issues/5993","state":"closed","created_at":"2021-04-30T00:02:04.068Z","updated_at":"2021-10-28T13:57:07.851Z","closed_at":"2021-04-30T06:59:31.041Z","closed_by":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/263716/avatar.jpeg","web_url":"https://gitlab.com/grzesiek"},"labels":["Category:Pages","Pages::Object Storage","[deprecated] low hanging fruit","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":1233762,"iid":58,"group_id":9970,"title":"13.12","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.948Z","updated_at":"2022-04-21T07:22:18.898Z","due_date":"2021-05-17","start_date":"2021-04-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/58"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/568","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/568","notes":"https://gitlab.com/api/v4/projects/734943/issues/568/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/568/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#568","relative":"#568","full":"gitlab-org/gitlab-pages#568"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":86163535,"iid":567,"project_id":734943,"title":"Add Permissions-Policy: interest-cohort=() header to Pages sites hosted on GitLab.com","description":"### Background\n\nThis issue is the same as https://gitlab.com/gitlab-org/gitlab/-/issues/327904, but for GitLab Pages instead of GitLab itself.\n\n### Proposal\n\nBegin sending the `Permissions-Policy: interest-cohort=()` header by default for Pages sites.\n\nFor now, we'll scope this change to Pages sites hosted on GitLab.com, and not self-managed Pages.\n\n### Why?\n\n- [FLoC has some worrying privacy concerns](https://www.eff.org/deeplinks/2021/03/googles-floc-terrible-idea)\n- [GitHub Pages recently blocked FLoC](https://github.blog/changelog/2021-04-27-github-pages-permissions-policy-interest-cohort-header-added-to-all-pages-sites/)\n\n### Additional info\n\nGitHub only enabled this new header for non-custom sites:\n\n\u003e Pages sites using a custom domain will not be impacted\n\nI'm not exactly sure why they made this decision. I think we should send this header by default for _all_ Pages sites, unless there's a convincing reason not to.\n\n### Technical proposal\n\n* Add `Permissions-Policy: interest-cohort=()` to the [config CustomHeaders](https://gitlab.com/gitlab-org/gitlab-pages/-/blob/4ff61e374a7dbfa51fee91799f11197e0f8d53f7/internal/config/config.go#L251) on startup\n* Add a boolean flag `-disable-floc-header` (or `-disable-permissions-policy-header`) to https://gitlab.com/gitlab-org/gitlab-pages/-/blob/master/internal/config/flags.go -\u003e when `true` we don't attach that header as above\n* Add the option to Omnibus\n* Update admin docs","state":"closed","created_at":"2021-04-28T19:17:22.895Z","updated_at":"2021-06-01T13:26:52.758Z","closed_at":"2021-05-04T17:20:53.101Z","closed_by":{"id":493585,"username":"nfriend","name":"Nathan Friend","state":"active","avatar_url":"https://secure.gravatar.com/avatar/cd23f74a33fc7d8dfe081948696551a5?s=80\u0026d=identicon","web_url":"https://gitlab.com/nfriend"},"labels":["Category:Pages","backend","devops::release [DEPRECATED]","documentation","group::release [DEPRECATED]","section::ops","workflow::planning breakdown"],"milestone":null,"assignees":[{"id":876203,"username":"igorwwwwwwwwwwwwwwwwwwww","name":"Igor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/876203/avatar.png","web_url":"https://gitlab.com/igorwwwwwwwwwwwwwwwwwwww"}],"author":{"id":493585,"username":"nfriend","name":"Nathan Friend","state":"active","avatar_url":"https://secure.gravatar.com/avatar/cd23f74a33fc7d8dfe081948696551a5?s=80\u0026d=identicon","web_url":"https://gitlab.com/nfriend"},"type":"ISSUE","assignee":{"id":876203,"username":"igorwwwwwwwwwwwwwwwwwwww","name":"Igor","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/876203/avatar.png","web_url":"https://gitlab.com/igorwwwwwwwwwwwwwwwwwwww"},"user_notes_count":13,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/567","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/567","notes":"https://gitlab.com/api/v4/projects/734943/issues/567/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/567/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#567","relative":"#567","full":"gitlab-org/gitlab-pages#567"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":85999746,"iid":566,"project_id":734943,"title":"Handle multiple errors in config validation","description":"The following discussion from !465 should be addressed:\n\n- [ ] @hswimelar started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/465#note_560875755):  (+1 comment)\n\n    \u003e This might be a good chance to either use non-fatal logging and return an error at the end. This way, multple problems with the config can be reported all at once, so the user may understand all the work they need to do, rather than having to fix the config one problem at a time.\n    \u003e \n    \u003e https://github.com/hashicorp/go-multierror works really well here, but I'm not a maintainer, so I don't feel very confident recommending you to add a third-party dependency. Maybe something do in a commit you can easily revert, if you decide to do down this path.","state":"closed","created_at":"2021-04-27T05:24:27.363Z","updated_at":"2021-10-28T13:57:15.514Z","closed_at":"2021-05-04T22:32:34.990Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] low hanging fruit","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":6,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/566","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/566","notes":"https://gitlab.com/api/v4/projects/734943/issues/566/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/566/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#566","relative":"#566","full":"gitlab-org/gitlab-pages#566"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":84834773,"iid":561,"project_id":734943,"title":"Remove chroot logic","description":"We should remove chroot/jail once we fully rollout ZIP, on or after %\"14.3\" \n\nhttps://gitlab.com/gitlab-org/gitlab/-/issues/326117#note_546346101\n\nThis can be removed after `use_legacy_storage` has been removed https://gitlab.com/gitlab-org/omnibus-gitlab/-/issues/6166","state":"closed","created_at":"2021-04-08T05:21:56.430Z","updated_at":"2022-01-12T00:37:50.914Z","closed_at":"2021-08-26T04:44:13.088Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Deliverable","Pages::Object Storage","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","workflow::in dev"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https://secure.gravatar.com/avatar/40569112d16323eb878ebdead2117943?s=80\u0026d=identicon","web_url":"https://gitlab.com/feistel"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":2,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/561","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/561","notes":"https://gitlab.com/api/v4/projects/734943/issues/561/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/561/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#561","relative":"#561","full":"gitlab-org/gitlab-pages#561"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"/groups/gitlab-org/-/epics/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":81597674,"iid":557,"project_id":734943,"title":"Reduce cyclomatic complexity of appMain","description":"Job [#1122897267](https://gitlab.com/gitlab-org/gitlab-pages/-/jobs/1122897267) failed for fa7c12070e7ba921c1d5091f735eec4cc638cd6b:","state":"closed","created_at":"2021-03-24T23:42:58.086Z","updated_at":"2021-11-25T05:30:04.793Z","closed_at":"2021-11-25T05:30:04.772Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","[deprecated] low hanging fruit","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/557","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/557","notes":"https://gitlab.com/api/v4/projects/734943/issues/557/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/557/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#557","relative":"#557","full":"gitlab-org/gitlab-pages#557"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":80527421,"iid":555,"project_id":734943,"title":"Make mutex in type Gitlab a value receiver","description":"The following discussion from !434 should be addressed:\n\n- [ ] @ash2k started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/434#note_522916031): \n\n    \u003e There is almost never a need to make mutexes pointers. I wonder why it's a pointer here?","state":"closed","created_at":"2021-03-09T04:50:20.468Z","updated_at":"2021-10-28T13:59:07.879Z","closed_at":"2021-03-31T23:15:28.573Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/555","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/555","notes":"https://gitlab.com/api/v4/projects/734943/issues/555/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/555/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#555","relative":"#555","full":"gitlab-org/gitlab-pages#555"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":78475986,"iid":543,"project_id":734943,"title":"Allow to disable local disk type of access","description":"Since Pages can run in a fully remote type of access we should\nallow disabling disk access completely.\n\nMaybe the simplest way to achieve that would be to specify `-enable-disk=false`,\nor switch to specifying an array of `-allowed-paths=[]` instead that would superseed `-pages-root`.\n\nThis would be needed to ensure that we fully disable a disk-type of accesses for cases where it is not needed,\nlike CNG.\n\nProposal:\n\n- Introduce `-enable-disk`, when false Pages will not need to scan the `pages-root` directory. However, a `pages-root` value is still needed for daemonizing into a jail or chroot.","state":"closed","created_at":"2021-02-05T08:42:18.476Z","updated_at":"2021-07-01T05:32:18.552Z","closed_at":"2021-05-18T23:02:44.062Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","workflow::production"],"milestone":{"id":1233762,"iid":58,"group_id":9970,"title":"13.12","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.948Z","updated_at":"2022-04-21T07:22:18.898Z","due_date":"2021-05-17","start_date":"2021-04-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/58"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":15,"merge_requests_count":1,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/543","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/543","notes":"https://gitlab.com/api/v4/projects/734943/issues/543/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/543/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#543","relative":"#543","full":"gitlab-org/gitlab-pages#543"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3910,"epic":{"id":81062,"iid":3910,"title":"Migrate GitLab Pages to object storage on self-hosted installs","url":"/groups/gitlab-org/-/epics/3910","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":78475817,"iid":542,"project_id":734943,"title":"Introduce a switch for `disk` serving that would allow this type of access being disabled","description":"Currently, we expose `disk` serving as a way to access data.\n\nWe should introduce a switch that would disallow usage of that feature with a toggle.\nThis toggle ideally:\n- should be off by default with %\"14.0\"\n- should be off by default for every CNG installation\n\n```\n- use-legacy-storage=true\n```","state":"closed","created_at":"2021-02-05T08:38:08.969Z","updated_at":"2021-03-09T04:21:12.021Z","closed_at":"2021-03-04T03:37:46.205Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","workflow::in review"],"milestone":{"id":1233761,"iid":57,"group_id":9970,"title":"13.10","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.646Z","updated_at":"2022-04-21T07:22:00.171Z","due_date":"2021-03-17","start_date":"2021-02-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/57"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":16,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/542","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/542","notes":"https://gitlab.com/api/v4/projects/734943/issues/542/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/542/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#542","relative":"#542","full":"gitlab-org/gitlab-pages#542"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3910,"epic":{"id":81062,"iid":3910,"title":"Migrate GitLab Pages to object storage on self-hosted installs","url":"/groups/gitlab-org/-/epics/3910","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":77799953,"iid":535,"project_id":734943,"title":"Pages \"auto\" configuration source doesn't work as expected","description":"After `13.7` some people started to have problems with gitlab-pages. Most common symptom: pages are available 50% of the time.\n\nThe problem is only present if people have multiple servers running both pages and `gitlab-rails`(see below)\n\n### Consider this setup\n* client has gitlab instance \"gitlab.example.com\"\n* and multiple servers running both `gitlab-rails` and `gitlab-pages` simultaneously\n\n### How \"auto\" currently works\n* During startup `gitlab-pages` checks if the API is available multiple times until it gets `200 OK` in response. Which it eventually does because there is a load balancer for \"gitlab.example.com\" and eventually `gitlab-pages` hits the same server as one it's running on.\n* Then `gitlab-pages` remembers that `API is functioning` and will serve `502` errors if it isn't.\n\n### Workaround\n* run steps 8-10 in https://docs.gitlab.com/13.7/ee/administration/pages/index.html#running-gitlab-pages-on-a-separate-server\n* or explicitly set `gitlab_pages['domain_config_source'] = \"disk\"` as described in https://docs.gitlab.com/ee/administration/pages/#gitlab-api-based-configuration (not recommended, because in %14.0 this option will be removed and you'll need to do the first option anyway)\n\n### Suggested fix\nchange \"auto\" behavior: if we ever fail to access API with unauthorized error - fallback to disk. (do not do this if `gitlab` is set explicitly).","state":"closed","created_at":"2021-01-25T13:54:18.794Z","updated_at":"2023-03-20T18:04:36.643Z","closed_at":"2021-02-01T09:37:57.290Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","devops::release [DEPRECATED]","group::release [DEPRECATED]","priority::2","regression","regression:13.7","section::ops","severity::2","type::bug","workflow::in review"],"milestone":{"id":1233760,"iid":56,"group_id":9970,"title":"13.9","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.334Z","updated_at":"2022-04-21T07:21:28.468Z","due_date":"2021-02-17","start_date":"2021-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/56"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":9,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/535","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/535","notes":"https://gitlab.com/api/v4/projects/734943/issues/535/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/535/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#535","relative":"#535","full":"gitlab-org/gitlab-pages#535"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":76842878,"iid":528,"project_id":734943,"title":"Re-enable IPv6 listeners in acceptance tests","description":"Re-enable IPv6 listeners in acceptance tests once https://gitlab.com/gitlab-com/gl-infra/infrastructure/-/issues/12258 is resolved\n\nBlocked by https://gitlab.com/gitlab-com/gl-infra/infrastructure/-/issues/12258\n\nRelated to #524","state":"closed","created_at":"2021-01-07T00:36:31.450Z","updated_at":"2021-10-28T14:01:42.586Z","closed_at":"2021-02-01T07:02:56.028Z","closed_by":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/263716/avatar.jpeg","web_url":"https://gitlab.com/grzesiek"},"labels":["Category:Pages","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","type::maintenance"],"milestone":{"id":1233760,"iid":56,"group_id":9970,"title":"13.9","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.334Z","updated_at":"2022-04-21T07:21:28.468Z","due_date":"2021-02-17","start_date":"2021-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/56"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":4,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/528","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/528","notes":"https://gitlab.com/api/v4/projects/734943/issues/528/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/528/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#528","relative":"#528","full":"gitlab-org/gitlab-pages#528"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":76168314,"iid":524,"project_id":734943,"title":"Flaky acceptance tests due to port already in use","description":"Since we split the acceptance tests execution in https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/403, we now get a bunch of errors due to the ports being already in use. \n\nRetrying the jobs one by one in a failing pipeline seem to be enough to make the tests pass.\n\nSample job https://gitlab.com/gitlab-org/gitlab-pages/-/jobs/912690661\n```\nmsg=\"could not create socket\" error=\"listen tcp [::1]:37000: bind: cannot assign requested address\"\n```\n\nA potential solution is to use TCP port 0 and let the OS assign an available port. However, there is no easy way to communicate the port that was assigned to the Pages acceptance tests. This causes [`WaitUntilRequestSucceeds`](https://gitlab.com/gitlab-org/gitlab-pages/-/blob/21066de52d7f7af759bdf2395694c935110da1bb/test/acceptance/helpers_test.go#L155) to wait until timeout to get a response from the binary currently running.\n\nSample faling pipeline\nhttps://gitlab.com/gitlab-org/gitlab-pages/-/pipelines/237350515\n\n---\n\n## Update 2020-01-07\n\nIPv6 seems to be disabled in some `gitlab-org-docker` runners https://gitlab.com/gitlab-com/gl-infra/infrastructure/-/issues/12258.","state":"closed","created_at":"2020-12-17T06:45:20.047Z","updated_at":"2021-01-11T08:42:45.694Z","closed_at":"2021-01-11T08:42:45.621Z","closed_by":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/263716/avatar.jpeg","web_url":"https://gitlab.com/grzesiek"},"labels":["Category:Pages","Stuff that should Just Work","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","workflow::in review"],"milestone":{"id":1233759,"iid":55,"group_id":9970,"title":"13.8","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:13.983Z","updated_at":"2022-04-13T14:51:23.220Z","due_date":"2021-01-17","start_date":"2020-12-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/55"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":5,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/524","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/524","notes":"https://gitlab.com/api/v4/projects/734943/issues/524/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/524/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#524","relative":"#524","full":"gitlab-org/gitlab-pages#524"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":76013210,"iid":520,"project_id":734943,"title":"Make gitlab client cache configurable","description":"The `internal/source/gitlab/cache/` package is currently semi hardcoded using the [`defaultCacheConfiguration`](https://gitlab.com/gitlab-org/gitlab-pages/-/blob/5e5ce293e7eb529f4443198b8cd8bb4d9a1ff418/internal/source/gitlab/cache/cache.go#L11). This makes it hard to write acceptance tests that can execute faster. For example https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/393#note_463829311.\n\nWe should introduce extra flags that will allow configuring the cache's behaviour for resolving a domain's configuration.\n\n## Default configuration\n\n```go\nvar defaultCacheConfig = cacheConfig{\n\tcacheExpiry:          10 * time.Minute,\n\tentryRefreshTimeout:  60 * time.Second,\n\tretrievalTimeout:     30 * time.Second,\n\tmaxRetrievalInterval: time.Second,\n\tmaxRetrievalRetries:  3,\n}\n``` \n\n## Implementation\n\n1. Add the following flags to Pages and override `defaultCacheConfig`\n\n  - gitlab-cache-expiry -\u003e The maximum time a domain's configuration is stored in the cache (default: 600s)\n  - gitlab-cache-refresh -\u003e The interval at which a domain's configuration is set to be due to refresh (default: 60s)\n  - gitlab-cache-cleanup -\u003e The interval at which expired items are removed from the cache (default: 60s)\n  - gitlab-retrieval-timeout -\u003e The maximum time to wait for a response from the GitLab API per request (default: 30s)\n  - gitlab-retrieval-interval -\u003e The interval to wait before retrying to resolve a domain's configuration via the GitLab API (default: 1s)\n  - gitlab-retrieval-retries -\u003e The maximum number of times to retry to resolve a domain's configuration via the API (default: 3)\n\n\n2. Move `cacheConfig` to `internal/config/`\n3. Add flags to Omnibus\n4. Documentation updates\n\nThe first part of https://gitlab.com/gitlab-org/gitlab-pages/-/issues/507 is done so we can work on this\n\n## What do these settings do\n\nUsers can configure these settings when using [API-based configuration](https://docs.gitlab.com/ee/administration/pages/#gitlab-api-based-configuration) to modify the cache behavior for a domain's resolution. The recommended default values are set inside GitLab Pages and should only be modified if needed.\n\nSome examples:\n\n- Increasing `gitlab-cache-expiry` will allow items to exist in the cache longer. This setting might be useful if the communication between Pages and GitLab Rails is not stable or the content served by Pages does not change frequently.\n- Increasing `gitlab-cache-refresh` will reduce the frequency at which GitLab Pages requests a domain's configuration from GitLab Rails. This setting might be useful for content that does not change frequently.\n- Decreasing `gitlab-retrieval-retries` will report issues between Pages and Rails more quickly. However, they can be transient failures rather than real issues.","state":"closed","created_at":"2020-12-14T07:02:16.166Z","updated_at":"2021-10-28T14:02:21.225Z","closed_at":"2021-03-23T03:53:50.784Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","cicd::active","devops::release [DEPRECATED]","documentation","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::production"],"milestone":{"id":1233761,"iid":57,"group_id":9970,"title":"13.10","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.646Z","updated_at":"2022-04-21T07:22:00.171Z","due_date":"2021-03-17","start_date":"2021-02-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/57"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/520","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/520","notes":"https://gitlab.com/api/v4/projects/734943/issues/520/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/520/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#520","relative":"#520","full":"gitlab-org/gitlab-pages#520"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":75395466,"iid":513,"project_id":734943,"title":"Refactor `Error`s to strings that aren't used as `error`","description":"Follow up to https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/399#note_455909360\n\n@jaime started a discussion https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/399#note_455909360:\n\n\u003e If we are using them as error messages rather than errors, then we should probably change them to just string constants or even inline them in the log line itself. There's no point in defining an error that is not going to be returned or used as value, WDYT?\n\u003e \n\u003e e.g. define the messages as strings\n\u003e \n\u003e ```go\n\u003e const (\n\u003e\tcreateArtifactRequestErrMsg = \"Failed to create the artifact request\"\n\u003e\tartifactRequestErrMsg       = \"Failed to request the artifact\"\n\u003e )\n\u003e ```","state":"closed","created_at":"2020-12-01T00:52:26.451Z","updated_at":"2021-10-28T14:03:21.962Z","closed_at":"2021-01-20T12:39:12.425Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","[deprecated] low hanging fruit","cicd::planning","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::in dev"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[{"id":7892101,"username":"kevin.kengne1","name":"Kevin Kengne","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/7892101/avatar.png","web_url":"https://gitlab.com/kevin.kengne1"}],"author":{"id":259327,"username":"tomquirk","name":"Tom Quirk","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/259327/avatar.png","web_url":"https://gitlab.com/tomquirk"},"type":"ISSUE","assignee":{"id":7892101,"username":"kevin.kengne1","name":"Kevin Kengne","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/7892101/avatar.png","web_url":"https://gitlab.com/kevin.kengne1"},"user_notes_count":4,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/513","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/513","notes":"https://gitlab.com/api/v4/projects/734943/issues/513/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/513/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#513","relative":"#513","full":"gitlab-org/gitlab-pages#513"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":74943046,"iid":510,"project_id":734943,"title":"Use CorrelationID middleware in Pages","description":"Since Pages does not appear to use CorrelationIDs are present (it should!)\n\nThe following discussion from !397 should be addressed:\n\n- [ ] @andrewn started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/397#note_452561607):  (+2 comments)\n\n    \u003e @jaime would you mind reviewing please?\n\n---\n\n1. Add the correlation ID to Pages, including a `propagate-correlation-id` flag.\n1. Add flag to Omnibus `gitlab_pages['propagate_correlation_id'] to Omnibus\n1. Update Pages admin documentation \n\n---\n\n# Propagating the correlation ID\n\nSetting the `propagate_correlation_id` in Omnibus will allow installations behind a reverse proxy generate and set a correlation ID to requests sent to GitLab Pages. When a reverse proxy sets the header value `x-request-id`, the value will be propagated in the request chain. Users [can find the correlation ID in the logs](https://docs.gitlab.com/ee/administration/troubleshooting/tracing_correlation_id.html#identify-the-correlation-id-for-a-request).","state":"closed","created_at":"2020-11-25T01:23:27.781Z","updated_at":"2021-10-25T23:23:57.600Z","closed_at":"2021-10-25T20:49:05.353Z","closed_by":{"id":5622641,"username":"nicolewilliams","name":"Nicole Williams","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5622641/avatar.png","web_url":"https://gitlab.com/nicolewilliams"},"labels":["Category:Pages","[deprecated] good for new contributors","cicd::planning","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","type::maintenance","workflow::in dev"],"milestone":{"id":1233761,"iid":57,"group_id":9970,"title":"13.10","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.646Z","updated_at":"2022-04-21T07:22:00.171Z","due_date":"2021-03-17","start_date":"2021-02-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/57"},"assignees":[{"id":1832709,"username":"ercan.ucan","name":"Ercan Ucan","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1832709/avatar.png","web_url":"https://gitlab.com/ercan.ucan"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":1832709,"username":"ercan.ucan","name":"Ercan Ucan","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/1832709/avatar.png","web_url":"https://gitlab.com/ercan.ucan"},"user_notes_count":8,"merge_requests_count":1,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/510","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/510","notes":"https://gitlab.com/api/v4/projects/734943/issues/510/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/510/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#510","relative":"#510","full":"gitlab-org/gitlab-pages#510"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":74618720,"iid":507,"project_id":734943,"title":"Refactor config flags and consolidate in internal/config/ package","description":"- Move all config flags to `internal/config/`\n- Refactor config struct so it can be called from any other package\n\nThe following discussion from !392 should be addressed:\n\n- [ ] @jaime started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/392#note_450695359): \n\n    \u003e Move all config flags to `internal/config/`","state":"closed","created_at":"2020-11-19T10:01:00.981Z","updated_at":"2021-10-28T14:03:48.961Z","closed_at":"2021-03-05T06:33:56.807Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":{"id":1233761,"iid":57,"group_id":9970,"title":"13.10","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.646Z","updated_at":"2022-04-21T07:22:00.171Z","due_date":"2021-03-17","start_date":"2021-02-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/57"},"assignees":[{"id":4849,"username":"balasankarc","name":"Balasankar 'Balu' C","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4849/avatar.png","web_url":"https://gitlab.com/balasankarc"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4849,"username":"balasankarc","name":"Balasankar 'Balu' C","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4849/avatar.png","web_url":"https://gitlab.com/balasankarc"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/507","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/507","notes":"https://gitlab.com/api/v4/projects/734943/issues/507/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/507/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#507","relative":"#507","full":"gitlab-org/gitlab-pages#507"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":74416375,"iid":505,"project_id":734943,"title":"Make `/pages` to be an actual `artifacts-path`","description":"We decided that `file://` being used for ZIP will return a full absolute path as seen from Rails perspective.\n\nHowever, when doing `chroot` in `pages` we mount `pages-root` under `/pages`. We should instead ensure\nthat in chroot env the absolute path to access resource is exactly the same, to allow the `file://` returned by\nRails to function exactly the same.\n\nThis is required for https://gitlab.com/gitlab-org/gitlab-pages/-/issues/485.","state":"closed","created_at":"2020-11-16T09:12:14.631Z","updated_at":"2021-02-02T08:41:24.361Z","closed_at":"2021-02-02T08:41:24.014Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::feature","workflow::in review"],"milestone":{"id":1233760,"iid":56,"group_id":9970,"title":"13.9","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.334Z","updated_at":"2022-04-21T07:21:28.468Z","due_date":"2021-02-17","start_date":"2021-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/56"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":13,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/505","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/505","notes":"https://gitlab.com/api/v4/projects/734943/issues/505/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/505/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#505","relative":"#505","full":"gitlab-org/gitlab-pages#505"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"/groups/gitlab-org/-/epics/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":73899685,"iid":500,"project_id":734943,"title":"Support splat (wildcard) redirects","description":"In https://gitlab.com/gitlab-org/gitlab-pages/-/issues/24, a simple redirect mechanism was implemented https://docs.gitlab.com/ee/user/project/pages/redirects.html.\n\nIt would be great if we also supported splat (wildcard) redirect support. According to the [Netlify docs](https://docs.netlify.com/routing/redirects/redirect-options/#splats):\n\n```\n/news/*  /blog/:splat\n```\n\nThis would redirect paths like `/news/2004/01/10/my-story` to `/blog/2004/01/10/my-story`.\n\nIt would mean a lot for the docs site, since we want to move away from the `/ee` prefix and use something like `/gitlab`.\n\n```\n/ee/*  /gitlab/:splat\n```\n\n### Release Notes\n\nDetails to be added","state":"closed","created_at":"2020-11-05T08:32:43.022Z","updated_at":"2021-09-20T02:09:42.032Z","closed_at":"2021-09-20T02:09:42.019Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","GitLab Core","GitLab Premium","GitLab Ultimate","Technical Writing","cicd::active","customer","devops::release [DEPRECATED]","direction","group::release [DEPRECATED]","internal customer","release post item::in review","section::ops","type::feature","workflow::production"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/63"},"assignees":[{"id":493585,"username":"nfriend","name":"Nathan Friend","state":"active","avatar_url":"https://secure.gravatar.com/avatar/cd23f74a33fc7d8dfe081948696551a5?s=80\u0026d=identicon","web_url":"https://gitlab.com/nfriend"},{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":3585,"username":"axil","name":"Achilleas Pipinellis","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3585/avatar.png","web_url":"https://gitlab.com/axil"},"type":"ISSUE","assignee":{"id":493585,"username":"nfriend","name":"Nathan Friend","state":"active","avatar_url":"https://secure.gravatar.com/avatar/cd23f74a33fc7d8dfe081948696551a5?s=80\u0026d=identicon","web_url":"https://gitlab.com/nfriend"},"user_notes_count":51,"merge_requests_count":0,"upvotes":5,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/500","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/500","notes":"https://gitlab.com/api/v4/projects/734943/issues/500/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/500/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#500","relative":"#500","full":"gitlab-org/gitlab-pages#500"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":73297571,"iid":495,"project_id":734943,"title":"Object Storage should have a strict TTFB timeout","description":"We had/have an outage related to GCS used by GitLab Pages:\n\nhttps://prometheus-app.gprd.gitlab.net/graph?g0.range_input=1h\u0026g0.expr=avg(rate(gitlab_pages_httprange_trace_duration_sum%7Brequest_stage%3D%22httptrace.ClientTrace.GotFirstResponseByte%22%7D%5B5m%5D)%2Frate(gitlab_pages_httprange_trace_duration_count%7Brequest_stage%3D%22httptrace.ClientTrace.GotFirstResponseByte%22%7D%5B5m%5D))\u0026g0.tab=0\u0026g1.range_input=2h\u0026g1.expr=sum(gitlab_pages_httprange_open_requests)\u0026g1.tab=0\u0026g2.range_input=2h\u0026g2.stacked=1\u0026g2.expr=sum(increase(gitlab_pages_vfs_operations_total%7Boperation%3D%22Open%22%7D%5B5m%5D))%20by%20(vfs_name%2C%20operation)\u0026g2.tab=0\n\n### TTFB\n\n![image](/uploads/fd84ed1775b3ae7c32735a9bf8c76cfb/image.png)\n\nWe clearly see that TTFB sky rockets once we disabled NFS. In regular operation we expect `25ms`, during outage of GCS we were seeing around `20s`, but once we disabled it appears that some requests had TTFB close to \"a few minutes\".\n\n### Connections\n\n![image](/uploads/24df853cd766d9b48b65962c0464ab49/image.png)\n\nThis created a crazy backlog of 6k open connections to GCS. Our timeout on the connection is 30 minutes.\n\n### Summary\n\nThis outage showed some aspects to improve in Pages related how Pages handles timeouts, and what timeouts it should use to ensure sane service recovery and reducing amplification pressure due to outage happening elsewhere.\n\n### Proposal\n\nDefine TTFB to be no longer than 15s. This should ensure that \"sane amount\" of requests is opened, and system can fast-reject instead of hang.\n\n```golang\nvar httpClient = \u0026http.Client{\n\t// The longest time the request can be executed\n\tTimeout: 30 * time.Minute,\n\tTransport: httptransport.NewTransportWithMetrics(\n\t\t\"httprange_client\",\n\t\tmetrics.HTTPRangeTraceDuration,\n\t\tmetrics.HTTPRangeRequestDuration,\n\t\tmetrics.HTTPRangeRequestsTotal,\n\t),\n}\n```\n\nWe should configure the:\n\n- `TLSHandshakeTimeout time.Duration`, aka before being able to write `request`\n- `ResponseHeaderTimeout time.Duration`, aka close to `TTFB`\n- `ExpectContinueTimeout time.Duration`, aka similar to `TTFB`\n\nOr, just implement that differently as part of RoundTrip of `httprange` to define a timeout to receiving response (but not yet fully reading it).\n\nMore here: https://blog.cloudflare.com/the-complete-guide-to-golang-net-http-timeouts/","state":"closed","created_at":"2020-10-24T16:05:31.917Z","updated_at":"2020-10-28T09:26:15.130Z","closed_at":"2020-10-28T09:26:15.025Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","[deprecated] low hanging fruit","devops::release [DEPRECATED]","feature::enhancement","section::ops","type::feature","workflow::in review"],"milestone":{"id":1233755,"iid":53,"group_id":9970,"title":"13.6","description":"https://about.gitlab.com/releases/2020/11/22/gitlab-13-6-released/","state":"closed","created_at":"2020-04-09T17:39:22.328Z","updated_at":"2022-04-13T14:51:04.376Z","due_date":"2020-11-17","start_date":"2020-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/53"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":10,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/495","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/495","notes":"https://gitlab.com/api/v4/projects/734943/issues/495/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/495/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#495","relative":"#495","full":"gitlab-org/gitlab-pages#495"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4659,"epic":{"id":129623,"iid":4659,"title":"Finalize Pages on zip architecture for rollout to gitlab.com","url":"/groups/gitlab-org/-/epics/4659","group_id":9970,"human_readable_end_date":"Dec 22, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":73291617,"iid":494,"project_id":734943,"title":"The unavailability of GitLab API makes us fallback to disk-serving","description":"Currently, if the GitLab API is unavailable we fallback to using `disk serving`.\n\nThis is OK, now, but in a fully cloud-native architecture, this should rather\nreturn a proper `500` type of error.\n\nWe should disable `local instance()` and instead return a proper error to client.\n\n```golang\nfunc (d *Domain) resolve(r *http.Request) *serving.Request {\n\trequest, _ := d.Resolver.Resolve(r)\n\n\t// TODO improve code around default serving, when `disk` serving gets removed\n\t// https://gitlab.com/gitlab-org/gitlab-pages/issues/353\n\tif request == nil {\n\t\treturn \u0026serving.Request{Serving: local.Instance()}\n\t}\n\n\treturn request\n}\n\n// ServeFileHTTP returns true if something was served, false if not.\nfunc (d *Domain) ServeFileHTTP(w http.ResponseWriter, r *http.Request) bool {\n\tif !d.HasLookupPath(r) {\n\t\t// TODO: this seems to be wrong: as we should rather return false, and\n\t\t// fallback to `ServeNotFoundHTTP` to handle this case\n\t\thttperrors.Serve404(w)\n\t\treturn true\n\t}\n\n\trequest := d.resolve(r)\n\n\treturn request.ServeFileHTTP(w, r)\n}\n```","state":"closed","created_at":"2020-10-24T10:50:23.835Z","updated_at":"2021-10-28T14:05:08.001Z","closed_at":"2021-01-27T10:44:11.376Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":1233760,"iid":56,"group_id":9970,"title":"13.9","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.334Z","updated_at":"2022-04-21T07:21:28.468Z","due_date":"2021-02-17","start_date":"2021-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/56"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":17,"merge_requests_count":2,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/494","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/494","notes":"https://gitlab.com/api/v4/projects/734943/issues/494/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/494/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#494","relative":"#494","full":"gitlab-org/gitlab-pages#494"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4659,"epic":{"id":129623,"iid":4659,"title":"Finalize Pages on zip architecture for rollout to gitlab.com","url":"/groups/gitlab-org/-/epics/4659","group_id":9970,"human_readable_end_date":"Dec 22, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":72696799,"iid":485,"project_id":734943,"title":"Allow to serve `zip` from a disk `/pages`","description":"Currently, GitLab Pages can serve remotely stored ZIP archives.\n\nHowever, since we want to migrate all our deployments to ZIP,\nwe should support serving a local stored content as well.\n\nThis is needed to ensure that we can migrate on-premise installations\nusing NFS or local disks to ZIP-architecture.","state":"closed","created_at":"2020-10-14T08:56:02.169Z","updated_at":"2023-03-20T18:04:36.377Z","closed_at":"2021-02-15T09:49:30.819Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::feature","workflow::in review"],"milestone":{"id":1233760,"iid":56,"group_id":9970,"title":"13.9","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.334Z","updated_at":"2022-04-21T07:21:28.468Z","due_date":"2021-02-17","start_date":"2021-01-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/56"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":37,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/485","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/485","notes":"https://gitlab.com/api/v4/projects/734943/issues/485/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/485/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#485","relative":"#485","full":"gitlab-org/gitlab-pages#485"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3910,"epic":{"id":81062,"iid":3910,"title":"Migrate GitLab Pages to object storage on self-hosted installs","url":"/groups/gitlab-org/-/epics/3910","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":72676917,"iid":483,"project_id":734943,"title":"Fix TestVFSFindOrCreateArchiveCacheEvict flaky test","description":"I found this flaky test locally, I believe this line https://gitlab.com/gitlab-org/gitlab-pages/-/blob/6cba2f2875856a7b4e2d008ca348d7b91098ed35/internal/vfs/zip/vfs_test.go#L120 is causing trouble\n\n```\n go test ./internal/vfs/zip -run TestVFSFindOrCreateArchiveCacheEvict -count 10 -failfast\n--- FAIL: TestVFSFindOrCreateArchiveCacheEvict (0.00s)\n    vfs_test.go:126:\n        \tError Trace:\tvfs_test.go:126\n        \tError:      \tShould not be: \u0026zip.zipArchive{fs:(*zip.zipVFS)(0xc0000b1e90), path:\"http://127.0.0.1:60311/public.zip\", once:sync.Once{done:0x1, m:sync.Mutex{state:0, sema:0x0}}, done:(chan struct {})(0xc0000b26c0), openTimeout:30000000000, cacheNamespace:\"1:\", resource:(*httprange.Resource)(0xc00007fe00), reader:(*httprange.RangedReader)(0xc00007ba50), archive:(*zip.Reader)(0xc00007fe80), err:error(nil), files:map[string]*zip.File{\"public/\":(*zip.File)(0xc000240160), \"public/404.html\":(*zip.File)(0xc000240370), \"public/bad_symlink.html\":(*zip.File)(0xc000240790), \"public/index.html\":(*zip.File)(0xc0002402c0), \"public/subdir/\":(*zip.File)(0xc000240420), \"public/subdir/2bp3Qzs9CCW7cGnxhghdavZ2bJDTzvu2mrj6O8Yqjm3YMRozRZULxBBKzJXCK16GlsvO1GlbCyONf2LTCndJU9cIr5T3PLDN7XnfG00lEmf9DWHPXiAbbi0v8ioSjnoTqdyjELVKuhsGRGxeV9RptLMyGnbpJx1w2uECiUQSHrRVQNuq2xoHLlk30UAmis1EhGXP5kKprzHxuavsKMdT4XRP0d79tie4tjqtfRsP4y60hmNS1vSujrxzhDa\":(*zip.File)(0xc0002406e0), \"public/subdir/hello.html\":(*zip.File)(0xc0002404d0), \"public/subdir/linked.html\":(*zip.File)(0xc000240580), \"public/symlink.html\":(*zip.File)(0xc000240630)}}\n        \tTest:       \tTestVFSFindOrCreateArchiveCacheEvict\n        \tMessages:   \ta different archive is returned\nFAIL\nFAIL\tgitlab.com/gitlab-org/gitlab-pages/internal/vfs/zip\t0.132s\nFAIL\n```","state":"closed","created_at":"2020-10-13T23:38:37.891Z","updated_at":"2020-10-14T16:29:55.634Z","closed_at":"2020-10-14T16:29:55.590Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Pages::Object Storage","devops::release [DEPRECATED]","section::ops","type::bug"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/483","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/483","notes":"https://gitlab.com/api/v4/projects/734943/issues/483/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/483/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#483","relative":"#483","full":"gitlab-org/gitlab-pages#483"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":72631918,"iid":482,"project_id":734943,"title":"Pages 404s with pages_artifacts_archive enabled","description":"We had a Silver Customer ([Zendesk](https://gitlab.zendesk.com/agent/tickets/176158) - internal only) report that they started getting 404s on their Pages project, but it worked when copying in a new project.\n\nThat happened a few hours after the `pages_artifacts_archive` rollout percentage was increased.\n\n@ayufan turned off the feature flag and we were able to see the Pages again.\n\nRelevant [Slack thread](https://gitlab.slack.com/archives/C1BSEQ138/p1602582002162400?thread_ts=1602547809.159500\u0026cid=C1BSEQ138) (internal only)","state":"closed","created_at":"2020-10-13T10:01:55.835Z","updated_at":"2020-10-15T08:42:59.390Z","closed_at":"2020-10-15T08:42:58.914Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","customer","devops::release [DEPRECATED]","section::ops","type::bug","workflow::in dev"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https://about.gitlab.com/releases/2020/10/22/gitlab-13-5-released/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/52"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"}],"author":{"id":4375373,"username":"cat","name":"Catalin Irimie","state":"active","avatar_url":"https://secure.gravatar.com/avatar/fd4f68fe3a123d56ac4413dc960b7559?s=80\u0026d=identicon","web_url":"https://gitlab.com/cat"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/482","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/482","notes":"https://gitlab.com/api/v4/projects/734943/issues/482/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/482/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#482","relative":"#482","full":"gitlab-org/gitlab-pages#482"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"/groups/gitlab-org/-/epics/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":72614208,"iid":481,"project_id":734943,"title":"Improve zip cache refreshing for the same domain","description":"We open a bunch of archives each minute: https://prometheus-app.gprd.gitlab.net/graph?g0.range_input=1h\u0026g0.expr=increase(gitlab_pages_zip_opened%5B5m%5D)\u0026g0.tab=0\n\nFrom slack: https://gitlab.slack.com/archives/C1BSEQ138/p1602144418115300\n\n```\nkamil Oct 8th at 7:06 PM\n@jaime I think we are done with LRU for time being. Maybe next get archive refresh to be working?\n4 replies\n\nkamil  5 days ago\nLooking at this graph it appears that we open a bunch of archives each minute: https://prometheus-app.gprd.gitlab.net/graph?g0.range_input=1h\u0026g0.expr=increase(gitlab_pages_zip_opened%5B5m%5D)\u0026g0.tab=0\n\njaime  1 day ago\ndo you mean we‚Äôre refreshing too often?\n\nkamil  22 hours ago\nYes, we each time we refresh the domain via API a new URL is being returned due to changed auth params. This means that we reload each accessed archive every minute. (edited) \n\nkamil  22 hours ago\nDue to caching, holding 2-3 archives for a given domain at a single time.\n```","state":"closed","created_at":"2020-10-13T05:42:39.952Z","updated_at":"2021-10-28T14:05:58.604Z","closed_at":"2020-11-10T11:20:40.500Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":1233755,"iid":53,"group_id":9970,"title":"13.6","description":"https://about.gitlab.com/releases/2020/11/22/gitlab-13-6-released/","state":"closed","created_at":"2020-04-09T17:39:22.328Z","updated_at":"2022-04-13T14:51:04.376Z","due_date":"2020-11-17","start_date":"2020-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/53"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"user_notes_count":20,"merge_requests_count":2,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/481","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/481","notes":"https://gitlab.com/api/v4/projects/734943/issues/481/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/481/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#481","relative":"#481","full":"gitlab-org/gitlab-pages#481"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4659,"epic":{"id":129623,"iid":4659,"title":"Finalize Pages on zip architecture for rollout to gitlab.com","url":"/groups/gitlab-org/-/epics/4659","group_id":9970,"human_readable_end_date":"Dec 22, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":72377135,"iid":477,"project_id":734943,"title":"Add vfs type to access log","description":"From [slack comment](https://gitlab.slack.com/archives/C1BSEQ138/p1602147615122100?thread_ts=1602147179.119100\u0026cid=C1BSEQ138):\n\u003e I also think that it would be helpful for us to extend kibana logs with information on how the file was served (if it was ZIP), so we could ELK grep logs and find unique domains being served.","state":"closed","created_at":"2020-10-08T09:18:48.703Z","updated_at":"2020-10-13T11:13:12.987Z","closed_at":"2020-10-13T11:13:12.930Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","section::ops"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https://about.gitlab.com/releases/2020/10/22/gitlab-13-5-released/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/52"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/477","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/477","notes":"https://gitlab.com/api/v4/projects/734943/issues/477/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/477/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#477","relative":"#477","full":"gitlab-org/gitlab-pages#477"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"/groups/gitlab-org/-/epics/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":71929438,"iid":474,"project_id":734943,"title":"Cache `Readlink` data","description":"Currently `Readlink` is evaluated each time. Similarly to [`cacheOffset`](https://gitlab.com/gitlab-org/gitlab-pages/-/issues/461) we should cache symlinks as well.\n\nTo ensure that `Readlink` is processed in a predictable time, using minimal amount of requests, especially that in some cases we need to perform symlink traversal.","state":"closed","created_at":"2020-09-30T09:26:49.550Z","updated_at":"2020-10-14T18:52:10.394Z","closed_at":"2020-10-07T00:20:15.071Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Pages::Object Storage","bug::performance","cicd::active","devops::release [DEPRECATED]","section::ops","type::feature","workflow::in dev"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https://about.gitlab.com/releases/2020/10/22/gitlab-13-5-released/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/52"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/474","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/474","notes":"https://gitlab.com/api/v4/projects/734943/issues/474/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/474/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#474","relative":"#474","full":"gitlab-org/gitlab-pages#474"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"/groups/gitlab-org/-/epics/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":71907954,"iid":473,"project_id":734943,"title":"Improve tooling for local Golang development","description":"Local development is not friendly for Go newcomers, decreasing the likelihood of ~\"Community contribution\"s\n\n- Since go modules was introduced, `make setup` fails trying to remove `.GOPATH/`. $GOPATH is not needed anymore so we should remove this\n\n```sh\n$ make setup\n\nrm: .GOPATH:\n...\nrm: .GOPATH/pkg/mod/sourcegraph.com/sqs/pbtypes@v0.0.0-20180604144634-d3ebe8f20ae4/void.pb.go: Permission denied\n```\n\n- `make lint` fails with `ERRO Running error: context loading failed: no go files to analyze`\n- Add `make format` for people that run into linter issues , e.g. https://gitlab.com/gitlab-org/gitlab-pages/-/jobs/764364111","state":"closed","created_at":"2020-09-30T02:19:12.835Z","updated_at":"2021-10-28T14:06:36.250Z","closed_at":"2021-04-30T00:49:35.491Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/473","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/473","notes":"https://gitlab.com/api/v4/projects/734943/issues/473/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/473/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#473","relative":"#473","full":"gitlab-org/gitlab-pages#473"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":71658480,"iid":469,"project_id":734943,"title":"Negative cache errored zip archives","description":"Having two intervals:\n\n* positive cache: long-time cache, likely prolonged\n* negative cache: short-time cache, likely not prolonged\n\n---\nThe following discussion from !351 should be addressed:\n\n- [ ] @ayufan started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/351#note_418261431): \n\n    \u003e I believe that we have a TODO item: Should we cache an archive that cannot be read for a long period? Aka. negative cache.\n    \u003e \n    \u003e This works very well for positive cache, but also makes us to cache negative cache (errored archive forever).","state":"closed","created_at":"2020-09-25T02:21:21.568Z","updated_at":"2021-10-28T14:06:47.441Z","closed_at":"2020-10-29T10:15:56.074Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":1233755,"iid":53,"group_id":9970,"title":"13.6","description":"https://about.gitlab.com/releases/2020/11/22/gitlab-13-6-released/","state":"closed","created_at":"2020-04-09T17:39:22.328Z","updated_at":"2022-04-13T14:51:04.376Z","due_date":"2020-11-17","start_date":"2020-10-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/53"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":17,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/469","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/469","notes":"https://gitlab.com/api/v4/projects/734943/issues/469/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/469/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#469","relative":"#469","full":"gitlab-org/gitlab-pages#469"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4659,"epic":{"id":129623,"iid":4659,"title":"Finalize Pages on zip architecture for rollout to gitlab.com","url":"/groups/gitlab-org/-/epics/4659","group_id":9970,"human_readable_end_date":"Dec 22, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":71443472,"iid":468,"project_id":734943,"title":"Ignore `@ hashed` directory when performing disk scan.","description":"In https://gitlab.com/gitlab-org/gitlab/-/merge_requests/42461 we store zipped pages site version on the same top directory as other pages content. But add `@hashed` to avoid name collision with namespaces.\n\nIIRC pages currently recusively scans all subdirectories in `shared/pages`, so we need exclude `shared/pages/@hashed`.\n\nIt may sound irrelevant for .com, since we disabled this disk scan completely. But it's not true for self-managed instances, and once we [enable feature flag responsible for creating pages deployments](https://gitlab.com/gitlab-org/gitlab/-/issues/245308) this directory will appear on self-managed. This may create performance problem and maybe some security risks(unlikely though).\n\nBut maybe pages will just not find `config.json` file there and ignore this directory automatically, but that's need to be tested. :shrug:","state":"closed","created_at":"2020-09-21T11:54:45.704Z","updated_at":"2020-10-14T18:46:10.160Z","closed_at":"2020-09-29T09:19:48.797Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","[deprecated] low hanging fruit","backend","devops::release [DEPRECATED]","section::ops","type::feature","workflow::in review"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https://about.gitlab.com/releases/2020/10/22/gitlab-13-5-released/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/52"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":2,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/468","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/468","notes":"https://gitlab.com/api/v4/projects/734943/issues/468/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/468/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#468","relative":"#468","full":"gitlab-org/gitlab-pages#468"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3906,"epic":{"id":81057,"iid":3906,"title":"Deploy pages zip archives to object storage/local storage when pages are deployed","url":"/groups/gitlab-org/-/epics/3906","group_id":9970,"human_readable_end_date":"Nov 17, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":71430811,"iid":466,"project_id":734943,"title":"Handle extra headers when serving from compressed zip archive","description":"Handle some missing headers lost functionality by using `io.Copy` instead of `http.ServeContent`.\n\nGo src for [`http.ServeContent`](https://github.com/golang/go/blob/ef20f76b8bc4e082d5f81fd818890d707751475b/src/net/http/fs.go#L130) as reference.\n\n## Proposal\n\n1. Handle request headers:\n- If-Match\n- If-Unmodified-Since\n- If-None-Match\n- If-Modified-Since\n- ~~If-Range~~ can't use this header with compressed files\n\n2. Set in response header:\n- Last-Modified\n\n~\"backend-weight::2\" \n---\nThe following discussion from !348 should be addressed:\n\n- [ ] @vshushlin started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/348#note_415122700):  (+2 comments)\n\n    \u003e **Question:** from `ServeContent` docs:\n    \u003e \n    \u003e \u003e ...sets the MIME type, and handles If-Match, If-Unmodified-Since, If-None-Match, If-Modified-Since...\n    \u003e \n    \u003e Do we plan to reimplement MIME types and modified-since logic? Do we need follow up issues for them?","state":"closed","created_at":"2020-09-21T07:45:04.405Z","updated_at":"2021-11-16T01:16:53.129Z","closed_at":"2021-11-16T01:16:53.035Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Next Up","Pages::Object Storage","backend","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":9,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/466","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/466","notes":"https://gitlab.com/api/v4/projects/734943/issues/466/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/466/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#466","relative":"#466","full":"gitlab-org/gitlab-pages#466"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6729,"epic":{"id":346861,"iid":6729,"title":"Make GitLab Pages more resilient","url":"/groups/gitlab-org/-/epics/6729","group_id":9970,"human_readable_end_date":"Oct 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":71425929,"iid":465,"project_id":734943,"title":"Implement zip cache callbacks","description":"The following discussion from !351 should be addressed:\n\n- [ ] @ayufan started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/351#note_414831416): \n\n    \u003e As a follow-up maybe we would have \"a kind of callback\" on `zipArchive`?\n    \u003e \n    \u003e ```golang\n    \u003e func (z *zipArchive) onCacheAdded() {}\n    \u003e func (z *zipArchive) onCacheRefreshed() {}\n    \u003e func (z *zipArchive) onCacheEvicted() {}\n    \u003e ```\n    \u003e \n    \u003e We would simply call these methods on these points, and they could update metrics on a will, assuming that if you ever call `onCacheAdded()` the `onCacheEvicted()` will be called as well.\n\nAnd implement tests https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/351#note_418262162","state":"closed","created_at":"2020-09-21T05:08:55.944Z","updated_at":"2020-10-08T01:22:45.219Z","closed_at":"2020-10-08T01:22:45.147Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","feature::addition","section::ops","type::feature","workflow::ready for development"],"milestone":{"id":427855,"iid":11,"group_id":9970,"title":"Next 4-7 releases","description":"Bigger issues we plan to ship in the next 4-7 releases, but don't have a designated release yet. \r\n\r\nDO NOT add small changes, bugs, regressions to this milestone.","state":"active","created_at":"2017-12-11T16:26:55.828Z","updated_at":"2018-08-17T11:09:43.594Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/11"},"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/465","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/465","notes":"https://gitlab.com/api/v4/projects/734943/issues/465/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/465/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#465","relative":"#465","full":"gitlab-org/gitlab-pages#465"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"/groups/gitlab-org/-/epics/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":71425440,"iid":464,"project_id":734943,"title":"Make zip cache configurable","description":"A simple in-memory cache was introduced in https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/351 and https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/364 with some hard-coded values. These should be configurable.\n\n## Proposal\n\n* Add configuration changes flag to Pages\n  - Add a zipCacheConfig type and flags:\n  - `zip-cache-expiration`\n  - `zip-cache-cleanup`\n  - `zip-cache-refresh`\n  - `zip-open-timeout`\n  - ~~`zip-cache-dataoffset-size`~~\n  - ~~`zip-cache-dataoffset-prune-count`~~\n  - ~~`zip-cache-readlink-size`~~\n  - ~~`zip-cache-readlink-prune-count`~~\n* Add documentation\n* Add flag to omnibus\n\n---\nThe following discussion from !351 should be addressed:\n\n- [ ] @jaime started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/351#note_414788991):  (+2 comments)\n\n    \u003e **question**: are these values good enough? Should we make them configurable in future iterations?","state":"closed","created_at":"2020-09-21T04:42:24.962Z","updated_at":"2021-10-28T14:06:57.733Z","closed_at":"2020-12-06T22:15:43.081Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Next::1-3 releases","Pages::Object Storage","devops::release [DEPRECATED]","group::release [DEPRECATED]","release post item::secondary","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":1233757,"iid":54,"group_id":9970,"title":"13.7","description":"https://about.gitlab.com/releases/archives.html","state":"closed","created_at":"2020-04-09T17:43:14.893Z","updated_at":"2022-04-13T14:51:12.240Z","due_date":"2020-12-17","start_date":"2020-11-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/54"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":17,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/464","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/464","notes":"https://gitlab.com/api/v4/projects/734943/issues/464/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/464/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#464","relative":"#464","full":"gitlab-org/gitlab-pages#464"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"/groups/gitlab-org/-/epics/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":71182750,"iid":461,"project_id":734943,"title":"Cache dataOffset and symlink when requesting zip files","description":"Currently `Readlink` and `dataOffset` are evaluated each time, we should cache them to lower the latency when serving from zip.\n\nTo ensure that `Readlink` is processed in a predictable time, using minimal amount of requests, especially that in some cases we need to perform symlink traversal.\n\n---\n\nThe following discussion from !348 should be addressed:\n\n- [ ] @ayufan started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/348#note_412690978): \n\n    \u003e I wish that we would cache `dataOffset`, since the `file.DataOffset()` each time makes us to fire additional request.","state":"closed","created_at":"2020-09-15T08:07:27.075Z","updated_at":"2020-10-13T16:36:03.168Z","closed_at":"2020-10-13T16:36:03.133Z","closed_by":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","maintenance::refactor","section::ops","workflow::in review"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https://about.gitlab.com/releases/2020/10/22/gitlab-13-5-released/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/52"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"user_notes_count":19,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/461","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/461","notes":"https://gitlab.com/api/v4/projects/734943/issues/461/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/461/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#461","relative":"#461","full":"gitlab-org/gitlab-pages#461"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"/groups/gitlab-org/-/epics/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":70849987,"iid":457,"project_id":734943,"title":"Make httprange http client configurable","description":"In https://gitlab.com/gitlab-org/gitlab-pages/-/issues/448 we introduced an `httprange` package that can download artifacts and support reading ranges from the response body. The `httpClient` used has a hardcoded timeout which should be configurable.\n\nWe should either pass an httpClient when initializing a resource or some config flags\n\n## Proposal\n\n- Add configuration changes flag to Pages\n- Add documentation\n- Add flag to omnibus\n- Add flag to charts\n\n---\nThe following discussion from !333 should be addressed:\n\n- [ ] @vshushlin started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/333#note_408522039): \n\n    \u003e Do we already have an issue for that? Can we add a link?","state":"closed","created_at":"2020-09-08T02:15:41.257Z","updated_at":"2022-03-30T04:53:29.712Z","closed_at":"2022-03-30T04:53:29.613Z","closed_by":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"labels":["Category:Pages","Next::1-3 releases","Pages::Object Storage","backend","devops::create","group::editor","section::dev","type::maintenance"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/72"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/10764887/avatar.png","web_url":"https://gitlab.com/vtak"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/457","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/457","notes":"https://gitlab.com/api/v4/projects/734943/issues/457/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/457/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#457","relative":"#457","full":"gitlab-org/gitlab-pages#457"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"/groups/gitlab-org/-/epics/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":70848619,"iid":456,"project_id":734943,"title":"Use versioned templates for security scanners","description":"Some security templates keep changing and they break our pipelines when they are merged to the default branch. We should use a versioned template pointing to a stable branch, e.g.\n\n```yaml\ninclue:\n  - https://gitlab.com/gitlab-org/gitlab/-/raw/13-3-stable-ee/lib/gitlab/ci/templates/Security/Dependency-Scanning.gitlab-ci.yml\n```\n\n---\nThe following discussion from !343 should be addressed:\n\n- [ ] @jaime started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/343#note_408774219): \n\n    \u003e We should use versioned templates","state":"closed","created_at":"2020-09-08T01:18:31.804Z","updated_at":"2021-10-28T14:07:55.348Z","closed_at":"2021-05-31T02:24:00.814Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/456","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/456","notes":"https://gitlab.com/api/v4/projects/734943/issues/456/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/456/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#456","relative":"#456","full":"gitlab-org/gitlab-pages#456"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":70685400,"iid":453,"project_id":734943,"title":"TestClientStatusClientTimeout flaky","description":"https://gitlab.com/gitlab-org/gitlab-pages/-/jobs/718191293\n\n```\n=== RUN   TestClientStatusClientTimeout\n    client_test.go:303: \n        \tError Trace:\tclient_test.go:303\n        \tError:      \t\"failed to connect to internal Pages API: Get \"http://127.0.0.1:42673/api/v4/internal/pages/status\": context deadline exceeded\" does not contain \"Client.Timeout\"\n        \tTest:       \tTestClientStatusClientTimeout\n--- FAIL: TestClientStatusClientTimeout (0.06s)\n```","state":"closed","created_at":"2020-09-03T13:08:04.247Z","updated_at":"2022-05-31T12:46:48.638Z","closed_at":"2020-09-03T14:15:29.134Z","closed_by":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"labels":["Category:Pages","Pages::Object Storage","devops::data stores","group::application performance","maintenance::refactor","section::enablement"],"milestone":{"id":1233753,"iid":51,"group_id":9970,"title":"13.4","description":"https://about.gitlab.com/releases/2020/09/22/gitlab-13-4-released/","state":"closed","created_at":"2020-04-09T17:39:21.662Z","updated_at":"2022-04-13T14:50:33.769Z","due_date":"2020-09-17","start_date":"2020-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/51"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/453","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/453","notes":"https://gitlab.com/api/v4/projects/734943/issues/453/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/453/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#453","relative":"#453","full":"gitlab-org/gitlab-pages#453"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":70194664,"iid":449,"project_id":734943,"title":"Remove GitLab API internal polling","description":"Remove polling from Pages implemented in gitlab-pages!304 (merged)","state":"closed","created_at":"2020-08-24T05:44:59.085Z","updated_at":"2021-08-19T05:21:26.715Z","closed_at":"2021-08-19T05:21:26.324Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Next::4-7 releases","Pages::Object Storage","[deprecated] low hanging fruit","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/449","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/449","notes":"https://gitlab.com/api/v4/projects/734943/issues/449/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/449/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#449","relative":"#449","full":"gitlab-org/gitlab-pages#449"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6514,"epic":{"id":320001,"iid":6514,"title":"GitLab Pages Post Re-Architecture Cleanup \u0026 Improvements","url":"/groups/gitlab-org/-/epics/6514","group_id":9970},"iteration":null,"health_status":null},{"id":70178333,"iid":448,"project_id":734943,"title":"Create an `httprange` package to allow loading content from object storage","description":"Source https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/326/diffs#c697a55849ad2b6da28d7b6de7e8effd7860e40b\n\n- `http_range` should create resources that can be read in chunks from a pre-signed URL\n- Add metrics and traceln","state":"closed","created_at":"2020-08-24T01:28:39.390Z","updated_at":"2020-09-16T11:49:35.011Z","closed_at":"2020-09-15T23:58:26.787Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","section::ops","workflow::in review"],"milestone":{"id":1233753,"iid":51,"group_id":9970,"title":"13.4","description":"https://about.gitlab.com/releases/2020/09/22/gitlab-13-4-released/","state":"closed","created_at":"2020-04-09T17:39:21.662Z","updated_at":"2022-04-13T14:50:33.769Z","due_date":"2020-09-17","start_date":"2020-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/51"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":25,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/448","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/448","notes":"https://gitlab.com/api/v4/projects/734943/issues/448/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/448/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#448","relative":"#448","full":"gitlab-org/gitlab-pages#448"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"/groups/gitlab-org/-/epics/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":70174536,"iid":447,"project_id":734943,"title":"Support range requests for zip","description":"PoC https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/331\n\nDepends on https://gitlab.com/gitlab-org/gitlab-pages/-/issues/448\n\n- Define a `SeekableFile` interface\n- Extend zip http reader to support range requests","state":"closed","created_at":"2020-08-24T01:00:09.452Z","updated_at":"2020-10-16T01:52:43.455Z","closed_at":"2020-10-15T05:33:16.472Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","section::ops","workflow::production"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https://about.gitlab.com/releases/2020/10/22/gitlab-13-5-released/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/52"},"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/447","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/447","notes":"https://gitlab.com/api/v4/projects/734943/issues/447/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/447/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#447","relative":"#447","full":"gitlab-org/gitlab-pages#447"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4256,"epic":{"id":99191,"iid":4256,"title":"Support range requests in pages ZIP object storage architecture","url":"/groups/gitlab-org/-/epics/4256","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":70053993,"iid":446,"project_id":734943,"title":"Abstract `VFS` `Root`","description":"Currently, pages assumes that projects are located in subdirectories `pages_dir/group/subgroup/project/public/index.html`. While in the zip object storage VFS will just have `/public/index.html` in the archive structure.\n\nBased on the work in https://gitlab.com/gitlab-org/gitlab-pages/-/issues/439 we want to abstract some kind of `Root directory` for the project. It will allow us to implement zip serving much easier.","state":"closed","created_at":"2020-08-20T08:14:55.998Z","updated_at":"2020-09-10T14:40:17.502Z","closed_at":"2020-09-10T14:40:17.451Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","section::ops","workflow::verification"],"milestone":{"id":1233753,"iid":51,"group_id":9970,"title":"13.4","description":"https://about.gitlab.com/releases/2020/09/22/gitlab-13-4-released/","state":"closed","created_at":"2020-04-09T17:39:21.662Z","updated_at":"2022-04-13T14:50:33.769Z","due_date":"2020-09-17","start_date":"2020-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/51"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/446","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/446","notes":"https://gitlab.com/api/v4/projects/734943/issues/446/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/446/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#446","relative":"#446","full":"gitlab-org/gitlab-pages#446"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"/groups/gitlab-org/-/epics/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":69757262,"iid":444,"project_id":734943,"title":"Support VFS serving from LookupPath","description":"- Add a `VFS` type to `LookupPath`\n- Extend the serving `Reader` to hold a map of `VFS`'s\n- Resolve file contents using the specified `VFS`\n\nMR https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/329/diffs","state":"closed","created_at":"2020-08-12T10:56:19.871Z","updated_at":"2020-09-04T01:23:06.219Z","closed_at":"2020-09-04T01:23:06.171Z","closed_by":{"id":5622641,"username":"nicolewilliams","name":"Nicole Williams","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5622641/avatar.png","web_url":"https://gitlab.com/nicolewilliams"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","section::ops","workflow::in dev"],"milestone":{"id":1233753,"iid":51,"group_id":9970,"title":"13.4","description":"https://about.gitlab.com/releases/2020/09/22/gitlab-13-4-released/","state":"closed","created_at":"2020-04-09T17:39:21.662Z","updated_at":"2022-04-13T14:50:33.769Z","due_date":"2020-09-17","start_date":"2020-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/51"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci≈Ñski","state":"active","avatar_url":"https://secure.gravatar.com/avatar/7a285e30f35d72526fb0954e8fe7cefa?s=80\u0026d=identicon","web_url":"https://gitlab.com/ayufan"},"user_notes_count":11,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/444","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/444","notes":"https://gitlab.com/api/v4/projects/734943/issues/444/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/444/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#444","relative":"#444","full":"gitlab-org/gitlab-pages#444"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"/groups/gitlab-org/-/epics/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":69757192,"iid":443,"project_id":734943,"title":"VFS implementation for zip archives","description":"Add `zip` implementation of the VFS interface introduced in https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/324 and !325.\n\nDepends on https://gitlab.com/gitlab-org/gitlab-pages/-/issues/446 and https://gitlab.com/gitlab-org/gitlab-pages/-/issues/448.\n\n- Add a `zip` package that opens archives using `http_range` - source https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/326/diffs#f0eb7ce2a638003d1f5dd027e9b5ce3aa44355e7_0_1\n- Implement the `VFS` interface - source https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/326/diffs#21487386d5527c7631ac241c03fb0400516c3839_0_1\n- Update metrics acceptance tests for `TestPrometheusMetricsCanBeScraped`","state":"closed","created_at":"2020-08-12T10:53:57.104Z","updated_at":"2020-10-18T07:09:31.438Z","closed_at":"2020-09-30T01:21:36.284Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Deliverable","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","section::ops","workflow::production"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https://about.gitlab.com/releases/2020/10/22/gitlab-13-5-released/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/52"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":38,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/443","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/443","notes":"https://gitlab.com/api/v4/projects/734943/issues/443/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/443/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#443","relative":"#443","full":"gitlab-org/gitlab-pages#443"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"/groups/gitlab-org/-/epics/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":69101016,"iid":436,"project_id":734943,"title":"Fix intermittent cache test failures","description":"Job [#658818771](https://gitlab.com/gitlab-org/gitlab-pages/-/jobs/658818771) failed for 43f724fe2886e07cd97799ff0a14a3b98a239ec3:\n\n```plaintext\n    --- FAIL: TestResolve/when_retrieval_failed_because_of_resolution_context_being_canceled (0.00s)\n        cache_test.go:264: \n            \tError Trace:\tcache_test.go:264\n            \t            \t\t\t\tcache_test.go:113\n            \t            \t\t\t\tcache_test.go:253\n            \t            \t\t\t\tcache_test.go:93\n            \t            \t\t\t\tcache_test.go:252\n            \tError:      \tAn error is expected but got nil.\n            \tTest:       \tTestResolve/when_retrieval_failed_because_of_resolution_context_being_canceled\n```\n\nAnother job https://gitlab.com/gitlab-org/gitlab-pages/-/jobs/658818891\n\n```plaintext\n=== RUN   TestResolve/when_item_is_in_long_cache_only\n    cache_test.go:207: \n        \tError Trace:\tcache_test.go:207\n        \t            \t\t\t\tcache_test.go:113\n        \t            \t\t\t\tcache_test.go:200\n        \t            \t\t\t\tcache_test.go:93\n        \t            \t\t\t\tcache_test.go:199\n        \tError:      \tNot equal: \n        \t            \texpected: 0x1\n        \t            \tactual  : 0x0\n        \tTest:       \tTestResolve/when_item_is_in_long_cache_only\n```\n\nRetrying a job fixes it https://gitlab.com/gitlab-org/gitlab-pages/-/jobs/658821575","state":"closed","created_at":"2020-07-28T04:49:05.917Z","updated_at":"2020-09-02T16:12:02.632Z","closed_at":"2020-09-02T08:21:26.283Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","cicd::active","devops::release [DEPRECATED]","maintenance::refactor","section::ops"],"milestone":{"id":1233753,"iid":51,"group_id":9970,"title":"13.4","description":"https://about.gitlab.com/releases/2020/09/22/gitlab-13-4-released/","state":"closed","created_at":"2020-04-09T17:39:21.662Z","updated_at":"2022-04-13T14:50:33.769Z","due_date":"2020-09-17","start_date":"2020-08-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/51"},"assignees":[{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/263716/avatar.jpeg","web_url":"https://gitlab.com/grzesiek"},{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/263716/avatar.jpeg","web_url":"https://gitlab.com/grzesiek"},"user_notes_count":21,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/436","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/436","notes":"https://gitlab.com/api/v4/projects/734943/issues/436/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/436/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#436","relative":"#436","full":"gitlab-org/gitlab-pages#436"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":68932846,"iid":435,"project_id":734943,"title":"Use exponential back-off for polling status endpoint","description":"The following discussion from !304 should be addressed:\n\n- [ ] @jaime started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/304#note_382039256):  (+2 comments)\n\n    \u003e **question**: should we consider using an exponential back-off approach?\n    \u003e \n    \u003e Some sample library https://pkg.go.dev/github.com/cenkalti/backoff/v4?tab=doc#pkg-examples","state":"closed","created_at":"2020-07-24T05:33:13.660Z","updated_at":"2020-08-24T01:55:30.645Z","closed_at":"2020-08-10T10:26:34.639Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Deliverable","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","workflow::in review"],"milestone":{"id":1233752,"iid":50,"group_id":9970,"title":"13.3","description":"https://about.gitlab.com/releases/2020/08/22/gitlab-13-3-released/","state":"closed","created_at":"2020-04-09T17:39:21.090Z","updated_at":"2022-04-13T14:50:18.976Z","due_date":"2020-08-17","start_date":"2020-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/50"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":12,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/435","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/435","notes":"https://gitlab.com/api/v4/projects/734943/issues/435/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/435/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#435","relative":"#435","full":"gitlab-org/gitlab-pages#435"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4242,"epic":{"id":97712,"iid":4242,"title":"Move pages domain/project configuration to the API","url":"/groups/gitlab-org/-/epics/4242","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":59219708,"iid":434,"project_id":734943,"title":"Adopt zip package from workhorse","description":"Extracted from https://gitlab.com/gitlab-org/gitlab/-/issues/28784#note_375446009","state":"closed","created_at":"2020-07-15T13:28:56.899Z","updated_at":"2020-07-15T13:30:10.945Z","closed_at":"2020-07-15T13:30:10.915Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","devops::release [DEPRECATED]"],"milestone":null,"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/434","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/434","notes":"https://gitlab.com/api/v4/projects/734943/issues/434/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/434/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#434","relative":"#434","full":"gitlab-org/gitlab-pages#434"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":54558743,"iid":432,"project_id":734943,"title":"Preprocess zip archives on load and cache file structure","description":"Preprocess zip archive and cache relevant files:\n\n* cache only relevant list of files with references where to fetch them in an efficient way\n* cache into a `map` to have `O(logn)` search\n\nReference code https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/326/diffs#f0eb7ce2a638003d1f5dd027e9b5ce3aa44355e7_0_34\n\nDepends on https://gitlab.com/gitlab-org/gitlab-pages/-/issues/443\n\n### Considerations\n\nA noticeable change came up during the [profiler demo](https://gitlab.com/gitlab-com/gl-infra/scalability/-/issues/479#note_423617206) with ~\"team::Scalability\"  where we saw that `readArchive` is allocating a considerable amount of memory (about 28MB for the top 1%) for `docs.gitlab.com` alone in production. \n\n[Profiler on GCP](https://console.cloud.google.com/profiler;timespan=1h/gitlab-pages;type=HEAP/inuse_space?project=gitlab-production) (internal) \n\n![Screen_Shot_2020-10-08_at_3.21.17_pm](/uploads/6a0a161802a5c7b5d2c31b5dcbe4be06/Screen_Shot_2020-10-08_at_3.21.17_pm.png)\n\n[Allocated memory spike](https://prometheus-app.gprd.gitlab.net/graph?g0.range_input=1w\u0026g0.stacked=1\u0026g0.expr=max(go_memstats_alloc_bytes%7Binstance%3D~%22web-pages-.*%22%7D)\u0026g0.tab=0) after enabling Zip for 5% of Pages projects on 2020-10-08 ~12:30 UTC\n\n![Screen_Shot_2020-10-12_at_10.52.25_am](/uploads/36f50746826ed854b4d2a2019d6cbad9/Screen_Shot_2020-10-12_at_10.52.25_am.png)\n\n---\n\u003cdetails\u003e\n\u003csummary\u003eThe following discussion from !299 should be addressed:\n\u003c/summary\u003e\n- [ ] @ayufan started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/299#note_377210608): \n\n    \u003e Oh, yes, yes, yes. It would really help to convert a flat list into:\n    \u003e \n    \u003e - `map[string]zip.File`, ideally with `zip.File` having an `offset` as well\n    \u003e \n    \u003e And, drop all the ones that are not within `public/`\n\nCache flat list idea https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/299#note_377210617\n\u003c/details\u003e","state":"closed","created_at":"2020-07-12T23:41:30.593Z","updated_at":"2022-02-10T09:36:49.366Z","closed_at":"2022-02-10T09:36:49.338Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Next::4-7 releases","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":18,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/432","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/432","notes":"https://gitlab.com/api/v4/projects/734943/issues/432/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/432/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#432","relative":"#432","full":"gitlab-org/gitlab-pages#432"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"/groups/gitlab-org/-/epics/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":54062784,"iid":426,"project_id":734943,"title":"Tech Evaluation of supporting NFS in cloud native deployments as an alternative to object storage for Pages","description":"### Problem to solve \n\nSupport for object storage in Pages is currently looking to arrive early FY22.\n\nThis is impacting a few deployments to our `gitlab` helm chart:\n\n1. GitLab.com's [migration to Kubernetes](https://gitlab.com/groups/gitlab-com/gl-infra/-/epics/98) (multiple services depend upon Pages - including web and api services)\n1. A very large opportunity who requires Pages\n\nOne way to potentially solve this, is to introduce shared storage into our Kubernetes deployments.\n\n### Evaluation \n\n* [ ] Discuss feasibility of this idea with ~\"group::distribution\", ~infrastructure, and ~Quality \n* [ ] Ask large opportunity if they would be open to / capable of utilizing shared storage in their Kubernetes cluster\n* [ ] Implement Pages in the Helm chart and cloud native images (does not look like this is present today) - https://gitlab.com/gitlab-org/charts/gitlab/-/issues/37\n  * [ ] Add support for a shared `ReadWriteMany` PV across needed services (Pages, Sidekiq, API, and Web)\n* [ ] Run a 50k architecture load test on a cloud native deployment with Pages (will require utilizing something like Rook, Portworx, etc. to provide ReadWriteMany support)\n* [ ] Strongly consider utilizing this architecture on GitLab.com, so we can move forward with k8s migration/dogfooding, as well as confirm this Pages architecture works at scale before recommending to our customers\n* [ ] Launch official support for Pages in Helm charts using shared storage","state":"closed","created_at":"2020-07-07T20:59:11.915Z","updated_at":"2020-11-24T17:10:11.594Z","closed_at":"2020-09-10T20:07:19.106Z","closed_by":{"id":4905402,"username":"jreporter","name":"Jackie Porter","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4905402/avatar.png","web_url":"https://gitlab.com/jreporter"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","kubernetes-migration-blocker","section::ops","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[],"author":{"id":4905402,"username":"jreporter","name":"Jackie Porter","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4905402/avatar.png","web_url":"https://gitlab.com/jreporter"},"type":"ISSUE","assignee":null,"user_notes_count":26,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/426","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":7,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/426","notes":"https://gitlab.com/api/v4/projects/734943/issues/426/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/426/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#426","relative":"#426","full":"gitlab-org/gitlab-pages#426"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":1316,"epic":{"id":7325,"iid":1316,"title":"GitLab Pages Architecture Updates","url":"/groups/gitlab-org/-/epics/1316","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":53851171,"iid":423,"project_id":734943,"title":"Add metrics for zip serving","description":"Zip serving package implements the `type Serving interface`. We should add some metrics to serve from zip archives similar to https://gitlab.com/gitlab-org/gitlab-pages/-/issues/365 so that we can track and compare serving times from archives vs disk.\n\n- ZipServingOpenArchivesTotal\n- ZipServingFilesPerArchiveCount\n\nhttps://gitlab.slack.com/archives/C1BSEQ138/p1601113581019900\n\n\u003e I think we should for OS access have a histogram of timings of different request stages, like: connection, tls handshake, response write, response to the first byte, response read. This would allow us to understand how responsive is OS on different stages. (edited) \n\n\u003eAlso, for caches we should have hit/miss metric, and amount of cache entries :slightly_smiling_face:","state":"closed","created_at":"2020-07-03T01:22:15.708Z","updated_at":"2020-10-01T14:27:15.723Z","closed_at":"2020-10-01T08:55:11.234Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","section::ops","workflow::in review"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https://about.gitlab.com/releases/2020/10/22/gitlab-13-5-released/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/52"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":14,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/423","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/423","notes":"https://gitlab.com/api/v4/projects/734943/issues/423/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/423/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#423","relative":"#423","full":"gitlab-org/gitlab-pages#423"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"/groups/gitlab-org/-/epics/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":53850876,"iid":421,"project_id":734943,"title":"Tech Evaluation: Extract the Reader logic from disk serving into its own package so it can be reused","description":"Serving from disk uses the [`type Reader struct`](https://gitlab.com/gitlab-org/gitlab-pages/-/blob/master/internal/serving/disk/reader.go#L19) to try to find and resolve paths from the file system structure. \n\nThis logic can be reused to serve content from zip archives https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/299/diffs#580d90130ae2083bae1a5eda81a8947e0b57d443_0_51","state":"closed","created_at":"2020-07-03T01:04:41.782Z","updated_at":"2020-08-06T17:55:38.851Z","closed_at":"2020-08-06T17:53:33.294Z","closed_by":{"id":5622641,"username":"nicolewilliams","name":"Nicole Williams","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/5622641/avatar.png","web_url":"https://gitlab.com/nicolewilliams"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","workflow::in dev"],"milestone":{"id":1233752,"iid":50,"group_id":9970,"title":"13.3","description":"https://about.gitlab.com/releases/2020/08/22/gitlab-13-3-released/","state":"closed","created_at":"2020-04-09T17:39:21.090Z","updated_at":"2022-04-13T14:50:18.976Z","due_date":"2020-08-17","start_date":"2020-07-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/50"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":18,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/421","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/421","notes":"https://gitlab.com/api/v4/projects/734943/issues/421/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/421/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#421","relative":"#421","full":"gitlab-org/gitlab-pages#421"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3908,"epic":{"id":81060,"iid":3908,"title":"Object storage for GitLab Pages (golang side/zip version)","url":"/groups/gitlab-org/-/epics/3908","group_id":9970,"human_readable_end_date":"Aug 17, 2020","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null},{"id":35363254,"iid":403,"project_id":734943,"title":"root config contains unknown keys: license_management","description":"Pipeline failed `root config contains unknown keys: license_management`\n\nhttps://gitlab.com/gitlab-org/gitlab-pages/pipelines/152290252\n\n`license_management` has been deprecated https://gitlab.com/gitlab-org/gitlab/-/issues/14624\n\nWe need to update to `license_scanning`","state":"closed","created_at":"2020-06-03T07:09:06.761Z","updated_at":"2020-06-03T07:25:41.809Z","closed_at":"2020-06-03T07:15:43.346Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Stuff that should Just Work","devops::release [DEPRECATED]"],"milestone":null,"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/403","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/403","notes":"https://gitlab.com/api/v4/projects/734943/issues/403/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/403/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#403","relative":"#403","full":"gitlab-org/gitlab-pages#403"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":35168405,"iid":400,"project_id":734943,"title":"Remove eslint sast","description":"For some reason, eslint-sast decided that we need it, and now pipeline is passed with warnings :see_no_evil:\n\nhttps://gitlab.com/gitlab-org/gitlab-pages/pipelines/150886980","state":"closed","created_at":"2020-05-29T11:57:49.820Z","updated_at":"2020-06-01T10:39:50.763Z","closed_at":"2020-06-01T10:39:50.696Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Stuff that should Just Work","backend","backstage [DEPRECATED]","devops::release [DEPRECATED]"],"milestone":{"id":1112145,"iid":47,"group_id":9970,"title":"13.1","description":"","state":"closed","created_at":"2020-01-03T12:28:30.160Z","updated_at":"2020-10-08T12:01:07.361Z","due_date":"2020-06-17","start_date":"2020-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/47"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":2,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/400","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/400","notes":"https://gitlab.com/api/v4/projects/734943/issues/400/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/400/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#400","relative":"#400","full":"gitlab-org/gitlab-pages#400"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34952382,"iid":395,"project_id":734943,"title":"Keep track of dev dependencies in go.mod","description":"When running `make setup`, the dev tools will be installed into the project's local `.GOPATH`. However, this overwrites the `go.mod` and `go.sum` files with a reference to those tools. The `make deps-check` rule will fail **If the changes are committed by mistake**.\n\nUsing a `tools.go` file is a common pattern to keep track of dev dependencies inside the `go.mod` file.\n\nThe [release-cli tools.go](https://gitlab.com/gitlab-org/release-cli/-/blob/master/cmd/release-cli/tools.go) has an example of how to do it. We also reference https://marcofranssen.nl/manage-go-tools-via-go-modules/:\n\n\u003e To ensure my tool dependencies are not removed and can leverage the Go Modules, I create a file tools.go. In this file I will list all my tool dependencies using an import statement.\n\nTo do:\n\n- Add a file called `tools.go` to the root directory and add the dev/tool dependencies.\n- `make deps-check` will add an entry to `go.mod`, consider version locking to a desired release.\n- Commit the changes.","state":"closed","created_at":"2020-05-25T02:07:10.975Z","updated_at":"2021-10-28T14:11:26.046Z","closed_at":"2021-07-29T01:46:39.663Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","backend","backstage [DEPRECATED]","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":2,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/395","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/395","notes":"https://gitlab.com/api/v4/projects/734943/issues/395/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/395/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#395","relative":"#395","full":"gitlab-org/gitlab-pages#395"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34867840,"iid":394,"project_id":734943,"title":"SAST scanning fails intermittently","description":"Example of a job where the SAST scanning fails\n\nJob [#562578827](https://gitlab.com/gitlab-org/gitlab-pages/-/jobs/562578827) failed for 98c479549ef6e4017fa052a4d5f19535e70b6d2e:\n\n```\ndocker: error during connect: Post http://docker:2375/v1.40/containers/create: dial tcp: lookup docker on 169.254.169.254:53: no such host.\n```\n\nFrom [Slack thread](https://gitlab.slack.com/archives/CETG54GQ0/p1590023829443200)\n\n\u003e @fcatteau license-scanning works fine so this might be related to sast, and in that case the legacy SAST orchestrator (Docker-in-Docker)\n\n\u003eby the way, the CI configuration implicitly enables the Docker-in-Docker orchestrator for SAST even though the no-DinD is now the default\nhttps://gitlab.com/gitlab-org/security/gitlab-pages/-/blob/master/.gitlab-ci.yml#L63\nsee https://gitlab.com/gitlab-org/gitlab/-/issues/218541\n\n\u003ethe important difference between sast and license-scanning is that the former explicitly calls docker run whereas the latter sets the image.name in its job definition. this might explain why License Scanning works. I'm able to pull registry.gitlab.com/gitlab-org/security-products/sast:2 though\n\n\u003e  I suggest you override the rules of the *-sast jobs triggered for this project, and don't override sast anymore. could you try that in a MR? also, I suggest you share this with #g_secure-static-analysis\n\n\u003e actually you only need to override secrets-sast and gosec-sast . see https://gitlab.com/gitlab-org/security/gitlab-pages/-/jobs/548248714#L192","state":"closed","created_at":"2020-05-22T02:10:55.273Z","updated_at":"2020-05-29T06:45:20.817Z","closed_at":"2020-05-25T15:53:40.340Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","Stuff that should Just Work","cicd::active","devops::release [DEPRECATED]","security reports","type::bug","workflow::in review"],"milestone":{"id":1112145,"iid":47,"group_id":9970,"title":"13.1","description":"","state":"closed","created_at":"2020-01-03T12:28:30.160Z","updated_at":"2020-10-08T12:01:07.361Z","due_date":"2020-06-17","start_date":"2020-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/47"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":13,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/394","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/394","notes":"https://gitlab.com/api/v4/projects/734943/issues/394/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/394/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#394","relative":"#394","full":"gitlab-org/gitlab-pages#394"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34789512,"iid":393,"project_id":734943,"title":"Add Dangerbot to Pages","description":"Pages does not currently have a Dangerbot and therefore does not suggest reviewers for MRs. In theory any engineer working on Golang should be able to do reviews, so there would be a large pool of reviewers.\n\nThe maintainer pool in Pages is quite small presently, but this is [being worked on](https://gitlab.com/gitlab-com/www-gitlab-com/-/issues/7701), with the intention of developing more maintainers within ~\"group::release\".\n\nAdditional reviewers would be added to `team.yml`\n\n```yml\n  projects:\n    gitlab-pages: reviewer\n```","state":"closed","created_at":"2020-05-20T07:56:14.188Z","updated_at":"2022-04-14T08:06:03.049Z","closed_at":"2022-04-14T08:06:02.375Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","backend","backstage [DEPRECATED]","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::ready for development"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/72"},"assignees":[{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"}],"author":{"id":4391348,"username":"sean_carroll","name":"Sean Carroll","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4391348/avatar.png","web_url":"https://gitlab.com/sean_carroll"},"type":"ISSUE","assignee":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"user_notes_count":26,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/393","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/393","notes":"https://gitlab.com/api/v4/projects/734943/issues/393/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/393/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#393","relative":"#393","full":"gitlab-org/gitlab-pages#393"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34562513,"iid":391,"project_id":734943,"title":"Tech Evaluation for option B of Serve custom 404.html file for namespace domains","description":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/183\n\nOpen the research issue for implementing the approach `B` and prioritize it. It's really tricky to implement and basically only `custom 404s for namespace level projects, e.g. username.gitlab.io` are broken, they are not broken on custom domains or on `username.gitlab.io/myprojectname`.\n\nTasks\n\n* [ ]  Update proposal for linked issue ","state":"closed","created_at":"2020-05-14T15:09:28.045Z","updated_at":"2020-07-13T12:34:37.216Z","closed_at":"2020-07-13T12:34:36.925Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","cicd::active","devops::release [DEPRECATED]","feature flag","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/14"},"assignees":[],"author":{"id":4905402,"username":"jreporter","name":"Jackie Porter","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4905402/avatar.png","web_url":"https://gitlab.com/jreporter"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/391","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/391","notes":"https://gitlab.com/api/v4/projects/734943/issues/391/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/391/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#391","relative":"#391","full":"gitlab-org/gitlab-pages#391"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34133160,"iid":385,"project_id":734943,"title":"Use custom .golangci.yml file with improved lint rules","description":"The following discussion from !264 should be addressed:\r\n\r\n- [ ] @krasio started a [discussion](https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/264#note_333342106):  (+2 comments)\r\n\r\n    \u003e Is this to avoid name clash with the `client` package?\r\n\r\n--- \r\n\r\nWe use [automatic linting](https://docs.gitlab.com/ee/development/go_guide/#automatic-linting) via `golangci-lint` with a default set of relaxed rules. To improve the code style we should add a custom `.golangci.yml` file enabling a set of useful linters.\r\n\r\nWe can use [GitLab's Runner `.golangci.yml`](https://gitlab.com/gitlab-org/gitlab-runner/-/blob/master/.golangci.yml) for consistency or use as a base for the set of rules we want to apply to Pages.\r\n\r\n\r\ncc @krasio @vshushlin @sean_carroll\r\n\r\n--- \r\n\r\n## Linters\r\n\r\nFrom [GitLab's Runner `.golangci.yml`](https://gitlab.com/gitlab-org/gitlab-runner/-/blob/master/.golangci.yml)\r\n\r\n| Linter | Enable in iteration # | \r\n| ------ | :--------------------:|\r\n| bodyclose | 2 |\r\n| deadcode | 2 |\r\n| dogsled | 2 |\r\n| goconst | 1 |\r\n| gocyclo | 1 |\r\n| goimports | 1 |\r\n| golint | 1 |\r\n| gosec | 1 |\r\n| gosimple | 1 |\r\n| govet | 1 |\r\n| ineffassign | 2 |\r\n| misspell | 2 |\r\n| structcheck | 2 |\r\n| typecheck | 2 |\r\n| unconvert | 2 |\r\n| unused | 2 |\r\n| varcheck | 2 |\r\n| whitespace | 2 |\r\n\r\n### Other linters to consider\r\n\r\nList of supported [linters](https://golangci-lint.run/usage/linters/) by `golangci-lint`\r\n\r\n| Linter | Description |\r\n| ------ | :----------:|\r\n| wsl | improve empty line spacing (annoying but makes the code more readable) |\r\n| interfacer | Linter that suggests narrower interface types |\r\n| lll | long lines |\r\n| unparam |  Reports unused function parameters |\r\n| gocritic | The most opinionated Go source code linter |\r\n| gochecknoinits | This will help with #342 |\r\n\r\n---\r\n\r\n## MRs\r\n\r\n- [x] Add .golangci.yml linter configuration !286 \r\n- [x] Enable more linters https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/287","state":"closed","created_at":"2020-05-05T00:40:00.985Z","updated_at":"2020-06-18T20:09:13.097Z","closed_at":"2020-06-03T07:00:11.249Z","closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"labels":["Category:Pages","backstage [DEPRECATED]","cicd::active","devops::release [DEPRECATED]","maintenance::refactor","workflow::in review"],"milestone":{"id":1112145,"iid":47,"group_id":9970,"title":"13.1","description":"","state":"closed","created_at":"2020-01-03T12:28:30.160Z","updated_at":"2020-10-08T12:01:07.361Z","due_date":"2020-06-17","start_date":"2020-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/47"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"user_notes_count":7,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/385","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":3,"completed_count":2},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/385","notes":"https://gitlab.com/api/v4/projects/734943/issues/385/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/385/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#385","relative":"#385","full":"gitlab-org/gitlab-pages#385"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34001444,"iid":383,"project_id":734943,"title":"Remove `gitlab-server` fallback to `auth-server` and `artifacts server`","description":"Currently `auth-server` and `artifacts-server` may be used instead of `gitlab-server` command line flag. That was done for a seamless upgrade.\n\nDeprecation was announced, so we can just remove it in %\"14.0\"\n\nFrom @igorwwwwwwwwwwwwwwwwwwww's comment https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/270#note_334218639 :\n\n\u003e Alternatively, I think it might be good to remove this fallback logic.\n\u003e \n\u003e From an operational perspective, I found it very surprising that `gitlab-server` inherits from both auth server as well as artifacts server.\n\u003e \n\u003e I would find the inverse *much* more intuitive. But even having to specify all the params would be acceptable.\n\u003e \n\u003e So if we can verify that the main consumers of this (probably just omnibus?) are always specifying `gitlab-server` explicitly, it may be worth simply requiring it to be specified without fallback.\n\nWe need to:\n\n- [x] Mark auth-server as deprecate in Omnibus(might be already done)\n- [x] Make a release deprecation post. draft:\n```\nWe're changing the behaviour of some configuration options of GitLab Pages. If you run GitLab Pages via Omnibus based package, no action required. Otherwise, make sure to set [`gitlab-server` parameter and remove `auth-server`](https://docs.gitlab.com/ee/administration/pages/).\n```\n\n\nLater we may consider removing `artifacts-server` and use `gitlab-server`(or better: new parameter introduced in https://gitlab.com/gitlab-org/gitlab-pages/-/merge_requests/276) and appending path.","state":"closed","created_at":"2020-04-30T13:59:36.861Z","updated_at":"2021-05-17T01:54:47.666Z","closed_at":"2021-05-17T01:54:47.559Z","closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/4082686/avatar.png","web_url":"https://gitlab.com/jaime"},"labels":["Category:Pages","Community contribution","backend","backstage [DEPRECATED]","cicd::active","deprecation","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::feature","workflow::in dev"],"milestone":{"id":1850113,"iid":60,"group_id":9970,"title":"14.0","description":"","state":"closed","created_at":"2021-01-26T16:55:07.714Z","updated_at":"2022-04-21T07:25:17.749Z","due_date":"2021-06-17","start_date":"2021-05-18","expired":true,"web_url":"https://gitlab.com/groups/gitlab-org/-/milestones/60"},"assignees":[{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https://secure.gravatar.com/avatar/40569112d16323eb878ebdead2117943?s=80\u0026d=identicon","web_url":"https://gitlab.com/feistel"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/3379682/avatar.png","web_url":"https://gitlab.com/vshushlin"},"type":"ISSUE","assignee":{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https://secure.gravatar.com/avatar/40569112d16323eb878ebdead2117943?s=80\u0026d=identicon","web_url":"https://gitlab.com/feistel"},"user_notes_count":4,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https://gitlab.com/gitlab-org/gitlab-pages/-/issues/383","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":2,"completed_count":2},"weight":2,"blocking_issues_count":0,"has_tasks":false,"_links":{"self":"https://gitlab.com/api/v4/projects/734943/issues/383","notes":"https://gitlab.com/api/v4/projects/734943/issues/383/notes","award_emoji":"https://gitlab.com/api/v4/projects/734943/issues/383/award_emoji","project":"https://gitlab.com/api/v4/projects/734943","closed_as_duplicate_of":null},"references":{"short":"#383","relative":"#383","full":"gitlab-org/gitlab-pages#383"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4705,"epic":{"id":134034,"iid":4705,"title":"14.0 Release Team feature removals","url":"/groups/gitlab-org/-/epics/4705","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"\u003cstrong\u003ePast due\u003c/strong\u003e"},"iteration":null,"health_status":null}]