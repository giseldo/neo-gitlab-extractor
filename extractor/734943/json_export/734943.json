[{"id":33999404,"iid":382,"project_id":734943,"title":"Remove support for disk configuration source","description":"In https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/217912 we introduced `domain-config-source` configuration flag to allow users to choose which domain source to use between `disk` and `api`.\n\nIn %\"14.0\" we plan to remove support for old disk configuration source.\n\nThe purpose of this issue is to remove `domain-source`, some code may be hard to remove in one MR, so this can be extracted to follow-up issues.\n\nOmnibus will need to be updated to remove this flag\n\nIf users can't use the disk config source, we can gradually get rid of old code supporting it.","state":"closed","created_at":1588252638566,"updated_at":1631948530659,"closed_at":1629943098677,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Deliverable","Pages::Object Storage","backstage [DEPRECATED]","cicd::active","deprecation","devops::release [DEPRECATED]","direction","group::release [DEPRECATED]","maintenance::refactor","section::ops","workflow::verification"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/63"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/40569112d16323eb878ebdead2117943?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/feistel"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":13,"merge_requests_count":2,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/382","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/382","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/382\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/382\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#382","relative":"#382","full":"gitlab-org\/gitlab-pages#382"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4705.0,"epic":{"id":134034,"iid":4705,"title":"14.0 Release Team feature removals","url":"\/groups\/gitlab-org\/-\/epics\/4705","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":33344838,"iid":377,"project_id":734943,"title":"Tech evaluation: Object storage using presigned URLs","description":"This is a follow-up tech evaluation from #355 \n\n@ayufan thanks for your [input on slack](https:\/\/gitlab.slack.com\/archives\/C1BSEQ138\/p1585668949053900)!(copying here)\n\n- We need to use pre-signed URLs from GitLab, that way we don\u2019t need any credentials on Pages, and whether the .zip is used can be controlled by Rails exclusively, the link would have an encoded and Rails controlled expiry date\n- If serving from .zip I think we need to likely define the maximum archive size that we can support, likely filtering the relevant files (public\/ only folder), and holding that somewhere in memory. I would assume that we could likely configure how many files-in-archives\/archives we cache and allow this to be configured and optimised towards cache-hit-ratio, likely GitLab.com would allow to use a ton of memory if needed\n- I would likely break the support for Content-Range if serving files as I don\u2019t think that this is cheaply possible with .zip\n- GitLab Workhorse does have OpenArchive that supports local and remote archive just it is not performance optimised: the HTTP requests are badly aligned and this will likely need to be somehow improved, so just copy-pasting will not give a great performance yet\n\n---\n- [ ] @vshushlin started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/258#note_309921953):  (+7 comments)\n\n    > Oh, I thought that https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/136\/ has some object storage implementation while it only has serving from zip files from disc :see_no_evil: \n    > \n    > I have a very simple idea for alternative PoC:\n    > \n    > 1. We can copy(and maybe slightly modify) https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/blob\/84c0ffe12646b9bae1fdf2e576cde7f01f8ded73\/lib\/api\/job_artifacts.rb#L75-94 to pages API https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/blob\/75f8d42bb443d0a6101a9c2f6b65c607cd95efd4\/lib\/api\/internal\/pages.rb#L19\n    > 1. Then we can return the `job_id` in the API\n    > 1. Pages will get specific file and proxy it to user.\n    > 1. Later we can add cache for it.\n    > \n    > Alternatively, we can get the whole artifacts zip archive and use the current zip reading code, then we'll need to cache those files.\n    > \n    > I don't think that adding some object-storage specific code to pages is a good idea. We already have it in the workhorse, we can just use the API. It's slower, but much simplier.\n\n### Diagram\/proposal \n\n![Screen_Shot_2020-06-26_at_5.09.00_pm](\/uploads\/6c277237392a3ce3844fe3e1551f980f\/Screen_Shot_2020-06-26_at_5.09.00_pm.png)\n\n```\nsequenceDiagram\n  participant U as User\n  participant P as gitlab-pages\n  participant G as gitlab-workhorse and rails\n  participant OS as Object Storage\n  U->>P: 1. username.gitlab.io\/index.html\n  P->>G: 2. GET \/api\/v4\/internal\/pages?host=username.gitlab.io\n  G->>P: 3. {... lookup_paths: [{source: {type: \"zip\", path: \"presignedURL\"}],...}\n  loop zipartifacts\n    P->>P: 4. reader:= OpenArchive(presignedURL)\n    P->>OS: 5. GET presignedURL\n    OS->>P: 6. .zip file\n    P->>P: 7. reader.find(public\/index.html)\n    P->>P: 8. go func(){ cache({host,reader}) } ()\n  end\n  P->>U: 9. username.gitlab.io\/index.html\n```\n\n### Proposal \n\nIn this PoC we will hardcode the returning value from `\/api\/v4\/internal\/pages` to reduce the scope. I will use minio which is already supported in the GDK. I'll also shamelessly steal and slightly modify the `zipartifacts` package from workhorse.\n\nTo address https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/377#note_367358348 the source type should be `\"zip\"` so that Pages can serve from `.zip` regardless of the path (pre-signed URL or disk path).\n\n### Outcomes\n\nWe have now https:\/\/gitlab.com\/groups\/gitlab-org\/-\/epics\/3901 and https:\/\/gitlab.com\/groups\/gitlab-org\/-\/epics\/3902 with parent https:\/\/gitlab.com\/groups\/gitlab-org\/-\/epics\/1316 to track all future efforts.\n\n#### Rails\n\n1. Allow deploying Pages as `.zip` archives with a `max_archive_size`. https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/208135\n1. On deploy ->check size -> store `public.zip` either on disk or in object storage depending on the features enabled. also tracked in https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/208135\n1. Update `\/api\/v4\/internal\/pages` -> return a \"source\".\"type\":\u201czip\u201d with a path https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/225840 e.g.\n```json\n{\n\t\"lookup_paths\" : [\n\t{\n\t\t\"source\": {\n\t\t\t\"type\": \"zip\",\n\t\t\t\"path\": \"https:\/\/presigned.url\/public.zip\",\n\t\t\t\"_\":\"or from disk path\"\n\t\t\t\"path\": \"\/shared\/pages\/domain\/project\/public.zip\"\n\t}\n]\n```\n\n#### Pages (Go)\n\n0. extract the `resolvePath` logic from disk serving into its own package so it can be shared. https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/421\n1. Add package `zip` with `zip\/reader` https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/28784\n2. Add `zip` serving to Pages - this allows serving from disk or pre-signed URLs from object storage https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/28784\n3. Implement a zip reader caching mechanism https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/422\n4. Add metrics for zip serving https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/423\n\n* while testing I hit https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/371 so I think it would be valuable to work on that issue first.","state":"closed","created_at":1586993445118,"updated_at":1671491097612,"closed_at":1595205505754,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Pages::Object Storage","backend","cicd::active","devops::release [DEPRECATED]","type::feature","workflow::in review"],"milestone":{"id":1233746,"iid":49,"group_id":9970,"title":"13.2","description":"https:\/\/about.gitlab.com\/releases\/2020\/07\/22\/gitlab-13-2-released\/","state":"closed","created_at":"2020-04-09T17:28:01.032Z","updated_at":"2022-04-13T14:48:24.167Z","due_date":"2020-07-17","start_date":"2020-06-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/49"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":26,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/377","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":1,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/377","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/377\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/377\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#377","relative":"#377","full":"gitlab-org\/gitlab-pages#377"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3902.0,"epic":{"id":81052,"iid":3902,"title":"GitLab Pages Object storage PoCs","url":"\/groups\/gitlab-org\/-\/epics\/3902","group_id":9970,"human_readable_end_date":"Aug 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":32478519,"iid":365,"project_id":734943,"title":"Add metrics for disk serving","description":"As part of the work done for #355 we need to add some metrics to measure loading times of serving from disk.\n\n- file size\n- time taken to serve\n\nThis will give us some visibility on serving files and will allow us to compare serving times when we implement object storage #377 ","state":"closed","created_at":1585211380970,"updated_at":1593739340201,"closed_at":1591856372824,"closed_by":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/263716\/avatar.jpeg","web_url":"https:\/\/gitlab.com\/grzesiek"},"labels":["Category:Pages","Deliverable","backend","backstage [DEPRECATED]","cicd::active","devops::release [DEPRECATED]","workflow::in review"],"milestone":{"id":1112145,"iid":47,"group_id":9970,"title":"13.1","description":"","state":"closed","created_at":"2020-01-03T12:28:30.160Z","updated_at":"2020-10-08T12:01:07.361Z","due_date":"2020-06-17","start_date":"2020-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/47"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":3,"merge_requests_count":2,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/365","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/365","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/365\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/365\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#365","relative":"#365","full":"gitlab-org\/gitlab-pages#365"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":31331442,"iid":356,"project_id":734943,"title":"Fix data race in gitlab source cache package","description":"The following discussion from !246 should be addressed:\n\n- [ ] @nolith started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/246#note_294638273):  (+1 comment)\n\n    > Here the race is deep inside the package\n    > \n    > we make use of global variables and this test will alter `retrievalTimeout` when a goroutine from the previous one is still running.\n    > \n    > This will require extra effort to fix, but I think we should add the race detector now.\n    > \n    > ```\n    >  ==================\n    >  WARNING: DATA RACE\n    >  Write at 0x000000e0d4f0 by goroutine 46:\n    >    gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\/gitlab\/cache.TestResolve.func9()\n    >        \/builds\/nolith\/gitlab-pages\/internal\/source\/gitlab\/cache\/cache_test.go:247 +0x3e\n    >    testing.tRunner()\n    >        \/usr\/local\/go\/src\/testing\/testing.go:827 +0x162\n    >  Previous read at 0x000000e0d4f0 by goroutine 44:\n    >    gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\/gitlab\/cache.(*Retriever).Retrieve()\n    >        \/builds\/nolith\/gitlab-pages\/internal\/source\/gitlab\/cache\/retriever.go:22 +0x8d\n    >    gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\/gitlab\/cache.(*Entry).retrieveWithClient()\n    >        \/builds\/nolith\/gitlab-pages\/internal\/source\/gitlab\/cache\/entry.go:92 +0xc5\n    >  Goroutine 46 (running) created at:\n    >    testing.(*T).Run()\n    >        \/usr\/local\/go\/src\/testing\/testing.go:878 +0x659\n    >    gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\/gitlab\/cache.TestResolve()\n    >        \/builds\/nolith\/gitlab-pages\/internal\/source\/gitlab\/cache\/cache_test.go:246 +0x1d5\n    >    testing.tRunner()\n    >        \/usr\/local\/go\/src\/testing\/testing.go:827 +0x162\n    >  Goroutine 44 (running) created at:\n    >    gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\/gitlab\/cache.(*Entry).Retrieve.func1()\n    >        \/builds\/nolith\/gitlab-pages\/internal\/source\/gitlab\/cache\/entry.go:64 +0x67\n    >    sync.(*Once).Do()\n    >        \/usr\/local\/go\/src\/sync\/once.go:44 +0xde\n    >    gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\/gitlab\/cache.(*Entry).Retrieve()\n    >        \/builds\/nolith\/gitlab-pages\/internal\/source\/gitlab\/cache\/entry.go:64 +0xad\n    >    gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\/gitlab\/cache.(*Cache).Resolve()\n    >        \/builds\/nolith\/gitlab-pages\/internal\/source\/gitlab\/cache\/cache.go:89 +0x1ea\n    >    gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\/gitlab\/cache.TestResolve.func8.1()\n    >        \/builds\/nolith\/gitlab-pages\/internal\/source\/gitlab\/cache\/cache_test.go:239 +0x76\n    >    gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\/gitlab\/cache.withTestCache()\n    >        \/builds\/nolith\/gitlab-pages\/internal\/source\/gitlab\/cache\/cache_test.go:89 +0x185\n    >    gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\/gitlab\/cache.TestResolve.func8()\n    >        \/builds\/nolith\/gitlab-pages\/internal\/source\/gitlab\/cache\/cache_test.go:238 +0xc7\n    >    testing.tRunner()\n    >        \/usr\/local\/go\/src\/testing\/testing.go:827 +0x162\n    >  ==================\n    > ```","state":"closed","created_at":1582795927557,"updated_at":1583247005845,"closed_at":1583247005791,"closed_by":{"id":376774,"username":"nolith","name":"Alessio Caiazza","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/376774\/avatar.png","web_url":"https:\/\/gitlab.com\/nolith"},"labels":["Category:Pages","backend","backstage [DEPRECATED]","cicd::active","devops::release [DEPRECATED]","maintenance::refactor","workflow::in dev"],"milestone":{"id":1001916,"iid":44,"group_id":9970,"title":"12.9","description":"https:\/\/about.gitlab.com\/releases\/2020\/03\/22\/gitlab-12-9-released","state":"closed","created_at":"2019-09-15T20:54:50.875Z","updated_at":"2020-09-02T11:04:41.671Z","due_date":"2020-03-17","start_date":"2020-02-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/44"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":3,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/356","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/356","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/356\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/356\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#356","relative":"#356","full":"gitlab-org\/gitlab-pages#356"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":31320489,"iid":355,"project_id":734943,"title":"Tech evaluation: Serve pages from object storage","description":"From https:\/\/gitlab.com\/gitlab-org\/gitlab\/issues\/208135\n\nThe idea is to create proof of concept for pages to be able to serve content from object storage. This will hopefully help identify some of the unknowns to enable this functionality!\n\nWill use [GitLab's object storage](https:\/\/docs.gitlab.com\/charts\/advanced\/external-object-storage\/) with the [GDK config](https:\/\/gitlab.com\/gitlab-org\/gitlab-development-kit\/-\/blob\/master\/doc\/howto\/object_storage.md) to explore a possible solution for this.\n\n## Results\n\nWhat we've discovered from !258\n\n* Adding specific code to handle objects from AWS S3 or GCS may not be scalable and would be harder to maintain.\n* Implementing [this diagram](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/258#note_310076437) it will be super slow, as Rails and Workhorse validate metadata multiple times, and is not very efficient if we want to random access the file (it does not cache anything).\n* We should explore using presigned URLs #377","state":"closed","created_at":1582766462720,"updated_at":1595530893068,"closed_at":1586993927009,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Pages::Object Storage","backend","cicd::active","devops::release [DEPRECATED]","missed:12.9","workflow::in dev"],"milestone":{"id":1104429,"iid":46,"group_id":9970,"title":"12.10","description":"https:\/\/about.gitlab.com\/releases\/2020\/04\/22\/gitlab-12-10-released","state":"closed","created_at":"2019-12-20T15:15:53.243Z","updated_at":"2020-10-08T12:00:39.852Z","due_date":"2020-04-17","start_date":"2020-03-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/46"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":13,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/355","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/355","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/355\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/355\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#355","relative":"#355","full":"gitlab-org\/gitlab-pages#355"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":29164214,"iid":315,"project_id":734943,"title":"Content-length header is not provided when content-encoding is used","description":"GitLab pages [support serving statically compressed files](https:\/\/docs.gitlab.com\/ee\/user\/project\/pages\/introduction.html#serving-compressed-assets). But it looks like when this is done, the response headers are missing `Content-Length` header, when response headers include `Content-Encoding: gzip`.","state":"closed","created_at":1577551041739,"updated_at":1596573070662,"closed_at":1596532468969,"closed_by":{"id":376774,"username":"nolith","name":"Alessio Caiazza","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/376774\/avatar.png","web_url":"https:\/\/gitlab.com\/nolith"},"labels":["Category:Pages","devops::release [DEPRECATED]","priority::4","severity::4","type::bug"],"milestone":null,"assignees":[{"id":2020145,"username":"mark2472","name":"Mark Francis","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/2020145\/avatar.png","web_url":"https:\/\/gitlab.com\/mark2472"}],"author":{"id":706613,"username":"mitar","name":"Mitar","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/706613\/avatar.png","web_url":"https:\/\/gitlab.com\/mitar"},"type":"ISSUE","assignee":{"id":2020145,"username":"mark2472","name":"Mark Francis","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/2020145\/avatar.png","web_url":"https:\/\/gitlab.com\/mark2472"},"user_notes_count":3,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/315","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/315","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/315\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/315\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#315","relative":"#315","full":"gitlab-org\/gitlab-pages#315"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":29009434,"iid":314,"project_id":734943,"title":"Tech Evaluation: Support HSTS on GitLab Pages","description":"## Problem to solve \nWe need to research the technical implementation details to solve https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\/28\n\n## Proposal \nSpend 2-3 days assessing sorting capabilities and breakdown issue into smaller components if larger than 2 MRs: \nSome users want to enforce no access to their web content without HTTPS\/certificates. This can be done with [HTTP Strict Transport Security (HSTS) policy](https:\/\/en.wikipedia.org\/wiki\/HTTP_Strict_Transport_Security), but we do not currently support enabling this for GitLab Pages sites.","state":"closed","created_at":1577116214281,"updated_at":1665957771205,"closed_at":1665957771177,"closed_by":{"id":1646689,"username":"oregand","name":"David O'Regan","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/1646689\/avatar.png","web_url":"https:\/\/gitlab.com\/oregand"},"labels":["Category:Pages","backend","cicd::active","devops::create","group::editor","section::dev","security","type::feature"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":4905402,"username":"jreporter","name":"Jackie Porter","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4905402\/avatar.png","web_url":"https:\/\/gitlab.com\/jreporter"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":0,"upvotes":3,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/314","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/314","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/314\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/314\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#314","relative":"#314","full":"gitlab-org\/gitlab-pages#314"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27985016,"iid":281,"project_id":734943,"title":"GitLab Pages depends on the availability of GitLab API","description":"If gitlab API is not available for some reason(e.g. https:\/\/gitlab.com\/gitlab-com\/gl-infra\/production\/-\/issues\/1936) GitLab Pages currently will become unavailable too(we clear cache in case of any API lookup problem).\n\nIf we not clear cache in these cases, GitLab Pages will be more independent and won't produce spikes of errors like https:\/\/dashboards.gitlab.net\/d\/web-pages-main\/web-pages-overview?orgId=1&from=1586889900000&to=1586891700000&var-PROMETHEUS_DS=Global&var-environment=gprd&var-stage=main&var-sigma=2\n\nThe following discussion from !194 should be addressed:\n\n- [ ] @ayufan started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/merge_requests\/194#note_255169959):  (+1 comment)\n\n    > Should we consider replacing entry only if the new received one does not have `entry.lookup.Error` to solve intermediate errors of processing lookups?\n    > \n    > I consider the today it can happen that we store the lookup of success request, but after refresh we receive error, like 500 from GitLab. It would help if we could catch with this mechanism a short living errors of GitLab API, and try to re-use success requests for as long as long interval. This reduces Pages dependence on API being super stable, and we anticipate that upstream API is flaky to some extent.\n    > \n    > Or maybe better is in such case, is to re-use current lookup and extend the lease on the lookup to allow another refresh?\n    > \n    > ```golang\n    > if entry.response != nil && entry.response.Error != nil {\n    >   entry.response = e.response\n    > }\n    > ```\n    > \n    > > Note: I'm fine following that in next MR as an stability improvement.","state":"closed","created_at":1575559754918,"updated_at":1617866739710,"closed_at":1617866739500,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","backend","backstage [DEPRECATED]","cicd::active","devops::release [DEPRECATED]","gitlab.com:availability","group::release [DEPRECATED]","priority::3","section::ops","severity::3","type::bug","workflow::production"],"milestone":{"id":1406669,"iid":59,"group_id":9970,"title":"13.11","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-08-13T14:23:09.688Z","updated_at":"2022-04-21T07:22:08.835Z","due_date":"2021-04-17","start_date":"2021-03-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/59"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/263716\/avatar.jpeg","web_url":"https:\/\/gitlab.com\/grzesiek"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":32,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/281","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/281","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/281\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/281\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#281","relative":"#281","full":"gitlab-org\/gitlab-pages#281"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":27741902,"iid":274,"project_id":734943,"title":"Make GitLab client timeout \/ JTW token expiry configurable","description":"The following discussion from !201 should be addressed:\n\n- [ ] @ayufan started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/merge_requests\/201#note_251814520):  (+3 comments)\n\n    > Is this timeout too small?\n    > \n    > Can we make it larger, or at least configurable?","state":"closed","created_at":1575025049701,"updated_at":1580945684000,"closed_at":1580864561289,"closed_by":{"id":42196,"username":"twk3","name":"DJ Mountney","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/0585c59e37fc2dbc124fc4c9f575234d?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/twk3"},"labels":["backend","devops::release [DEPRECATED]","type::feature","workflow::in review"],"milestone":{"id":1001915,"iid":43,"group_id":9970,"title":"12.8","description":"https:\/\/about.gitlab.com\/releases\/2020\/02\/22\/gitlab-12-8-released","state":"closed","created_at":"2019-09-15T20:53:58.792Z","updated_at":"2020-05-19T14:23:44.837Z","due_date":"2020-02-17","start_date":"2020-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/43"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/263716\/avatar.jpeg","web_url":"https:\/\/gitlab.com\/grzesiek"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":1,"merge_requests_count":2,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/274","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/274","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/274\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/274\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#274","relative":"#274","full":"gitlab-org\/gitlab-pages#274"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26998252,"iid":267,"project_id":734943,"title":"Provide a way to track and measure API calls","description":"We need the way to track the requests made from the `gitlab` config source (https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/merge_requests\/194) to the internal API.","state":"closed","created_at":1573612541940,"updated_at":1582207075682,"closed_at":1581410366998,"closed_by":{"id":376774,"username":"nolith","name":"Alessio Caiazza","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/376774\/avatar.png","web_url":"https:\/\/gitlab.com\/nolith"},"labels":["Category:Pages","backend","cicd::active","devops::release [DEPRECATED]","type::feature","workflow::in review"],"milestone":{"id":1001915,"iid":43,"group_id":9970,"title":"12.8","description":"https:\/\/about.gitlab.com\/releases\/2020\/02\/22\/gitlab-12-8-released","state":"closed","created_at":"2019-09-15T20:53:58.792Z","updated_at":"2020-05-19T14:23:44.837Z","due_date":"2020-02-17","start_date":"2020-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/43"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":3170776,"username":"krasio","name":"Krasimir Angelov","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3170776\/avatar.png","web_url":"https:\/\/gitlab.com\/krasio"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":13,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/267","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/267","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/267\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/267\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#267","relative":"#267","full":"gitlab-org\/gitlab-pages#267"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4242.0,"epic":{"id":97712,"iid":4242,"title":"Move pages domain\/project configuration to the API","url":"\/groups\/gitlab-org\/-\/epics\/4242","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":26188901,"iid":264,"project_id":734943,"title":"XSSI in Gitlab Pages *.gitlab.io","description":"**[HackerOne report #719770](https:\/\/hackerone.com\/reports\/719770)** by `ngalog` on 2019-10-22, assigned to @jeremymatos:\n\nSecurity workflow issue: https:\/\/dev.gitlab.org\/gitlab\/gitlabhq\/issues\/2967.\n\n### Summary  \nSince now gitlab.io has implemented access control for all private pages, all pages should be limited to authorized user, however I found there is a way to steal content of JS files of victim using the XSSI(Cross Site Scripting Inclusion) technique in certain conditions.\n\n### Steps to reproduce  \n- Use Gitlab CI\/CD to build a page, and limit access to project member only  \n- In the gitlab page folder, upload a JS file, something like below\n\n`secret.js`\n\n```  \naws_key='AKIARONCHAN';  \naws_secret='RONCHANAGAIN'  \n```  \n- Then, as the victim, login to gitlab  \n- As the attacker, in a domain that you control, prepare below html file and make victim to visit the page\n\nhttps:\/\/attacker.com\/attackpage\n\n```  \n<script src=\"https:\/\/GROUPID.gitlab.io\/PROJECTID\/secret.js\"><\/script>  \n<script>alert(aws_key);<\/script>  \n```\n\n- Then you should see a pop up containing the JS secrets of the gitlab page.\n\n\n### Impact  \nXSSI to steal user's gitlab page's JS file content\n\n### Examples  \nGiven above\n\n### What is the current *bug* behavior?  \nDidn't block invalid refer\n\n### What is the expected *correct* behavior?  \nShould not be able to allow attacker to carry out XSSI attacker\n\n### Relevant logs and\/or screenshots  \n![Screenshot_2019-10-22_at_9.46.24_PM.png](https:\/\/h1.sec.gitlab.net\/a\/bb6765a1-a5b7-4bff-b992-6a6e84553263\/Screenshot_2019-10-22_at_9.46.24_PM.png)  \n![Screenshot_2019-10-22_at_9.46.36_PM.png](https:\/\/h1.sec.gitlab.net\/a\/c7948fcf-c65c-449d-8f23-58add7b4b289\/Screenshot_2019-10-22_at_9.46.36_PM.png)  \n![Screenshot_2019-10-22_at_9.46.42_PM.png](https:\/\/h1.sec.gitlab.net\/a\/08c44e4a-8ac2-47ab-b817-71f750589783\/Screenshot_2019-10-22_at_9.46.42_PM.png)\n\n### Output of checks  \ngitlab.com\n\n## Impact\n\nXSSI\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [Screenshot_2019-10-22_at_9.46.24_PM.png](https:\/\/h1.sec.gitlab.net\/a\/bb6765a1-a5b7-4bff-b992-6a6e84553263\/Screenshot_2019-10-22_at_9.46.24_PM.png)\n* [Screenshot_2019-10-22_at_9.46.36_PM.png](https:\/\/h1.sec.gitlab.net\/a\/c7948fcf-c65c-449d-8f23-58add7b4b289\/Screenshot_2019-10-22_at_9.46.36_PM.png)\n* [Screenshot_2019-10-22_at_9.46.42_PM.png](https:\/\/h1.sec.gitlab.net\/a\/08c44e4a-8ac2-47ab-b817-71f750589783\/Screenshot_2019-10-22_at_9.46.42_PM.png)","state":"closed","created_at":1571739627813,"updated_at":1676657946825,"closed_at":1649765364010,"closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"labels":["Category:Pages","Deliverable","HackerOne","SLO::Missed","Weakness::CWE-79","backend","bug::vulnerability","cicd::active","devops::create","frontend","group::editor","priority::3","section::ops","security","severity::3","type::maintenance","workflow::production"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/72"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"}],"author":{"id":2741139,"username":"gitlab-securitybot","name":"GitLab SecurityBot","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/2741139\/avatar.png","web_url":"https:\/\/gitlab.com\/gitlab-securitybot"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"user_notes_count":27,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2019-12-27","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/264","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/264","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/264\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/264\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#264","relative":"#264","full":"gitlab-org\/gitlab-pages#264"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26150199,"iid":262,"project_id":734943,"title":"[Gitlab Pages Auth Bypass] Able to steal a user's Authentication Code For Gitlab Pages","description":"**[HackerOne report #718460](https:\/\/hackerone.com\/reports\/718460)** by `ngalog` on 2019-10-21, assigned to @jeremymatos:\n\n### Summary\n\nI bypassed the regex for the gitlab pages authentication in gitlab.com\n\n### Steps to reproduce  \n- Login to gitlab and then visit https:\/\/projects.gitlab.io\/auth?domain=https:\/\/ronchangitlab.io&state=xdgnwM0hmRQ7g5xoevNV6g==  \n- Then attacker can get the access authorization code in ronchangitlab.io, then they can use it to exchange for victim's gitlab pages cookies\n\n## Impact\n\nGitlab Pages authentication bypass\n\n## Issue on dev\n\nhttps:\/\/dev.gitlab.org\/gitlab\/gitlabhq\/issues\/2938\n\nhttps:\/\/gitlab.com\/gitlab-org\/security\/gitlab\/-\/issues\/102\n\n---\n\n## Solution\n\n### Proposals\n\n- Proposal 1 - https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/262#note_255332604 and WIP PoC https:\/\/dev.gitlab.org\/gitlab\/gitlab-pages\/-\/merge_requests\/21\n- Proposal 2 - https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/262#note_341774099\n\n### Proposal 2\n\n~~Going ahead with proposal 2~~\n\n1. Generate a JWT signing key based on the `auth-secret` on Pages startup\n1. When we initiate the authentication flow, generate a JWT token with claims, set it as the state and save to the encrypted cookie\n  ```go\n    state := jwt(domain, randomNewState, jwtSigningKey)\n  ```\n3. Redirect to `projects.gitlab.io?state=state` and validate the state's JWT signature\n4. Extract the domain from the JWT claims and continue OAuth flow.\n5. When we receive `mydomain.gitlab.io?stat=state&code=code` we verify the state's JWT signature again.\n6. Continue as usual\n\n---\n## Implemented solution\n\nIt was later discovered that the problem lies in someone being able to steal an OAuth `code` as part of the authentication flow. To mitigate this, the process is to encrypt the code and add it to a JWT which is then signed.\nThe flow is\n\n1. Generate a JWT signing key based on the `auth-secret` on Pages startup.\n1. On redirection from GitLab to https:\/\/gitlab.io\/auth?code=plaintext&state=random, encrypt and sign the code\n1. Encrypt code `encryptedCode=AES-GCM(code, domain (as salt), hkdfKey(auth-secret)`\n1. Use the JWT as new code `code=JWT(encryptedCode, nonce, signingKey)`\n1. Redirect to `mydomain.com\/auth?code=JWT(encryptedCode, nonce, signingKey)&state=random` and strip the `token` from the query string to mitigate https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/285244\n1. When we receive `mydomain.gitlab.io?state=random&code=code` we verify the code's JWT signature.\n1. Get `encryptedCode` and `nonce` from the JWT claims and decrypt the code\n1. Exchange for access token and serve content if successful\n\n---\n<details>\n<summary>Sequence diagrams from the comment below<\/summary>\n\n### Summary\n\n* The goal of the attack is to ready the content of site `mygroup.gitlab.io` which is private\n* To achieve this attacker sends link `project.gitlab.io?domain=Attackersdomain.com` to user, which result in `attackersdomain.com?code=mygroupcode&state=irrelevant`\n* After receiving the `code` attacker can complete the Auth process for `mygroup.gitlab.io`\n\nNote: it's not possible for attacker to get `token`, only to read the content of private web-site.\n\n### How the current Auth workflow works\n\n```mermaid\nsequenceDiagram\n    participant U as User\n    participant D as mygroup.gitlab.io\n    participant P as projects.gitlab.io\n    participant G as gitlab.com\n    U->>D: get index.html\n    D->>U: not authorzied, redirect to projects.gitlab.io\/auth?domain=mygroup.gitlab.io&state=123\n    U->>P: projects.gitlab.io\/auth?domain=mygroup.gitlab.io&state=123\n    rect rgb(0, 255, 0)\n    Note over P,G: OAuth workflow\n    P->>U: redirect to gitlab.com\/oauth?redirect_url=projects.gitlab.io&state=123\n    U->>G: gitlab.com\/oauth?redirect_url=projects.gitlab.io&state=123\n    G->>U: redirect to projects.gitlab.io?state=123&code=mycode\n    U->>P: projects.gitlab.io?state=123&code=mycode\n    end\n    P->>U: redirect to mygroup.gitlab.io?state=123&code=mycode\n    U->>D: mygroup.gitlab.io?state=123&code=mycode\n    rect rgb(0, 255, 0)\n    Note over D,G: Exchange code for token and verify that user has permissions for the mygroup.gitlab.io\n    D->>G: get token by code=mycode\n    G->>D: token = blablabla\n    D->>G: get project by id with token = blablabla\n    G->>D: success\n    end\n    D->>U: success\n```\n\n### Requests highlined in the green are not so relevant to the described attack, so let's get rid of them\n\n```mermaid\nsequenceDiagram\n    participant U as User\n    participant D as mygroup.gitlab.io\n    participant P as projects.gitlab.io\n    participant G as gitlab.com\n    U->>D: get index.html\n    D->>U: not authorzied, redirect to projects.gitlab.io\/auth?domain=mygroup.gitlab.io&state=123\n    U->>P: projects.gitlab.io\/auth?domain=mygroup.gitlab.io&state=123\n    Note over P,G: OAuth workflow\n    P->>U: redirect to mygroup.gitlab.io?state=123&code=mycode\n    U->>D: mygroup.gitlab.io?state=123&code=mycode\n    Note over D,G: Exchange code for token and verify that user has permissions for the mygroup.gitlab.io\n    D->>U: success\n```\n\n### Some notes about sessions(stored in encrypted and signed cookies with 10 minutes expiration time)\n\n```mermaid\nsequenceDiagram\n    participant U as User\n    participant D as mygroup.gitlab.io\n    participant P as projects.gitlab.io\n    participant G as gitlab.com\n    U->>D: get index.html\n    Note left of D: generate random state and save it in the session cookie\n    D->>U: not authorzied, redirect to projects.gitlab.io\/auth?domain=mygroup.gitlab.io&state=123\n    U->>P: projects.gitlab.io\/auth?domain=mygroup.gitlab.io&state=123\n    Note over P,G: domain=mygroup.gitlab.io is being saved to the session cookie\n    Note over P,G: OAuth workflow\n    Note over P,G: verify that \"GitLab Pages conrolls the domain\" from session cookie \n    P->>U: redirect to mygroup.gitlab.io?state=123&code=mycode\n    U->>D: mygroup.gitlab.io?state=123&code=mycode\n    Note left of D: Verify that state from the query parameter is the same as in session cookie\n    Note over D,G: Exchange code for token and verify that user has permissions for the mygroup.gitlab.io\n    D->>U: success\n```\n\n### A vulnerable step\n\nYou can see `verify that \"GitLab Pages conrolls the domain\" from session cookie` step above.\n\nThis is how it's implemented:\n```golang\nfunc (a *Auth) domainAllowed(name string, domains source.Source) bool {\n\t\/\/ This is incorrect but it's not important because of second check\n\tisConfigured := (name == a.pagesDomain) || strings.HasSuffix(\".\"+name, a.pagesDomain)\n\n\tif isConfigured {\n\t\treturn true\n\t}\n\n\t\/\/ This check is super easy to bypass by just adding the `attackersdomain.com` to any pages project passing validation\n\t\/\/ Note that validation does not mean that the correct CNAME record is set\n\tdomain, err := domains.GetDomain(name)\n\n\t\/\/ domain exists and there is no error\n\treturn (domain != nil && err == nil)\n}\n```\n\n### The attack as it's can be performed currently\n\n(note this diagram is a little different from [my previous comment](https:\/\/gitlab.com\/gitlab-org\/security\/gitlab-pages\/-\/merge_requests\/1#note_359604339):\nI placed attacker requesting user domain last to bring related steps closer, it's still possible to perform the attack this way, and it's actually even more convenient)\n\nVulnerability executed is highlighted in green.\n\n```mermaid\nsequenceDiagram\n    participant A as Attacker\n    participant U as User\n    participant D as mygroup.gitlab.io\n    participant P as projects.gitlab.io\n    participant G as gitlab.com\n    participant AD as ATTACKERSDOMAIN.com\n    A->U: can you please visit projects.gitlab.io\/auth?domain=ATTACKERSDOMAIN.COM&state=IRRELEVANT\n    U->>P: projects.gitlab.io\/auth?domain=ATTACKERSDOMAIN.COM&state=IRRELEVANT\n    Note over P,G: domain=ATTACKERSDOMAIN.COM is being saved to the session cookie\n    Note over P,G: OAuth workflow\n    rect rgb(0, 255, 0)\n    Note over P,G: verify that \"GitLab Pages controls the domain\" from session cookie\n    Note over P,G: This check is bypassed by adding ATTACKERSDOMAIN.COM to a random pages project\n    P->>U: redirect to ATTACKERSDOMAIN.COM?state=IRRELEVANT&code=mycode\n    U->>AD: ?state=IRRELEVANT&code=mycode\n    end\n    AD->>A: code=mycode\n    Note right of A: Need to get a valid state in cookie:\n    A->>D: get index.html\n    D->>A: unauthorized, redirect to projects.gitlab.io\/auth?domain=mygroup.gitlab.io&state=USERSTATE\n    Note right of A: skip the auth, just go the last step manually:\n    A->>D: \/auth?state=USERSTATE&code=mycode\n    Note over D,G: Exchange code for token and verify that user has permissions for the mygroup.gitlab.io\n    D->>A: success\n```\n\n### The JWT fix\n\nWe tried to fix this in https:\/\/gitlab.com\/gitlab-org\/security\/gitlab-pages\/-\/merge_requests\/1\n\nIt works by completely removing the `domain` parameter and including it in the `state=JWT({random=random, domain=domain...})`.\n\nSo the attacker can't send a link to domain.\n\nBut, it can be exploited in a little more complicated way:\n```mermaid\nsequenceDiagram\n    participant A as Attacker\n    participant Pages as Pages Server\n    participant U as User\n    participant D as mygroup.gitlab.io\n    participant P as projects.gitlab.io\n    participant G as gitlab.com\n    participant AD as ATTACKERSDOMAIN.com\n    Note right of A: Need to get a valid state for ATTACKERSDOMAIN.COM\n    Note right of A: Add ATTACKERSDOMAIN.COM as the domain for the private pages project\n    Note right of A: But not setup DNS for it\n    A->Pages: ATTACKERSDOMAIN.com\/index\n    Pages->A: not authorized, redirect to projects.gitlab.io\/auth?state=JWT({random=random, domain=ATTACKERSDOMAIN.com})\n    Note right of A: Let's call JWT({random=random, domain=ATTACKERSDOMAIN.com}) ATTACKERSTATE\n    A->U: can you please visit projects.gitlab.io\/auth?state=ATTACKERSTATE\n    U->>P: projects.gitlab.io\/auth?state=ATTACKERSTATE\n    Note over P,G: OAuth workflow\n    rect rgb(0, 255, 0)\n    Note over P,G: use the domain from state, wich is ATTACKERSDOMAIN.COM\n    P->>U: redirect to ATTACKERSDOMAIN.COM?state=ATTACKERSTATE&code=mycode\n    U->>AD: ?state=ATTACKERSTATE&code=mycode\n    end\n    AD->>A: code=mycode\n    Note right of A: Need to get a valid state in cookie:\n    A->>D: get index.html\n    D->>A: unauthorized, redirect to projects.gitlab.io\/auth?state=USERSTATE(JWT({random=random, domain=mygroup.gitlab.io}))\n    Note right of A: skip the auth, just go the last step manually:\n    A->>D: \/auth?state=USERSTATE&code=mycode\n    Note over D,G: Exchange code for token and verify that user has permissions for the mygroup.gitlab.io\n    D->>A: success\n```\n\n### The \"~~Signed~~ Encrypted code\" fix\n\nMy current idea is to sign the code instead of state when we redirect back to user domain\n\n```mermaid\nsequenceDiagram\n    participant A as Attacker\n    participant U as User\n    participant D as mygroup.gitlab.io\n    participant P as projects.gitlab.io\n    participant G as gitlab.com\n    participant AD as ATTACKERSDOMAIN.com\n    A->U: can you please visit projects.gitlab.io\/auth?domain=ATTACKERSDOMAIN.COM&state=IRRELEVANT\n    U->>P: projects.gitlab.io\/auth?domain=ATTACKERSDOMAIN.COM&state=IRRELEVANT\n    Note over P,G: domain=ATTACKERSDOMAIN.COM is being saved to the session cookie\n    Note over P,G: OAuth workflow\n    P->>U: redirect to ATTACKERSDOMAIN.COM?state=IRRELEVANT&securecode=ENCRYPTED({domain=ATTACKERSDOMAIN.COM, code=mycode})\n    U->>AD: ?state=IRRELEVANT&securecode=ENCRYPTED({domain=ATTACKERSDOMAIN.COM, code=mycode})\n    AD->>A: securecode=ENCRYPTED({domain=ATTACKERSDOMAIN.COM, code=mycode})\n    Note right of A: Need to get a valid state in cookie:\n    A->>D: get index.html\n    D->>A: unauthorized, redirect to projects.gitlab.io\/auth?domain=mygroup.gitlab.io&state=USERSTATE\n    Note right of A: skip the auth, just go the last step manually:\n    A->>D: \/auth?state=USERSTATE&securecode=ENCRYPTED({domain=ATTACKERSDOMAIN.COM, code=mycode})\n    Note right of D: decrypt code, and get domain=ATTACKERSDOMAIN.COM, and code=mycode\n    Note right of D: check if ATTACKERSDOMAIN.COM==mygroup.gitlab.io\n    Note right of D: it's not equal, so user was tricked into clicking this,\n    D->>A: failure\n```\n\n**I can't say if there is a way to bypass this check. I would really appreciate if everyone who read that far tries to break it** :wink: \n\n<\/details>","state":"closed","created_at":1571651218732,"updated_at":1678363155758,"closed_at":1610044630145,"closed_by":{"id":4992072,"username":"dcouture","name":"Dominic Couture","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4992072\/avatar.png","web_url":"https:\/\/gitlab.com\/dcouture"},"labels":["Category:Pages","HackerOne","Weakness::CWE-287","backend","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","priority::1","section::ops","security","security-backlog::valid","severity::2","type::bug","workflow::verification"],"milestone":{"id":1233757,"iid":54,"group_id":9970,"title":"13.7","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:43:14.893Z","updated_at":"2022-04-13T14:51:12.240Z","due_date":"2020-12-17","start_date":"2020-11-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/54"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":2741139,"username":"gitlab-securitybot","name":"GitLab SecurityBot","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/2741139\/avatar.png","web_url":"https:\/\/gitlab.com\/gitlab-securitybot"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":136,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/262","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":7,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/262","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/262\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/262\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#262","relative":"#262","full":"gitlab-org\/gitlab-pages#262"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":26044218,"iid":260,"project_id":734943,"title":"Secrets cannot be passed on the command line","description":"Passing of Pages secrets was deprecated with issue https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\/208 and issues a deprecation warning in the Pages logs. \n\nDisallowing the passing of secrets is a breaking change, so should be implemented during the next major release of GitLab (13.0).\n","state":"closed","created_at":1571320765470,"updated_at":1589196218633,"closed_at":1589170788098,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","cicd::active","devops::release [DEPRECATED]","maintenance::refactor","security","workflow::production"],"milestone":{"id":991112,"iid":42,"group_id":9970,"title":"13.0","description":"","state":"closed","created_at":"2019-09-04T15:20:39.024Z","updated_at":"2020-10-08T12:00:55.725Z","due_date":"2020-05-17","start_date":"2020-04-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/42"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4391348,"username":"sean_carroll","name":"Sean Carroll","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4391348\/avatar.png","web_url":"https:\/\/gitlab.com\/sean_carroll"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":13,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/260","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/260","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/260\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/260\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#260","relative":"#260","full":"gitlab-org\/gitlab-pages#260"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":21200693,"iid":223,"project_id":734943,"title":"Default to JSON Logging","description":"[We are moving to make JSON the default configured log format for GitLab Pages in 12.0 Omnibus release](https:\/\/gitlab.com\/gitlab-org\/omnibus-gitlab\/issues\/4102).\n\nWould we like to make this the source install default as well by changing https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/blob\/master\/logging.go#L28 ?","state":"closed","created_at":1558561086918,"updated_at":1623919796223,"closed_at":1623919796201,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] low hanging fruit","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":2602134,"username":"rmarshall","name":"Robert Marshall","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/c78f467da196431abcc7aa223fdc1c64?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/rmarshall"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/223","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/223","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/223\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/223\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#223","relative":"#223","full":"gitlab-org\/gitlab-pages#223"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":20643279,"iid":219,"project_id":734943,"title":"Convert https variable to Gorilla ProxyHeaders","description":"We temporary saved `https` flag in the context in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/merge_requests\/168\/diffs, but `https` variable is still being passed through a lot of calls.\n\nWe can use https:\/\/godoc.org\/github.com\/gorilla\/handlers#ProxyHeaders instead of both these solutions.\n\nWe'll remove this flag in three steps \n\n- [x] Merge https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/225 to log an error if `https` flag does not match the `r.URL.Scheme`\n- [x] Test bed with using a reverse proxy see https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\/219#note_281592054 \n- [x] Completely remove the `https` flag from the context\n\n<details>\n<summary>Old description<\/summary>\n\nThe following discussion from !141 should be addressed:\n\n- [ ] @nick.thomas started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/merge_requests\/141#note_167068450):  (+1 comment)\n\n    > I know we use this imperative style of middleware (returning true\/false to indicate whether to end) elsewhere in gitlab-pages, but I wonder if we could avoid it in this case, and instead use the `http.Handler` style instead?\n    > \n    > One approach: the `Middleware` type would have a `ServeHTTP()` method and a `next` member. In the cases where we currently `return false`, we'd instead `m.next.ServeHTTP(w, r) ; return`. Otherwise, we'd serve the redirect and return. \n    > \n    > We use this pattern in workhorse and it serves us quite well. WDYT?\n\nThis is mostly a refactoring issue, I think  it would make the gitlab-pages codebase easier to understand, and we could make use of more third-party implementations this way.\n\nOne example: we could start using https:\/\/godoc.org\/github.com\/gorilla\/handlers#ProxyHeaders on *just* the `ServeProxy` route!\n\n<\/details>","state":"closed","created_at":1557218356048,"updated_at":1582248181992,"closed_at":1582212504399,"closed_by":{"id":376774,"username":"nolith","name":"Alessio Caiazza","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/376774\/avatar.png","web_url":"https:\/\/gitlab.com\/nolith"},"labels":["Category:Pages","backend","cicd::active","devops::release [DEPRECATED]","missed-deliverable","missed:12.4","missed:12.5","missed:12.8","type::feature","workflow::in review"],"milestone":{"id":1001916,"iid":44,"group_id":9970,"title":"12.9","description":"https:\/\/about.gitlab.com\/releases\/2020\/03\/22\/gitlab-12-9-released","state":"closed","created_at":"2019-09-15T20:54:50.875Z","updated_at":"2020-09-02T11:04:41.671Z","due_date":"2020-03-17","start_date":"2020-02-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/44"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":22,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/219","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":4,"completed_count":3},"weight":2,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/219","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/219\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/219\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#219","relative":"#219","full":"gitlab-org\/gitlab-pages#219"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":17671246,"iid":196,"project_id":734943,"title":"Serve *in*directly from artifacts","description":"![1_-_Artifact.zip_SSOT_plus_filesystem_cache](\/uploads\/31e4d81967e779c24dc76b08a89d747e\/1_-_Artifact.zip_SSOT_plus_filesystem_cache.jpeg)\n\n## Prerequisites\n\n1. Pages site artifact zip files are no longer consumed https:\/\/gitlab.com\/gitlab-org\/gitlab-ce\/issues\/45888\n1. We regenerate any Pages artifact zip files that were already consumed https:\/\/gitlab.com\/gitlab-org\/gitlab-ee\/issues\/9346\n1. We have Pages pull config from the Rails API https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\/161\n\n## Proposal\n\n1. Pages receives a request for a site resource.\n1. Pages does a lookup in configs as usual.\n1. If the site exists, and Pages doesn't have the artifact.zip yet, it downloads it via the Rails API.\n1. Pages extracts the zip to a unique path in its filesystem.\n1. Pages serves the site from that path.\n1. Pages regularly checks for invalidation, so the filesystem acts as an LRU or other cache.\n\n### Pros\n\n- ~Geo doesn't need to \"sync\" *anything* at all.\n- Pages becomes HA and scalable?\n- Pages site symlinks continue to work.\n- Object storage is not required.\n\n### Cons\n\n- If we are extracting artifact.zip on demand, there is a cold-cache issue, whenever a new request comes in, there is this initial download\/extract time before it can handle requests, and this is shared by each \"Pages\" node. Site can be of GBs if it include a lot of images. It would 503 for a while.\n- Invalidating\/expiring is complex as you need to ping each machine to free space, or each one have to ping API in order to determine if they can or cannot remove folder from disk - O(N*M)?\n\n## More related discussion\n\nGitLab Pages direction doc (internal link): https:\/\/docs.google.com\/document\/d\/18awpT5MVhlmdX0erO1X__Od59KZvrXBbdV0HG5A7WZk\/edit#\n\n@nick.thomas \n\n>>>\nOnce we have https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\/78 done, we could rework the main pages functionality as a set of pointers to specific pages artifacts, accessed in the same way.\n\nWe'd need to stop deleting pages artifacts, and somehow regenerate the ones already deleted, of course, but then custom domains and the group \/ project pages can just become pointers to artifacts, with an optional filesystem cache to speed things up.\n\nOnce a given pages artifact is no longer the latest, it can expire according to the usual rules.\n>>>\n\nhttps:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\/158:\n\n@nick.thomas \n\n>>>\nFor content, I think we want to implement https:\/\/gitlab.com\/gitlab-org\/gitlab-ce\/issues\/45888. Modulo existing customer data (which could _in principle_ be backfilled), this will ensure you can _always_ get the current Pages content for a site from the GitLab API, (which may, of course, be serving a redirect to an archive in object storage).\n\nOnce we have this, we can treat the file store as a **non-coherent temporary cache**. If we're still interested in continued resilience while the GitLab API is unavailable, we can endeavour to keep it filled all the time. If the file store is lost, we can stand up a new, empty one, and the cache can be refilled from the GitLab API, either aggressively, or on-first-request.\n\nIf we have two of these backends, they don't have to share an NFS mount, and the loss of one won't cause an outage.\n>>>","state":"closed","created_at":1548446498217,"updated_at":1622044707092,"closed_at":1622044707077,"closed_by":{"id":1144264,"username":"mkozono","name":"Michael Kozono","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/6243abba3cf112e6df4a5a644c5f86aa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/mkozono"},"labels":["Architecture decision","Category:Pages","customer","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::feature"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":1144264,"username":"mkozono","name":"Michael Kozono","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/6243abba3cf112e6df4a5a644c5f86aa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/mkozono"},"type":"ISSUE","assignee":null,"user_notes_count":21,"merge_requests_count":0,"upvotes":10,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/196","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":20,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/196","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/196\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/196\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#196","relative":"#196","full":"gitlab-org\/gitlab-pages#196"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":589.0,"epic":{"id":2262,"iid":589,"title":"Geo: Support GitLab Pages","url":"\/groups\/gitlab-org\/-\/epics\/589","group_id":9970},"iteration":null,"health_status":null},{"id":17669680,"iid":195,"project_id":734943,"title":"Serve directly from artifacts in object storage","description":"![3_-_Proxy_to_artifact_in_object_storage](\/uploads\/12aa3170c49ec07d67f84b0930c56202\/3_-_Proxy_to_artifact_in_object_storage.jpeg)\n\n## Prerequisites\n\n1. Pages site artifact zip files are no longer consumed https:\/\/gitlab.com\/gitlab-org\/gitlab-ce\/issues\/45888\n1. We regenerate any Pages artifact zip files that were already consumed https:\/\/gitlab.com\/gitlab-org\/gitlab-ee\/issues\/9346\n1. We have Pages pull config from the Rails API https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\/161\n\n## Proposal\n\n1. Pages receives a request for a site resource.\n1. Pages does a lookup in configs as usual.\n1. Pages basically proxies the artifact files in object storage.\n\n### After MVP\n\n1. Pages caches the proxied files\n1. Pages translates symlinks into redirects (if we feel this is important enough behavior to add back)\n\n### Pros\n\n- ~Geo doesn't need to \"sync\" _anything_ at all.\n- Pages becomes HA and scalable?\n\n### Cons\n\n- Object storage is required.\n- Pages site symlinks would break, but it may be possible to reimplement the behavior by translating them to redirects.\n- Pages would need to keep the \"old\" way as well. To support small, simple instances, e.g. Raspberry Pi.\n- How would we transition?\n\n### More related discussion\n\nGitLab Pages direction doc (internal link): https:\/\/docs.google.com\/document\/d\/18awpT5MVhlmdX0erO1X__Od59KZvrXBbdV0HG5A7WZk\/edit#\n\n@brodock https:\/\/gitlab.com\/gitlab-org\/gitlab-ee\/issues\/4611#note_88542926:\n\n>>>\nI built a similar infra for hosting landing-pages at my previous company. The use-case is very similar to ours and it was also inspired in how GitHub Pages works.\n\nThe endpoint that served the pages were proxying requests to the S3 bucket, based on the domain we would find the base folder and then try to look for files.\nBecause S3 calls can be expensive, I've also added a short-lived TTL cache between the twos, so any spike in traffic would not mean multiple requests to the object storage.\n\nRelevant information is here: http:\/\/shipit.resultadosdigitais.com.br\/blog\/do-apache-ao-go-como-melhoramos-nossas-landing-pages\/ (it's in portuguese but google translator does a really good job).\n\nFor that specific use-case the Domain mapping was kept in both the database (for persistence reasons) and in Redis (so it is fast). Redis was being used not as cache but as main source of truth for that.\n>>>\n\n@nick.thomas https:\/\/gitlab.com\/gitlab-org\/gitlab-ee\/issues\/4611#note_101235573:\n\n>>>\nServing the _contents_ of the artifacts directly from object storage does several undesirable things from my point of view:\n\n- Makes object storage mandatory for Pages (unnecessary complexity for small sites)\n- Requires many changes in the Pages daemon\n- Breaks current symlink support, so breaking existing pages deployments\n\nUltimately, though, the route we take there is up to ~Release and @jlenny.\n>>>\n\nhttps:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\/68:\n\n@ayufan \n\n>>>\nWe could serve pages directly from ZIP archives, but loading all of the metadata is IO and memory consuming operation so it is not worthy.\n\nMaybe the solution is to assume that pages access data behind object storage, always. We could then build pages and sidekiq to access object storage directly, not filesystem. Extract data there and update metadata to make pages to pick a new changes.\n>>>\n\n@ayufan \n\n>>>\nCan pages be just regular OAuth application? Can pages use general API to download artifacts? This is possible even today. Maybe we can just generate one time URLs to download artifacts, similar how you can sign S3 URLs.\n>>>","state":"closed","created_at":1548438927240,"updated_at":1679006250109,"closed_at":1549316959408,"closed_by":{"id":1144264,"username":"mkozono","name":"Michael Kozono","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/6243abba3cf112e6df4a5a644c5f86aa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/mkozono"},"labels":["Architecture decision","Category:Geo Replication","group::geo","type::feature"],"milestone":null,"assignees":[],"author":{"id":1144264,"username":"mkozono","name":"Michael Kozono","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/6243abba3cf112e6df4a5a644c5f86aa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/mkozono"},"type":"ISSUE","assignee":null,"user_notes_count":5,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/195","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":20,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/195","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/195\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/195\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#195","relative":"#195","full":"gitlab-org\/gitlab-pages#195"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":16202508,"iid":183,"project_id":734943,"title":"Custom error pages not served for namespace domains","description":"Summary\n===\n\n`\/404.html` not served even though it exists.\n\nSteps to reproduce\n===\n\nCreate a GitLab Pages website with `\/404.html`. Go to `\/non\/existing_file`.\n\nExpected\n===\n\n`\/404.html` served.\n\nActual\n===\n\nDefault GitLab 404 page served when using `*.gitlab.io`, but `\/404.html` served when using custom domain.\n\nUseful links\n===\n\nPublic repository with a minimal, complete, verifiable example: https:\/\/gitlab.com\/error-page-demo\/error-page-demo.gitlab.io\n\nNon-existent GitLab Page: https:\/\/error-page-demo.gitlab.io\/non\/existing_file\n\n\nPage that should be served: https:\/\/error-page-demo.gitlab.io\/404.html\n\nRelevant documentation: https:\/\/docs.gitlab.com\/ce\/user\/project\/pages\/introduction.html#custom-error-codes-pages","state":"closed","created_at":1543464208753,"updated_at":1653457481328,"closed_at":1594643677399,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","[deprecated] Accepting merge requests","devops::release [DEPRECATED]","missed:12.10","priority::3","severity::3","type::bug","workflow::in review"],"milestone":{"id":1233746,"iid":49,"group_id":9970,"title":"13.2","description":"https:\/\/about.gitlab.com\/releases\/2020\/07\/22\/gitlab-13-2-released\/","state":"closed","created_at":"2020-04-09T17:28:01.032Z","updated_at":"2022-04-13T14:48:24.167Z","due_date":"2020-07-17","start_date":"2020-06-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/49"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":2410096,"username":"JonstonChan","name":"Jonston Chan","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/2410096\/avatar.png","web_url":"https:\/\/gitlab.com\/JonstonChan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":25,"merge_requests_count":1,"upvotes":17,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/183","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/183","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/183\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/183\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#183","relative":"#183","full":"gitlab-org\/gitlab-pages#183"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":13689763,"iid":161,"project_id":734943,"title":"Load domain data from API instead of traversing filesystem","description":"We've seen a number of bugs where stale values of `config.json` are stored or stale directories mess up the domains loading. I think it might make sense to switch GitLab Pages to load the data from the API. We are doing this to support access control in !94.\n\n- [ ] CE: Add API endpoint to serve project pages config.json\n- [ ] Pages: Fetch and cache config when it does not exist","state":"closed","created_at":1535179486063,"updated_at":1606513246880,"closed_at":1567111907327,"closed_by":{"id":2737706,"username":"darbyfrey","name":"Darby Frey","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/2737706\/avatar.png","web_url":"https:\/\/gitlab.com\/darbyfrey"},"labels":["Category:Pages","devops::release [DEPRECATED]","maintenance::refactor","priority::2","severity::2"],"milestone":null,"assignees":[],"author":{"id":64248,"username":"stanhu","name":"Stan Hu","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/64248\/stanhu.jpg","web_url":"https:\/\/gitlab.com\/stanhu"},"type":"ISSUE","assignee":null,"user_notes_count":20,"merge_requests_count":0,"upvotes":6,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/161","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":2,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/161","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/161\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/161\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#161","relative":"#161","full":"gitlab-org\/gitlab-pages#161"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4242.0,"epic":{"id":97712,"iid":4242,"title":"Move pages domain\/project configuration to the API","url":"\/groups\/gitlab-org\/-\/epics\/4242","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":2803186,"iid":28,"project_id":734943,"title":"Support HSTS on GitLab Pages","description":"## Problem to Solve\n\nSome users want to enforce no access to their web content without HTTPS\/certificates. This can be done with [HTTP Strict Transport Security (HSTS) policy](https:\/\/en.wikipedia.org\/wiki\/HTTP_Strict_Transport_Security), but we do not currently support enabling this for GitLab Pages sites.\n\n## Proposal\n\nBy allowing for enabling this as a custom configuration\/policy associated with a Pages site, we can make this possible.\n<!-- triage-serverless v3 PLEASE DO NOT REMOVE THIS SECTION -->\n*This page may contain information related to upcoming products, features and functionality.\nIt is important to note that the information presented is for informational purposes only, so please do not rely on the information for purchasing or planning purposes.\nJust like with all projects, the items mentioned on the page are subject to change or delay, and the development, release, and timing of any products, features, or functionality remain at the sole discretion of GitLab Inc.*\n<!-- triage-serverless v3 PLEASE DO NOT REMOVE THIS SECTION -->","state":"closed","created_at":1471890650935,"updated_at":1667180280882,"closed_at":1666778704564,"closed_by":{"id":1646689,"username":"oregand","name":"David O'Regan","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/1646689\/avatar.png","web_url":"https:\/\/gitlab.com\/oregand"},"labels":["Category:Pages","Deliverable","GitLab Free","[deprecated] Accepting merge requests","backend","customer","devops::create","direction","group::editor","priority::2","section::dev","security","severity::3","type::feature","workflow::refinement"],"milestone":{"id":2453027,"iid":77,"group_id":9970,"title":"15.5","description":"","state":"active","created_at":"2022-02-03T22:29:56.909Z","updated_at":"2022-02-03T22:29:56.909Z","due_date":"2022-10-17","start_date":"2022-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/77"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"}],"author":{"id":602446,"username":"mhalano","name":"Marcos H. Alano","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/42d18016aae2b40cc761f58eda8b3e17?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/mhalano"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"user_notes_count":78,"merge_requests_count":0,"upvotes":45,"downvotes":0,"due_date":"2020-11-18","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/28","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":1,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/28","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/28\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/28\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#28","relative":"#28","full":"gitlab-org\/gitlab-pages#28"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":766.0,"epic":{"id":3437,"iid":766,"title":"Improve certificate handling for Pages","url":"\/groups\/gitlab-org\/-\/epics\/766","group_id":9970,"human_readable_end_date":"Oct 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":2574075,"iid":23,"project_id":734943,"title":"Support for single page applications route all requests to index.html.","description":"## Problem to Solve \n\nWhen routing requests to Gitlab Pages, if there is no default index.html, the request renders an error that does not permit SEO or support of SPA on GitLab Pages. \n\n## Solution \n\nRoute all requests to GitPages to \/index.html by:\n*  implementing a `route single page app to index.html` to a checkbox in **Pages > Settings**\n* Enable SPAs to serve any accompanying files so that it works\n* Ensure existing files are served before trying to serve `index.html`\n\n## Update 2021-07-20\nClosing this issue in favor of https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/57. We aim to enable SPAs via a new `.gitlab-pages.yml`","state":"closed","created_at":1468072660932,"updated_at":1656310531792,"closed_at":1626803249906,"closed_by":{"id":5213298,"username":"kbychu","name":"Kevin Chu","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/0b6f70425a17d5ab47ec6093f8df9aa6?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kbychu"},"labels":["CEO Interest","Category:Pages","Community challenge","[deprecated] Accepting merge requests","customer","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::feature","workflow::planning breakdown"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":423525,"username":"mxrlkn","name":"mxrlkn","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/423525\/avatar.png","web_url":"https:\/\/gitlab.com\/mxrlkn"},"type":"ISSUE","assignee":null,"user_notes_count":66,"merge_requests_count":0,"upvotes":98,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/23","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/23","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/23\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/23\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#23","relative":"#23","full":"gitlab-org\/gitlab-pages#23"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":2317.0,"epic":{"id":16058,"iid":2317,"title":"Pages: Redirects","url":"\/groups\/gitlab-org\/-\/epics\/2317","group_id":9970,"human_readable_end_date":"Sep 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":118056437,"iid":810,"project_id":734943,"title":"Follow-up from \"Add auth-cookie-session-timeout flag\" - In Auth constructor use options struct","description":"The following discussion from !834 should be addressed:\n\n- [ ] @proglottis started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/834#note_1156512951): \n\n    > nit, not directly related to your change, but this constructor has enough arguments now that it's probably worth extracting an options struct.","state":"closed","created_at":1667460058432,"updated_at":1674108853300,"closed_at":1674108772732,"closed_by":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/12750949\/avatar.png","web_url":"https:\/\/gitlab.com\/ngala"},"labels":["Category:Pages","Stretch","backend","devops::create","group::editor","maintenance::refactor","section::dev","type::maintenance"],"milestone":{"id":2745650,"iid":84,"group_id":9970,"title":"15.9","description":"","state":"active","created_at":"2022-08-22T16:58:02.303Z","updated_at":"2022-08-22T16:58:02.303Z","due_date":"2023-02-17","start_date":"2023-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/84"},"assignees":[{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/12750949\/avatar.png","web_url":"https:\/\/gitlab.com\/ngala"}],"author":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/12750949\/avatar.png","web_url":"https:\/\/gitlab.com\/ngala"},"type":"ISSUE","assignee":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/12750949\/avatar.png","web_url":"https:\/\/gitlab.com\/ngala"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/810","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/810","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/810\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/810\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#810","relative":"#810","full":"gitlab-org\/gitlab-pages#810"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":117942630,"iid":809,"project_id":734943,"title":"`cache_pages_domain_api` feature flag cause failures in staging","description":"### Summary\n\nDuring the rollout of `cache_pages_domain_api` feature flag, the gitlab pages qa tests on staging started to fail.\n\nAfter some investigation with `@vshushlin`, we found out that the application settings are different between rails nodes (where the cache is created) and sidekiq nodes (where the cache is invalidated). Since we us a hash for the application settings in the cache key, the sidekiq job never finds the cache key to invalide it.\n\nRelated:\n- https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/376332+\n- https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/364127+\n\n### Possible fixes\n\n```json:table\n{\n    \"items\" : [\n{\n\"option\": \"\ud83c\udd70\ufe0f\",\n\"description\": \"Instead of using the application settings hash in the cache key we could insert the hash in the cached value and validate it when reading the cache. This way the app settings is not part of the cache key, so it should get invalidated in the sidekiq nodes.\",\n\"cons\": \"validating the cache manually based on the cached value.\"\n},\n{\n\"option\": \"\ud83c\udd71\ufe0f\",\n\"description\": \"Instead of using the application settings hash in the cache key we could have a two layers cache. The main cache key would save the app settings hash, which would be the key to the payload itself.\",\n\"cons\": \"two reads on redis to find the cached value.\"\n}\n]\n}\n```","state":"closed","created_at":1667310197770,"updated_at":1669888427624,"closed_at":1669888427601,"closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"labels":["Category:Pages","bug::functional","devops::create","group::editor","section::dev","type::bug","workflow::in review"],"milestone":null,"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"}],"author":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/809","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/809","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/809\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/809\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#809","relative":"#809","full":"gitlab-org\/gitlab-pages#809"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7920.0,"epic":{"id":503228,"iid":7920,"title":"Pages Internal API Caching","url":"\/groups\/gitlab-org\/-\/epics\/7920","group_id":9970,"human_readable_end_date":"May 17, 2023","human_readable_timestamp":"<strong>11<\/strong> days remaining"},"iteration":null,"health_status":null},{"id":117645763,"iid":808,"project_id":734943,"title":"Support HSTS on GitLab Pages on per domain basis (also on gitlab.com)","description":"## Problem to Solve\n\nSome users want to enforce no access to their web content without HTTPS\/certificates. \n\nThis can be done with [HTTP Strict Transport Security (HSTS) policy](https:\/\/en.wikipedia.org\/wiki\/HTTP_Strict_Transport_Security), but we do not currently support enabling this for GitLab Pages sites on GitLab.com.\n\n## Solution \n\nAllow users to enable HSTS for Pages on GitLab.com.","state":"closed","created_at":1666813932963,"updated_at":1667180259641,"closed_at":1667180259614,"closed_by":{"id":1646689,"username":"oregand","name":"David O'Regan","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/1646689\/avatar.png","web_url":"https:\/\/gitlab.com\/oregand"},"labels":["Category:Pages","GitLab Free","backend","devops::create","feature::enhancement","frontend","group::editor","section::dev","type::feature","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":1646689,"username":"oregand","name":"David O'Regan","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/1646689\/avatar.png","web_url":"https:\/\/gitlab.com\/oregand"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":0,"upvotes":3,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/808","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/808","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/808\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/808\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#808","relative":"#808","full":"gitlab-org\/gitlab-pages#808"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":115192449,"iid":806,"project_id":734943,"title":"Session timeout after 10 minutes","description":"### Summary\n\nWe use gitlab-pages for several internal website hostings and our users experience annoying session timeouts due to the short lifetime of the gitlab-pages cookie of 10 minutes. As an example, a single page web app can't load further assets (e.g. images) after the session timeout and a (hard) refresh in the browser is necessary.\n\nThe `authSessionMaxAge` constant is hardcoded in [`internal\/auth\/auth.go`](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/14e310074668254398d13f74e647dd16df2cb12c\/internal\/auth\/auth.go#L40):\n\n```go\nauthSessionMaxAge      = 60 * 10 \/\/ 10 minutes\n```\n\nIt seems that this was introduced with https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/178.\n\nSo we have a few questions:\n- Why was the timeout set to exactly 10 minutes? Is there a reason for this (e.g. a standard)?\n- If there is no specific reason, would it be possible to increase this value?\n- Or would it be possible to make this value configurable?\n\n\nWDYT?\n\nIf desired, we would be happy to support you as ~\"Leading Organization\"  with a ~\"Community contribution\".\n\n### Example Project\n\n<!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. -->\n\n### What is the current *bug* behavior?\n\nThere's a session timeout after 10 minutes.\n\n### What is the expected *correct* behavior?\n\nThe duration to a session timeout is higher or can be configured.\n\n### Goal\n\nMake the timeout configurable:\n\n1. [x] Add a new flag to Pages e.g. `auth-cookie-session-timeout` with default value of `10m` :arrow_right: https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/834\n1. [x] Add the flag to Omnibus, see [sample MR](https:\/\/gitlab.com\/gitlab-org\/omnibus-gitlab\/-\/merge_requests\/6144\/diffs) :arrow_right: https:\/\/gitlab.com\/gitlab-org\/omnibus-gitlab\/-\/merge_requests\/6495\n1. [x] Add the flag to the Helm charts, see [sample MR](https:\/\/gitlab.com\/gitlab-org\/charts\/gitlab\/-\/merge_requests\/2338\/diffs) :arrow_right: https:\/\/gitlab.com\/gitlab-org\/charts\/gitlab\/-\/merge_requests\/2838\n1. [x] Update the admin documentation, see [sample MR](https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/merge_requests\/89780\/diffs) :arrow_right: https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/merge_requests\/102996","state":"closed","created_at":1663319672428,"updated_at":1668573977763,"closed_at":1668573977736,"closed_by":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/12750949\/avatar.png","web_url":"https:\/\/gitlab.com\/ngala"},"labels":["devops::create","feature::addition","group::editor","section::dev","type::feature","workflow::in dev"],"milestone":{"id":2687593,"iid":81,"group_id":9970,"title":"15.6","description":"","state":"active","created_at":"2022-07-06T19:22:27.893Z","updated_at":"2022-07-06T19:22:27.893Z","due_date":"2022-11-17","start_date":"2022-10-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/81"},"assignees":[{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/12750949\/avatar.png","web_url":"https:\/\/gitlab.com\/ngala"}],"author":{"id":2742410,"username":"wwwjon","name":"Jonas W\u00e4lter","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/2742410\/avatar.png","web_url":"https:\/\/gitlab.com\/wwwjon"},"type":"ISSUE","assignee":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/12750949\/avatar.png","web_url":"https:\/\/gitlab.com\/ngala"},"user_notes_count":15,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/806","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":4,"completed_count":4},"weight":3,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/806","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/806\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/806\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#806","relative":"#806","full":"gitlab-org\/gitlab-pages#806"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":115128713,"iid":805,"project_id":734943,"title":"GCS ranged requests sometimes fails with 400","description":"<!---\n\nPlease read this!\n\n**NOTE**: Please check https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/331699 if you had issues upgrading to 14.0+\n\nBefore opening a new issue, make sure to search for keywords in the issues (including closed ones)\n- https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\n\nand verify the issue you're about to submit isn't a duplicate.\n--->\n\n\n### Summary\n\nIn GitLab.com, we recently ran into an [incident](https:\/\/gitlab.com\/gitlab-com\/gl-infra\/production\/-\/issues\/7727) where a small number of Pages hosts failed with 500 errors. Digging into it we found that this resulted from internal error where ranged requests to GCS were failing with \"400 Bad Request\".\n\nThis behavior seems recent (started Sepetmeber 8th), judging by graphs from GCS:\n![image](\/uploads\/795e5836674f380e1ada61233dd81ff8\/image.png).\n\nKibana logs doesn't provide much info beside the error itself, so perhaps we may need to consider logging the response body of 400 responses.\n\n<!-- DO NOT CHANGE -->","state":"closed","created_at":1663243658985,"updated_at":1664448127773,"closed_at":1663946947212,"closed_by":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/bd6d0ec4213b91601956c9f801cbfe9b?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ahmadsherif"},"labels":["Category:Pages","bug::availability","devops::create","golang","group::editor","infradev","priority::3","section::dev","severity::4","type::bug"],"milestone":{"id":2453027,"iid":77,"group_id":9970,"title":"15.5","description":"","state":"active","created_at":"2022-02-03T22:29:56.909Z","updated_at":"2022-02-03T22:29:56.909Z","due_date":"2022-10-17","start_date":"2022-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/77"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"}],"author":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/bd6d0ec4213b91601956c9f801cbfe9b?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ahmadsherif"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/805","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/805","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/805\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/805\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#805","relative":"#805","full":"gitlab-org\/gitlab-pages#805"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":111236649,"iid":792,"project_id":734943,"title":"Update documentation to state _redirects limits are now configurable","description":"Based on the work in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/778+, we want to update the ~documentation guides to let users know that the Pages ` _redirects limits` are now configurable.","state":"closed","created_at":1657095397411,"updated_at":1657530468242,"closed_at":1657530468222,"closed_by":{"id":1646689,"username":"oregand","name":"David O'Regan","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/1646689\/avatar.png","web_url":"https:\/\/gitlab.com\/oregand"},"labels":["Category:Pages","Technical Writing","backend","devops::create","documentation","frontend","group::editor","section::dev","type::feature","workflow::ready for development"],"milestone":{"id":2453024,"iid":74,"group_id":9970,"title":"15.2","description":"","state":"active","created_at":"2022-02-03T22:24:46.818Z","updated_at":"2022-02-03T22:26:32.010Z","due_date":"2022-07-17","start_date":"2022-06-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/74"},"assignees":[],"author":{"id":1646689,"username":"oregand","name":"David O'Regan","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/1646689\/avatar.png","web_url":"https:\/\/gitlab.com\/oregand"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/792","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/792","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/792\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/792\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#792","relative":"#792","full":"gitlab-org\/gitlab-pages#792"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":110795348,"iid":787,"project_id":734943,"title":"Flaky TestDomainResolverError race","description":"I've seen an increase in race test failures for `TestDomainResolverError` recently, I think it's worth investigating a bit more.\n\nJob [#2647463990](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/jobs\/2647463990) failed for be06885fdd167a523dd8e1e103bcbb23bb32db61:","state":"closed","created_at":1656375120958,"updated_at":1656573518638,"closed_at":1656573518608,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","devops::create","failure::flaky-test","golang","group::editor","section::dev","type::bug","workflow::in review"],"milestone":{"id":2453024,"iid":74,"group_id":9970,"title":"15.2","description":"","state":"active","created_at":"2022-02-03T22:24:46.818Z","updated_at":"2022-02-03T22:26:32.010Z","due_date":"2022-07-17","start_date":"2022-06-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/74"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"user_notes_count":4,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/787","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/787","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/787\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/787\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#787","relative":"#787","full":"gitlab-org\/gitlab-pages#787"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":110261083,"iid":781,"project_id":734943,"title":"Move Gitlab Pages documentation menu in the sidebar one level up","description":"### Summary\n\nGitlab Pages contribution documentation was recently moved to the docs site. I think it deserves to be a bit more discoverable\/easier to access. For that, I propose to move it to its own *contributing* submenu.\n| before | after |\n|--------|-------|\n| <img alt=\"SCR-20220616-l99\" src=\"https:\/\/gitlab.com\/gitlab-org\/gitlab-docs\/uploads\/76a348a3f1c32c69d18dfb674aa7780d\/SCR-20220616-l99.png\" width=\"300\"\/> | <img alt=\"image\" src=\"https:\/\/gitlab.com\/gitlab-org\/gitlab-docs\/uploads\/0abb0e10552412569fa43e60ffc03de1\/image.png\" width=\"300\"\/> |","state":"closed","created_at":1655411061528,"updated_at":1655823403569,"closed_at":1655823403551,"closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"labels":["Category:Pages","Technical Writing","devops::create","group::editor","type::maintenance","workflow::production"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/73"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"}],"author":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/781","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/781","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/781\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/781\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#781","relative":"#781","full":"gitlab-org\/gitlab-pages#781"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7829.0,"epic":{"id":488235,"iid":7829,"title":"\ud83d\udcd6 Pages documentation cleanup","url":"\/groups\/gitlab-org\/-\/epics\/7829","group_id":9970,"human_readable_end_date":"May 17, 2023","human_readable_timestamp":"<strong>11<\/strong> days remaining"},"iteration":null,"health_status":null},{"id":109935782,"iid":774,"project_id":734943,"title":"Remove doc\/development in favor of https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/blob\/master\/doc\/development\/pages\/index.md","description":"<!---\n\nPlease read this!\n\n**NOTE**: Please check https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/331699 if you had issues upgrading to 14.0+\n\nBefore opening a new issue, make sure to search for keywords in the issues (including closed ones)\n- https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\n\nand verify the issue you're about to submit isn't a duplicate.\n--->\n\n\n### Summary\n\n### Steps to reproduce\n\n<!-- Describe how one can reproduce the issue - this is very important. Please use an ordered list. -->\n\n### Example Project\n\n<!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. -->\n\n### What is the current *bug* behavior?\n\n<!-- Describe what actually happens. -->\n\n### What is the expected *correct* behavior?\n\n<!-- Describe what you should see instead. -->\n\n### Relevant logs and\/or screenshots\n\n<!-- Paste any relevant logs - please use code blocks (```) to format console output, logs, and code\n as it's tough to read otherwise. -->\n\n### Output of checks\n\n<!-- If you are reporting a bug on GitLab.com, write: This bug happens on GitLab.com -->\n\n### Possible fixes\n\n<!-- If you can, link to the line of code that might be responsible for the problem. -->\n\n<!-- DO NOT CHANGE -->","state":"closed","created_at":1654884567774,"updated_at":1655457825068,"closed_at":1655457825048,"closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"labels":["Category:Pages","Technical Writing","devops::create","golang","group::editor","section::dev","type::maintenance","workflow::in review"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/73"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"}],"author":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/774","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/774","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/774\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/774\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#774","relative":"#774","full":"gitlab-org\/gitlab-pages#774"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7829.0,"epic":{"id":488235,"iid":7829,"title":"\ud83d\udcd6 Pages documentation cleanup","url":"\/groups\/gitlab-org\/-\/epics\/7829","group_id":9970,"human_readable_end_date":"May 17, 2023","human_readable_timestamp":"<strong>11<\/strong> days remaining"},"iteration":null,"health_status":null},{"id":108886739,"iid":763,"project_id":734943,"title":"[SPIKE] create a gitlab-pages router","description":"### Goal\n\nTry to improve how routes are handled in gitlab-pages. \n\n### Expected Outcome\n\nAn example of how to organize gitlab-pages routes and a plan of action in how to do that in small steps.","state":"closed","created_at":1653066710237,"updated_at":1655372233167,"closed_at":1655372233147,"closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"labels":["Category:Pages","backend","devops::create","golang","group::editor","maintenance::refactor","section::dev","type::maintenance","workflow::verification"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/73"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"}],"author":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/763","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/763","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/763\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/763\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#763","relative":"#763","full":"gitlab-org\/gitlab-pages#763"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":8116.0,"epic":{"id":527286,"iid":8116,"title":"Gitlab Pages routes refactoring","url":"\/groups\/gitlab-org\/-\/epics\/8116","group_id":9970,"human_readable_end_date":"Jul 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":108336188,"iid":758,"project_id":734943,"title":"Investigate and configure bundle on CI to disallow any changes to Gemfile.lock","description":"This is a ~\"corrective action\" of sirt-2266.\n\nDetermine whether this project (https:\/\/gitlab.com\/gitlab-org\/gitlab-pages) uses `bundle` or `bundle install` in CI. Per the Rubygems.org advisory, we should use either the `frozen` or `deployment` options as defense-in-depth to mitigate supply chain attacks. This project needs to use the `frozen` or `deployment` options if not yet.\n\n## More background\n\nSee https:\/\/github.com\/rubygems\/rubygems.org\/security\/advisories\/GHSA-hccv-rwq6-vh79:\n\n> Using Bundler in --frozen or --deployment mode in CI and during deploys, as the Bundler team has always recommended, will guarantee that your application does not silently switch to versions created using this exploit.\n\nNote that the `deployment` option installs gems to `vendor`, which we may not want. So `frozen` will usually be the smaller change.\n\nNote that:\n\n> \\[DEPRECATED\\] The `--frozen` flag is deprecated because it relies on being remembered across bundler invocations, which bundler will no longer do in future versions. Instead please use `bundle config set --local frozen 'true'`, and stop using this flag","state":"closed","created_at":1652224137856,"updated_at":1653274681177,"closed_at":1652996818345,"closed_by":{"id":5407295,"username":"a_mcdonald","name":"Anastasia McDonald","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/1bb6df5df2f37b7a058f0f1d6d2b64d3?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/a_mcdonald"},"labels":["Category:Pages","Quality","corrective action","devops::create","feature::enhancement","group::editor","section::dev","security","severity::2","type::feature"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/73"},"assignees":[{"id":5407295,"username":"a_mcdonald","name":"Anastasia McDonald","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/1bb6df5df2f37b7a058f0f1d6d2b64d3?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/a_mcdonald"}],"author":{"id":3753003,"username":"cdu1","name":"Chun Du","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3753003\/avatar.png","web_url":"https:\/\/gitlab.com\/cdu1"},"type":"ISSUE","assignee":{"id":5407295,"username":"a_mcdonald","name":"Anastasia McDonald","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/1bb6df5df2f37b7a058f0f1d6d2b64d3?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/a_mcdonald"},"user_notes_count":7,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/758","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/758","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/758\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/758\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#758","relative":"#758","full":"gitlab-org\/gitlab-pages#758"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":8028.0,"epic":{"id":518339,"iid":8028,"title":"Use `deployment` or `frozen` options with `bundle install` in CI on all Ruby projects and Chef cookbooks that use Ruby gems","url":"\/groups\/gitlab-org\/-\/epics\/8028","group_id":9970,"human_readable_end_date":"Sep 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":107117140,"iid":749,"project_id":734943,"title":"Add early return and tests for internal\/handlers\/https","description":"The following discussion from !735 should be addressed:\n\n- [ ] @vshushlin started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/735#note_922396637): \n\n    > I would add \n    > \n    > ```golang\n    > if !redirect {\n    > \treturn handler\n    > }\n    > \n    > and tests for this handler. But let's move it to the follow-up issue. This is already a nice improvement :thumbs-up:","state":"closed","created_at":1650872852009,"updated_at":1650998623621,"closed_at":1650998623604,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Seeking community contributions","[deprecated] good for new contributors","devops::create","golang","group::editor","section::dev"],"milestone":{"id":2095271,"iid":65,"group_id":9970,"title":"15.0","description":"","state":"active","created_at":"2021-06-08T15:35:34.814Z","updated_at":"2021-11-02T18:23:35.115Z","due_date":"2022-05-17","start_date":"2022-04-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/65"},"assignees":[{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/40569112d16323eb878ebdead2117943?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/feistel"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/40569112d16323eb878ebdead2117943?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/feistel"},"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/749","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/749","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/749\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/749\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#749","relative":"#749","full":"gitlab-org\/gitlab-pages#749"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":106881635,"iid":747,"project_id":734943,"title":"Infer artifacts-server from internalGitlabServerFromFlags() unless it's set explicitly","description":"### Summary\n\nWe have a lot of config options pointing to the gitlab server. We use them for different reasons:\n\n1. getting domain information\n2. redirecting to authentication\n3. fetching OAuth token\n4. proxying artifacts\n\nIn the simplest case, it should be possible to infer all of them from a single URL.\n\nNote:\n1. some of these URL work in the `internal` network (e.g. OAuth token, gitlab domain information)\n2. while others should be public(e.g. OAuth redirects), because we can redirect the user to this URL\n\nSo we should have at least 2 parameters:\n- `gitlab-server`\n- `gitlab-internal-server`\n\nAnd all of the rest can be inferred from this.\n\nRight now `artifacts-server` should always be set in the config, I suggest we infer if from `internalGitlabServerFromFlags()` unless it's set.\n\n**Optional:** mark `artifacts-server` as deprecated an remove it on the next major release.\n\n## Implementation details\n\n```golang\nfunc artifactsServerFromFlags() string {\n\tif *artifactsServer != \"\" {\n\t\treturn *artifactsServer\n\t}\n\n\treturn internalGitlabServerFromFlags() + \"\/api\/v4\"\n}\n```","state":"closed","created_at":1650437439305,"updated_at":1654235984112,"closed_at":1654235984080,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Seeking community contributions","[deprecated] good for new contributors","backend","devops::create","golang","group::editor","section::ops","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":4,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/747","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/747","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/747\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/747\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#747","relative":"#747","full":"gitlab-org\/gitlab-pages#747"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":106318294,"iid":731,"project_id":734943,"title":"TLS Ciphers are breaking in FIPS Mode","description":"### Summary\n\nWhen Pages is running in FIPS mode, some [ciphers](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/blob\/master\/internal\/tls\/tls.go#L13-L13) do not work.\n\n### Steps to reproduce\n\nFollow steps in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/718#note_904531139\n\nIt also has the list of which ciphers do not work in FIPS mode.\n\n### What is the current *bug* behavior?\n\nAll the ciphers mentioned below work when Pages is running as part of GDK but do not work when Pages is hosted on a FIPS enabled RHEL server\n\n#### `TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305` and `TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305`\n\nThese are TLS 1.2 ciphers. By default the curl connection goes for TLS1.3 connection unless explicitly specified using `--tlsv1.2 --tls-max 1.2`\n\n\n<details>\n<summary>Logs when Pages is running in GDK and explicit TLS versions not specified in curl<\/summary>\n\n```sh\n$ curl https:\/\/127.0.0.1:3012 -H 'Host: t1.vishaltak.com' --verbose --insecure --cipher ECDHE-RSA-CHACHA20-POLY1305\n*   Trying 127.0.0.1:3012...\n* Connected to 127.0.0.1 (127.0.0.1) port 3012 (#0)\n* ALPN, offering h2\n* ALPN, offering http\/1.1\n* Cipher selection: ECDHE-RSA-CHACHA20-POLY1305\n* successfully set certificate verify locations:\n*  CAfile: \/etc\/ssl\/cert.pem\n*  CApath: none\n* (304) (OUT), TLS handshake, Client hello (1):\n* (304) (IN), TLS handshake, Server hello (2):\n* (304) (IN), TLS handshake, Unknown (8):\n* (304) (IN), TLS handshake, Certificate (11):\n* (304) (IN), TLS handshake, CERT verify (15):\n* (304) (IN), TLS handshake, Finished (20):\n* (304) (OUT), TLS handshake, Finished (20):\n* SSL connection using TLSv1.3 \/ AEAD-CHACHA20-POLY1305-SHA256\n* ALPN, server accepted to use h2\n* Server certificate:\n*  subject: C=IN; ST=MH; L=Mumbai; O=GitLab; OU=Create; CN=pages.gdk.test; emailAddress=vtak@gitlab.com\n*  start date: Apr  7 10:38:07 2022 GMT\n*  expire date: Apr  7 10:38:07 2023 GMT\n*  issuer: C=IN; ST=MH; L=Mumbai; O=GitLab; OU=Create; CN=pages.gdk.test; emailAddress=vtak@gitlab.com\n*  SSL certificate verify result: self signed certificate (18), continuing anyway.\n* Using HTTP2, server supports multiplexing\n* Connection state changed (HTTP\/2 confirmed)\n* Copying HTTP\/2 data in stream buffer to connection buffer after upgrade: len=0\n* Using Stream ID: 1 (easy handle 0x12100e600)\n> GET \/ HTTP\/2\n> Host: t1.vishaltak.com\n> user-agent: curl\/7.79.1\n> accept: *\/*\n>\n* Connection state changed (MAX_CONCURRENT_STREAMS == 250)!\n< HTTP\/2 200\n< cache-control: max-age=600\n< content-type: text\/html; charset=utf-8\n< etag: \"7918027bec724fb2a62bcc049eef34f25848f0d4e0aaa5955107e3fb87859dba\"\n< expires: Fri, 08 Apr 2022 09:03:39 UTC\n< last-modified: Tue, 22 Mar 2022 14:11:29 GMT\n< vary: Origin\n< content-length: 632\n< date: Fri, 08 Apr 2022 08:53:39 GMT\n...\n```\n\n<\/details>\n\n\n**Logs when Pages is running in FIPS RHEL**\n\nCurl logs\n\n```sh \n$ curl https:\/\/127.0.0.1:3012 -H 'Host: t1.vishaltak.com' --verbose --insecure --cipher ECDHE-ECDSA-CHACHA20-POLY1305 --tlsv1.2 --tls-max 1.2\n*   Trying 127.0.0.1:3012...\n* Connected to 127.0.0.1 (127.0.0.1) port 3012 (#0)\n* ALPN, offering h2\n* ALPN, offering http\/1.1\n* Cipher selection: ECDHE-ECDSA-CHACHA20-POLY1305\n* successfully set certificate verify locations:\n*  CAfile: \/etc\/ssl\/cert.pem\n*  CApath: none\n* (304) (OUT), TLS handshake, Client hello (1):\n* error:1404B410:SSL routines:ST_CONNECT:sslv3 alert handshake failure\n* Closing connection 0\ncurl: (35) error:1404B410:SSL routines:ST_CONNECT:sslv3 alert handshake failure\n```\n\nPages Server logs\n```json\n{\"level\":\"info\",\"msg\":\"http: TLS handshake error from 127.0.0.1:34048: tls: no cipher suite supported by both client and server\",\"time\":\"2022-04-08T09:10:37Z\"}\n```\n\n\n#### `TLS_AES_128_GCM_SHA256` , `TLS_AES_256_GCM_SHA384` and `TLS_CHACHA20_POLY1305_SHA256`\n\nThese are TLS v1.3 ciphers. \n\nCurl logs\n\n```sh\n$ curl https:\/\/127.0.0.1:3012 -H 'Host: t1.vishaltak.com' --verbose --insecure  --tls13-ciphers TLS_AES_128_GCM_SHA256 --tlsv1.3\n*   Trying 127.0.0.1:3012...\n* TCP_NODELAY set\n* Connected to 127.0.0.1 (127.0.0.1) port 3012 (#0)\n* ALPN, offering h2\n* ALPN, offering http\/1.1\n* TLS 1.3 cipher selection: TLS_AES_128_GCM_SHA256\n* successfully set certificate verify locations:\n*   CAfile: \/etc\/ssl\/certs\/ca-certificates.crt\n  CApath: \/etc\/ssl\/certs\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\n* TLSv1.3 (IN), TLS alert, protocol version (582):\n* error:1409442E:SSL routines:ssl3_read_bytes:tlsv1 alert protocol version\n* Closing connection 0\ncurl: (35) error:1409442E:SSL routines:ssl3_read_bytes:tlsv1 alert protocol version\n```\n\nPages server logs\n\n```json\n{\"level\":\"info\",\"msg\":\"http: TLS handshake error from 127.0.0.1:34066: tls: client offered only unsupported versions: [304]\",\"time\":\"2022-04-08T09:15:42Z\"}\n```\n\n### What is the expected *correct* behavior?\n\nThe HTML should be served while respecting the TLS version and the cipher\n\n### Comments\n\nI think, for TLS 1.2, ciphers `ECDHE-RSA-CHACHA20-POLY1305` and `ECDHE-ECDSA-CHACHA20-POLY1305` are not supported in FIPS mode\n\n**Reason**\n```sh\n$ openssl ciphers -v -stdname  | grep TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305    # when run of RHEL FIPS machine, gives empty result\n$ openssl ciphers -v -stdname  | grep TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305  # when run of RHEL FIPS machine, gives empty result\n```\n\n\nI think TLS v1.3 is not supported in FIPS mode and that is why the Pages server logs `tls: client offered only unsupported versions: [304]` . `304` refers to TLS v1.3 as can be seen [here](https:\/\/cs.opensource.google\/go\/go\/+\/refs\/tags\/go1.18:src\/crypto\/tls\/common.go;l=33) . \n\nHowever, out of the 3 TLSv.13 ciphers mentioned above, the first two can be seen as available in FIPS RHEL OpenSSL.\n\n```sh\n$ openssl ciphers -v -stdname -s -tls1_3         # when run of RHEL FIPS machine\nTLS_AES_256_GCM_SHA384 - TLS_AES_256_GCM_SHA384  TLSv1.3 Kx=any      Au=any  Enc=AESGCM(256) Mac=AEAD\nTLS_AES_128_GCM_SHA256 - TLS_AES_128_GCM_SHA256  TLSv1.3 Kx=any      Au=any  Enc=AESGCM(128) Mac=AEAD\nTLS_AES_128_CCM_SHA256 - TLS_AES_128_CCM_SHA256  TLSv1.3 Kx=any      Au=any  Enc=AESCCM(128) Mac=AEAD\n```\n\n`TLS_CHACHA20_POLY1305_SHA256` is not available in the list\n\n#### OpenSSL Version Details\n- Local Mac - `LibreSSL 2.8.3`\n- GDK (Ubuntu) - `OpenSSL 1.1.1f  31 Mar 2020`\n- FIPS Pages(RHEL) - `OpenSSL 1.1.1k  FIPS 25 Mar 2021`\n\nIf you are using Mac, you would want to spin up some server(Ubuntu) which has openssl installed or install a separate openssl on Mac. The default openssl installed in Mac does have TLS v1.3 ciphers available for some reason. \n\n\n### Note\n\nWhile testing this, I've generated certificates for the pages domain (`pages.gdk.test`) and not for the custom domain (`t1.vishaltak.com`) .\n\n<!-- DO NOT CHANGE -->","state":"closed","created_at":1649411202625,"updated_at":1653393637533,"closed_at":1652331188089,"closed_by":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"labels":["Category:Pages","Deliverable","FIPS","backend","devops::create","feature flag","golang","group::editor","quad-planning::complete-no-action","section::dev","workflow::in dev"],"milestone":{"id":2095271,"iid":65,"group_id":9970,"title":"15.0","description":"","state":"active","created_at":"2021-06-08T15:35:34.814Z","updated_at":"2021-11-02T18:23:35.115Z","due_date":"2022-05-17","start_date":"2022-04-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/65"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"}],"author":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/731","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/731","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/731\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/731\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#731","relative":"#731","full":"gitlab-org\/gitlab-pages#731"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7744.0,"epic":{"id":471545,"iid":7744,"title":"Editor BE FIPS Compliance","url":"\/groups\/gitlab-org\/-\/epics\/7744","group_id":9970,"human_readable_end_date":"Jul 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":106238762,"iid":730,"project_id":734943,"title":"Revamp gitlab-pages development docs","description":"<!---\n\nPlease read this!\n\n**NOTE**: Please check https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/331699 if you had issues upgrading to 14.0+\n\nBefore opening a new issue, make sure to search for keywords in the issues (including closed ones)\n- https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\n\nand verify the issue you're about to submit isn't a duplicate.\n--->\n\n\n### Summary\n\nWhile setting up my gitlab-pages environment I got confused with some information on `doc\/development.md`. It was also confusing to have some duplicated information in https:\/\/gitlab.com\/gitlab-org\/gitlab-development-kit\/-\/blob\/main\/doc\/howto\/pages.md.\n\nI propose to have all the information regarding gitlab-pages development in one place (a Single Source Of Truth - SSOT). For that, I:\n\n1. Revamped the `gitlab-pages\/doc\/development.md` to have all the required information to start a gitlab-pages developing environment (this MR)\n1. If this MR is approve, I'll open another MR in the GDK repository to point the `GDK\/doc\/howto\/pages.md` to the `gitlab-pages\/doc\/development.md`.","state":"closed","created_at":1649325539934,"updated_at":1660222845840,"closed_at":1654788328237,"closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"labels":["Category:Pages","backend","devops::create","golang","group::editor","section::dev","workflow::production"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/73"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},{"id":5133434,"username":"aqualls","name":"Amy Qualls","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/5133434\/avatar.png","web_url":"https:\/\/gitlab.com\/aqualls"}],"author":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/730","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/730","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/730\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/730\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#730","relative":"#730","full":"gitlab-org\/gitlab-pages#730"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7829.0,"epic":{"id":488235,"iid":7829,"title":"\ud83d\udcd6 Pages documentation cleanup","url":"\/groups\/gitlab-org\/-\/epics\/7829","group_id":9970,"human_readable_end_date":"May 17, 2023","human_readable_timestamp":"<strong>11<\/strong> days remaining"},"iteration":null,"health_status":null},{"id":106045796,"iid":728,"project_id":734943,"title":"Arbitrary protocol redirection","description":"<!---\n\nPlease read this!\n\n**NOTE**: Please check https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/331699 if you had issues upgrading to 14.0+\n\nBefore opening a new issue, make sure to search for keywords in the issues (including closed ones)\n- https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\n\nand verify the issue you're about to submit isn't a duplicate.\n--->\n\n\n### Summary\n\n<!-- Summarize the bug encountered concisely. -->\n\nGitLab pages can be used to redirect to arbitrary protocols in the authentication flow.\n\n\n### Steps to reproduce\n\n<!-- Describe how one can reproduce the issue - this is very important. Please use an ordered list. -->\n\nConsider the following URL:\n\n```\nhttps:\/\/projects.gitlab.io\/auth?domain=mailto:\/\/gitlab-com.gitlab.io?body=OMGWTF&state=aaa\n```\n\nIt will, after the login redirect to `gitlab.com` redirect the user to their mail client.\n\n![image](\/uploads\/44a20d4331d7cc8ee9699884c47d8bc7\/image.png)\n\nThis might be potentially used e.g. on mobile devices to exfiltrate authentication token via custom URL handler.\n\n### Example Project\n\n<!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. -->\n\n### What is the current *bug* behavior?\n\n<!-- Describe what actually happens. -->\n\nRedirect to arbitrary protocols is possible.\n\n### What is the expected *correct* behavior?\n\nRedirect should only be possible to `https` or `http` URLs.\n<!-- Describe what you should see instead. -->\n\n### Relevant logs and\/or screenshots\n\n<!-- Paste any relevant logs - please use code blocks (```) to format console output, logs, and code\n as it's tough to read otherwise. -->\n\n### Output of checks\n\n<!-- If you are reporting a bug on GitLab.com, write: This bug happens on GitLab.com -->\n\n### Possible fixes\n\n<!-- If you can, link to the line of code that might be responsible for the problem. -->\n\n<!-- DO NOT CHANGE -->","state":"closed","created_at":1649087328597,"updated_at":1675957342665,"closed_at":1673332633426,"closed_by":{"id":9043659,"username":"rshambhuni","name":"Rohit Shambhuni","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/9043659\/avatar.png","web_url":"https:\/\/gitlab.com\/rshambhuni"},"labels":["Category:Pages","Deliverable","devops::create","golang","group::editor","priority::4","section::dev","severity::4","type::bug","workflow::in dev"],"milestone":{"id":2745648,"iid":83,"group_id":9970,"title":"15.8","description":"","state":"active","created_at":"2022-08-22T16:57:34.875Z","updated_at":"2022-08-22T16:57:34.875Z","due_date":"2023-01-17","start_date":"2022-12-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/83"},"assignees":[{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/12750949\/avatar.png","web_url":"https:\/\/gitlab.com\/ngala"}],"author":{"id":104376,"username":"joernchen","name":"Joern Schneeweisz","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/5a29ccf0244143eb2faed20bcf7fe8bd?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/joernchen"},"type":"ISSUE","assignee":{"id":12750949,"username":"ngala","name":"Naman Jagdish Gala","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/12750949\/avatar.png","web_url":"https:\/\/gitlab.com\/ngala"},"user_notes_count":13,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2022-10-04","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/728","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/728","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/728\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/728\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#728","relative":"#728","full":"gitlab-org\/gitlab-pages#728"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":105901313,"iid":725,"project_id":734943,"title":"Unable to download large files from gitlab.io","description":"### Summary\n\nIf you try to download a large file from gitlab.io the connection is closed after about 37s. This is probably a regression of the recent security fix. \n\n### Steps to reproduce\n\nTry to download a large file over a slow connection or try to rate limit your connection (`wget --limit-rate` works to reproduce this issue). This affects f.e. https:\/\/gitlab.com\/paulcarroty\/vscodium-deb-rpm-repo. (see https:\/\/gitlab.com\/paulcarroty\/vscodium-deb-rpm-repo\/-\/issues\/77) If you try to download the mentioned `codium_1.66.0-1648720116_amd64.deb` (80Mb) and the download requires more than about 37s the connection is closed and the download is not finished.\n\n\n## TODO\n\n- [x] change the default to 5 minutes https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/722\n- [x] make backports to versions we backported security fix to\n   - 1.51: https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/723\n   - 1.54: https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/724\n   - 1.56: https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/725\n- [x] make these parameters configurable in charts and omnibus\n   - charts: https:\/\/gitlab.com\/gitlab-org\/charts\/gitlab\/-\/merge_requests\/2504\n   - omnibus: https:\/\/gitlab.com\/gitlab-org\/omnibus-gitlab\/-\/merge_requests\/6029\n- [x] log them in http:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/blob\/4b1afecbb6ae1886bfd3a31f256909ca2770bce4\/internal\/config\/config.go#L331-L331\n- [x] remove the hot fix from https:\/\/gitlab.com\/gitlab-com\/gl-infra\/k8s-workloads\/gitlab-com\/-\/merge_requests\/1697\n   - https:\/\/gitlab.com\/gitlab-com\/gl-infra\/k8s-workloads\/gitlab-com\/-\/merge_requests\/1731","state":"closed","created_at":1648828915060,"updated_at":1652797851597,"closed_at":1652797851580,"closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"labels":["Category:Pages","backend","bug::availability","devops::create","group::editor","section::dev","type::bug","workflow::in dev"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/72"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"}],"author":{"id":11261867,"username":"AnimuxAlex","name":"Alexander Sulfrian","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/db1f1780753690b4cddccc2fd1ac01c3?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/AnimuxAlex"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"user_notes_count":35,"merge_requests_count":0,"upvotes":7,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/725","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":5,"completed_count":5},"weight":3,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/725","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/725\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/725\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#725","relative":"#725","full":"gitlab-org\/gitlab-pages#725"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":102683500,"iid":706,"project_id":734943,"title":"Remove rate limits feature flags","description":"### Summary\n\nWe rolled out rate limits for gitlab pages, so now we can remove feature flags guarding it.\n\nSO we need to:\n1. remove 4 relevant feature flags from https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/a8be317a96f2dfb4ab30e338daee2b51833c2322\/internal\/feature\/feature.go#L12-L12 \n1. remove `enforce` flag from https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/master\/internal\/ratelimiter\/ratelimiter.go#L48, and all tests using it\n1. clean our production to not mention these feature flags: https:\/\/gitlab.com\/gitlab-com\/gl-infra\/k8s-workloads\/gitlab-com\/-\/blob\/96a3bf149c1cd2847f29c3ed666c480e6b8d15b7\/releases\/gitlab\/values\/values.yaml.gotmpl#L449 , https:\/\/gitlab.com\/gitlab-com\/gl-infra\/k8s-workloads\/gitlab-com\/-\/blob\/96a3bf149c1cd2847f29c3ed666c480e6b8d15b7\/releases\/gitlab\/values\/gprd.yaml.gotmpl#L97 , and other files, **grep the repository for each of them**\n1. remove mentions of feature flags in https:\/\/docs.gitlab.com\/ee\/administration\/pages\/#rate-limits","state":"closed","created_at":1645186867463,"updated_at":1682685570992,"closed_at":1666876662598,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Deliverable","backend","devops::create","feature flag","group::editor","quad-planning::complete-no-action","section::dev","type::maintenance","workflow::ready for development"],"milestone":{"id":2453024,"iid":74,"group_id":9970,"title":"15.2","description":"","state":"active","created_at":"2022-02-03T22:24:46.818Z","updated_at":"2022-02-03T22:26:32.010Z","due_date":"2022-07-17","start_date":"2022-06-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/74"},"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/706","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/706","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/706\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/706\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#706","relative":"#706","full":"gitlab-org\/gitlab-pages#706"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":102495890,"iid":705,"project_id":734943,"title":"TLS security for GitLab Pages metrics endpoints","description":"Refer https:\/\/gitlab.com\/groups\/gitlab-org\/-\/epics\/7479\n\nGitLab components report metrics via Prometheus, and sometimes start a pprof listener to aid live profiling. Either of these may be open and listening when running GitLab in production, as they are on GitLab.com\n\n1. Inventory which endpoints report to Prometheus\n1. Determine of those endpoints are already or can be TLS-secured\n1. Secure each unsecured endpoint\n\n~\"devops::release\" ~\"group::release\" ~\"Category:Pages\"","state":"closed","created_at":1644946387002,"updated_at":1655983524538,"closed_at":1654747603787,"closed_by":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"labels":["Category:Pages","FIPS","backend","blocked","devops::create","frontend","group::editor","infrastructure","quad-planning::complete-no-action","section::dev","type::maintenance"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/73"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"}],"author":{"id":4391348,"username":"sean_carroll","name":"Sean Carroll","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4391348\/avatar.png","web_url":"https:\/\/gitlab.com\/sean_carroll"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"user_notes_count":27,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/705","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/705","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/705\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/705\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#705","relative":"#705","full":"gitlab-org\/gitlab-pages#705"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7744.0,"epic":{"id":471545,"iid":7744,"title":"Editor BE FIPS Compliance","url":"\/groups\/gitlab-org\/-\/epics\/7744","group_id":9970,"human_readable_end_date":"Jul 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":101609858,"iid":694,"project_id":734943,"title":"Intermittent 404s with gitlab-org.gitlab.io due to \"domain does not exist\"","description":"### Summary\n\n@marcel.amirault mentioned that he was seeing intermittent 404s while visiting https:\/\/gitlab-org.gitlab.io\/gitlab-roulette\/ today.\n\nhttps:\/\/log.gprd.gitlab.net\/goto\/e5236f50-82bc-11ec-a649-b7cbb8e4f62e shows that the `domain does not exist` error pops up quite frequently for this host:\n\n![image](\/uploads\/81fd4b665c5aded40fe716eb759cbe7f\/image.png)\n\nThe issue seems distributed across multiple pods:\n\n![image](\/uploads\/082536dceb7b114b7a8e247abbc4b629\/image.png)\n\nCurious why these URLs seem to be involved?\n\n![image](\/uploads\/520b15b310d4e7bc88608728cf42568b\/image.png)\n\nhttps:\/\/gitlab-org.gitlab.io\/trello-power-up\/scripts\/api.js should exist.\n\n<!-- Summarize the bug encountered concisely. -->\n\n### Steps to reproduce\n\n<!-- Describe how one can reproduce the issue - this is very important. Please use an ordered list. -->\n\n### Example Project\n\n<!-- If possible, please create an example project here on GitLab.com that exhibits the problematic \nbehavior, and link to it here in the bug report. If you are using an older version of GitLab, this \nwill also determine whether the bug is fixed in a more recent version. -->\n\n### What is the current *bug* behavior?\n\n<!-- Describe what actually happens. -->\n\n### What is the expected *correct* behavior?\n\n<!-- Describe what you should see instead. -->\n\n### Relevant logs and\/or screenshots\n\n<!-- Paste any relevant logs - please use code blocks (```) to format console output, logs, and code\n as it's tough to read otherwise. -->\n\n### Output of checks\n\n<!-- If you are reporting a bug on GitLab.com, write: This bug happens on GitLab.com -->\n\n### Possible fixes\n\n<!-- If you can, link to the line of code that might be responsible for the problem. -->\n\n<!-- DO NOT CHANGE -->\n\n~\"devops::release\" ~\"group::release\" ~\"Category:Pages\"","state":"closed","created_at":1643651238142,"updated_at":1655812934414,"closed_at":1655114202216,"closed_by":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"labels":["Category:Pages","Deliverable","devops::create","group::editor","internal customer","priority::2","section::dev","severity::2","type::bug","workflow::verification"],"milestone":{"id":2453022,"iid":73,"group_id":9970,"title":"15.1","description":"","state":"active","created_at":"2022-02-03T22:23:29.335Z","updated_at":"2022-02-03T22:23:29.335Z","due_date":"2022-06-17","start_date":"2022-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/73"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"}],"author":{"id":64248,"username":"stanhu","name":"Stan Hu","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/64248\/stanhu.jpg","web_url":"https:\/\/gitlab.com\/stanhu"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"user_notes_count":24,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/694","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/694","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/694\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/694\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#694","relative":"#694","full":"gitlab-org\/gitlab-pages#694"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":100941602,"iid":688,"project_id":734943,"title":"feat: make server shutdown timeout configurable","description":"The following discussion from !664 should be addressed:\n\n- [x] @jaime started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/664#note_815813893): \n\n    > \/\/ TODO: make this timeout configurable\n\n# Proposal\n\nAdd a new config flag `server-shutdown-timeout` of type `time.Duration`.\n\n- [x] Add to Pages server\n- [x] Add to Omnibus config (example https:\/\/gitlab.com\/gitlab-org\/omnibus-gitlab\/-\/merge_requests\/5832\/diffs)\n- [x] Add to GitLab Charts (example https:\/\/gitlab.com\/gitlab-org\/charts\/gitlab\/-\/merge_requests\/2338)\n- [x] Document in the admin docs (example https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/merge_requests\/77969)","state":"closed","created_at":1642631321956,"updated_at":1647923150151,"closed_at":1647923150139,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Community contribution","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::feature"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/72"},"assignees":[{"id":10660827,"username":"HuseyinEmreAksoy","name":"H\u00fcseyin Emre Aksoy","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/22476f2f3088298f5a1e0ce14f6c4788?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/HuseyinEmreAksoy"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":10660827,"username":"HuseyinEmreAksoy","name":"H\u00fcseyin Emre Aksoy","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/22476f2f3088298f5a1e0ce14f6c4788?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/HuseyinEmreAksoy"},"user_notes_count":16,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/688","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":5,"completed_count":5},"weight":4,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/688","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/688\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/688\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#688","relative":"#688","full":"gitlab-org\/gitlab-pages#688"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":99072743,"iid":677,"project_id":734943,"title":"Include correlation ID and remote IP in Sentry tags","description":"### Summary\n\nWhile investigating https:\/\/gitlab.com\/gitlab-com\/gl-infra\/production\/-\/issues\/6074, it was hard correlating 50x requests to Sentry errors because the latter don't include things like correlation ID or remote IP. Having those tags (and preferably even more) could aid greatly in tracking down problems.","state":"closed","created_at":1639564357139,"updated_at":1647356997018,"closed_at":1647356997000,"closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"labels":["Category:Pages","corrective action","devops::create","group::editor","section::ops"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/72"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"}],"author":{"id":506061,"username":"ahmadsherif","name":"Ahmad Sherif","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/bd6d0ec4213b91601956c9f801cbfe9b?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ahmadsherif"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/677","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/677","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/677\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/677\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#677","relative":"#677","full":"gitlab-org\/gitlab-pages#677"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":99052899,"iid":673,"project_id":734943,"title":"refactor: revert back to archive\/zip once go1.17 is no longer supported","description":"### Summary\n\nDue to a bug in go1.17, we had to introduced a forked version of the `archive\/zip` package: https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/646.\n\nThis bug is fixed in go1.18, so eventually, we can revert back to using `archive\/zip` in place of `gitlab.com\/gitlab-org\/golang-archive-zip` once support for go1.17 has been dropped.\n\n<!-- DO NOT CHANGE -->\n\n~\"devops::release\" ~\"group::release\" ~\"Category:Pages\"","state":"closed","created_at":1639536127837,"updated_at":1676383914158,"closed_at":1676383914137,"closed_by":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"labels":["Category:Pages","devops::create","group::editor","maintenance::refactor","section::dev","type::maintenance","workflow::complete"],"milestone":{"id":2745650,"iid":84,"group_id":9970,"title":"15.9","description":"","state":"active","created_at":"2022-08-22T16:58:02.303Z","updated_at":"2022-08-22T16:58:02.303Z","due_date":"2023-02-17","start_date":"2023-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/84"},"assignees":[{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"}],"author":{"id":5878538,"username":"ajwalker","name":"Arran Walker","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/13209547f9f01b0bbb1d3b340263573c?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ajwalker"},"type":"ISSUE","assignee":{"id":696751,"username":"kassio","name":"Kassio Borges","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/be7919dfa5d1e8b8826bf51bfc747055?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/kassio"},"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2022-08-22","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/673","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/673","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/673\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/673\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#673","relative":"#673","full":"gitlab-org\/gitlab-pages#673"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":98258008,"iid":668,"project_id":734943,"title":"Allow customizing the artifacts path (\"public\") in GitLab Pages","description":"### Reasoning \n\nCurrently GitLab Pages will only publish built files from a folder named `public` inside the project root.\n\nExcept for a few minor Frameworks this requires changing the default behaviour of the framework the user is using:\n\nFor example, Next.js uses `.next`, Nuxt and Astro use `dist`, Eleventy uses `_site`, etc... &mdash; what all of them have in common is the fact, that the `public` folder (sometimes in the root directory, sometimes not) often has a slightly different use: It stores static public files that don't need to go through the build process.\n\nThis means that in order to deploy a site with pages not only does the user need to configure the build path, they also often need to change where files from the *original* `public` folders live.\n\nSo the default behaviour of Pages is almost never what the user needs. It almost always is in conflict with the default behaviour of the frameworks. This causes confusion because it's not clearly documented (gitlab#340682).\n\nThe most user-centric way to approach this is to refactor GitLab Pages so that it obtains the artifacts folder from the `.gitlab-ci.yml` file and uses whatever has been specified there.\n\n### Proposal\n\n#### The initial idea\n\nThe easiest way would be to just **drop** the requirement entirely and do the following:\n - If there's only one folder in artifacts, use that as the pages root\n - If there's multiple folders, do some educated guessing which one to use (quoted from the original MR):\n   > In the case where `artifacts.paths` contains more than one folder, it will check for the presence of any of the     following folders. These are the output folders generated by the [most popular frontend frameworks](https:\/\/gitlab.com\/gitlab-org\/incubation-engineering\/jamstack\/meta\/-\/issues\/12#popular-frameworks), ordered by the popularity of the related framework (but `public` first, because backwards compatibility):\n   > - `public` (previous GitLab behaviour, Hugo, Gatsby, Svelte)\n   > - `build` (React)\n   > - `dist` (Vue, Nuxt.js, Angular, Astro, Vite)\n   > - `out` (Next.js)\n   > - `_site` (Eleventy, Jekyll)\n\nThe problem with that approach is that it would *change GitLab Pages behavior* for existing pages. If someone had previously uploaded files inside the `pages` job that's not in a `public` directory, they would start to be exposed at the time the change came into effect. \nAlthough it's rather unlikely that users uploaded artifacts in the pages job they *did not want* to be exposed, this case cannot be excluded, so following the principle of least surprise, we should require the user to opt in to a behaviour like this.\n\n#### The better idea\n\nLet's introduce a new property to the pipeline. One that's specific to the `pages` job. Say, `publish`\n\n```yaml\npages:\n  script: ...\n  publish: some\/dir\n```\n\nSo this new `publish` property has a semantic meaning: \"This is the folder I want to publish\".\n\nIn the background this does two things:\n\n1. It behaves as `artifacts.paths` with a single entry. (Pages needs a single root directory anyway, so it doesn't make much sense to allow more than one dir, at least for Pages. The user is allowed to add a classic `artifacts` property if they want to publish artifacts from that repo too, but it would be ignored by the pages server)\n\n2. It causes the GitLab Pages server to treat a folder of that name as the pages root. I guess the best implementation to do this would be via the API, but I'm open to suggestions.\n\nNow, if there's no `publish` property in the pages job definition, we just keep the legacy behaviour: Without a `publish` property, Pages will only ever expose the `public` folder. No surprises for anyone. Users would have to explicitly enable the new behaviour.","state":"closed","created_at":1636551462502,"updated_at":1683011824487,"closed_at":1679396002216,"closed_by":{"id":9622933,"username":"janis","name":"Janis Altherr","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/9622933\/avatar.png","web_url":"https:\/\/gitlab.com\/janis"},"labels":["Category:Pages","Deliverable","GitLab Core","GitLab Premium","GitLab Ultimate","devops::plan","group::knowledge","section::dev","type::feature","workflow::in dev"],"milestone":{"id":2910456,"iid":86,"group_id":9970,"title":"15.11","description":"","state":"active","created_at":"2022-12-13T20:08:46.985Z","updated_at":"2022-12-13T20:08:46.985Z","due_date":"2023-04-17","start_date":"2023-03-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/86"},"assignees":[{"id":9622933,"username":"janis","name":"Janis Altherr","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/9622933\/avatar.png","web_url":"https:\/\/gitlab.com\/janis"}],"author":{"id":9622933,"username":"janis","name":"Janis Altherr","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/9622933\/avatar.png","web_url":"https:\/\/gitlab.com\/janis"},"type":"ISSUE","assignee":{"id":9622933,"username":"janis","name":"Janis Altherr","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/9622933\/avatar.png","web_url":"https:\/\/gitlab.com\/janis"},"user_notes_count":11,"merge_requests_count":1,"upvotes":14,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/668","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/668","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/668\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/668\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#668","relative":"#668","full":"gitlab-org\/gitlab-pages#668"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":"on_track"},{"id":96169536,"iid":655,"project_id":734943,"title":"Enable domain-base rate-limiting","description":"Choose rate-limit for gitlab.com based on results of https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/654 and enable rate-limiting. Remove feature flags for self-hosted version.","state":"closed","created_at":1635256899855,"updated_at":1643214275090,"closed_at":1643214275076,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Eng-Consumer::Infrastructure","Eng-Producer::Development","Engineering Allocation","Next Up","automation:infradev-missing-labels","backend","devops::release [DEPRECATED]","group::release [DEPRECATED]","infradev","section::ops","severity::3"],"milestone":null,"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":10,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/655","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/655","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/655\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/655\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#655","relative":"#655","full":"gitlab-org\/gitlab-pages#655"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6972.0,"epic":{"id":375387,"iid":6972,"title":"Add per IP\/domain rate-limits to GitLab Pages","url":"\/groups\/gitlab-org\/-\/epics\/6972","group_id":9970,"human_readable_end_date":"Feb 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":96169359,"iid":654,"project_id":734943,"title":"Enable domain-based rate-limiting in the test mode","description":"Enable rate-limiting introduced in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/630 in test-only mode(only report how many requests were rejected without actually rejecting them)","state":"closed","created_at":1635256784935,"updated_at":1645167752681,"closed_at":1643214065102,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Deliverable","Next Up","backend","devops::release [DEPRECATED]","documentation","group::release [DEPRECATED]","section::ops","workflow::ready for development"],"milestone":{"id":2161849,"iid":70,"group_id":9970,"title":"14.8","description":"","state":"active","created_at":"2021-07-26T16:51:47.677Z","updated_at":"2021-07-26T16:51:47.677Z","due_date":"2022-02-17","start_date":"2022-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/70"},"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/654","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/654","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/654\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/654\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#654","relative":"#654","full":"gitlab-org\/gitlab-pages#654"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6972.0,"epic":{"id":375387,"iid":6972,"title":"Add per IP\/domain rate-limits to GitLab Pages","url":"\/groups\/gitlab-org\/-\/epics\/6972","group_id":9970,"human_readable_end_date":"Feb 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":96079199,"iid":652,"project_id":734943,"title":"Try to build GitLab Pages with FIPS compliant libraries","description":"See https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/296017#note_487842290 as reference.","state":"closed","created_at":1635162757359,"updated_at":1651612157824,"closed_at":1648038383239,"closed_by":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"labels":["Category:Pages","Deliverable","FIPS","Next Up","backend","devops::create","group::editor","section::dev","workflow::ready for development"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/72"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"user_notes_count":30,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2022-05-22","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/652","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/652","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/652\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/652\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#652","relative":"#652","full":"gitlab-org\/gitlab-pages#652"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":7744.0,"epic":{"id":471545,"iid":7744,"title":"Editor BE FIPS Compliance","url":"\/groups\/gitlab-org\/-\/epics\/7744","group_id":9970,"human_readable_end_date":"Jul 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":95676479,"iid":649,"project_id":734943,"title":"Wildcard redirects break Let's Encrypt integration","description":"From https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/merge_requests\/72069: \n\n> The Let's encrypt automatic integration for gitlab pages is not working when using wildcard redirects.\n> \n> I.e. `\/* \/index.html 200` in _redirects file for pages.\n\nThis happens because https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/blob\/5e86747b6287381e2f23afe837ede1820876cf8d\/internal\/acme\/acme.go#L33-L33 checks if project has a file in it, and we handle redirects, so our acme middleware doesn't redirect to gitlab.\n\nI see a few ways of fixing this:\n\n1. stop redirecting any `\"\/.well-known\/acme-challenge\/*\"` files\n1. remove this `if domain.ServeFileHTTP(w, r)` check completely. This was originally done to allow users to manually implement their integration with Let's Encrypt. People were doing this before we had our one integration.\n1. In the API response for domain add `redirect_for_acme_challenges: true` and replace `if domain.ServeFileHTTP(w, r) {` with `if !domain.RedirectForAcmeChallenges {`\n1. In the API response return the actually acme challenges like `{acme_challenges: [{path: \"\/.well-known\/acme-challenge\/somehting\", value: \"somevalue\"}]}`. Currently, we rely on the main gitlab instance being public and reachable from Let's Encrypt, so we just redirect to it. If we go with the last option, we can get rid of this requirement. \n\nHowever, last 2 options will also slow down the Let's Encrypt integration, as we update domain config cache not that often.\n\nActually, I'm(@vshushlin) in favor of the first option - it shouldn't break anything for existing users, as not many people use redirects yet. And it doesn't slow down the Let's Encrypt integraiton.","state":"closed","created_at":1634637714301,"updated_at":1658881466484,"closed_at":1658822022873,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Next Up","devops::create","group::editor","priority::3","section::dev","severity::3","type::bug","workflow::planning breakdown"],"milestone":{"id":2453025,"iid":75,"group_id":9970,"title":"15.3","description":"","state":"active","created_at":"2022-02-03T22:28:50.229Z","updated_at":"2022-02-03T22:28:50.229Z","due_date":"2022-08-17","start_date":"2022-07-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/75"},"assignees":[{"id":9938509,"username":"faleksic","name":"Filip Aleksic","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/9938509\/avatar.png","web_url":"https:\/\/gitlab.com\/faleksic"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":9938509,"username":"faleksic","name":"Filip Aleksic","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/9938509\/avatar.png","web_url":"https:\/\/gitlab.com\/faleksic"},"user_notes_count":15,"merge_requests_count":2,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/649","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/649","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/649\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/649\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#649","relative":"#649","full":"gitlab-org\/gitlab-pages#649"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":95409156,"iid":648,"project_id":734943,"title":"Replace GetCompressedPageFromListener, GetPageFromListenerWithCookie and GetProxiedPageFromListener with GetPageFromListenerWithHeaders","description":"In https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/594\/diffs#b0462893f1f2c58c31c518d3cfb09feb2cb3dc57_402_402 we introduced GetPageFromListenerWithHeaders.\n\nNow we can replace GetCompressedPageFromListener, GetPageFromListenerWithCookie and GetProxiedPageFromListener with it. They all are very similar and differ only be headers.\n\n~\"devops::release\" ~\"group::release\" ~\"Category:Pages\"","state":"closed","created_at":1634203161675,"updated_at":1635762956364,"closed_at":1635762956352,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops"],"milestone":null,"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/648","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/648","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/648\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/648\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#648","relative":"#648","full":"gitlab-org\/gitlab-pages#648"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":95406544,"iid":647,"project_id":734943,"title":"Make internal\/lru metrics optional","description":"### Summary\n\nCurrently, https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/blob\/247bd7ba2fd9139711218c6a42ed03c551f958d9\/internal\/lru\/lru.go#L30-L30 makes metric parameters required.\n\nSo in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/594#note_703313432 we needed to make them required for rate-limiter too.\n\nIf these parameters were optional:\n* it may be easier to test without need for things like https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/594\/diffs#16df871fa23e530eb52c7b56cc4ea5ce8a5e5997_108_113 (unless we want to test metrics specifically)\n* `ratelimiter.New` interface would be cleaner\n\nSo I suggest:\n* Allow `nil` for metrics in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/blob\/247bd7ba2fd9139711218c6a42ed03c551f958d9\/internal\/lru\/lru.go#L30-L30. Or use functional options for them.\n* Convert metrics in ratelimiter.New to functional options as well\n\n**This is a very low priority and just nice to have refactoring**\n\n<!-- DO NOT CHANGE -->\n\n~\"devops::release\" ~\"group::release\" ~\"Category:Pages\"","state":"closed","created_at":1634201150412,"updated_at":1638350410088,"closed_at":1638318899372,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops"],"milestone":null,"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":2,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/647","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/647","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/647\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/647\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#647","relative":"#647","full":"gitlab-org\/gitlab-pages#647"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":93685391,"iid":631,"project_id":734943,"title":"Allow to configure IP-rate-limits in Omnibus\/CNG","description":"Follow-up from https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/490\n\n* Add flags support to omnibus -> 1 MR\n* Add flags to CNG -> 1 MR\n* Add documentation to admin guide -> 1 MR","state":"closed","created_at":1631679496657,"updated_at":1637053598359,"closed_at":1637053598334,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","devops::release [DEPRECATED]","documentation","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":2114817,"iid":66,"group_id":9970,"title":"14.5","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2021-06-23T04:59:45.082Z","updated_at":"2022-04-21T07:25:45.431Z","due_date":"2021-11-17","start_date":"2021-10-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/66"},"assignees":[{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/631","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/631","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/631\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/631\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#631","relative":"#631","full":"gitlab-org\/gitlab-pages#631"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6972.0,"epic":{"id":375387,"iid":6972,"title":"Add per IP\/domain rate-limits to GitLab Pages","url":"\/groups\/gitlab-org\/-\/epics\/6972","group_id":9970,"human_readable_end_date":"Feb 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":93685350,"iid":630,"project_id":734943,"title":"Add rate limiting per domain name","description":"- Add per-domain rate limiting, this could be added much more quickly -> 1-2 MRs\n- Enable per-source-IP in all environments -> 2 MRs\n\n\nFollow-up from https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/490#note_676655191","state":"closed","created_at":1631679396597,"updated_at":1642489334124,"closed_at":1642416186537,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Deliverable","Next Up","Technical Writing","backend","devops::release [DEPRECATED]","documentation","feature::addition","group::release [DEPRECATED]","section::ops","type::feature","workflow::verification"],"milestone":{"id":2156369,"iid":68,"group_id":9970,"title":"14.7","description":"","state":"active","created_at":"2021-07-21T17:39:41.786Z","updated_at":"2021-07-21T17:39:41.786Z","due_date":"2022-01-17","start_date":"2021-12-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/68"},"assignees":[{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"user_notes_count":8,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/630","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/630","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/630\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/630\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#630","relative":"#630","full":"gitlab-org\/gitlab-pages#630"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6972.0,"epic":{"id":375387,"iid":6972,"title":"Add per IP\/domain rate-limits to GitLab Pages","url":"\/groups\/gitlab-org\/-\/epics\/6972","group_id":9970,"human_readable_end_date":"Feb 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":93685291,"iid":628,"project_id":734943,"title":"Enable rate limit per source IP without dropping requests","description":"Follow-up 3 https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/490#note_676655191\n\nAdd configuration flags to Pages, integrate with the `ratelimit` package and add acceptance tests. The flags disable the rate limiter by default so this needs to be enabled in our environments manually. That means 1 MR for staging and another one for production.\n\nFollow approach described in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/575#note_675965682 where we deploy the code and start collecting metrics as-if-enabled to understand the impact of this functionality.\n\n- [ ] pre-prod environments, blocked by https:\/\/gitlab.com\/gitlab-com\/gl-infra\/delivery\/-\/issues\/2083\n- [ ] prod, blocked by  https:\/\/gitlab.com\/gitlab-com\/gl-infra\/production\/-\/issues\/5706\n- [ ] create a dashboard in Grafana or Kibana","state":"closed","created_at":1631679174113,"updated_at":1643043626535,"closed_at":1643035673284,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Eng-Consumer::Infrastructure","Eng-Producer::Development","Engineering Allocation","Next Up","corrective action","devops::release [DEPRECATED]","feature::addition","group::release [DEPRECATED]","infradev","priority::2","section::ops","severity::2","tw-weight::5","type::feature","workflow::ready for development"],"milestone":{"id":2161849,"iid":70,"group_id":9970,"title":"14.8","description":"","state":"active","created_at":"2021-07-26T16:51:47.677Z","updated_at":"2021-07-26T16:51:47.677Z","due_date":"2022-02-17","start_date":"2022-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/70"},"assignees":[{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"user_notes_count":30,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":"2022-01-31","confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/628","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":3,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/628","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/628\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/628\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#628","relative":"#628","full":"gitlab-org\/gitlab-pages#628"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6972.0,"epic":{"id":375387,"iid":6972,"title":"Add per IP\/domain rate-limits to GitLab Pages","url":"\/groups\/gitlab-org\/-\/epics\/6972","group_id":9970,"human_readable_end_date":"Feb 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":93685212,"iid":627,"project_id":734943,"title":"GitLab Pages Source IP Rate Limiting","description":"Follow-up 2 https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/490#note_676655191\n\n- Add a `ratelimit` package with support for source IP rate limit\n- Add middleware\n- Add metrics\n\n### Release notes\nGitLab Pages can become quite popular. When too many users are trying to access the Page at the same time, this can lead to an outage.\n\nIn this release, GitLab is introducing rate limiting per source IP. This will make Pages hosted on gitlab.com more stable. For users with a self hosted GitLab instance, you can also limit the number of concurrent requesters.","state":"closed","created_at":1631679087580,"updated_at":1635293357824,"closed_at":1634515776801,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Deliverable","Eng-Consumer::Infrastructure","Eng-Producer::Development","Engineering Allocation","GitLab Free","devops::release [DEPRECATED]","feature::addition","group::release [DEPRECATED]","infradev","priority::2","release post item::secondary","section::ops","severity::2","type::feature","workflow::production"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/64"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":14,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/627","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/627","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/627\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/627\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#627","relative":"#627","full":"gitlab-org\/gitlab-pages#627"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6729.0,"epic":{"id":346861,"iid":6729,"title":"Make GitLab Pages more resilient","url":"\/groups\/gitlab-org\/-\/epics\/6729","group_id":9970,"human_readable_end_date":"Oct 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":93685144,"iid":626,"project_id":734943,"title":"Extract lru cache to its own package so it can be reused","description":"Follow-up 1 https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/490#note_676655191","state":"closed","created_at":1631679015429,"updated_at":1635429151301,"closed_at":1632265617765,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::production"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/63"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/626","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/626","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/626\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/626\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#626","relative":"#626","full":"gitlab-org\/gitlab-pages#626"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6729.0,"epic":{"id":346861,"iid":6729,"title":"Make GitLab Pages more resilient","url":"\/groups\/gitlab-org\/-\/epics\/6729","group_id":9970,"human_readable_end_date":"Oct 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":92972812,"iid":619,"project_id":734943,"title":"Enable FF_ENABLE_PLACEHOLDERS by default","description":"We should enable `FF_ENABLE_PLACEHOLDERS` by default after this feature has been validated for a longer time, perhaps in %\"14.4\"","state":"closed","created_at":1630559511921,"updated_at":1670239523536,"closed_at":1657035881379,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Deliverable","[deprecated] low hanging fruit","backend","devops::create","frontend","group::editor","maintenance::refactor","quad-planning::complete-no-action","section::dev","type::maintenance","workflow::in review"],"milestone":{"id":2453024,"iid":74,"group_id":9970,"title":"15.2","description":"","state":"active","created_at":"2022-02-03T22:24:46.818Z","updated_at":"2022-02-03T22:26:32.010Z","due_date":"2022-07-17","start_date":"2022-06-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/74"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":2,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/619","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":1,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/619","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/619\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/619\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#619","relative":"#619","full":"gitlab-org\/gitlab-pages#619"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":92972789,"iid":618,"project_id":734943,"title":"Remove FF_ENABLE_REDIRECTS feature flag","description":"`FF_ENABLE_REDIRECTS` has been enabled by default since the feature was merged https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/336 in %\"13.4\"","state":"closed","created_at":1630559420890,"updated_at":1655687107935,"closed_at":1639488739989,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] low hanging fruit","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops"],"milestone":{"id":2114820,"iid":67,"group_id":9970,"title":"14.6","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2021-06-23T05:00:52.094Z","updated_at":"2022-04-21T07:26:38.271Z","due_date":"2021-12-17","start_date":"2021-11-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/67"},"assignees":[{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/618","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/618","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/618\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/618\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#618","relative":"#618","full":"gitlab-org\/gitlab-pages#618"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":92897197,"iid":615,"project_id":734943,"title":"Investigate and test sentry integration","description":"### Summary\n\nSeems like Pages is not reporting any errors to Sentry at all https:\/\/sentry.gitlab.net\/gitlab\/gitlab-pages\/.\n\n- We ignore the error when initializing the error tracker in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/master\/main.go#L28 so we might be blindly assuming it\u2019s working, when in fact is not.\n- There is a way to deploy a local instance of Sentry for testing purposes and integrate with the GDK https:\/\/gitlab.com\/gitlab-org\/gitlab-development-kit\/-\/issues\/748\n- Consider implementing some sort of catch-all error reporting.\n- Verify the DSN set in https:\/\/gitlab.com\/gitlab-com\/gl-infra\/chef-repo\/-\/blob\/master\/roles\/gprd-base-fe-web-pages.json#L32 is correct","state":"closed","created_at":1630452950657,"updated_at":1634564864165,"closed_at":1633649771033,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","devops::release [DEPRECATED]","group::release [DEPRECATED]","kubernetes-migration-blocker","section::ops","wg_k8s-migration"],"milestone":{"id":1948708,"iid":64,"group_id":9970,"title":"14.4","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2021-03-17T21:44:55.682Z","updated_at":"2022-04-21T07:25:38.537Z","due_date":"2021-10-17","start_date":"2021-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/64"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":16,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/615","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/615","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/615\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/615\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#615","relative":"#615","full":"gitlab-org\/gitlab-pages#615"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":92242264,"iid":607,"project_id":734943,"title":"Replace defer with t.Cleanup in tests","description":"At least split into 2 MRs\n\n- unit tests\n- acceptance tests\n\nBut smaller chunks would be great and easier to review\n\n\nThe following discussion from !546 should be addressed:\n\n- [ ] @jaime started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/546#note_654658851):  (+1 comment)\n\n    > **suggestion**: thinking if we should use `t.Cleanup` and extract this into the `testhelpers`\n    > \n    > ```diff\n    > git diff --color=always --exit-code\n    > diff --git a\/internal\/auth\/auth_test.go b\/internal\/auth\/auth_test.go\n    > index d03407a52..d2f219c83 100644\n    > --- a\/internal\/auth\/auth_test.go\n    > +++ b\/internal\/auth\/auth_test.go\n    > @@ -15,6 +15,7 @@ import (\n    > \n    >  \t\"gitlab.com\/gitlab-org\/gitlab-pages\/internal\/request\"\n    >  \t\"gitlab.com\/gitlab-org\/gitlab-pages\/internal\/source\"\n    > +\t\"gitlab.com\/gitlab-org\/gitlab-pages\/internal\/testhelpers\"\n    >  )\n    > \n    >  func createTestAuth(t *testing.T, internalServer string, publicServer string) *Auth {\n    > @@ -211,7 +212,7 @@ func testTryAuthenticateWithCodeAndState(t *testing.T, https bool) {\n    >  \trequire.Equal(t, true, auth.TryAuthenticate(result, r, source.NewMockSource()))\n    > \n    >  \tres := result.Result()\n    > -\tdefer res.Body.Close()\n    > +\ttesthelpers.Close(t, res.Body)\n    > \n    >  \trequire.Equal(t, http.StatusFound, result.Code)\n    >  \trequire.Equal(t, \"https:\/\/pages.gitlab-example.com\/project\/\", result.Header().Get(\"Location\"))\n    > diff --git a\/internal\/testhelpers\/testhelpers.go b\/internal\/testhelpers\/testhelpers.go\n    > index 3ec97a79c..46d4932ca 100644\n    > --- a\/internal\/testhelpers\/testhelpers.go\n    > +++ b\/internal\/testhelpers\/testhelpers.go\n    > @@ -2,6 +2,7 @@ package testhelpers\n    > \n    >  import (\n    >  \t\"fmt\"\n    > +\t\"io\"\n    >  \t\"mime\"\n    >  \t\"net\/http\"\n    >  \t\"net\/http\/httptest\"\n    > @@ -68,6 +69,15 @@ func ToFileProtocol(t *testing.T, path string) string {\n    >  \treturn fmt.Sprintf(\"file:\/\/%s\/%s\", wd, path)\n    >  }\n    > \n    > +\/\/ Close a closer like response.Body as part of testing.T.Cleanup\n    > +func Close(t *testing.T, c io.Closer) {\n    > +\tt.Helper()\n    > +\n    > +\tt.Cleanup(func() {\n    > +\t\trequire.NoError(t, c.Close())\n    > +\t})\n    > +}\n    > +\n    >  \/\/ Getwd must return current working directory\n    >  func Getwd(t *testing.T) string {\n    >  \tt.Helper()\n    > ```\n    > \n    > WDYT?","state":"closed","created_at":1629351267799,"updated_at":1645437854624,"closed_at":1645437854550,"closed_by":{"id":10678907,"username":"yigithankardas","name":"Yi\u011fithan Karda\u015f","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10678907\/avatar.png","web_url":"https:\/\/gitlab.com\/yigithankardas"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":{"id":2161849,"iid":70,"group_id":9970,"title":"14.8","description":"","state":"active","created_at":"2021-07-26T16:51:47.677Z","updated_at":"2021-07-26T16:51:47.677Z","due_date":"2022-02-17","start_date":"2022-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/70"},"assignees":[{"id":10678907,"username":"yigithankardas","name":"Yi\u011fithan Karda\u015f","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10678907\/avatar.png","web_url":"https:\/\/gitlab.com\/yigithankardas"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":10678907,"username":"yigithankardas","name":"Yi\u011fithan Karda\u015f","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10678907\/avatar.png","web_url":"https:\/\/gitlab.com\/yigithankardas"},"user_notes_count":6,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/607","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/607","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/607\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/607\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#607","relative":"#607","full":"gitlab-org\/gitlab-pages#607"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":89642676,"iid":589,"project_id":734943,"title":"Disable jailing mechanism by default","description":"### Release notes\nWe disable the jailing mechanism for GitLab Pages by default. The main reason for this is that [many users complain that it causes a lot of problems \nafter upgrading to 14.0](https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/331699). It also lost it relevance since we stopped serving directly from the \ndisk starting from 14.0. You can still [enable jailing back](LINK TO https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/merge_requests\/65791\/diffs ONCE IT'S \nMERGED) if disabling it will break something for you. In that case please reach to us on the [feedback issue](https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/331699).\n\n### Background\n\nStarting from GitLab 14.1 the [jailing\/chroot mechanism is disabled by default](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/589).\nIf you are using API-based configuration and the new [Zip storage architecture](#zip-storage)\nthere is nothing you need to do.\n\nIf you run into any problems please [open a new issue](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/new)\nand enable the jail again by setting the environment variable:\n\n1. Edit `\/etc\/gitlab\/gitlab.rb`.\n1. Set the `DAEMON_ENABLE_JAIL` environment variable to `true` for GitLab Pages:\n\n   ```ruby\n   gitlab_pages['env']['DAEMON_ENABLE_JAIL'] = \"true\"\n   ```\n\n\nDisabling the jail will hopefully fix a bunch of issues related to DNS resolution when running Pages inside a Docker container and ease the transition to the new Pages architecture.\n\n\nPer @vshushlin suggestion https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/589#note_618738893\n\n- Add `daemon-enable-jail` flag to Pages available for source installations\n- For Omnibus installations, you can enable this by setting the following environment variable in your `\/etc\/gitlab\/gitlab.rb` file\n\n```rb\ngitlab_pages['env']['DAEMON_ENABLE_JAIL'] = \"true\"\n```","state":"closed","created_at":1625189529467,"updated_at":1631751906231,"closed_at":1626659478400,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","GitLab Core","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","release post item::in review","section::ops","type::feature","workflow::verification"],"milestone":{"id":1850118,"iid":61,"group_id":9970,"title":"14.1","description":"","state":"closed","created_at":"2021-01-26T16:56:41.887Z","updated_at":"2022-04-21T07:25:22.879Z","due_date":"2021-07-17","start_date":"2021-06-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/61"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/589","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/589","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/589\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/589\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#589","relative":"#589","full":"gitlab-org\/gitlab-pages#589"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":89577791,"iid":587,"project_id":734943,"title":"Internal API access drops URL path component","description":"I am using the GitLab CE Docker images for 13.12 and run GitLab Pages on a [separate server](https:\/\/docs.gitlab.com\/ee\/administration\/pages\/#running-gitlab-pages-on-a-separate-server).  My setup still uses disk based configuration and all pages are accessible.  I have `gitlab_pages['inplace_chroot'] = true` and set `external_url` to point to my GitLab instance.\n\nPreparing for an upgrade to 14.0 on a test setup I ran into an issue contacting the GitLab server's API.  This seems to be caused by the fact that my GitLab instance is hosted on a URL like `http:\/\/server.example.internal\/gitlab`.\n\nOn 13.12, I see the following in the GitLab Pages logs\n``` console\n==> \/var\/log\/gitlab\/gitlab-pages\/current <==\n{\"level\":\"info\",\"msg\":\"Checking GitLab internal API availability\",\"time\":\"2021-07-01T01:03:21Z\"}\n{\"error\":\"failed to connect to internal Pages API: Get \\\"http:\/\/server.example.internal\/api\/v4\/internal\/pages\/status\\\": dial tcp: lookup maniac.machine.easy on [::1]:53: dial udp [::1]:53: connect: cannot assign requested address\",\"level\":\"warning\",\"msg\":\"attempted to connect to the API\",\"time\":\"2021-07-01T01:03:21Z\"}\n```\nNote the absence of the `\/gitlab` path component in the URL!\n\nAfter I copied `\/etc\/resolv.conf` to an `etc\/` directory directly below `gitlab_rails['pages_path']`, that changed to\n``` console\n==> \/var\/log\/gitlab\/gitlab-pages\/current <==\n{\"level\":\"info\",\"msg\":\"Checking GitLab internal API availability\",\"time\":\"2021-07-01T01:20:45Z\"}\n{\"error\":\"failed to connect to internal Pages API: HTTP status: 404\",\"level\":\"warning\",\"msg\":\"attempted to connect to the API\",\"time\":\"2021-07-01T01:20:45Z\"}\n```\nFor the above GitLab Pages log entry, I see the following in the logs on my GitLab server\n``` console\n==> \/var\/log\/gitlab\/nginx\/gitlab_access.log <==\n10.11.55.227 - - [01\/Jul\/2021:01:20:45 +0000] \"GET \/api\/v4\/internal\/pages\/status HTTP\/1.1\" 404 1576 \"\" \"Go-http-client\/1.1\" 1.99\n```\nconfirming that the `\/gitlab` path component is ignored.\n\nI have tried setting `gitlab_pages['internal_gitlab_server'] = http:\/\/server.example.internal\/gitlab` but that didn't make a difference.\n\nDespite all of the above, I am able to access pages using 13.12.  So far so good :thinking:  \nHowever, when I add `gitlab_pages['domain_config_source'] = \"gitlab\"` to my 13.12 configuration, all I get is `502` HTTP status error pages :sob:  \n\nSeeing that 14.0 requires access to the internal API, it seems I will loose GitLab Pages functionality if I upgrade :worried:","state":"closed","created_at":1625104479659,"updated_at":1631597714912,"closed_at":1625557556361,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Stuff that should Just Work","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::bug","workflow::in review"],"milestone":{"id":1850118,"iid":61,"group_id":9970,"title":"14.1","description":"","state":"closed","created_at":"2021-01-26T16:56:41.887Z","updated_at":"2022-04-21T07:25:22.879Z","due_date":"2021-07-17","start_date":"2021-06-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/61"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":133754,"username":"paddy-hack","name":"Olaf Meeuwissen","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/133754\/6804372.png","web_url":"https:\/\/gitlab.com\/paddy-hack"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":9,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/587","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/587","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/587\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/587\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#587","relative":"#587","full":"gitlab-org\/gitlab-pages#587"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":88716490,"iid":582,"project_id":734943,"title":"Add flag to disable ACME challenge","description":"Currently Pages depends on [`-gitlab-server` to enable support for the ACME challenge middleware](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/39c7efd7a9045cfde6ca230e5586d8ae1842ddb0\/app.go#L517). \nThis means it's enabled by default now that the API is on by default. We should have a flag to allow users to disable the middleware if needed.\n\n```go\n\tif config.GitLab.Server != \"\" {\n\t\ta.AcmeMiddleware = &acme.Middleware{GitlabURL: config.GitLab.Server}\n\t}\n```\n\n## Proposal \n\n- Add `-disable-acme-middleware` flag to `internal\/config\/flags.go`\n- Add `disable_acme_middleware` to Omnibus default to `nil`","state":"closed","created_at":1623736227785,"updated_at":1635429358514,"closed_at":1624322681663,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/582","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/582","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/582\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/582\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#582","relative":"#582","full":"gitlab-org\/gitlab-pages#582"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":88715846,"iid":581,"project_id":734943,"title":"Use internal-gitlab-server in ACME Middleware and Auth package","description":"ACME middleware and the `auth` package both talk to the GitLab server. Currently uses the value of `-gitlab-server`. However, this may cause issues in networks with local access only. We should use the value of `config.GitLab.InternalServer` instead, which uses `-interanl-gitlab-server`.","state":"closed","created_at":1623734775608,"updated_at":1635429358903,"closed_at":1626999364739,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","[deprecated] low hanging fruit","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/581","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/581","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/581\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/581\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#581","relative":"#581","full":"gitlab-org\/gitlab-pages#581"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":87172523,"iid":571,"project_id":734943,"title":"Refactor acceptance tests to use GitLab API stub","description":"As part of removing support of disc source configuration, we need to make sure that acceptance tests are running using the API as well. Most of the current tests use disk source so this effort would likely take 2-3 MRs to get through.\n\nhttps:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/483#note_576522305","state":"closed","created_at":1621236753337,"updated_at":1635429402665,"closed_at":1629191686414,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","type::maintenance","workflow::in dev"],"milestone":{"id":1850126,"iid":62,"group_id":9970,"title":"14.2","description":"","state":"active","created_at":"2021-01-26T16:57:35.404Z","updated_at":"2021-07-22T19:45:42.498Z","due_date":"2021-08-17","start_date":"2021-07-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/62"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":7,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/571","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/571","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/571\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/571\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#571","relative":"#571","full":"gitlab-org\/gitlab-pages#571"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":86252215,"iid":568,"project_id":734943,"title":"Remove use-legacy-storage from Pages","description":"Decided to remove unnecessary flag use-legacy-storage from Pages during our last Pages sync. The logic will be handled by omnibus instead https:\/\/gitlab.com\/gitlab-org\/omnibus-gitlab\/-\/issues\/5993","state":"closed","created_at":1619740924068,"updated_at":1635429427851,"closed_at":1619765971041,"closed_by":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/263716\/avatar.jpeg","web_url":"https:\/\/gitlab.com\/grzesiek"},"labels":["Category:Pages","Pages::Object Storage","[deprecated] low hanging fruit","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":1233762,"iid":58,"group_id":9970,"title":"13.12","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.948Z","updated_at":"2022-04-21T07:22:18.898Z","due_date":"2021-05-17","start_date":"2021-04-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/58"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/568","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/568","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/568\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/568\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#568","relative":"#568","full":"gitlab-org\/gitlab-pages#568"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":86163535,"iid":567,"project_id":734943,"title":"Add Permissions-Policy: interest-cohort=() header to Pages sites hosted on GitLab.com","description":"### Background\n\nThis issue is the same as https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/327904, but for GitLab Pages instead of GitLab itself.\n\n### Proposal\n\nBegin sending the `Permissions-Policy: interest-cohort=()` header by default for Pages sites.\n\nFor now, we'll scope this change to Pages sites hosted on GitLab.com, and not self-managed Pages.\n\n### Why?\n\n- [FLoC has some worrying privacy concerns](https:\/\/www.eff.org\/deeplinks\/2021\/03\/googles-floc-terrible-idea)\n- [GitHub Pages recently blocked FLoC](https:\/\/github.blog\/changelog\/2021-04-27-github-pages-permissions-policy-interest-cohort-header-added-to-all-pages-sites\/)\n\n### Additional info\n\nGitHub only enabled this new header for non-custom sites:\n\n> Pages sites using a custom domain will not be impacted\n\nI'm not exactly sure why they made this decision. I think we should send this header by default for _all_ Pages sites, unless there's a convincing reason not to.\n\n### Technical proposal\n\n* Add `Permissions-Policy: interest-cohort=()` to the [config CustomHeaders](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/4ff61e374a7dbfa51fee91799f11197e0f8d53f7\/internal\/config\/config.go#L251) on startup\n* Add a boolean flag `-disable-floc-header` (or `-disable-permissions-policy-header`) to https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/master\/internal\/config\/flags.go -> when `true` we don't attach that header as above\n* Add the option to Omnibus\n* Update admin docs","state":"closed","created_at":1619637442895,"updated_at":1622554012758,"closed_at":1620148853101,"closed_by":{"id":493585,"username":"nfriend","name":"Nathan Friend","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/cd23f74a33fc7d8dfe081948696551a5?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/nfriend"},"labels":["Category:Pages","backend","devops::release [DEPRECATED]","documentation","group::release [DEPRECATED]","section::ops","workflow::planning breakdown"],"milestone":null,"assignees":[{"id":876203,"username":"igorwwwwwwwwwwwwwwwwwwww","name":"Igor","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/876203\/avatar.png","web_url":"https:\/\/gitlab.com\/igorwwwwwwwwwwwwwwwwwwww"}],"author":{"id":493585,"username":"nfriend","name":"Nathan Friend","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/cd23f74a33fc7d8dfe081948696551a5?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/nfriend"},"type":"ISSUE","assignee":{"id":876203,"username":"igorwwwwwwwwwwwwwwwwwwww","name":"Igor","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/876203\/avatar.png","web_url":"https:\/\/gitlab.com\/igorwwwwwwwwwwwwwwwwwwww"},"user_notes_count":13,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/567","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/567","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/567\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/567\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#567","relative":"#567","full":"gitlab-org\/gitlab-pages#567"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":85999746,"iid":566,"project_id":734943,"title":"Handle multiple errors in config validation","description":"The following discussion from !465 should be addressed:\n\n- [ ] @hswimelar started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/465#note_560875755):  (+1 comment)\n\n    > This might be a good chance to either use non-fatal logging and return an error at the end. This way, multple problems with the config can be reported all at once, so the user may understand all the work they need to do, rather than having to fix the config one problem at a time.\n    > \n    > https:\/\/github.com\/hashicorp\/go-multierror works really well here, but I'm not a maintainer, so I don't feel very confident recommending you to add a third-party dependency. Maybe something do in a commit you can easily revert, if you decide to do down this path.","state":"closed","created_at":1619501067363,"updated_at":1635429435514,"closed_at":1620167554990,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] low hanging fruit","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":6,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/566","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/566","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/566\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/566\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#566","relative":"#566","full":"gitlab-org\/gitlab-pages#566"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":84834773,"iid":561,"project_id":734943,"title":"Remove chroot logic","description":"We should remove chroot\/jail once we fully rollout ZIP, on or after %\"14.3\" \n\nhttps:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/326117#note_546346101\n\nThis can be removed after `use_legacy_storage` has been removed https:\/\/gitlab.com\/gitlab-org\/omnibus-gitlab\/-\/issues\/6166","state":"closed","created_at":1617859316430,"updated_at":1641947870914,"closed_at":1629953053088,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Deliverable","Pages::Object Storage","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","workflow::in dev"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/63"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/40569112d16323eb878ebdead2117943?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/feistel"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":2,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/561","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/561","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/561\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/561\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#561","relative":"#561","full":"gitlab-org\/gitlab-pages#561"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905.0,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"\/groups\/gitlab-org\/-\/epics\/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":81597674,"iid":557,"project_id":734943,"title":"Reduce cyclomatic complexity of appMain","description":"Job [#1122897267](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/jobs\/1122897267) failed for fa7c12070e7ba921c1d5091f735eec4cc638cd6b:","state":"closed","created_at":1616629378086,"updated_at":1637818204793,"closed_at":1637818204772,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","[deprecated] low hanging fruit","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/557","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/557","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/557\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/557\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#557","relative":"#557","full":"gitlab-org\/gitlab-pages#557"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":80527421,"iid":555,"project_id":734943,"title":"Make mutex in type Gitlab a value receiver","description":"The following discussion from !434 should be addressed:\n\n- [ ] @ash2k started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/434#note_522916031): \n\n    > There is almost never a need to make mutexes pointers. I wonder why it's a pointer here?","state":"closed","created_at":1615265420468,"updated_at":1635429547879,"closed_at":1617232528573,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/555","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/555","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/555\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/555\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#555","relative":"#555","full":"gitlab-org\/gitlab-pages#555"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":78475986,"iid":543,"project_id":734943,"title":"Allow to disable local disk type of access","description":"Since Pages can run in a fully remote type of access we should\nallow disabling disk access completely.\n\nMaybe the simplest way to achieve that would be to specify `-enable-disk=false`,\nor switch to specifying an array of `-allowed-paths=[]` instead that would superseed `-pages-root`.\n\nThis would be needed to ensure that we fully disable a disk-type of accesses for cases where it is not needed,\nlike CNG.\n\nProposal:\n\n- Introduce `-enable-disk`, when false Pages will not need to scan the `pages-root` directory. However, a `pages-root` value is still needed for daemonizing into a jail or chroot.","state":"closed","created_at":1612514538476,"updated_at":1625117538552,"closed_at":1621378964062,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","workflow::production"],"milestone":{"id":1233762,"iid":58,"group_id":9970,"title":"13.12","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.948Z","updated_at":"2022-04-21T07:22:18.898Z","due_date":"2021-05-17","start_date":"2021-04-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/58"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":15,"merge_requests_count":1,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/543","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/543","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/543\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/543\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#543","relative":"#543","full":"gitlab-org\/gitlab-pages#543"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3910.0,"epic":{"id":81062,"iid":3910,"title":"Migrate GitLab Pages to object storage on self-hosted installs","url":"\/groups\/gitlab-org\/-\/epics\/3910","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":78475817,"iid":542,"project_id":734943,"title":"Introduce a switch for `disk` serving that would allow this type of access being disabled","description":"Currently, we expose `disk` serving as a way to access data.\n\nWe should introduce a switch that would disallow usage of that feature with a toggle.\nThis toggle ideally:\n- should be off by default with %\"14.0\"\n- should be off by default for every CNG installation\n\n```\n- use-legacy-storage=true\n```","state":"closed","created_at":1612514288969,"updated_at":1615263672021,"closed_at":1614829066205,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","workflow::in review"],"milestone":{"id":1233761,"iid":57,"group_id":9970,"title":"13.10","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.646Z","updated_at":"2022-04-21T07:22:00.171Z","due_date":"2021-03-17","start_date":"2021-02-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/57"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":16,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/542","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/542","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/542\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/542\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#542","relative":"#542","full":"gitlab-org\/gitlab-pages#542"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3910.0,"epic":{"id":81062,"iid":3910,"title":"Migrate GitLab Pages to object storage on self-hosted installs","url":"\/groups\/gitlab-org\/-\/epics\/3910","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":77799953,"iid":535,"project_id":734943,"title":"Pages \"auto\" configuration source doesn't work as expected","description":"After `13.7` some people started to have problems with gitlab-pages. Most common symptom: pages are available 50% of the time.\n\nThe problem is only present if people have multiple servers running both pages and `gitlab-rails`(see below)\n\n### Consider this setup\n* client has gitlab instance \"gitlab.example.com\"\n* and multiple servers running both `gitlab-rails` and `gitlab-pages` simultaneously\n\n### How \"auto\" currently works\n* During startup `gitlab-pages` checks if the API is available multiple times until it gets `200 OK` in response. Which it eventually does because there is a load balancer for \"gitlab.example.com\" and eventually `gitlab-pages` hits the same server as one it's running on.\n* Then `gitlab-pages` remembers that `API is functioning` and will serve `502` errors if it isn't.\n\n### Workaround\n* run steps 8-10 in https:\/\/docs.gitlab.com\/13.7\/ee\/administration\/pages\/index.html#running-gitlab-pages-on-a-separate-server\n* or explicitly set `gitlab_pages['domain_config_source'] = \"disk\"` as described in https:\/\/docs.gitlab.com\/ee\/administration\/pages\/#gitlab-api-based-configuration (not recommended, because in %14.0 this option will be removed and you'll need to do the first option anyway)\n\n### Suggested fix\nchange \"auto\" behavior: if we ever fail to access API with unauthorized error - fallback to disk. (do not do this if `gitlab` is set explicitly).","state":"closed","created_at":1611582858794,"updated_at":1679335476643,"closed_at":1612172277290,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","devops::release [DEPRECATED]","group::release [DEPRECATED]","priority::2","regression","regression:13.7","section::ops","severity::2","type::bug","workflow::in review"],"milestone":{"id":1233760,"iid":56,"group_id":9970,"title":"13.9","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.334Z","updated_at":"2022-04-21T07:21:28.468Z","due_date":"2021-02-17","start_date":"2021-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/56"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":9,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/535","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/535","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/535\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/535\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#535","relative":"#535","full":"gitlab-org\/gitlab-pages#535"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":76842878,"iid":528,"project_id":734943,"title":"Re-enable IPv6 listeners in acceptance tests","description":"Re-enable IPv6 listeners in acceptance tests once https:\/\/gitlab.com\/gitlab-com\/gl-infra\/infrastructure\/-\/issues\/12258 is resolved\n\nBlocked by https:\/\/gitlab.com\/gitlab-com\/gl-infra\/infrastructure\/-\/issues\/12258\n\nRelated to #524","state":"closed","created_at":1609979791450,"updated_at":1635429702586,"closed_at":1612162976028,"closed_by":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/263716\/avatar.jpeg","web_url":"https:\/\/gitlab.com\/grzesiek"},"labels":["Category:Pages","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","type::maintenance"],"milestone":{"id":1233760,"iid":56,"group_id":9970,"title":"13.9","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.334Z","updated_at":"2022-04-21T07:21:28.468Z","due_date":"2021-02-17","start_date":"2021-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/56"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":4,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/528","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/528","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/528\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/528\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#528","relative":"#528","full":"gitlab-org\/gitlab-pages#528"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":76168314,"iid":524,"project_id":734943,"title":"Flaky acceptance tests due to port already in use","description":"Since we split the acceptance tests execution in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/403, we now get a bunch of errors due to the ports being already in use. \n\nRetrying the jobs one by one in a failing pipeline seem to be enough to make the tests pass.\n\nSample job https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/jobs\/912690661\n```\nmsg=\"could not create socket\" error=\"listen tcp [::1]:37000: bind: cannot assign requested address\"\n```\n\nA potential solution is to use TCP port 0 and let the OS assign an available port. However, there is no easy way to communicate the port that was assigned to the Pages acceptance tests. This causes [`WaitUntilRequestSucceeds`](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/21066de52d7f7af759bdf2395694c935110da1bb\/test\/acceptance\/helpers_test.go#L155) to wait until timeout to get a response from the binary currently running.\n\nSample faling pipeline\nhttps:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/pipelines\/237350515\n\n---\n\n## Update 2020-01-07\n\nIPv6 seems to be disabled in some `gitlab-org-docker` runners https:\/\/gitlab.com\/gitlab-com\/gl-infra\/infrastructure\/-\/issues\/12258.","state":"closed","created_at":1608187520047,"updated_at":1610354565694,"closed_at":1610354565621,"closed_by":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/263716\/avatar.jpeg","web_url":"https:\/\/gitlab.com\/grzesiek"},"labels":["Category:Pages","Stuff that should Just Work","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","workflow::in review"],"milestone":{"id":1233759,"iid":55,"group_id":9970,"title":"13.8","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:13.983Z","updated_at":"2022-04-13T14:51:23.220Z","due_date":"2021-01-17","start_date":"2020-12-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/55"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":5,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/524","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/524","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/524\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/524\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#524","relative":"#524","full":"gitlab-org\/gitlab-pages#524"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":76013210,"iid":520,"project_id":734943,"title":"Make gitlab client cache configurable","description":"The `internal\/source\/gitlab\/cache\/` package is currently semi hardcoded using the [`defaultCacheConfiguration`](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/5e5ce293e7eb529f4443198b8cd8bb4d9a1ff418\/internal\/source\/gitlab\/cache\/cache.go#L11). This makes it hard to write acceptance tests that can execute faster. For example https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/393#note_463829311.\n\nWe should introduce extra flags that will allow configuring the cache's behaviour for resolving a domain's configuration.\n\n## Default configuration\n\n```go\nvar defaultCacheConfig = cacheConfig{\n\tcacheExpiry:          10 * time.Minute,\n\tentryRefreshTimeout:  60 * time.Second,\n\tretrievalTimeout:     30 * time.Second,\n\tmaxRetrievalInterval: time.Second,\n\tmaxRetrievalRetries:  3,\n}\n``` \n\n## Implementation\n\n1. Add the following flags to Pages and override `defaultCacheConfig`\n\n  - gitlab-cache-expiry -> The maximum time a domain's configuration is stored in the cache (default: 600s)\n  - gitlab-cache-refresh -> The interval at which a domain's configuration is set to be due to refresh (default: 60s)\n  - gitlab-cache-cleanup -> The interval at which expired items are removed from the cache (default: 60s)\n  - gitlab-retrieval-timeout -> The maximum time to wait for a response from the GitLab API per request (default: 30s)\n  - gitlab-retrieval-interval -> The interval to wait before retrying to resolve a domain's configuration via the GitLab API (default: 1s)\n  - gitlab-retrieval-retries -> The maximum number of times to retry to resolve a domain's configuration via the API (default: 3)\n\n\n2. Move `cacheConfig` to `internal\/config\/`\n3. Add flags to Omnibus\n4. Documentation updates\n\nThe first part of https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/507 is done so we can work on this\n\n## What do these settings do\n\nUsers can configure these settings when using [API-based configuration](https:\/\/docs.gitlab.com\/ee\/administration\/pages\/#gitlab-api-based-configuration) to modify the cache behavior for a domain's resolution. The recommended default values are set inside GitLab Pages and should only be modified if needed.\n\nSome examples:\n\n- Increasing `gitlab-cache-expiry` will allow items to exist in the cache longer. This setting might be useful if the communication between Pages and GitLab Rails is not stable or the content served by Pages does not change frequently.\n- Increasing `gitlab-cache-refresh` will reduce the frequency at which GitLab Pages requests a domain's configuration from GitLab Rails. This setting might be useful for content that does not change frequently.\n- Decreasing `gitlab-retrieval-retries` will report issues between Pages and Rails more quickly. However, they can be transient failures rather than real issues.","state":"closed","created_at":1607929336166,"updated_at":1635429741225,"closed_at":1616471630784,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","cicd::active","devops::release [DEPRECATED]","documentation","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::production"],"milestone":{"id":1233761,"iid":57,"group_id":9970,"title":"13.10","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.646Z","updated_at":"2022-04-21T07:22:00.171Z","due_date":"2021-03-17","start_date":"2021-02-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/57"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/520","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":4,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/520","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/520\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/520\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#520","relative":"#520","full":"gitlab-org\/gitlab-pages#520"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":75395466,"iid":513,"project_id":734943,"title":"Refactor `Error`s to strings that aren't used as `error`","description":"Follow up to https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/399#note_455909360\n\n@jaime started a discussion https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/399#note_455909360:\n\n> If we are using them as error messages rather than errors, then we should probably change them to just string constants or even inline them in the log line itself. There's no point in defining an error that is not going to be returned or used as value, WDYT?\n> \n> e.g. define the messages as strings\n> \n> ```go\n> const (\n>\tcreateArtifactRequestErrMsg = \"Failed to create the artifact request\"\n>\tartifactRequestErrMsg       = \"Failed to request the artifact\"\n> )\n> ```","state":"closed","created_at":1606783946451,"updated_at":1635429801962,"closed_at":1611146352425,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","[deprecated] Accepting merge requests","[deprecated] good for new contributors","[deprecated] low hanging fruit","cicd::planning","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::in dev"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[{"id":7892101,"username":"kevin.kengne1","name":"Kevin Kengne","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/7892101\/avatar.png","web_url":"https:\/\/gitlab.com\/kevin.kengne1"}],"author":{"id":259327,"username":"tomquirk","name":"Tom Quirk","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/259327\/avatar.png","web_url":"https:\/\/gitlab.com\/tomquirk"},"type":"ISSUE","assignee":{"id":7892101,"username":"kevin.kengne1","name":"Kevin Kengne","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/7892101\/avatar.png","web_url":"https:\/\/gitlab.com\/kevin.kengne1"},"user_notes_count":4,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/513","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/513","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/513\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/513\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#513","relative":"#513","full":"gitlab-org\/gitlab-pages#513"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":74943046,"iid":510,"project_id":734943,"title":"Use CorrelationID middleware in Pages","description":"Since Pages does not appear to use CorrelationIDs are present (it should!)\n\nThe following discussion from !397 should be addressed:\n\n- [ ] @andrewn started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/397#note_452561607):  (+2 comments)\n\n    > @jaime would you mind reviewing please?\n\n---\n\n1. Add the correlation ID to Pages, including a `propagate-correlation-id` flag.\n1. Add flag to Omnibus `gitlab_pages['propagate_correlation_id'] to Omnibus\n1. Update Pages admin documentation \n\n---\n\n# Propagating the correlation ID\n\nSetting the `propagate_correlation_id` in Omnibus will allow installations behind a reverse proxy generate and set a correlation ID to requests sent to GitLab Pages. When a reverse proxy sets the header value `x-request-id`, the value will be propagated in the request chain. Users [can find the correlation ID in the logs](https:\/\/docs.gitlab.com\/ee\/administration\/troubleshooting\/tracing_correlation_id.html#identify-the-correlation-id-for-a-request).","state":"closed","created_at":1606267407781,"updated_at":1635204237600,"closed_at":1635194945353,"closed_by":{"id":5622641,"username":"nicolewilliams","name":"Nicole Williams","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/5622641\/avatar.png","web_url":"https:\/\/gitlab.com\/nicolewilliams"},"labels":["Category:Pages","[deprecated] good for new contributors","cicd::planning","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","type::maintenance","workflow::in dev"],"milestone":{"id":1233761,"iid":57,"group_id":9970,"title":"13.10","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.646Z","updated_at":"2022-04-21T07:22:00.171Z","due_date":"2021-03-17","start_date":"2021-02-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/57"},"assignees":[{"id":1832709,"username":"ercan.ucan","name":"Ercan Ucan","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/1832709\/avatar.png","web_url":"https:\/\/gitlab.com\/ercan.ucan"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":1832709,"username":"ercan.ucan","name":"Ercan Ucan","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/1832709\/avatar.png","web_url":"https:\/\/gitlab.com\/ercan.ucan"},"user_notes_count":8,"merge_requests_count":1,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/510","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/510","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/510\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/510\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#510","relative":"#510","full":"gitlab-org\/gitlab-pages#510"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":74618720,"iid":507,"project_id":734943,"title":"Refactor config flags and consolidate in internal\/config\/ package","description":"- Move all config flags to `internal\/config\/`\n- Refactor config struct so it can be called from any other package\n\nThe following discussion from !392 should be addressed:\n\n- [ ] @jaime started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/392#note_450695359): \n\n    > Move all config flags to `internal\/config\/`","state":"closed","created_at":1605780060981,"updated_at":1635429828961,"closed_at":1614926036807,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":{"id":1233761,"iid":57,"group_id":9970,"title":"13.10","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.646Z","updated_at":"2022-04-21T07:22:00.171Z","due_date":"2021-03-17","start_date":"2021-02-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/57"},"assignees":[{"id":4849,"username":"balasankarc","name":"Balasankar 'Balu' C","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4849\/avatar.png","web_url":"https:\/\/gitlab.com\/balasankarc"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4849,"username":"balasankarc","name":"Balasankar 'Balu' C","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4849\/avatar.png","web_url":"https:\/\/gitlab.com\/balasankarc"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/507","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/507","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/507\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/507\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#507","relative":"#507","full":"gitlab-org\/gitlab-pages#507"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":74416375,"iid":505,"project_id":734943,"title":"Make `\/pages` to be an actual `artifacts-path`","description":"We decided that `file:\/\/` being used for ZIP will return a full absolute path as seen from Rails perspective.\n\nHowever, when doing `chroot` in `pages` we mount `pages-root` under `\/pages`. We should instead ensure\nthat in chroot env the absolute path to access resource is exactly the same, to allow the `file:\/\/` returned by\nRails to function exactly the same.\n\nThis is required for https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/485.","state":"closed","created_at":1605517934631,"updated_at":1612255284361,"closed_at":1612255284014,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::feature","workflow::in review"],"milestone":{"id":1233760,"iid":56,"group_id":9970,"title":"13.9","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.334Z","updated_at":"2022-04-21T07:21:28.468Z","due_date":"2021-02-17","start_date":"2021-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/56"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":13,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/505","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/505","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/505\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/505\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#505","relative":"#505","full":"gitlab-org\/gitlab-pages#505"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905.0,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"\/groups\/gitlab-org\/-\/epics\/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":73899685,"iid":500,"project_id":734943,"title":"Support splat (wildcard) redirects","description":"In https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/24, a simple redirect mechanism was implemented https:\/\/docs.gitlab.com\/ee\/user\/project\/pages\/redirects.html.\n\nIt would be great if we also supported splat (wildcard) redirect support. According to the [Netlify docs](https:\/\/docs.netlify.com\/routing\/redirects\/redirect-options\/#splats):\n\n```\n\/news\/*  \/blog\/:splat\n```\n\nThis would redirect paths like `\/news\/2004\/01\/10\/my-story` to `\/blog\/2004\/01\/10\/my-story`.\n\nIt would mean a lot for the docs site, since we want to move away from the `\/ee` prefix and use something like `\/gitlab`.\n\n```\n\/ee\/*  \/gitlab\/:splat\n```\n\n### Release Notes\n\nDetails to be added","state":"closed","created_at":1604565163022,"updated_at":1632103782032,"closed_at":1632103782019,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","GitLab Core","GitLab Premium","GitLab Ultimate","Technical Writing","cicd::active","customer","devops::release [DEPRECATED]","direction","group::release [DEPRECATED]","internal customer","release post item::in review","section::ops","type::feature","workflow::production"],"milestone":{"id":1948702,"iid":63,"group_id":9970,"title":"14.3","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2021-03-17T21:43:36.613Z","updated_at":"2022-04-21T07:25:29.231Z","due_date":"2021-09-17","start_date":"2021-08-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/63"},"assignees":[{"id":493585,"username":"nfriend","name":"Nathan Friend","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/cd23f74a33fc7d8dfe081948696551a5?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/nfriend"},{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":3585,"username":"axil","name":"Achilleas Pipinellis","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3585\/avatar.png","web_url":"https:\/\/gitlab.com\/axil"},"type":"ISSUE","assignee":{"id":493585,"username":"nfriend","name":"Nathan Friend","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/cd23f74a33fc7d8dfe081948696551a5?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/nfriend"},"user_notes_count":51,"merge_requests_count":0,"upvotes":5,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/500","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/500","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/500\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/500\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#500","relative":"#500","full":"gitlab-org\/gitlab-pages#500"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":73297571,"iid":495,"project_id":734943,"title":"Object Storage should have a strict TTFB timeout","description":"We had\/have an outage related to GCS used by GitLab Pages:\n\nhttps:\/\/prometheus-app.gprd.gitlab.net\/graph?g0.range_input=1h&g0.expr=avg(rate(gitlab_pages_httprange_trace_duration_sum%7Brequest_stage%3D%22httptrace.ClientTrace.GotFirstResponseByte%22%7D%5B5m%5D)%2Frate(gitlab_pages_httprange_trace_duration_count%7Brequest_stage%3D%22httptrace.ClientTrace.GotFirstResponseByte%22%7D%5B5m%5D))&g0.tab=0&g1.range_input=2h&g1.expr=sum(gitlab_pages_httprange_open_requests)&g1.tab=0&g2.range_input=2h&g2.stacked=1&g2.expr=sum(increase(gitlab_pages_vfs_operations_total%7Boperation%3D%22Open%22%7D%5B5m%5D))%20by%20(vfs_name%2C%20operation)&g2.tab=0\n\n### TTFB\n\n![image](\/uploads\/fd84ed1775b3ae7c32735a9bf8c76cfb\/image.png)\n\nWe clearly see that TTFB sky rockets once we disabled NFS. In regular operation we expect `25ms`, during outage of GCS we were seeing around `20s`, but once we disabled it appears that some requests had TTFB close to \"a few minutes\".\n\n### Connections\n\n![image](\/uploads\/24df853cd766d9b48b65962c0464ab49\/image.png)\n\nThis created a crazy backlog of 6k open connections to GCS. Our timeout on the connection is 30 minutes.\n\n### Summary\n\nThis outage showed some aspects to improve in Pages related how Pages handles timeouts, and what timeouts it should use to ensure sane service recovery and reducing amplification pressure due to outage happening elsewhere.\n\n### Proposal\n\nDefine TTFB to be no longer than 15s. This should ensure that \"sane amount\" of requests is opened, and system can fast-reject instead of hang.\n\n```golang\nvar httpClient = &http.Client{\n\t\/\/ The longest time the request can be executed\n\tTimeout: 30 * time.Minute,\n\tTransport: httptransport.NewTransportWithMetrics(\n\t\t\"httprange_client\",\n\t\tmetrics.HTTPRangeTraceDuration,\n\t\tmetrics.HTTPRangeRequestDuration,\n\t\tmetrics.HTTPRangeRequestsTotal,\n\t),\n}\n```\n\nWe should configure the:\n\n- `TLSHandshakeTimeout time.Duration`, aka before being able to write `request`\n- `ResponseHeaderTimeout time.Duration`, aka close to `TTFB`\n- `ExpectContinueTimeout time.Duration`, aka similar to `TTFB`\n\nOr, just implement that differently as part of RoundTrip of `httprange` to define a timeout to receiving response (but not yet fully reading it).\n\nMore here: https:\/\/blog.cloudflare.com\/the-complete-guide-to-golang-net-http-timeouts\/","state":"closed","created_at":1603555531917,"updated_at":1603877175130,"closed_at":1603877175025,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","[deprecated] low hanging fruit","devops::release [DEPRECATED]","feature::enhancement","section::ops","type::feature","workflow::in review"],"milestone":{"id":1233755,"iid":53,"group_id":9970,"title":"13.6","description":"https:\/\/about.gitlab.com\/releases\/2020\/11\/22\/gitlab-13-6-released\/","state":"closed","created_at":"2020-04-09T17:39:22.328Z","updated_at":"2022-04-13T14:51:04.376Z","due_date":"2020-11-17","start_date":"2020-10-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/53"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":10,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/495","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/495","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/495\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/495\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#495","relative":"#495","full":"gitlab-org\/gitlab-pages#495"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4659.0,"epic":{"id":129623,"iid":4659,"title":"Finalize Pages on zip architecture for rollout to gitlab.com","url":"\/groups\/gitlab-org\/-\/epics\/4659","group_id":9970,"human_readable_end_date":"Dec 22, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":73291617,"iid":494,"project_id":734943,"title":"The unavailability of GitLab API makes us fallback to disk-serving","description":"Currently, if the GitLab API is unavailable we fallback to using `disk serving`.\n\nThis is OK, now, but in a fully cloud-native architecture, this should rather\nreturn a proper `500` type of error.\n\nWe should disable `local instance()` and instead return a proper error to client.\n\n```golang\nfunc (d *Domain) resolve(r *http.Request) *serving.Request {\n\trequest, _ := d.Resolver.Resolve(r)\n\n\t\/\/ TODO improve code around default serving, when `disk` serving gets removed\n\t\/\/ https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/issues\/353\n\tif request == nil {\n\t\treturn &serving.Request{Serving: local.Instance()}\n\t}\n\n\treturn request\n}\n\n\/\/ ServeFileHTTP returns true if something was served, false if not.\nfunc (d *Domain) ServeFileHTTP(w http.ResponseWriter, r *http.Request) bool {\n\tif !d.HasLookupPath(r) {\n\t\t\/\/ TODO: this seems to be wrong: as we should rather return false, and\n\t\t\/\/ fallback to `ServeNotFoundHTTP` to handle this case\n\t\thttperrors.Serve404(w)\n\t\treturn true\n\t}\n\n\trequest := d.resolve(r)\n\n\treturn request.ServeFileHTTP(w, r)\n}\n```","state":"closed","created_at":1603536623835,"updated_at":1635429908001,"closed_at":1611744251376,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":1233760,"iid":56,"group_id":9970,"title":"13.9","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.334Z","updated_at":"2022-04-21T07:21:28.468Z","due_date":"2021-02-17","start_date":"2021-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/56"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":17,"merge_requests_count":2,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/494","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/494","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/494\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/494\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#494","relative":"#494","full":"gitlab-org\/gitlab-pages#494"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4659.0,"epic":{"id":129623,"iid":4659,"title":"Finalize Pages on zip architecture for rollout to gitlab.com","url":"\/groups\/gitlab-org\/-\/epics\/4659","group_id":9970,"human_readable_end_date":"Dec 22, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":72696799,"iid":485,"project_id":734943,"title":"Allow to serve `zip` from a disk `\/pages`","description":"Currently, GitLab Pages can serve remotely stored ZIP archives.\n\nHowever, since we want to migrate all our deployments to ZIP,\nwe should support serving a local stored content as well.\n\nThis is needed to ensure that we can migrate on-premise installations\nusing NFS or local disks to ZIP-architecture.","state":"closed","created_at":1602665762169,"updated_at":1679335476377,"closed_at":1613382570819,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::feature","workflow::in review"],"milestone":{"id":1233760,"iid":56,"group_id":9970,"title":"13.9","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:44:14.334Z","updated_at":"2022-04-21T07:21:28.468Z","due_date":"2021-02-17","start_date":"2021-01-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/56"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":37,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/485","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":5,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/485","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/485\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/485\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#485","relative":"#485","full":"gitlab-org\/gitlab-pages#485"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3910.0,"epic":{"id":81062,"iid":3910,"title":"Migrate GitLab Pages to object storage on self-hosted installs","url":"\/groups\/gitlab-org\/-\/epics\/3910","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":72676917,"iid":483,"project_id":734943,"title":"Fix TestVFSFindOrCreateArchiveCacheEvict flaky test","description":"I found this flaky test locally, I believe this line https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/6cba2f2875856a7b4e2d008ca348d7b91098ed35\/internal\/vfs\/zip\/vfs_test.go#L120 is causing trouble\n\n```\n go test .\/internal\/vfs\/zip -run TestVFSFindOrCreateArchiveCacheEvict -count 10 -failfast\n--- FAIL: TestVFSFindOrCreateArchiveCacheEvict (0.00s)\n    vfs_test.go:126:\n        \tError Trace:\tvfs_test.go:126\n        \tError:      \tShould not be: &zip.zipArchive{fs:(*zip.zipVFS)(0xc0000b1e90), path:\"http:\/\/127.0.0.1:60311\/public.zip\", once:sync.Once{done:0x1, m:sync.Mutex{state:0, sema:0x0}}, done:(chan struct {})(0xc0000b26c0), openTimeout:30000000000, cacheNamespace:\"1:\", resource:(*httprange.Resource)(0xc00007fe00), reader:(*httprange.RangedReader)(0xc00007ba50), archive:(*zip.Reader)(0xc00007fe80), err:error(nil), files:map[string]*zip.File{\"public\/\":(*zip.File)(0xc000240160), \"public\/404.html\":(*zip.File)(0xc000240370), \"public\/bad_symlink.html\":(*zip.File)(0xc000240790), \"public\/index.html\":(*zip.File)(0xc0002402c0), \"public\/subdir\/\":(*zip.File)(0xc000240420), \"public\/subdir\/2bp3Qzs9CCW7cGnxhghdavZ2bJDTzvu2mrj6O8Yqjm3YMRozRZULxBBKzJXCK16GlsvO1GlbCyONf2LTCndJU9cIr5T3PLDN7XnfG00lEmf9DWHPXiAbbi0v8ioSjnoTqdyjELVKuhsGRGxeV9RptLMyGnbpJx1w2uECiUQSHrRVQNuq2xoHLlk30UAmis1EhGXP5kKprzHxuavsKMdT4XRP0d79tie4tjqtfRsP4y60hmNS1vSujrxzhDa\":(*zip.File)(0xc0002406e0), \"public\/subdir\/hello.html\":(*zip.File)(0xc0002404d0), \"public\/subdir\/linked.html\":(*zip.File)(0xc000240580), \"public\/symlink.html\":(*zip.File)(0xc000240630)}}\n        \tTest:       \tTestVFSFindOrCreateArchiveCacheEvict\n        \tMessages:   \ta different archive is returned\nFAIL\nFAIL\tgitlab.com\/gitlab-org\/gitlab-pages\/internal\/vfs\/zip\t0.132s\nFAIL\n```","state":"closed","created_at":1602632317891,"updated_at":1602692995634,"closed_at":1602692995590,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Pages::Object Storage","devops::release [DEPRECATED]","section::ops","type::bug"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/483","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/483","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/483\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/483\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#483","relative":"#483","full":"gitlab-org\/gitlab-pages#483"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":72631918,"iid":482,"project_id":734943,"title":"Pages 404s with pages_artifacts_archive enabled","description":"We had a Silver Customer ([Zendesk](https:\/\/gitlab.zendesk.com\/agent\/tickets\/176158) - internal only) report that they started getting 404s on their Pages project, but it worked when copying in a new project.\n\nThat happened a few hours after the `pages_artifacts_archive` rollout percentage was increased.\n\n@ayufan turned off the feature flag and we were able to see the Pages again.\n\nRelevant [Slack thread](https:\/\/gitlab.slack.com\/archives\/C1BSEQ138\/p1602582002162400?thread_ts=1602547809.159500&cid=C1BSEQ138) (internal only)","state":"closed","created_at":1602583315835,"updated_at":1602751379390,"closed_at":1602751378914,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","customer","devops::release [DEPRECATED]","section::ops","type::bug","workflow::in dev"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https:\/\/about.gitlab.com\/releases\/2020\/10\/22\/gitlab-13-5-released\/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/52"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"}],"author":{"id":4375373,"username":"cat","name":"Catalin Irimie","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/fd4f68fe3a123d56ac4413dc960b7559?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/cat"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/482","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/482","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/482\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/482\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#482","relative":"#482","full":"gitlab-org\/gitlab-pages#482"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905.0,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"\/groups\/gitlab-org\/-\/epics\/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":72614208,"iid":481,"project_id":734943,"title":"Improve zip cache refreshing for the same domain","description":"We open a bunch of archives each minute: https:\/\/prometheus-app.gprd.gitlab.net\/graph?g0.range_input=1h&g0.expr=increase(gitlab_pages_zip_opened%5B5m%5D)&g0.tab=0\n\nFrom slack: https:\/\/gitlab.slack.com\/archives\/C1BSEQ138\/p1602144418115300\n\n```\nkamil Oct 8th at 7:06 PM\n@jaime I think we are done with LRU for time being. Maybe next get archive refresh to be working?\n4 replies\n\nkamil  5 days ago\nLooking at this graph it appears that we open a bunch of archives each minute: https:\/\/prometheus-app.gprd.gitlab.net\/graph?g0.range_input=1h&g0.expr=increase(gitlab_pages_zip_opened%5B5m%5D)&g0.tab=0\n\njaime  1 day ago\ndo you mean we\u2019re refreshing too often?\n\nkamil  22 hours ago\nYes, we each time we refresh the domain via API a new URL is being returned due to changed auth params. This means that we reload each accessed archive every minute. (edited) \n\nkamil  22 hours ago\nDue to caching, holding 2-3 archives for a given domain at a single time.\n```","state":"closed","created_at":1602567759952,"updated_at":1635429958604,"closed_at":1605007240500,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":1233755,"iid":53,"group_id":9970,"title":"13.6","description":"https:\/\/about.gitlab.com\/releases\/2020\/11\/22\/gitlab-13-6-released\/","state":"closed","created_at":"2020-04-09T17:39:22.328Z","updated_at":"2022-04-13T14:51:04.376Z","due_date":"2020-11-17","start_date":"2020-10-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/53"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"user_notes_count":20,"merge_requests_count":2,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/481","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/481","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/481\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/481\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#481","relative":"#481","full":"gitlab-org\/gitlab-pages#481"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4659.0,"epic":{"id":129623,"iid":4659,"title":"Finalize Pages on zip architecture for rollout to gitlab.com","url":"\/groups\/gitlab-org\/-\/epics\/4659","group_id":9970,"human_readable_end_date":"Dec 22, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":72377135,"iid":477,"project_id":734943,"title":"Add vfs type to access log","description":"From [slack comment](https:\/\/gitlab.slack.com\/archives\/C1BSEQ138\/p1602147615122100?thread_ts=1602147179.119100&cid=C1BSEQ138):\n> I also think that it would be helpful for us to extend kibana logs with information on how the file was served (if it was ZIP), so we could ELK grep logs and find unique domains being served.","state":"closed","created_at":1602148728703,"updated_at":1602587592987,"closed_at":1602587592930,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","section::ops"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https:\/\/about.gitlab.com\/releases\/2020\/10\/22\/gitlab-13-5-released\/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/52"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/477","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/477","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/477\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/477\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#477","relative":"#477","full":"gitlab-org\/gitlab-pages#477"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905.0,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"\/groups\/gitlab-org\/-\/epics\/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":71929438,"iid":474,"project_id":734943,"title":"Cache `Readlink` data","description":"Currently `Readlink` is evaluated each time. Similarly to [`cacheOffset`](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/461) we should cache symlinks as well.\n\nTo ensure that `Readlink` is processed in a predictable time, using minimal amount of requests, especially that in some cases we need to perform symlink traversal.","state":"closed","created_at":1601458009550,"updated_at":1602701530394,"closed_at":1602030015071,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Pages::Object Storage","bug::performance","cicd::active","devops::release [DEPRECATED]","section::ops","type::feature","workflow::in dev"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https:\/\/about.gitlab.com\/releases\/2020\/10\/22\/gitlab-13-5-released\/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/52"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":9,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/474","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/474","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/474\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/474\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#474","relative":"#474","full":"gitlab-org\/gitlab-pages#474"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196.0,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"\/groups\/gitlab-org\/-\/epics\/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":71907954,"iid":473,"project_id":734943,"title":"Improve tooling for local Golang development","description":"Local development is not friendly for Go newcomers, decreasing the likelihood of ~\"Community contribution\"s\n\n- Since go modules was introduced, `make setup` fails trying to remove `.GOPATH\/`. $GOPATH is not needed anymore so we should remove this\n\n```sh\n$ make setup\n\nrm: .GOPATH:\n...\nrm: .GOPATH\/pkg\/mod\/sourcegraph.com\/sqs\/pbtypes@v0.0.0-20180604144634-d3ebe8f20ae4\/void.pb.go: Permission denied\n```\n\n- `make lint` fails with `ERRO Running error: context loading failed: no go files to analyze`\n- Add `make format` for people that run into linter issues , e.g. https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/jobs\/764364111","state":"closed","created_at":1601432352835,"updated_at":1635429996250,"closed_at":1619743775491,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","[deprecated] good for new contributors","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/473","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/473","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/473\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/473\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#473","relative":"#473","full":"gitlab-org\/gitlab-pages#473"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":71658480,"iid":469,"project_id":734943,"title":"Negative cache errored zip archives","description":"Having two intervals:\n\n* positive cache: long-time cache, likely prolonged\n* negative cache: short-time cache, likely not prolonged\n\n---\nThe following discussion from !351 should be addressed:\n\n- [ ] @ayufan started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/351#note_418261431): \n\n    > I believe that we have a TODO item: Should we cache an archive that cannot be read for a long period? Aka. negative cache.\n    > \n    > This works very well for positive cache, but also makes us to cache negative cache (errored archive forever).","state":"closed","created_at":1601000481568,"updated_at":1635430007441,"closed_at":1603966556074,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":1233755,"iid":53,"group_id":9970,"title":"13.6","description":"https:\/\/about.gitlab.com\/releases\/2020\/11\/22\/gitlab-13-6-released\/","state":"closed","created_at":"2020-04-09T17:39:22.328Z","updated_at":"2022-04-13T14:51:04.376Z","due_date":"2020-11-17","start_date":"2020-10-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/53"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":17,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/469","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/469","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/469\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/469\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#469","relative":"#469","full":"gitlab-org\/gitlab-pages#469"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4659.0,"epic":{"id":129623,"iid":4659,"title":"Finalize Pages on zip architecture for rollout to gitlab.com","url":"\/groups\/gitlab-org\/-\/epics\/4659","group_id":9970,"human_readable_end_date":"Dec 22, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":71443472,"iid":468,"project_id":734943,"title":"Ignore `@ hashed` directory when performing disk scan.","description":"In https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/merge_requests\/42461 we store zipped pages site version on the same top directory as other pages content. But add `@hashed` to avoid name collision with namespaces.\n\nIIRC pages currently recusively scans all subdirectories in `shared\/pages`, so we need exclude `shared\/pages\/@hashed`.\n\nIt may sound irrelevant for .com, since we disabled this disk scan completely. But it's not true for self-managed instances, and once we [enable feature flag responsible for creating pages deployments](https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/245308) this directory will appear on self-managed. This may create performance problem and maybe some security risks(unlikely though).\n\nBut maybe pages will just not find `config.json` file there and ignore this directory automatically, but that's need to be tested. :shrug:","state":"closed","created_at":1600689285704,"updated_at":1602701170160,"closed_at":1601371188797,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","[deprecated] low hanging fruit","backend","devops::release [DEPRECATED]","section::ops","type::feature","workflow::in review"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https:\/\/about.gitlab.com\/releases\/2020\/10\/22\/gitlab-13-5-released\/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/52"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":2,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/468","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/468","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/468\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/468\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#468","relative":"#468","full":"gitlab-org\/gitlab-pages#468"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3906.0,"epic":{"id":81057,"iid":3906,"title":"Deploy pages zip archives to object storage\/local storage when pages are deployed","url":"\/groups\/gitlab-org\/-\/epics\/3906","group_id":9970,"human_readable_end_date":"Nov 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":71430811,"iid":466,"project_id":734943,"title":"Handle extra headers when serving from compressed zip archive","description":"Handle some missing headers lost functionality by using `io.Copy` instead of `http.ServeContent`.\n\nGo src for [`http.ServeContent`](https:\/\/github.com\/golang\/go\/blob\/ef20f76b8bc4e082d5f81fd818890d707751475b\/src\/net\/http\/fs.go#L130) as reference.\n\n## Proposal\n\n1. Handle request headers:\n- If-Match\n- If-Unmodified-Since\n- If-None-Match\n- If-Modified-Since\n- ~~If-Range~~ can't use this header with compressed files\n\n2. Set in response header:\n- Last-Modified\n\n~\"backend-weight::2\" \n---\nThe following discussion from !348 should be addressed:\n\n- [ ] @vshushlin started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/348#note_415122700):  (+2 comments)\n\n    > **Question:** from `ServeContent` docs:\n    > \n    > > ...sets the MIME type, and handles If-Match, If-Unmodified-Since, If-None-Match, If-Modified-Since...\n    > \n    > Do we plan to reimplement MIME types and modified-since logic? Do we need follow up issues for them?","state":"closed","created_at":1600674304405,"updated_at":1637025413129,"closed_at":1637025413035,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Next Up","Pages::Object Storage","backend","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":9,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/466","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/466","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/466\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/466\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#466","relative":"#466","full":"gitlab-org\/gitlab-pages#466"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6729.0,"epic":{"id":346861,"iid":6729,"title":"Make GitLab Pages more resilient","url":"\/groups\/gitlab-org\/-\/epics\/6729","group_id":9970,"human_readable_end_date":"Oct 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":71425929,"iid":465,"project_id":734943,"title":"Implement zip cache callbacks","description":"The following discussion from !351 should be addressed:\n\n- [ ] @ayufan started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/351#note_414831416): \n\n    > As a follow-up maybe we would have \"a kind of callback\" on `zipArchive`?\n    > \n    > ```golang\n    > func (z *zipArchive) onCacheAdded() {}\n    > func (z *zipArchive) onCacheRefreshed() {}\n    > func (z *zipArchive) onCacheEvicted() {}\n    > ```\n    > \n    > We would simply call these methods on these points, and they could update metrics on a will, assuming that if you ever call `onCacheAdded()` the `onCacheEvicted()` will be called as well.\n\nAnd implement tests https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/351#note_418262162","state":"closed","created_at":1600664935944,"updated_at":1602120165219,"closed_at":1602120165147,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","feature::addition","section::ops","type::feature","workflow::ready for development"],"milestone":{"id":427855,"iid":11,"group_id":9970,"title":"Next 4-7 releases","description":"Bigger issues we plan to ship in the next 4-7 releases, but don't have a designated release yet. \r\n\r\nDO NOT add small changes, bugs, regressions to this milestone.","state":"active","created_at":"2017-12-11T16:26:55.828Z","updated_at":"2018-08-17T11:09:43.594Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/11"},"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/465","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/465","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/465\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/465\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#465","relative":"#465","full":"gitlab-org\/gitlab-pages#465"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905.0,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"\/groups\/gitlab-org\/-\/epics\/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":71425440,"iid":464,"project_id":734943,"title":"Make zip cache configurable","description":"A simple in-memory cache was introduced in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/351 and https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/364 with some hard-coded values. These should be configurable.\n\n## Proposal\n\n* Add configuration changes flag to Pages\n  - Add a zipCacheConfig type and flags:\n  - `zip-cache-expiration`\n  - `zip-cache-cleanup`\n  - `zip-cache-refresh`\n  - `zip-open-timeout`\n  - ~~`zip-cache-dataoffset-size`~~\n  - ~~`zip-cache-dataoffset-prune-count`~~\n  - ~~`zip-cache-readlink-size`~~\n  - ~~`zip-cache-readlink-prune-count`~~\n* Add documentation\n* Add flag to omnibus\n\n---\nThe following discussion from !351 should be addressed:\n\n- [ ] @jaime started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/351#note_414788991):  (+2 comments)\n\n    > **question**: are these values good enough? Should we make them configurable in future iterations?","state":"closed","created_at":1600663344962,"updated_at":1635430017733,"closed_at":1607292943081,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Next::1-3 releases","Pages::Object Storage","devops::release [DEPRECATED]","group::release [DEPRECATED]","release post item::secondary","section::ops","type::maintenance","workflow::in review"],"milestone":{"id":1233757,"iid":54,"group_id":9970,"title":"13.7","description":"https:\/\/about.gitlab.com\/releases\/archives.html","state":"closed","created_at":"2020-04-09T17:43:14.893Z","updated_at":"2022-04-13T14:51:12.240Z","due_date":"2020-12-17","start_date":"2020-11-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/54"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":17,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/464","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/464","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/464\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/464\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#464","relative":"#464","full":"gitlab-org\/gitlab-pages#464"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905.0,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"\/groups\/gitlab-org\/-\/epics\/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":71182750,"iid":461,"project_id":734943,"title":"Cache dataOffset and symlink when requesting zip files","description":"Currently `Readlink` and `dataOffset` are evaluated each time, we should cache them to lower the latency when serving from zip.\n\nTo ensure that `Readlink` is processed in a predictable time, using minimal amount of requests, especially that in some cases we need to perform symlink traversal.\n\n---\n\nThe following discussion from !348 should be addressed:\n\n- [ ] @ayufan started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/348#note_412690978): \n\n    > I wish that we would cache `dataOffset`, since the `file.DataOffset()` each time makes us to fire additional request.","state":"closed","created_at":1600157247075,"updated_at":1602606963168,"closed_at":1602606963133,"closed_by":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","maintenance::refactor","section::ops","workflow::in review"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https:\/\/about.gitlab.com\/releases\/2020\/10\/22\/gitlab-13-5-released\/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/52"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"user_notes_count":19,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/461","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/461","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/461\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/461\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#461","relative":"#461","full":"gitlab-org\/gitlab-pages#461"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196.0,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"\/groups\/gitlab-org\/-\/epics\/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":70849987,"iid":457,"project_id":734943,"title":"Make httprange http client configurable","description":"In https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/448 we introduced an `httprange` package that can download artifacts and support reading ranges from the response body. The `httpClient` used has a hardcoded timeout which should be configurable.\n\nWe should either pass an httpClient when initializing a resource or some config flags\n\n## Proposal\n\n- Add configuration changes flag to Pages\n- Add documentation\n- Add flag to omnibus\n- Add flag to charts\n\n---\nThe following discussion from !333 should be addressed:\n\n- [ ] @vshushlin started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/333#note_408522039): \n\n    > Do we already have an issue for that? Can we add a link?","state":"closed","created_at":1599531341257,"updated_at":1648616009712,"closed_at":1648616009613,"closed_by":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"labels":["Category:Pages","Next::1-3 releases","Pages::Object Storage","backend","devops::create","group::editor","section::dev","type::maintenance"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/72"},"assignees":[{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":10764887,"username":"vtak","name":"Vishal Tak","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/10764887\/avatar.png","web_url":"https:\/\/gitlab.com\/vtak"},"user_notes_count":4,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/457","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":3,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/457","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/457\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/457\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#457","relative":"#457","full":"gitlab-org\/gitlab-pages#457"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905.0,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"\/groups\/gitlab-org\/-\/epics\/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":70848619,"iid":456,"project_id":734943,"title":"Use versioned templates for security scanners","description":"Some security templates keep changing and they break our pipelines when they are merged to the default branch. We should use a versioned template pointing to a stable branch, e.g.\n\n```yaml\ninclue:\n  - https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/raw\/13-3-stable-ee\/lib\/gitlab\/ci\/templates\/Security\/Dependency-Scanning.gitlab-ci.yml\n```\n\n---\nThe following discussion from !343 should be addressed:\n\n- [ ] @jaime started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/343#note_408774219): \n\n    > We should use versioned templates","state":"closed","created_at":1599527911804,"updated_at":1635430075348,"closed_at":1622427840814,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":1,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/456","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/456","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/456\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/456\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#456","relative":"#456","full":"gitlab-org\/gitlab-pages#456"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":70685400,"iid":453,"project_id":734943,"title":"TestClientStatusClientTimeout flaky","description":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/jobs\/718191293\n\n```\n=== RUN   TestClientStatusClientTimeout\n    client_test.go:303: \n        \tError Trace:\tclient_test.go:303\n        \tError:      \t\"failed to connect to internal Pages API: Get \"http:\/\/127.0.0.1:42673\/api\/v4\/internal\/pages\/status\": context deadline exceeded\" does not contain \"Client.Timeout\"\n        \tTest:       \tTestClientStatusClientTimeout\n--- FAIL: TestClientStatusClientTimeout (0.06s)\n```","state":"closed","created_at":1599138484247,"updated_at":1654001208638,"closed_at":1599142529134,"closed_by":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"labels":["Category:Pages","Pages::Object Storage","devops::data stores","group::application performance","maintenance::refactor","section::enablement"],"milestone":{"id":1233753,"iid":51,"group_id":9970,"title":"13.4","description":"https:\/\/about.gitlab.com\/releases\/2020\/09\/22\/gitlab-13-4-released\/","state":"closed","created_at":"2020-04-09T17:39:21.662Z","updated_at":"2022-04-13T14:50:33.769Z","due_date":"2020-09-17","start_date":"2020-08-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/51"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"user_notes_count":3,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/453","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/453","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/453\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/453\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#453","relative":"#453","full":"gitlab-org\/gitlab-pages#453"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":70194664,"iid":449,"project_id":734943,"title":"Remove GitLab API internal polling","description":"Remove polling from Pages implemented in gitlab-pages!304 (merged)","state":"closed","created_at":1598247899085,"updated_at":1629350486715,"closed_at":1629350486324,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Next::4-7 releases","Pages::Object Storage","[deprecated] low hanging fruit","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/449","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/449","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/449\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/449\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#449","relative":"#449","full":"gitlab-org\/gitlab-pages#449"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":6514.0,"epic":{"id":320001,"iid":6514,"title":"GitLab Pages Post Re-Architecture Cleanup & Improvements","url":"\/groups\/gitlab-org\/-\/epics\/6514","group_id":9970},"iteration":null,"health_status":null},{"id":70178333,"iid":448,"project_id":734943,"title":"Create an `httprange` package to allow loading content from object storage","description":"Source https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/326\/diffs#c697a55849ad2b6da28d7b6de7e8effd7860e40b\n\n- `http_range` should create resources that can be read in chunks from a pre-signed URL\n- Add metrics and traceln","state":"closed","created_at":1598232519390,"updated_at":1600256975011,"closed_at":1600214306787,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","section::ops","workflow::in review"],"milestone":{"id":1233753,"iid":51,"group_id":9970,"title":"13.4","description":"https:\/\/about.gitlab.com\/releases\/2020\/09\/22\/gitlab-13-4-released\/","state":"closed","created_at":"2020-04-09T17:39:21.662Z","updated_at":"2022-04-13T14:50:33.769Z","due_date":"2020-09-17","start_date":"2020-08-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/51"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":25,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/448","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/448","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/448\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/448\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#448","relative":"#448","full":"gitlab-org\/gitlab-pages#448"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196.0,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"\/groups\/gitlab-org\/-\/epics\/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":70174536,"iid":447,"project_id":734943,"title":"Support range requests for zip","description":"PoC https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/331\n\nDepends on https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/448\n\n- Define a `SeekableFile` interface\n- Extend zip http reader to support range requests","state":"closed","created_at":1598230809452,"updated_at":1602813163455,"closed_at":1602739996472,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","section::ops","workflow::production"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https:\/\/about.gitlab.com\/releases\/2020\/10\/22\/gitlab-13-5-released\/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/52"},"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":5,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/447","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/447","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/447\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/447\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#447","relative":"#447","full":"gitlab-org\/gitlab-pages#447"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4256.0,"epic":{"id":99191,"iid":4256,"title":"Support range requests in pages ZIP object storage architecture","url":"\/groups\/gitlab-org\/-\/epics\/4256","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":70053993,"iid":446,"project_id":734943,"title":"Abstract `VFS` `Root`","description":"Currently, pages assumes that projects are located in subdirectories `pages_dir\/group\/subgroup\/project\/public\/index.html`. While in the zip object storage VFS will just have `\/public\/index.html` in the archive structure.\n\nBased on the work in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/439 we want to abstract some kind of `Root directory` for the project. It will allow us to implement zip serving much easier.","state":"closed","created_at":1597911295998,"updated_at":1599748817502,"closed_at":1599748817451,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","section::ops","workflow::verification"],"milestone":{"id":1233753,"iid":51,"group_id":9970,"title":"13.4","description":"https:\/\/about.gitlab.com\/releases\/2020\/09\/22\/gitlab-13-4-released\/","state":"closed","created_at":"2020-04-09T17:39:21.662Z","updated_at":"2022-04-13T14:50:33.769Z","due_date":"2020-09-17","start_date":"2020-08-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/51"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"user_notes_count":2,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/446","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/446","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/446\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/446\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#446","relative":"#446","full":"gitlab-org\/gitlab-pages#446"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196.0,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"\/groups\/gitlab-org\/-\/epics\/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":69757262,"iid":444,"project_id":734943,"title":"Support VFS serving from LookupPath","description":"- Add a `VFS` type to `LookupPath`\n- Extend the serving `Reader` to hold a map of `VFS`'s\n- Resolve file contents using the specified `VFS`\n\nMR https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/329\/diffs","state":"closed","created_at":1597229779871,"updated_at":1599182586219,"closed_at":1599182586171,"closed_by":{"id":5622641,"username":"nicolewilliams","name":"Nicole Williams","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/5622641\/avatar.png","web_url":"https:\/\/gitlab.com\/nicolewilliams"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","section::ops","workflow::in dev"],"milestone":{"id":1233753,"iid":51,"group_id":9970,"title":"13.4","description":"https:\/\/about.gitlab.com\/releases\/2020\/09\/22\/gitlab-13-4-released\/","state":"closed","created_at":"2020-04-09T17:39:21.662Z","updated_at":"2022-04-13T14:50:33.769Z","due_date":"2020-09-17","start_date":"2020-08-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/51"},"assignees":[{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":12452,"username":"ayufan","name":"Kamil Trzci\u0144ski","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/7a285e30f35d72526fb0954e8fe7cefa?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/ayufan"},"user_notes_count":11,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/444","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/444","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/444\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/444\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#444","relative":"#444","full":"gitlab-org\/gitlab-pages#444"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196.0,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"\/groups\/gitlab-org\/-\/epics\/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":69757192,"iid":443,"project_id":734943,"title":"VFS implementation for zip archives","description":"Add `zip` implementation of the VFS interface introduced in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/324 and !325.\n\nDepends on https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/446 and https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/448.\n\n- Add a `zip` package that opens archives using `http_range` - source https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/326\/diffs#f0eb7ce2a638003d1f5dd027e9b5ce3aa44355e7_0_1\n- Implement the `VFS` interface - source https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/326\/diffs#21487386d5527c7631ac241c03fb0400516c3839_0_1\n- Update metrics acceptance tests for `TestPrometheusMetricsCanBeScraped`","state":"closed","created_at":1597229637104,"updated_at":1603004971438,"closed_at":1601428896284,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Deliverable","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","section::ops","workflow::production"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https:\/\/about.gitlab.com\/releases\/2020\/10\/22\/gitlab-13-5-released\/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/52"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":38,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/443","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/443","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/443\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/443\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#443","relative":"#443","full":"gitlab-org\/gitlab-pages#443"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196.0,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"\/groups\/gitlab-org\/-\/epics\/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":69101016,"iid":436,"project_id":734943,"title":"Fix intermittent cache test failures","description":"Job [#658818771](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/jobs\/658818771) failed for 43f724fe2886e07cd97799ff0a14a3b98a239ec3:\n\n```plaintext\n    --- FAIL: TestResolve\/when_retrieval_failed_because_of_resolution_context_being_canceled (0.00s)\n        cache_test.go:264: \n            \tError Trace:\tcache_test.go:264\n            \t            \t\t\t\tcache_test.go:113\n            \t            \t\t\t\tcache_test.go:253\n            \t            \t\t\t\tcache_test.go:93\n            \t            \t\t\t\tcache_test.go:252\n            \tError:      \tAn error is expected but got nil.\n            \tTest:       \tTestResolve\/when_retrieval_failed_because_of_resolution_context_being_canceled\n```\n\nAnother job https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/jobs\/658818891\n\n```plaintext\n=== RUN   TestResolve\/when_item_is_in_long_cache_only\n    cache_test.go:207: \n        \tError Trace:\tcache_test.go:207\n        \t            \t\t\t\tcache_test.go:113\n        \t            \t\t\t\tcache_test.go:200\n        \t            \t\t\t\tcache_test.go:93\n        \t            \t\t\t\tcache_test.go:199\n        \tError:      \tNot equal: \n        \t            \texpected: 0x1\n        \t            \tactual  : 0x0\n        \tTest:       \tTestResolve\/when_item_is_in_long_cache_only\n```\n\nRetrying a job fixes it https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/jobs\/658821575","state":"closed","created_at":1595911745917,"updated_at":1599063122632,"closed_at":1599034886283,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","cicd::active","devops::release [DEPRECATED]","maintenance::refactor","section::ops"],"milestone":{"id":1233753,"iid":51,"group_id":9970,"title":"13.4","description":"https:\/\/about.gitlab.com\/releases\/2020\/09\/22\/gitlab-13-4-released\/","state":"closed","created_at":"2020-04-09T17:39:21.662Z","updated_at":"2022-04-13T14:50:33.769Z","due_date":"2020-09-17","start_date":"2020-08-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/51"},"assignees":[{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/263716\/avatar.jpeg","web_url":"https:\/\/gitlab.com\/grzesiek"},{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":263716,"username":"grzesiek","name":"Grzegorz Bizon | OOO until May 15th","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/263716\/avatar.jpeg","web_url":"https:\/\/gitlab.com\/grzesiek"},"user_notes_count":21,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/436","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/436","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/436\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/436\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#436","relative":"#436","full":"gitlab-org\/gitlab-pages#436"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":68932846,"iid":435,"project_id":734943,"title":"Use exponential back-off for polling status endpoint","description":"The following discussion from !304 should be addressed:\n\n- [ ] @jaime started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/304#note_382039256):  (+2 comments)\n\n    > **question**: should we consider using an exponential back-off approach?\n    > \n    > Some sample library https:\/\/pkg.go.dev\/github.com\/cenkalti\/backoff\/v4?tab=doc#pkg-examples","state":"closed","created_at":1595568793660,"updated_at":1598234130645,"closed_at":1597055194639,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Deliverable","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","workflow::in review"],"milestone":{"id":1233752,"iid":50,"group_id":9970,"title":"13.3","description":"https:\/\/about.gitlab.com\/releases\/2020\/08\/22\/gitlab-13-3-released\/","state":"closed","created_at":"2020-04-09T17:39:21.090Z","updated_at":"2022-04-13T14:50:18.976Z","due_date":"2020-08-17","start_date":"2020-07-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/50"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":12,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/435","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/435","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/435\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/435\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#435","relative":"#435","full":"gitlab-org\/gitlab-pages#435"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4242.0,"epic":{"id":97712,"iid":4242,"title":"Move pages domain\/project configuration to the API","url":"\/groups\/gitlab-org\/-\/epics\/4242","group_id":9970,"human_readable_end_date":"May 17, 2021","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":59219708,"iid":434,"project_id":734943,"title":"Adopt zip package from workhorse","description":"Extracted from https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/28784#note_375446009","state":"closed","created_at":1594819736899,"updated_at":1594819810945,"closed_at":1594819810915,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","devops::release [DEPRECATED]"],"milestone":null,"assignees":[],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":null,"user_notes_count":0,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/434","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/434","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/434\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/434\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#434","relative":"#434","full":"gitlab-org\/gitlab-pages#434"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":54558743,"iid":432,"project_id":734943,"title":"Preprocess zip archives on load and cache file structure","description":"Preprocess zip archive and cache relevant files:\n\n* cache only relevant list of files with references where to fetch them in an efficient way\n* cache into a `map` to have `O(logn)` search\n\nReference code https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/326\/diffs#f0eb7ce2a638003d1f5dd027e9b5ce3aa44355e7_0_34\n\nDepends on https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/443\n\n### Considerations\n\nA noticeable change came up during the [profiler demo](https:\/\/gitlab.com\/gitlab-com\/gl-infra\/scalability\/-\/issues\/479#note_423617206) with ~\"team::Scalability\"  where we saw that `readArchive` is allocating a considerable amount of memory (about 28MB for the top 1%) for `docs.gitlab.com` alone in production. \n\n[Profiler on GCP](https:\/\/console.cloud.google.com\/profiler;timespan=1h\/gitlab-pages;type=HEAP\/inuse_space?project=gitlab-production) (internal) \n\n![Screen_Shot_2020-10-08_at_3.21.17_pm](\/uploads\/6a0a161802a5c7b5d2c31b5dcbe4be06\/Screen_Shot_2020-10-08_at_3.21.17_pm.png)\n\n[Allocated memory spike](https:\/\/prometheus-app.gprd.gitlab.net\/graph?g0.range_input=1w&g0.stacked=1&g0.expr=max(go_memstats_alloc_bytes%7Binstance%3D~%22web-pages-.*%22%7D)&g0.tab=0) after enabling Zip for 5% of Pages projects on 2020-10-08 ~12:30 UTC\n\n![Screen_Shot_2020-10-12_at_10.52.25_am](\/uploads\/36f50746826ed854b4d2a2019d6cbad9\/Screen_Shot_2020-10-12_at_10.52.25_am.png)\n\n---\n<details>\n<summary>The following discussion from !299 should be addressed:\n<\/summary>\n- [ ] @ayufan started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/299#note_377210608): \n\n    > Oh, yes, yes, yes. It would really help to convert a flat list into:\n    > \n    > - `map[string]zip.File`, ideally with `zip.File` having an `offset` as well\n    > \n    > And, drop all the ones that are not within `public\/`\n\nCache flat list idea https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/299#note_377210617\n<\/details>","state":"closed","created_at":1594597290593,"updated_at":1644485809366,"closed_at":1644485809338,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Next::4-7 releases","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":18,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/432","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/432","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/432\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/432\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#432","relative":"#432","full":"gitlab-org\/gitlab-pages#432"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3905.0,"epic":{"id":81055,"iid":3905,"title":"Improvements to serve GitLab Pages via Object Storage","url":"\/groups\/gitlab-org\/-\/epics\/3905","group_id":9970,"human_readable_end_date":"Apr 17, 2022","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":54062784,"iid":426,"project_id":734943,"title":"Tech Evaluation of supporting NFS in cloud native deployments as an alternative to object storage for Pages","description":"### Problem to solve \n\nSupport for object storage in Pages is currently looking to arrive early FY22.\n\nThis is impacting a few deployments to our `gitlab` helm chart:\n\n1. GitLab.com's [migration to Kubernetes](https:\/\/gitlab.com\/groups\/gitlab-com\/gl-infra\/-\/epics\/98) (multiple services depend upon Pages - including web and api services)\n1. A very large opportunity who requires Pages\n\nOne way to potentially solve this, is to introduce shared storage into our Kubernetes deployments.\n\n### Evaluation \n\n* [ ] Discuss feasibility of this idea with ~\"group::distribution\", ~infrastructure, and ~Quality \n* [ ] Ask large opportunity if they would be open to \/ capable of utilizing shared storage in their Kubernetes cluster\n* [ ] Implement Pages in the Helm chart and cloud native images (does not look like this is present today) - https:\/\/gitlab.com\/gitlab-org\/charts\/gitlab\/-\/issues\/37\n  * [ ] Add support for a shared `ReadWriteMany` PV across needed services (Pages, Sidekiq, API, and Web)\n* [ ] Run a 50k architecture load test on a cloud native deployment with Pages (will require utilizing something like Rook, Portworx, etc. to provide ReadWriteMany support)\n* [ ] Strongly consider utilizing this architecture on GitLab.com, so we can move forward with k8s migration\/dogfooding, as well as confirm this Pages architecture works at scale before recommending to our customers\n* [ ] Launch official support for Pages in Helm charts using shared storage","state":"closed","created_at":1594155551915,"updated_at":1606237811594,"closed_at":1599768439106,"closed_by":{"id":4905402,"username":"jreporter","name":"Jackie Porter","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4905402\/avatar.png","web_url":"https:\/\/gitlab.com\/jreporter"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","kubernetes-migration-blocker","section::ops","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":4905402,"username":"jreporter","name":"Jackie Porter","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4905402\/avatar.png","web_url":"https:\/\/gitlab.com\/jreporter"},"type":"ISSUE","assignee":null,"user_notes_count":26,"merge_requests_count":0,"upvotes":2,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/426","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":7,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/426","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/426\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/426\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#426","relative":"#426","full":"gitlab-org\/gitlab-pages#426"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":1316.0,"epic":{"id":7325,"iid":1316,"title":"GitLab Pages Architecture Updates","url":"\/groups\/gitlab-org\/-\/epics\/1316","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":53851171,"iid":423,"project_id":734943,"title":"Add metrics for zip serving","description":"Zip serving package implements the `type Serving interface`. We should add some metrics to serve from zip archives similar to https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/365 so that we can track and compare serving times from archives vs disk.\n\n- ZipServingOpenArchivesTotal\n- ZipServingFilesPerArchiveCount\n\nhttps:\/\/gitlab.slack.com\/archives\/C1BSEQ138\/p1601113581019900\n\n> I think we should for OS access have a histogram of timings of different request stages, like: connection, tls handshake, response write, response to the first byte, response read. This would allow us to understand how responsive is OS on different stages. (edited) \n\n>Also, for caches we should have hit\/miss metric, and amount of cache entries :slightly_smiling_face:","state":"closed","created_at":1593739335708,"updated_at":1601562435723,"closed_at":1601542511234,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Pages::Object Storage","devops::release [DEPRECATED]","section::ops","workflow::in review"],"milestone":{"id":1233754,"iid":52,"group_id":9970,"title":"13.5","description":"https:\/\/about.gitlab.com\/releases\/2020\/10\/22\/gitlab-13-5-released\/","state":"closed","created_at":"2020-04-09T17:39:21.990Z","updated_at":"2022-04-21T07:21:12.213Z","due_date":"2020-10-17","start_date":"2020-09-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/52"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":14,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/423","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/423","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/423\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/423\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#423","relative":"#423","full":"gitlab-org\/gitlab-pages#423"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4196.0,"epic":{"id":94157,"iid":4196,"title":"Object storage for GitLab Pages(golang side)","url":"\/groups\/gitlab-org\/-\/epics\/4196","group_id":9970,"human_readable_end_date":"Oct 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":53850876,"iid":421,"project_id":734943,"title":"Tech Evaluation: Extract the Reader logic from disk serving into its own package so it can be reused","description":"Serving from disk uses the [`type Reader struct`](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/blob\/master\/internal\/serving\/disk\/reader.go#L19) to try to find and resolve paths from the file system structure. \n\nThis logic can be reused to serve content from zip archives https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/299\/diffs#580d90130ae2083bae1a5eda81a8947e0b57d443_0_51","state":"closed","created_at":1593738281782,"updated_at":1596736538851,"closed_at":1596736413294,"closed_by":{"id":5622641,"username":"nicolewilliams","name":"Nicole Williams","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/5622641\/avatar.png","web_url":"https:\/\/gitlab.com\/nicolewilliams"},"labels":["Category:Pages","Pages::Object Storage","cicd::active","devops::release [DEPRECATED]","workflow::in dev"],"milestone":{"id":1233752,"iid":50,"group_id":9970,"title":"13.3","description":"https:\/\/about.gitlab.com\/releases\/2020\/08\/22\/gitlab-13-3-released\/","state":"closed","created_at":"2020-04-09T17:39:21.090Z","updated_at":"2022-04-13T14:50:18.976Z","due_date":"2020-08-17","start_date":"2020-07-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/50"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":18,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/421","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/421","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/421\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/421\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#421","relative":"#421","full":"gitlab-org\/gitlab-pages#421"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":3908.0,"epic":{"id":81060,"iid":3908,"title":"Object storage for GitLab Pages (golang side\/zip version)","url":"\/groups\/gitlab-org\/-\/epics\/3908","group_id":9970,"human_readable_end_date":"Aug 17, 2020","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null},{"id":35363254,"iid":403,"project_id":734943,"title":"root config contains unknown keys: license_management","description":"Pipeline failed `root config contains unknown keys: license_management`\n\nhttps:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/pipelines\/152290252\n\n`license_management` has been deprecated https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/14624\n\nWe need to update to `license_scanning`","state":"closed","created_at":1591168146761,"updated_at":1591169141809,"closed_at":1591168543346,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Stuff that should Just Work","devops::release [DEPRECATED]"],"milestone":null,"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":1,"merge_requests_count":0,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/403","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/403","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/403\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/403\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#403","relative":"#403","full":"gitlab-org\/gitlab-pages#403"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":35168405,"iid":400,"project_id":734943,"title":"Remove eslint sast","description":"For some reason, eslint-sast decided that we need it, and now pipeline is passed with warnings :see_no_evil:\n\nhttps:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/pipelines\/150886980","state":"closed","created_at":1590753469820,"updated_at":1591007990763,"closed_at":1591007990696,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Stuff that should Just Work","backend","backstage [DEPRECATED]","devops::release [DEPRECATED]"],"milestone":{"id":1112145,"iid":47,"group_id":9970,"title":"13.1","description":"","state":"closed","created_at":"2020-01-03T12:28:30.160Z","updated_at":"2020-10-08T12:01:07.361Z","due_date":"2020-06-17","start_date":"2020-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/47"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":2,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/400","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/400","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/400\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/400\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#400","relative":"#400","full":"gitlab-org\/gitlab-pages#400"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34952382,"iid":395,"project_id":734943,"title":"Keep track of dev dependencies in go.mod","description":"When running `make setup`, the dev tools will be installed into the project's local `.GOPATH`. However, this overwrites the `go.mod` and `go.sum` files with a reference to those tools. The `make deps-check` rule will fail **If the changes are committed by mistake**.\n\nUsing a `tools.go` file is a common pattern to keep track of dev dependencies inside the `go.mod` file.\n\nThe [release-cli tools.go](https:\/\/gitlab.com\/gitlab-org\/release-cli\/-\/blob\/master\/cmd\/release-cli\/tools.go) has an example of how to do it. We also reference https:\/\/marcofranssen.nl\/manage-go-tools-via-go-modules\/:\n\n> To ensure my tool dependencies are not removed and can leverage the Go Modules, I create a file tools.go. In this file I will list all my tool dependencies using an import statement.\n\nTo do:\n\n- Add a file called `tools.go` to the root directory and add the dev\/tool dependencies.\n- `make deps-check` will add an entry to `go.mod`, consider version locking to a desired release.\n- Commit the changes.","state":"closed","created_at":1590372430975,"updated_at":1635430286046,"closed_at":1627523199663,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","backend","backstage [DEPRECATED]","devops::release [DEPRECATED]","group::release [DEPRECATED]","maintenance::refactor","section::ops","type::maintenance"],"milestone":null,"assignees":[],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":null,"user_notes_count":2,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/395","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/395","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/395\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/395\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#395","relative":"#395","full":"gitlab-org\/gitlab-pages#395"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34867840,"iid":394,"project_id":734943,"title":"SAST scanning fails intermittently","description":"Example of a job where the SAST scanning fails\n\nJob [#562578827](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/jobs\/562578827) failed for 98c479549ef6e4017fa052a4d5f19535e70b6d2e:\n\n```\ndocker: error during connect: Post http:\/\/docker:2375\/v1.40\/containers\/create: dial tcp: lookup docker on 169.254.169.254:53: no such host.\n```\n\nFrom [Slack thread](https:\/\/gitlab.slack.com\/archives\/CETG54GQ0\/p1590023829443200)\n\n> @fcatteau license-scanning works fine so this might be related to sast, and in that case the legacy SAST orchestrator (Docker-in-Docker)\n\n>by the way, the CI configuration implicitly enables the Docker-in-Docker orchestrator for SAST even though the no-DinD is now the default\nhttps:\/\/gitlab.com\/gitlab-org\/security\/gitlab-pages\/-\/blob\/master\/.gitlab-ci.yml#L63\nsee https:\/\/gitlab.com\/gitlab-org\/gitlab\/-\/issues\/218541\n\n>the important difference between sast and license-scanning is that the former explicitly calls docker run whereas the latter sets the image.name in its job definition. this might explain why License Scanning works. I'm able to pull registry.gitlab.com\/gitlab-org\/security-products\/sast:2 though\n\n>  I suggest you override the rules of the *-sast jobs triggered for this project, and don't override sast anymore. could you try that in a MR? also, I suggest you share this with #g_secure-static-analysis\n\n> actually you only need to override secrets-sast and gosec-sast . see https:\/\/gitlab.com\/gitlab-org\/security\/gitlab-pages\/-\/jobs\/548248714#L192","state":"closed","created_at":1590113455273,"updated_at":1590734720817,"closed_at":1590422020340,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","Stuff that should Just Work","cicd::active","devops::release [DEPRECATED]","security reports","type::bug","workflow::in review"],"milestone":{"id":1112145,"iid":47,"group_id":9970,"title":"13.1","description":"","state":"closed","created_at":"2020-01-03T12:28:30.160Z","updated_at":"2020-10-08T12:01:07.361Z","due_date":"2020-06-17","start_date":"2020-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/47"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":13,"merge_requests_count":1,"upvotes":0,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/394","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/394","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/394\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/394\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#394","relative":"#394","full":"gitlab-org\/gitlab-pages#394"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34789512,"iid":393,"project_id":734943,"title":"Add Dangerbot to Pages","description":"Pages does not currently have a Dangerbot and therefore does not suggest reviewers for MRs. In theory any engineer working on Golang should be able to do reviews, so there would be a large pool of reviewers.\n\nThe maintainer pool in Pages is quite small presently, but this is [being worked on](https:\/\/gitlab.com\/gitlab-com\/www-gitlab-com\/-\/issues\/7701), with the intention of developing more maintainers within ~\"group::release\".\n\nAdditional reviewers would be added to `team.yml`\n\n```yml\n  projects:\n    gitlab-pages: reviewer\n```","state":"closed","created_at":1589961374188,"updated_at":1649923563049,"closed_at":1649923562375,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","backend","backstage [DEPRECATED]","cicd::active","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::maintenance","workflow::ready for development"],"milestone":{"id":2204142,"iid":72,"group_id":9970,"title":"14.10","description":"","state":"active","created_at":"2021-08-26T19:12:33.701Z","updated_at":"2021-08-26T19:12:33.701Z","due_date":"2022-04-17","start_date":"2022-03-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/72"},"assignees":[{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"}],"author":{"id":4391348,"username":"sean_carroll","name":"Sean Carroll","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4391348\/avatar.png","web_url":"https:\/\/gitlab.com\/sean_carroll"},"type":"ISSUE","assignee":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"user_notes_count":26,"merge_requests_count":0,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/393","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":0,"completed_count":0},"weight":2,"blocking_issues_count":0,"has_tasks":true,"task_status":"0 of 0 checklist items completed","_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/393","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/393\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/393\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#393","relative":"#393","full":"gitlab-org\/gitlab-pages#393"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34562513,"iid":391,"project_id":734943,"title":"Tech Evaluation for option B of Serve custom 404.html file for namespace domains","description":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/183\n\nOpen the research issue for implementing the approach `B` and prioritize it. It's really tricky to implement and basically only `custom 404s for namespace level projects, e.g. username.gitlab.io` are broken, they are not broken on custom domains or on `username.gitlab.io\/myprojectname`.\n\nTasks\n\n* [ ]  Update proposal for linked issue ","state":"closed","created_at":1589468968045,"updated_at":1594643677216,"closed_at":1594643676925,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","cicd::active","devops::release [DEPRECATED]","feature flag","workflow::ready for development"],"milestone":{"id":490705,"iid":14,"group_id":9970,"title":"Backlog","description":"Issues that we want to do but are not planned right now. Open for contribution from the community.","state":"active","created_at":"2018-03-22T13:09:23.767Z","updated_at":"2018-10-30T14:56:54.069Z","due_date":null,"start_date":null,"expired":false,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/14"},"assignees":[],"author":{"id":4905402,"username":"jreporter","name":"Jackie Porter","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4905402\/avatar.png","web_url":"https:\/\/gitlab.com\/jreporter"},"type":"ISSUE","assignee":null,"user_notes_count":3,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/391","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":1,"completed_count":0},"weight":1,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/391","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/391\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/391\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#391","relative":"#391","full":"gitlab-org\/gitlab-pages#391"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34133160,"iid":385,"project_id":734943,"title":"Use custom .golangci.yml file with improved lint rules","description":"The following discussion from !264 should be addressed:\r\n\r\n- [ ] @krasio started a [discussion](https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/264#note_333342106):  (+2 comments)\r\n\r\n    > Is this to avoid name clash with the `client` package?\r\n\r\n--- \r\n\r\nWe use [automatic linting](https:\/\/docs.gitlab.com\/ee\/development\/go_guide\/#automatic-linting) via `golangci-lint` with a default set of relaxed rules. To improve the code style we should add a custom `.golangci.yml` file enabling a set of useful linters.\r\n\r\nWe can use [GitLab's Runner `.golangci.yml`](https:\/\/gitlab.com\/gitlab-org\/gitlab-runner\/-\/blob\/master\/.golangci.yml) for consistency or use as a base for the set of rules we want to apply to Pages.\r\n\r\n\r\ncc @krasio @vshushlin @sean_carroll\r\n\r\n--- \r\n\r\n## Linters\r\n\r\nFrom [GitLab's Runner `.golangci.yml`](https:\/\/gitlab.com\/gitlab-org\/gitlab-runner\/-\/blob\/master\/.golangci.yml)\r\n\r\n| Linter | Enable in iteration # | \r\n| ------ | :--------------------:|\r\n| bodyclose | 2 |\r\n| deadcode | 2 |\r\n| dogsled | 2 |\r\n| goconst | 1 |\r\n| gocyclo | 1 |\r\n| goimports | 1 |\r\n| golint | 1 |\r\n| gosec | 1 |\r\n| gosimple | 1 |\r\n| govet | 1 |\r\n| ineffassign | 2 |\r\n| misspell | 2 |\r\n| structcheck | 2 |\r\n| typecheck | 2 |\r\n| unconvert | 2 |\r\n| unused | 2 |\r\n| varcheck | 2 |\r\n| whitespace | 2 |\r\n\r\n### Other linters to consider\r\n\r\nList of supported [linters](https:\/\/golangci-lint.run\/usage\/linters\/) by `golangci-lint`\r\n\r\n| Linter | Description |\r\n| ------ | :----------:|\r\n| wsl | improve empty line spacing (annoying but makes the code more readable) |\r\n| interfacer | Linter that suggests narrower interface types |\r\n| lll | long lines |\r\n| unparam |  Reports unused function parameters |\r\n| gocritic | The most opinionated Go source code linter |\r\n| gochecknoinits | This will help with #342 |\r\n\r\n---\r\n\r\n## MRs\r\n\r\n- [x] Add .golangci.yml linter configuration !286 \r\n- [x] Enable more linters https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/287","state":"closed","created_at":1588639200985,"updated_at":1592510953097,"closed_at":1591167611249,"closed_by":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"labels":["Category:Pages","backstage [DEPRECATED]","cicd::active","devops::release [DEPRECATED]","maintenance::refactor","workflow::in review"],"milestone":{"id":1112145,"iid":47,"group_id":9970,"title":"13.1","description":"","state":"closed","created_at":"2020-01-03T12:28:30.160Z","updated_at":"2020-10-08T12:01:07.361Z","due_date":"2020-06-17","start_date":"2020-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/47"},"assignees":[{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"}],"author":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"type":"ISSUE","assignee":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"user_notes_count":7,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/385","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":3,"completed_count":2},"weight":2,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/385","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/385\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/385\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#385","relative":"#385","full":"gitlab-org\/gitlab-pages#385"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":null,"epic":null,"iteration":null,"health_status":null},{"id":34001444,"iid":383,"project_id":734943,"title":"Remove `gitlab-server` fallback to `auth-server` and `artifacts server`","description":"Currently `auth-server` and `artifacts-server` may be used instead of `gitlab-server` command line flag. That was done for a seamless upgrade.\n\nDeprecation was announced, so we can just remove it in %\"14.0\"\n\nFrom @igorwwwwwwwwwwwwwwwwwwww's comment https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/270#note_334218639 :\n\n> Alternatively, I think it might be good to remove this fallback logic.\n> \n> From an operational perspective, I found it very surprising that `gitlab-server` inherits from both auth server as well as artifacts server.\n> \n> I would find the inverse *much* more intuitive. But even having to specify all the params would be acceptable.\n> \n> So if we can verify that the main consumers of this (probably just omnibus?) are always specifying `gitlab-server` explicitly, it may be worth simply requiring it to be specified without fallback.\n\nWe need to:\n\n- [x] Mark auth-server as deprecate in Omnibus(might be already done)\n- [x] Make a release deprecation post. draft:\n```\nWe're changing the behaviour of some configuration options of GitLab Pages. If you run GitLab Pages via Omnibus based package, no action required. Otherwise, make sure to set [`gitlab-server` parameter and remove `auth-server`](https:\/\/docs.gitlab.com\/ee\/administration\/pages\/).\n```\n\n\nLater we may consider removing `artifacts-server` and use `gitlab-server`(or better: new parameter introduced in https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/merge_requests\/276) and appending path.","state":"closed","created_at":1588255176861,"updated_at":1621216487666,"closed_at":1621216487559,"closed_by":{"id":4082686,"username":"jaime","name":"Jaime Martinez","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/4082686\/avatar.png","web_url":"https:\/\/gitlab.com\/jaime"},"labels":["Category:Pages","Community contribution","backend","backstage [DEPRECATED]","cicd::active","deprecation","devops::release [DEPRECATED]","group::release [DEPRECATED]","section::ops","type::feature","workflow::in dev"],"milestone":{"id":1850113,"iid":60,"group_id":9970,"title":"14.0","description":"","state":"closed","created_at":"2021-01-26T16:55:07.714Z","updated_at":"2022-04-21T07:25:17.749Z","due_date":"2021-06-17","start_date":"2021-05-18","expired":true,"web_url":"https:\/\/gitlab.com\/groups\/gitlab-org\/-\/milestones\/60"},"assignees":[{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/40569112d16323eb878ebdead2117943?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/feistel"}],"author":{"id":3379682,"username":"vshushlin","name":"Vladimir Shushlin","state":"active","avatar_url":"https:\/\/gitlab.com\/uploads\/-\/system\/user\/avatar\/3379682\/avatar.png","web_url":"https:\/\/gitlab.com\/vshushlin"},"type":"ISSUE","assignee":{"id":6742251,"username":"feistel","name":"feistel","state":"active","avatar_url":"https:\/\/secure.gravatar.com\/avatar\/40569112d16323eb878ebdead2117943?s=80&d=identicon","web_url":"https:\/\/gitlab.com\/feistel"},"user_notes_count":4,"merge_requests_count":1,"upvotes":1,"downvotes":0,"due_date":null,"confidential":false,"discussion_locked":null,"issue_type":"issue","web_url":"https:\/\/gitlab.com\/gitlab-org\/gitlab-pages\/-\/issues\/383","time_stats":{"time_estimate":0,"total_time_spent":0,"human_time_estimate":null,"human_total_time_spent":null},"task_completion_status":{"count":2,"completed_count":2},"weight":2,"blocking_issues_count":0,"has_tasks":false,"task_status":null,"_links":{"self":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/383","notes":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/383\/notes","award_emoji":"https:\/\/gitlab.com\/api\/v4\/projects\/734943\/issues\/383\/award_emoji","project":"https:\/\/gitlab.com\/api\/v4\/projects\/734943","closed_as_duplicate_of":null},"references":{"short":"#383","relative":"#383","full":"gitlab-org\/gitlab-pages#383"},"severity":"UNKNOWN","moved_to_id":null,"service_desk_reply_to":null,"epic_iid":4705.0,"epic":{"id":134034,"iid":4705,"title":"14.0 Release Team feature removals","url":"\/groups\/gitlab-org\/-\/epics\/4705","group_id":9970,"human_readable_end_date":"Sep 17, 2021","human_readable_timestamp":"<strong>Past due<\/strong>"},"iteration":null,"health_status":null}]